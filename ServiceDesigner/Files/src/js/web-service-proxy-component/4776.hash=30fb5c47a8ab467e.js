(self.webpackChunkapp_studio_enterprise_web_service=self.webpackChunkapp_studio_enterprise_web_service||[]).push([[4776],{4776:(de,F,C)=>{C.r(F),C.d(F,{RegExpCursor:()=>Q,SearchCursor:()=>d,SearchQuery:()=>N,closeSearchPanel:()=>G,findNext:()=>W,findPrevious:()=>P,getSearchQuery:()=>Pe,gotoLine:()=>te,highlightSelectionMatches:()=>xe,openSearchPanel:()=>j,replaceAll:()=>ae,replaceNext:()=>H,search:()=>Ae,searchKeymap:()=>qe,searchPanelOpen:()=>_e,selectMatches:()=>le,selectNextOccurrence:()=>ie,selectSelectionMatches:()=>oe,setSearchQuery:()=>k});var h=C(27875),c=C(20920),u=C(90380);const p=typeof String.prototype.normalize=="function"?t=>t.normalize("NFKD"):t=>t;class d{constructor(e,r,n=0,i=e.length,s,l){this.test=l,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(n,i),this.bufferStart=n,this.normalize=s?o=>s(p(o)):p,this.query=this.normalize(r)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return(0,c.codePointAt)(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let r=(0,c.fromCodePoint)(e),n=this.bufferStart+this.bufferPos;this.bufferPos+=(0,c.codePointSize)(e);let i=this.normalize(r);if(i.length)for(let s=0,l=n;;s++){let o=i.charCodeAt(s),a=this.match(o,l,this.bufferPos+this.bufferStart);if(s==i.length-1){if(a)return this.value=a,this;break}l==n&&s<r.length&&r.charCodeAt(s)==o&&l++}}}match(e,r,n){let i=null;for(let s=0;s<this.matches.length;s+=2){let l=this.matches[s],o=!1;this.query.charCodeAt(l)==e&&(l==this.query.length-1?i={from:this.matches[s+1],to:n}:(this.matches[s]++,o=!0)),o||(this.matches.splice(s,2),s-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?i={from:r,to:n}:this.matches.push(1,r)),i&&this.test&&!this.test(i.from,i.to,this.buffer,this.bufferStart)&&(i=null),i}}typeof Symbol<"u"&&(d.prototype[Symbol.iterator]=function(){return this});const M={from:-1,to:-1,match:/.*/.exec("")},y="gm"+(/x/.unicode==null?"":"u");class Q{constructor(e,r,n,i=0,s=e.length){if(this.text=e,this.to=s,this.curLine="",this.done=!1,this.value=M,/\\[sWDnr]|\n|\r|\[\^/.test(r))return new Z(e,r,n,i,s);this.re=new RegExp(r,y+(n?.ignoreCase?"i":"")),this.test=n?.test,this.iter=e.iter();let l=e.lineAt(i);this.curLineStart=l.from,this.matchPos=R(e,i),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let r=this.matchPos<=this.to&&this.re.exec(this.curLine);if(r){let n=this.curLineStart+r.index,i=n+r[0].length;if(this.matchPos=R(this.text,i+(n==i?1:0)),n==this.curLineStart+this.curLine.length&&this.nextLine(),(n<i||n>this.value.to)&&(!this.test||this.test(n,i,r)))return this.value={from:n,to:i,match:r},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const $=new WeakMap;class v{constructor(e,r){this.from=e,this.text=r}get to(){return this.from+this.text.length}static get(e,r,n){let i=$.get(e);if(!i||i.from>=n||i.to<=r){let o=new v(r,e.sliceString(r,n));return $.set(e,o),o}if(i.from==r&&i.to==n)return i;let{text:s,from:l}=i;return l>r&&(s=e.sliceString(r,l)+s,l=r),i.to<n&&(s+=e.sliceString(i.to,n)),$.set(e,new v(l,s)),new v(r,s.slice(r-l,n-l))}}class Z{constructor(e,r,n,i,s){this.text=e,this.to=s,this.done=!1,this.value=M,this.matchPos=R(e,i),this.re=new RegExp(r,y+(n?.ignoreCase?"i":"")),this.test=n?.test,this.flat=v.get(e,i,this.chunkEnd(i+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,r=this.re.exec(this.flat.text);if(r&&!r[0]&&r.index==e&&(this.re.lastIndex=e+1,r=this.re.exec(this.flat.text)),r){let n=this.flat.from+r.index,i=n+r[0].length;if((this.flat.to>=this.to||r.index+r[0].length<=this.flat.text.length-10)&&(!this.test||this.test(n,i,r)))return this.value={from:n,to:i,match:r},this.matchPos=R(this.text,i+(n==i?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=v.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(Q.prototype[Symbol.iterator]=Z.prototype[Symbol.iterator]=function(){return this});function pe(t){try{return new RegExp(t,y),!0}catch{return!1}}function R(t,e){if(e>=t.length)return e;let r=t.lineAt(e),n;for(;e<r.to&&(n=r.text.charCodeAt(e-r.from))>=56320&&n<57344;)e++;return e}function B(t){let e=String(t.state.doc.lineAt(t.state.selection.main.head).number),r=(0,u.A)("input",{class:"cm-textfield",name:"line",value:e}),n=(0,u.A)("form",{class:"cm-gotoLine",onkeydown:s=>{s.keyCode==27?(s.preventDefault(),t.dispatch({effects:D.of(!1)}),t.focus()):s.keyCode==13&&(s.preventDefault(),i())},onsubmit:s=>{s.preventDefault(),i()}},(0,u.A)("label",t.state.phrase("Go to line"),": ",r)," ",(0,u.A)("button",{class:"cm-button",type:"submit"},t.state.phrase("go")),(0,u.A)("button",{name:"close",onclick:()=>{t.dispatch({effects:D.of(!1)}),t.focus()},"aria-label":t.state.phrase("close"),type:"button"},["\xD7"]));function i(){let s=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(r.value);if(!s)return;let{state:l}=t,o=l.doc.lineAt(l.selection.main.head),[,a,f,g,x]=s,V=g?+g.slice(1):0,_=f?+f:o.number;if(f&&x){let Y=_/100;a&&(Y=Y*(a=="-"?-1:1)+o.number/l.doc.lines),_=Math.round(l.doc.lines*Y)}else f&&a&&(_=_*(a=="-"?-1:1)+o.number);let ue=l.doc.line(Math.max(1,Math.min(l.doc.lines,_))),fe=c.EditorSelection.cursor(ue.from+Math.max(0,Math.min(V,ue.length)));t.dispatch({effects:[D.of(!1),h.EditorView.scrollIntoView(fe.from,{y:"center"})],selection:fe}),t.focus()}return{dom:n}}const D=c.StateEffect.define(),ee=c.StateField.define({create(){return!0},update(t,e){for(let r of e.effects)r.is(D)&&(t=r.value);return t},provide:t=>h.showPanel.from(t,e=>e?B:null)}),te=t=>{let e=(0,h.getPanel)(t,B);if(!e){let r=[D.of(!0)];t.state.field(ee,!1)==null&&r.push(c.StateEffect.appendConfig.of([ee,ge])),t.dispatch({effects:r}),e=(0,h.getPanel)(t,B)}return e&&e.dom.querySelector("input").select(),!0},ge=h.EditorView.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px",position:"relative","& label":{fontSize:"80%"},"& [name=close]":{position:"absolute",top:"0",bottom:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:"0"}}}),me={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},re=c.Facet.define({combine(t){return(0,c.combineConfig)(t,me,{highlightWordAroundCursor:(e,r)=>e||r,minSelectionLength:Math.min,maxMatches:Math.min})}});function xe(t){let e=[be,Me];return t&&e.push(re.of(t)),e}const Se=h.Decoration.mark({class:"cm-selectionMatch"}),ye=h.Decoration.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function ne(t,e,r,n){return(r==0||t(e.sliceDoc(r-1,r))!=c.CharCategory.Word)&&(n==e.doc.length||t(e.sliceDoc(n,n+1))!=c.CharCategory.Word)}function Ce(t,e,r,n){return t(e.sliceDoc(r,r+1))==c.CharCategory.Word&&t(e.sliceDoc(n-1,n))==c.CharCategory.Word}const Me=h.ViewPlugin.fromClass(class{constructor(t){this.decorations=this.getDeco(t)}update(t){(t.selectionSet||t.docChanged||t.viewportChanged)&&(this.decorations=this.getDeco(t.view))}getDeco(t){let e=t.state.facet(re),{state:r}=t,n=r.selection;if(n.ranges.length>1)return h.Decoration.none;let i=n.main,s,l=null;if(i.empty){if(!e.highlightWordAroundCursor)return h.Decoration.none;let a=r.wordAt(i.head);if(!a)return h.Decoration.none;l=r.charCategorizer(i.head),s=r.sliceDoc(a.from,a.to)}else{let a=i.to-i.from;if(a<e.minSelectionLength||a>200)return h.Decoration.none;if(e.wholeWords){if(s=r.sliceDoc(i.from,i.to),l=r.charCategorizer(i.head),!(ne(l,r,i.from,i.to)&&Ce(l,r,i.from,i.to)))return h.Decoration.none}else if(s=r.sliceDoc(i.from,i.to),!s)return h.Decoration.none}let o=[];for(let a of t.visibleRanges){let f=new d(r.doc,s,a.from,a.to);for(;!f.next().done;){let{from:g,to:x}=f.value;if((!l||ne(l,r,g,x))&&(i.empty&&g<=i.from&&x>=i.to?o.push(ye.range(g,x)):(g>=i.to||x<=i.from)&&o.push(Se.range(g,x)),o.length>e.maxMatches))return h.Decoration.none}}return h.Decoration.set(o)}},{decorations:t=>t.decorations}),be=h.EditorView.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),ve=({state:t,dispatch:e})=>{let{selection:r}=t,n=c.EditorSelection.create(r.ranges.map(i=>t.wordAt(i.head)||c.EditorSelection.cursor(i.head)),r.mainIndex);return n.eq(r)?!1:(e(t.update({selection:n})),!0)};function Ee(t,e){let{main:r,ranges:n}=t.selection,i=t.wordAt(r.head),s=i&&i.from==r.from&&i.to==r.to;for(let l=!1,o=new d(t.doc,e,n[n.length-1].to);;)if(o.next(),o.done){if(l)return null;o=new d(t.doc,e,0,Math.max(0,n[n.length-1].from-1)),l=!0}else{if(l&&n.some(a=>a.from==o.value.from))continue;if(s){let a=t.wordAt(o.value.from);if(!a||a.from!=o.value.from||a.to!=o.value.to)continue}return o.value}}const ie=({state:t,dispatch:e})=>{let{ranges:r}=t.selection;if(r.some(s=>s.from===s.to))return ve({state:t,dispatch:e});let n=t.sliceDoc(r[0].from,r[0].to);if(t.selection.ranges.some(s=>t.sliceDoc(s.from,s.to)!=n))return!1;let i=Ee(t,n);return i?(e(t.update({selection:t.selection.addRange(c.EditorSelection.range(i.from,i.to),!1),effects:h.EditorView.scrollIntoView(i.to)})),!0):!1},b=c.Facet.define({combine(t){return(0,c.combineConfig)(t,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new Oe(e),scrollToMatch:e=>h.EditorView.scrollIntoView(e)})}});function Ae(t){return t?[b.of(t),X]:X}class N{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||pe(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(r,n)=>n=="n"?`
`:n=="r"?"\r":n=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new We(this):new De(this)}getCursor(e,r=0,n){let i=e.doc?e:c.EditorState.create({doc:e});return n==null&&(n=i.doc.length),this.regexp?A(this,i,r,n):E(this,i,r,n)}}class se{constructor(e){this.spec=e}}function E(t,e,r,n){return new d(e.doc,t.unquoted,r,n,t.caseSensitive?void 0:i=>i.toLowerCase(),t.wholeWord?ke(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function ke(t,e){return(r,n,i,s)=>((s>r||s+i.length<n)&&(s=Math.max(0,r-2),i=t.sliceString(s,Math.min(t.length,n+2))),(e(w(i,r-s))!=c.CharCategory.Word||e(q(i,r-s))!=c.CharCategory.Word)&&(e(q(i,n-s))!=c.CharCategory.Word||e(w(i,n-s))!=c.CharCategory.Word))}class De extends se{constructor(e){super(e)}nextMatch(e,r,n){let i=E(this.spec,e,n,e.doc.length).nextOverlapping();if(i.done){let s=Math.min(e.doc.length,r+this.spec.unquoted.length);i=E(this.spec,e,0,s).nextOverlapping()}return i.done||i.value.from==r&&i.value.to==n?null:i.value}prevMatchInRange(e,r,n){for(let i=n;;){let s=Math.max(r,i-1e4-this.spec.unquoted.length),l=E(this.spec,e,s,i),o=null;for(;!l.nextOverlapping().done;)o=l.value;if(o)return o;if(s==r)return null;i-=1e4}}prevMatch(e,r,n){let i=this.prevMatchInRange(e,0,r);return i||(i=this.prevMatchInRange(e,Math.max(0,n-this.spec.unquoted.length),e.doc.length)),i&&(i.from!=r||i.to!=n)?i:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,r){let n=E(this.spec,e,0,e.doc.length),i=[];for(;!n.next().done;){if(i.length>=r)return null;i.push(n.value)}return i}highlight(e,r,n,i){let s=E(this.spec,e,Math.max(0,r-this.spec.unquoted.length),Math.min(n+this.spec.unquoted.length,e.doc.length));for(;!s.next().done;)i(s.value.from,s.value.to)}}function A(t,e,r,n){return new Q(e.doc,t.search,{ignoreCase:!t.caseSensitive,test:t.wholeWord?Le(e.charCategorizer(e.selection.main.head)):void 0},r,n)}function w(t,e){return t.slice((0,c.findClusterBreak)(t,e,!1),e)}function q(t,e){return t.slice(e,(0,c.findClusterBreak)(t,e))}function Le(t){return(e,r,n)=>!n[0].length||(t(w(n.input,n.index))!=c.CharCategory.Word||t(q(n.input,n.index))!=c.CharCategory.Word)&&(t(q(n.input,n.index+n[0].length))!=c.CharCategory.Word||t(w(n.input,n.index+n[0].length))!=c.CharCategory.Word)}class We extends se{nextMatch(e,r,n){let i=A(this.spec,e,n,e.doc.length).next();return i.done&&(i=A(this.spec,e,0,r).next()),i.done?null:i.value}prevMatchInRange(e,r,n){for(let i=1;;i++){let s=Math.max(r,n-i*1e4),l=A(this.spec,e,s,n),o=null;for(;!l.next().done;)o=l.value;if(o&&(s==r||o.from>s+10))return o;if(s==r)return null}}prevMatch(e,r,n){return this.prevMatchInRange(e,0,r)||this.prevMatchInRange(e,n,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(r,n)=>{if(n=="&")return e.match[0];if(n=="$")return"$";for(let i=n.length;i>0;i--){let s=+n.slice(0,i);if(s>0&&s<e.match.length)return e.match[s]+n.slice(i)}return r})}matchAll(e,r){let n=A(this.spec,e,0,e.doc.length),i=[];for(;!n.next().done;){if(i.length>=r)return null;i.push(n.value)}return i}highlight(e,r,n,i){let s=A(this.spec,e,Math.max(0,r-250),Math.min(n+250,e.doc.length));for(;!s.next().done;)i(s.value.from,s.value.to)}}const k=c.StateEffect.define(),z=c.StateEffect.define(),S=c.StateField.define({create(t){return new K(O(t).create(),null)},update(t,e){for(let r of e.effects)r.is(k)?t=new K(r.value.create(),t.panel):r.is(z)&&(t=new K(t.query,r.value?U:null));return t},provide:t=>h.showPanel.from(t,e=>e.panel)});function Pe(t){let e=t.field(S,!1);return e?e.query.spec:O(t)}function _e(t){var e;return((e=t.field(S,!1))===null||e===void 0?void 0:e.panel)!=null}class K{constructor(e,r){this.query=e,this.panel=r}}const Fe=h.Decoration.mark({class:"cm-searchMatch"}),Re=h.Decoration.mark({class:"cm-searchMatch cm-searchMatch-selected"}),we=h.ViewPlugin.fromClass(class{constructor(t){this.view=t,this.decorations=this.highlight(t.state.field(S))}update(t){let e=t.state.field(S);(e!=t.startState.field(S)||t.docChanged||t.selectionSet||t.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:t,panel:e}){if(!e||!t.spec.valid)return h.Decoration.none;let{view:r}=this,n=new c.RangeSetBuilder;for(let i=0,s=r.visibleRanges,l=s.length;i<l;i++){let{from:o,to:a}=s[i];for(;i<l-1&&a>s[i+1].from-2*250;)a=s[++i].to;t.highlight(r.state,o,a,(f,g)=>{let x=r.state.selection.ranges.some(V=>V.from==f&&V.to==g);n.add(f,g,x?Re:Fe)})}return n.finish()}},{decorations:t=>t.decorations});function L(t){return e=>{let r=e.state.field(S,!1);return r&&r.query.spec.valid?t(e,r):j(e)}}const W=L((t,{query:e})=>{let{to:r}=t.state.selection.main,n=e.nextMatch(t.state,r,r);if(!n)return!1;let i=c.EditorSelection.single(n.from,n.to),s=t.state.facet(b);return t.dispatch({selection:i,effects:[J(t,n),s.scrollToMatch(i.main,t)],userEvent:"select.search"}),he(t),!0}),P=L((t,{query:e})=>{let{state:r}=t,{from:n}=r.selection.main,i=e.prevMatch(r,n,n);if(!i)return!1;let s=c.EditorSelection.single(i.from,i.to),l=t.state.facet(b);return t.dispatch({selection:s,effects:[J(t,i),l.scrollToMatch(s.main,t)],userEvent:"select.search"}),he(t),!0}),le=L((t,{query:e})=>{let r=e.matchAll(t.state,1e3);return!r||!r.length?!1:(t.dispatch({selection:c.EditorSelection.create(r.map(n=>c.EditorSelection.range(n.from,n.to))),userEvent:"select.search.matches"}),!0)}),oe=({state:t,dispatch:e})=>{let r=t.selection;if(r.ranges.length>1||r.main.empty)return!1;let{from:n,to:i}=r.main,s=[],l=0;for(let o=new d(t.doc,t.sliceDoc(n,i));!o.next().done;){if(s.length>1e3)return!1;o.value.from==n&&(l=s.length),s.push(c.EditorSelection.range(o.value.from,o.value.to))}return e(t.update({selection:c.EditorSelection.create(s,l),userEvent:"select.search.matches"})),!0},H=L((t,{query:e})=>{let{state:r}=t,{from:n,to:i}=r.selection.main;if(r.readOnly)return!1;let s=e.nextMatch(r,n,n);if(!s)return!1;let l=s,o=[],a,f,g=[];if(l.from==n&&l.to==i&&(f=r.toText(e.getReplacement(l)),o.push({from:l.from,to:l.to,insert:f}),l=e.nextMatch(r,l.from,l.to),g.push(h.EditorView.announce.of(r.phrase("replaced match on line $",r.doc.lineAt(n).number)+"."))),l){let x=o.length==0||o[0].from>=s.to?0:s.to-s.from-f.length;a=c.EditorSelection.single(l.from-x,l.to-x),g.push(J(t,l)),g.push(r.facet(b).scrollToMatch(a.main,t))}return t.dispatch({changes:o,selection:a,effects:g,userEvent:"input.replace"}),!0}),ae=L((t,{query:e})=>{if(t.state.readOnly)return!1;let r=e.matchAll(t.state,1e9).map(i=>{let{from:s,to:l}=i;return{from:s,to:l,insert:e.getReplacement(i)}});if(!r.length)return!1;let n=t.state.phrase("replaced $ matches",r.length)+".";return t.dispatch({changes:r,effects:h.EditorView.announce.of(n),userEvent:"input.replace.all"}),!0});function U(t){return t.state.facet(b).createPanel(t)}function O(t,e){var r,n,i,s,l;let o=t.selection.main,a=o.empty||o.to>o.from+100?"":t.sliceDoc(o.from,o.to);if(e&&!a)return e;let f=t.facet(b);return new N({search:((r=e?.literal)!==null&&r!==void 0?r:f.literal)?a:a.replace(/\n/g,"\\n"),caseSensitive:(n=e?.caseSensitive)!==null&&n!==void 0?n:f.caseSensitive,literal:(i=e?.literal)!==null&&i!==void 0?i:f.literal,regexp:(s=e?.regexp)!==null&&s!==void 0?s:f.regexp,wholeWord:(l=e?.wholeWord)!==null&&l!==void 0?l:f.wholeWord})}function ce(t){let e=(0,h.getPanel)(t,U);return e&&e.dom.querySelector("[main-field]")}function he(t){let e=ce(t);e&&e==t.root.activeElement&&e.select()}const j=t=>{let e=t.state.field(S,!1);if(e&&e.panel){let r=ce(t);if(r&&r!=t.root.activeElement){let n=O(t.state,e.query.spec);n.valid&&t.dispatch({effects:k.of(n)}),r.focus(),r.select()}}else t.dispatch({effects:[z.of(!0),e?k.of(O(t.state,e.query.spec)):c.StateEffect.appendConfig.of(X)]});return!0},G=t=>{let e=t.state.field(S,!1);if(!e||!e.panel)return!1;let r=(0,h.getPanel)(t,U);return r&&r.dom.contains(t.root.activeElement)&&t.focus(),t.dispatch({effects:z.of(!1)}),!0},qe=[{key:"Mod-f",run:j,scope:"editor search-panel"},{key:"F3",run:W,shift:P,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:W,shift:P,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:G,scope:"editor search-panel"},{key:"Mod-Shift-l",run:oe},{key:"Mod-Alt-g",run:te},{key:"Mod-d",run:ie,preventDefault:!0}];class Oe{constructor(e){this.view=e;let r=this.query=e.state.field(S).query.spec;this.commit=this.commit.bind(this),this.searchField=(0,u.A)("input",{value:r.search,placeholder:m(e,"Find"),"aria-label":m(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=(0,u.A)("input",{value:r.replace,placeholder:m(e,"Replace"),"aria-label":m(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=(0,u.A)("input",{type:"checkbox",name:"case",form:"",checked:r.caseSensitive,onchange:this.commit}),this.reField=(0,u.A)("input",{type:"checkbox",name:"re",form:"",checked:r.regexp,onchange:this.commit}),this.wordField=(0,u.A)("input",{type:"checkbox",name:"word",form:"",checked:r.wholeWord,onchange:this.commit});function n(i,s,l){return(0,u.A)("button",{class:"cm-button",name:i,onclick:s,type:"button"},l)}this.dom=(0,u.A)("div",{onkeydown:i=>this.keydown(i),class:"cm-search"},[this.searchField,n("next",()=>W(e),[m(e,"next")]),n("prev",()=>P(e),[m(e,"previous")]),n("select",()=>le(e),[m(e,"all")]),(0,u.A)("label",null,[this.caseField,m(e,"match case")]),(0,u.A)("label",null,[this.reField,m(e,"regexp")]),(0,u.A)("label",null,[this.wordField,m(e,"by word")]),...e.state.readOnly?[]:[(0,u.A)("br"),this.replaceField,n("replace",()=>H(e),[m(e,"replace")]),n("replaceAll",()=>ae(e),[m(e,"replace all")])],(0,u.A)("button",{name:"close",onclick:()=>G(e),"aria-label":m(e,"close"),type:"button"},["\xD7"])])}commit(){let e=new N({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:k.of(e)}))}keydown(e){(0,h.runScopeHandlers)(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?P:W)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),H(this.view))}update(e){for(let r of e.transactions)for(let n of r.effects)n.is(k)&&!n.value.eq(this.query)&&this.setQuery(n.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(b).top}}function m(t,e){return t.state.phrase(e)}const T=30,I=/[\s\.,:;?!]/;function J(t,{from:e,to:r}){let n=t.state.doc.lineAt(e),i=t.state.doc.lineAt(r).to,s=Math.max(n.from,e-T),l=Math.min(i,r+T),o=t.state.sliceDoc(s,l);if(s!=n.from){for(let a=0;a<T;a++)if(!I.test(o[a+1])&&I.test(o[a])){o=o.slice(a);break}}if(l!=i){for(let a=o.length-1;a>o.length-T;a--)if(!I.test(o[a-1])&&I.test(o[a])){o=o.slice(0,a);break}}return h.EditorView.announce.of(`${t.state.phrase("current match")}. ${o} ${t.state.phrase("on line")} ${n.number}.`)}const Te=h.EditorView.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),X=[S,c.Prec.low(we),Te]},90380:(de,F,C)=>{C.d(F,{A:()=>h});function h(){var u=arguments[0];typeof u=="string"&&(u=document.createElement(u));var p=1,d=arguments[1];if(d&&typeof d=="object"&&d.nodeType==null&&!Array.isArray(d)){for(var M in d)if(Object.prototype.hasOwnProperty.call(d,M)){var y=d[M];typeof y=="string"?u.setAttribute(M,y):y!=null&&(u[M]=y)}p++}for(;p<arguments.length;p++)c(u,arguments[p]);return u}function c(u,p){if(typeof p=="string")u.appendChild(document.createTextNode(p));else if(p!=null)if(p.nodeType!=null)u.appendChild(p);else if(Array.isArray(p))for(var d=0;d<p.length;d++)c(u,p[d]);else throw new RangeError("Unsupported child node: "+p)}}}]);
