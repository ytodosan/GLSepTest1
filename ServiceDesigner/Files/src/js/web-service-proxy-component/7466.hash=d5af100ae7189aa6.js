(self.webpackChunkapp_studio_enterprise_web_service=self.webpackChunkapp_studio_enterprise_web_service||[]).push([[7466,3308,927],{12014:(R,H,h)=>{var g={"./default-file-icon.svg":27107,"./file-excel.svg":76185,"./file-image.svg":87831,"./file-pdf.svg":96682,"./file-powerpoint.svg":30351,"./file-word.svg":23472};function _(i){var b=P(i);return h(b)}function P(i){if(!h.o(g,i)){var b=new Error("Cannot find module '"+i+"'");throw b.code="MODULE_NOT_FOUND",b}return g[i]}_.keys=function(){return Object.keys(g)},_.resolve=P,R.exports=_,_.id=12014},10722:(R,H,h)=>{var g={"./default-file-icon.svg":8035,"./file-excel.svg":25689,"./file-image.svg":21431,"./file-pdf.svg":94570,"./file-powerpoint.svg":17935,"./file-word.svg":94896,"./large/default-file-icon.svg":27107,"./large/file-excel.svg":76185,"./large/file-image.svg":87831,"./large/file-pdf.svg":96682,"./large/file-powerpoint.svg":30351,"./large/file-word.svg":23472};function _(i){var b=P(i);return h(b)}function P(i){if(!h.o(g,i)){var b=new Error("Cannot find module '"+i+"'");throw b.code="MODULE_NOT_FOUND",b}return g[i]}_.keys=function(){return Object.keys(g)},_.resolve=P,R.exports=_,_.id=10722},33996:(R,H,h)=>{var g={"./grid-area-1-icon.svg":35723,"./grid-column-1-icon.svg":27320,"./grid-column-2-icon.svg":48305,"./grid-column-3-icon.svg":6206,"./grid-column-4-icon.svg":50103};function _(i){var b=P(i);return h(b)}function P(i){if(!h.o(g,i)){var b=new Error("Cannot find module '"+i+"'");throw b.code="MODULE_NOT_FOUND",b}return g[i]}_.keys=function(){return Object.keys(g)},_.resolve=P,R.exports=_,_.id=33996},48104:(R,H,h)=>{var g={"./datetime-picker-toggle-date-icon.svg":67347,"./datetime-picker-toggle-time-icon.svg":63202};function _(i){var b=P(i);return h(b)}function P(i){if(!h.o(g,i)){var b=new Error("Cannot find module '"+i+"'");throw b.code="MODULE_NOT_FOUND",b}return g[i]}_.keys=function(){return Object.keys(g)},_.resolve=P,R.exports=_,_.id=48104},48422:(R,H,h)=>{var g={"./error-icon.svg":77017,"./warning-icon.svg":64207};function _(i){var b=P(i);return h(b)}function P(i){if(!h.o(g,i)){var b=new Error("Cannot find module '"+i+"'");throw b.code="MODULE_NOT_FOUND",b}return g[i]}_.keys=function(){return Object.keys(g)},_.resolve=P,R.exports=_,_.id=48422},47466:(R,H,h)=>{var g=h(71252),_=h(74369),P=h(63721),i=h(59131),b=h(93883),k=h(48059),m=h(79772),T=h(84065),M=h(28399),u=h(62278),l=h(36486),v=h(40297);function ae(r){return r.endsWith("/")||(r+="/"),r}function ie(r){return r.replace(/(^([/\\])+)|(([/\\])+$)/,"")}function he(r){return r=r.replace(location.hash,""),r.replace(location.search,"")}function Me(r){return`${W()}/Navigation/Navigation.aspx?schemaName=${r}`}function de(){return"/"}function pe(){let r=location.pathname;const e=r.match(/.*?\/\d\/?/);return e&&e.length===1?r=ae(e[0]):r="",ne(location.origin,r)}function S(){let r=location.href.replace(pe(),"");return r=he(r),r||"/"}function D(){const r=S(),e=pe(),t=r.split("/").filter(Boolean)[0];return t?`${e}${t}/`:e}function L(){let e=pe().replace(location.origin,"");return e.endsWith("/")&&(e=e.substring(0,e.length-1)),e}function W(){return pe().replace(/\/0\/?$|\/+$/,"")}function ne(...r){return r.map(e=>ie(e)).join("/")}function J(r,e){return`${Me(r)}&recordId=${e}`}function V(r,e){function t(o,c){return o.toLowerCase().replace(c,"").split("/").filter(d=>d).join("/")}const n=pe().toLowerCase(),s=t(r,n),a=t(e,n);return s===a}function B(r){return r?L()+imageServiceUrl+r:null}function Q(){return L()+esqServiceUrl}function Se(r){const{uId:e,name:t,packageUId:n,userLevelSchema:s}=r;if(!e&&!t)throw new Error("uId or name is required");const a=pe(),o=S(),c=`#/InterfaceDesigner/${e||t}`,d=new URLSearchParams;return n&&d.append("packageUId",n),s&&d.append("userLevelSchema","true"),`${a}${o}${c}?${d.toString()}`}const He="Translations/Custom/",_t="CommonFeatures.UseCustomCoreLocalizations";var y=h(5960);const fe=new i.InjectionToken("FEATURE_VALUES",{factory:()=>({})}),vi=new Array("constructor","ngOnDestroy");let rt=!1;const cn=new Proxy({},{get(r,e){if(rt||vi.includes(e))return r[e];throw new Error(`FEATURE_VALUES. "${String(e)}" not loaded`)}}),ir={provide:fe,useFactory:()=>cn},sr=new i.InjectionToken("FEATURE_SERVICE_GET_FEATURES_STATES_ENDPOINT",{factory:()=>"rest/FeatureService/GetFeatureStates",providedIn:"root"});let at=class Fl{constructor(e,t){this.httpClient=e,this._getFeatureStatesEndpoint=t,this._cachedCodes=new Map,this._destroyed$=new u.Subject}_checkFeaturesFromURL(){const e=s=>{new URLSearchParams(s.startsWith("?")?s.slice(1):s).forEach((o,c)=>{if(c.startsWith("feature:")){const d=c.substring(8),p=o==="true";this._cachedCodes.set(d,p)}})},t=location.hash,n=t.indexOf("?");if(n>=0){const s=t.substring(n+1);e(s)}}loadFeatureStates(){return this._featureStates$?this._featureStates$:(this._featureStates$=this.httpClient.post(this._getFeatureStatesEndpoint,{}).pipe((0,l.map)(e=>(e.GetFeatureStatesResult.forEach(t=>{this._cachedCodes.set(t.Key,t.Value===1)}),(0,i.isDevMode)()&&this._checkFeaturesFromURL(),Object.fromEntries(this._cachedCodes.entries()))),(0,l.tap)(e=>{Object.assign(cn,e),Object.freeze(cn),rt=!0}),(0,l.catchError)(()=>(rt=!0,(0,u.of)(null))),(0,u.shareReplay)({bufferSize:1,refCount:!1}),(0,l.takeUntil)(this._destroyed$)),this._featureStates$)}getFeatureState(e){return e?this._cachedCodes.size>0?(0,u.of)(this._cachedCodes.get(e)||!1):this.loadFeatureStates().pipe((0,l.map)(()=>this._cachedCodes.get(e)||!1)):(0,u.of)(!1)}getFeaturesState(e){return(0,u.from)(this.getFeaturesStateAsync(e))}getFeaturesStateAsync(e){return Promise.all(e.map(t=>{const n=typeof t=="string"?this.getFeatureState(t):t;return new Promise(s=>n.pipe((0,l.first)()).subscribe({next:s}))}))}ngOnDestroy(){this._destroyed$.next(),this._destroyed$.complete()}static{this.\u0275fac=function(t){return new(t||Fl)(i.\u0275\u0275inject(P.HttpClient),i.\u0275\u0275inject(sr))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Fl,factory:Fl.\u0275fac,providedIn:"root"})}};at=(0,y.__decorate)([(0,T.op)({requestType:"crt.FeatureService"}),(0,y.__metadata)("design:paramtypes",[P.HttpClient,String])],at);const Ii=new i.InjectionToken("FETCH_MULTI_TRANSLATE_RESOURCES_SOURCES"),wi=new i.InjectionToken("FETCH_MULTI_TRANSLATE_CUSTOM_RESOURCES_SOURCES");class ot{constructor(e,t,n){this._resourceSources=e,this._customResourceSources=t,this._featureService=n}_getCustomResourcesSource(){return this._customResourceSources?.length?this._customResourceSources:[{prefix:v.Location.joinWithSlash(pe(),He),suffix:".json"}]}getResourceOptions(){return(0,u.from)(this._featureService.getFeatureState(_t)).pipe((0,u.map)(e=>e?this._getCustomResourcesSource():[]),(0,u.map)(e=>[...this._resourceSources??[],...e]))}static{this.\u0275fac=function(t){return new(t||ot)(i.\u0275\u0275inject(Ii),i.\u0275\u0275inject(wi,8),i.\u0275\u0275inject(at))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:ot,factory:ot.\u0275fac})}}const rr=new i.InjectionToken("NestedTranslateLoader");class yt{constructor(e){this._optionsProvider=e}_fetchTranslation(e){return fetch(e,{cache:"no-cache"}).then(t=>{if(!t.ok&&t.status!==304)throw new Error(`Loading translations failed: ${e} (${t.status})`);return t.json()})}_handleFetchResults(e){for(const n of e.filter(s=>s.status==="rejected"))console.error(n.reason);const t=e.filter(n=>n.status==="fulfilled").map(n=>n.value||{});return(0,M.merge)({},...t)}getTranslation(e){return this._optionsProvider.getResourceOptions().pipe((0,u.switchMap)(t=>{const n=t.map(({prefix:s,suffix:a})=>this._fetchTranslation(`${s}${e}${a}`));return(0,u.from)(Promise.allSettled(n)).pipe((0,u.map)(s=>this._handleFetchResults(s)))}))}static{this.\u0275fac=function(t){return new(t||yt)(i.\u0275\u0275inject(ot))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:yt,factory:yt.\u0275fac})}}const ar=new i.InjectionToken("Custom event name for get translations");class Ct extends m.TranslateLoader{constructor(e,t,n,s){super(),this.customEventService=e,this._store=t,this._getTranslationsEventName=n,this._nestedTranslateLoader=s,this._destroyed$=new u.Subject}getTranslation(e){return new u.Observable(t=>{(0,u.combineLatest)([this.customEventService.subscribe(this._getTranslationsEventName),this._nestedTranslateLoader?this._nestedTranslateLoader.getTranslation(e):(0,u.of)({})]).pipe((0,l.map)(([n,s])=>{const a=M.merge(n,s);return this._store.langs.forEach(o=>{const c=this._store.translations[o];this._store.translations[o]=M.merge(c,a)}),a}),(0,l.takeUntil)(this._destroyed$)).subscribe(n=>{t.next(n)},u.noop,()=>{t.complete()}),this.customEventService.createOutboundChannel(this._getTranslationsEventName).next()})}ngOnDestroy(){this._destroyed$.next()}static{this.\u0275fac=function(t){return new(t||Ct)(i.\u0275\u0275inject(T.Dj),i.\u0275\u0275inject(m.TranslateStore),i.\u0275\u0275inject(ar),i.\u0275\u0275inject(rr,8))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Ct,factory:Ct.\u0275fac})}}function q(r){return()=>(0,u.lastValueFrom)(r.loadFeatureStates(),{defaultValue:null})}const w={provide:i.APP_INITIALIZER,useFactory:q,deps:[at],multi:!0};class A{static _getResourceSourcesProviders(e){const{resourceSources:t,customResourceSources:n}=e??{},s=(n??[]).map(a=>({...a,provide:wi,multi:!0}));return[{provide:Ii,useValue:t},...s]}static forRoot(e){const t=m.TranslateModule.forRoot({...e,loader:{provide:m.TranslateLoader,useClass:yt}});return t.providers.push(ot,...this._getResourceSourcesProviders(e)),t}static forNested(e){const t=m.TranslateModule.forRoot(e);return t.providers.push({provide:rr,useClass:yt},ot,...this._getResourceSourcesProviders(e)),t}static with(e){return{ngModule:A,providers:[yt,ot,...this._getResourceSourcesProviders(e)]}}static{this.\u0275fac=function(t){return new(t||A)}}static{this.\u0275mod=i.\u0275\u0275defineNgModule({type:A})}static{this.\u0275inj=i.\u0275\u0275defineInjector({})}}var N=h(76923),K=h(8995),oe;(function(r){r[r.undefined=0]="undefined",r[r.rest=1]="rest",r[r.soap11=2]="soap11",r[r.soap12=3]="soap12"})(oe||(oe={}));var Pe;(function(r){r.upload="upload",r.selectService="selectService",r.setupRequest="setupRequest",r.setupResponse="setupResponse"})(Pe||(Pe={}));var ke;(function(r){r.Success="Success",r.Skip="Skip",r.Close="Close",r.Error="Error"})(ke||(ke={}));var Ei=h(74975),E=h(86464);const or=new i.InjectionToken("DataServiceUri");let xi=class Bl extends Ei.S{constructor(e,t){super(),this.httpClient=e,this._sysSettingsInfo=new Map,this._sysSettingsValuesCache=new Map,this._sysSettingsChanged$=new u.Subject,this.sysSettingsChanged$=this._sysSettingsChanged$.asObservable(),this._serviceGetSysSettingsEndpoint=`${t}/QuerySysSettings`,this._serviceSaveSysSettingsEndpoint=`${t}/PostSysSettingsValues`,this._servicePreloadSysSettingsEndpoint=`${t}/PreloadSysSettings`}_removeNotActualSettingsValues(e){e.forEach(([t,n])=>{this._getIsSysSettingCached(t)&&this._getCacheableSysSetting(t).dataValueType===E.r.Lookup&&this._sysSettingsValuesCache.delete(t)})}_getSysSettingsRequestAfterUpdate(e){const t=e.filter(n=>!this._sysSettingsInfo.has(n[0]));return t.length===0?(0,u.of)(null):this.getByCodes(t.map(n=>n[0]))}_updateCache(e,t){const n=Object.entries(e??{}).filter(s=>t.saveResult[s[0]]);return n.filter(([s,a])=>this._sysSettingsInfo.has(s)).filter(([s,a])=>this._getIsSysSettingCacheable(s)).forEach(([s,a])=>{this._sysSettingsValuesCache.set(s,{value:a})}),this._getSysSettingsRequestAfterUpdate(n).pipe((0,l.map)(()=>t),(0,l.tap)(()=>{this._removeNotActualSettingsValues(n)}),(0,l.tap)(()=>{if(n.length>0){const s=n.map(a=>a[0]);this._sysSettingsChanged$.next(s)}}))}_getIsSysSettingCacheable(e){return this._sysSettingsInfo.get(e)?.isCacheable??!1}_getIsSysSettingCached(e){return this._getIsSysSettingCacheable(e)&&this._sysSettingsValuesCache.has(e)}_getCacheableSysSetting(e){const t=this._sysSettingsInfo.get(e);if(t&&t.isCacheable){const n=this._sysSettingsValuesCache.get(e);return{code:t.code,dataValueType:t.dataValueType,id:t.id,isCacheable:t.isCacheable,name:t.name,value:n.value,displayValue:n.displayValue}}return null}_setSysSettingInfo(e){this._sysSettingsInfo.set(e.code,{code:e.code,dataValueType:e.dataValueType,id:e.id,isCacheable:e.isCacheable,name:e.name})}_setSysSettingDetails(e){this._setSysSettingInfo(e),e?.isCacheable&&this._sysSettingsValuesCache.set(e.code,{displayValue:e.displayValue,value:e.value})}_requestSysSettings(e){return this.httpClient.post(this._serviceGetSysSettingsEndpoint,{sysSettingsNameCollection:e}).pipe((0,l.share)(),(0,l.tap)(t=>{e.forEach(n=>{const s=t.values[n];s&&this._setSysSettingDetails(s)})}))}_getResponseWithCachedSysSettings(e,t){return t.filter(s=>this._getIsSysSettingCached(s)).map(s=>this._getCacheableSysSetting(s)).forEach(s=>{e.values[s.code]=s}),e}_createEmptySysSettingDetailByCode(e){return{code:e,value:null,isCacheable:!0}}_updateNotFoundSettingDetails(e){return e.notFoundSettings?.forEach(t=>{const n=this._createEmptySysSettingDetailByCode(t);this._setSysSettingDetails(n),e.values[t]=n}),e}getByCodes(e){if(!e||e.length===0)return(0,u.of)({success:!0,values:{}});const t=e.filter(n=>!this._getIsSysSettingCached(n));return t.length===0?(0,u.of)(this._getResponseWithCachedSysSettings({success:!0,values:{}},e)):this._requestSysSettings(t).pipe((0,l.map)(n=>this._getResponseWithCachedSysSettings(n,e)),(0,l.map)(n=>this._updateNotFoundSettingDetails(n)))}getByCode(e){return this.getByCodes([e]).pipe((0,l.map)(t=>t.values[e]))}getValueByCode(e,t){return this.getByCode(e).pipe((0,l.map)(n=>{const s=n?.value;return!(s==null||s==="")||t===void 0?s:t}),(0,u.catchError)(()=>(0,u.of)(t)))}updateMany(e,t=!1){const n={};return e.forEach(s=>n[s.code]=s.value),this.httpClient.post(this._serviceSaveSysSettingsEndpoint,{sysSettingsValues:n,isPersonal:t}).pipe((0,l.mergeMap)(s=>this._updateCache(n,s)),(0,l.share)())}update(e,t=!1){return this.updateMany([e],t)}preload(){if(this._preloadedSysSettings$)return this._preloadedSysSettings$;const e=new P.HttpHeaders().set("Content-Type","application/json; charset=utf-8");return this._preloadedSysSettings$=this.httpClient.post(this._servicePreloadSysSettingsEndpoint,{},{headers:e}).pipe((0,l.tap)(t=>{Object.values(t.values).forEach(n=>{n.isCacheable=!0,this._setSysSettingDetails(n)})}),(0,l.map)(()=>Object.fromEntries(this._sysSettingsValuesCache.entries())),(0,u.shareReplay)({bufferSize:1,refCount:!1})),this._preloadedSysSettings$}static{this.\u0275fac=function(t){return new(t||Bl)(i.\u0275\u0275inject(P.HttpClient),i.\u0275\u0275inject(or))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Bl,factory:Bl.\u0275fac,providedIn:"root"})}};xi=(0,y.__decorate)([(0,T.op)({requestType:"crt.SysSettingsService"}),(0,y.__metadata)("design:paramtypes",[P.HttpClient,String])],xi);var We=h(23092);class bt extends Ei.S{constructor(e,t){super(),this.sysSettingsService=e,this.userInfo=t,this._enabled=!1,this._initialized=!1}_initializeDataLayer(){const e=window;e.dataLayer&&(this._dataLayer=e.dataLayer)}_initializeScripts(e){e&&(e=e.replace(/'/g,'"'),this._appendChildScriptTag(document.head,"script",this._getHtmlTagContent("script",e)),this._appendChildScriptTag(document.body,"noscript",this._getHtmlTagContent("noscript",e)))}_getHtmlTagContent(e,t){if(!t||!e)return"";const n=new RegExp("<"+e+"[\\s\\S]*?>[\\s\\S]*?<\\/"+e+">","gi"),s=t.match(n);if(s&&s.length===1){const a=s[0],o=new RegExp("<(\\/|)"+e+"(.*?|)>","gi");return a.replace(o,"").trim()}else return""}_appendChildScriptTag(e,t,n){if(!e||!t||!n)return;const s=document.createElement(t);s.appendChild(document.createTextNode(n)),e.appendChild(s)}_initializeDefaultVariables(e){const t=this.userInfo,n={productName:e.ProductName,productEdition:e.ProductEdition,primaryCulture:{displayValue:t.cultureInfo.sysCultureName,value:t.cultureInfo.sysCultureId},customerId:e.CustomerId,version:e.ConfigurationVersion,userId:t.id,userType:this._getUserType(),accessType:t.accessType};this._pushVariables(n)}_getUserType(){return this.userInfo.isSSP?"External":"Employee"}_pushVariables(e){try{this._dataLayer.push(e)}catch(t){console.log(t.message)}}_initializeGoogleTagManager(e){e.UseGoogleTagManager&&(this._initializeScripts(e.GoogleTagManagerScript),this._initializeDataLayer(),this._enabled=!!this._dataLayer,this._enabled&&this._initializeDefaultVariables(e))}_executeInitialization(){const e=["UseGoogleTagManager","GoogleTagManagerScript","ProductName","ProductEdition","ConfigurationVersion","CustomerId"],t=this.sysSettingsService.getByCodes(e);return t.pipe((0,l.take)(1)).subscribe(n=>{const s=n&&n.success&&n.values&&(0,M.mapValues)(n.values||{},a=>a.value);s&&this._initializeGoogleTagManager(s),this._initialized=!0}),t.pipe((0,l.map)(()=>{}))}_resetCustomData(e){const t={};for(const n of Object.keys(e))t[n]=void 0;this._pushVariables(t)}initialize(){return this._initialized?(0,u.of)(void 0):(this._initializationObservable$||(this._initializationObservable$=this._executeInitialization()),this._initializationObservable$)}track(e){this._enabled&&(this._pushVariables(Object.assign(e,{description:JSON.stringify(e.description),event:e?.event||"bpmonlineInfo",virtualUrl:location.href})),this._resetCustomData(e))}static{this.\u0275fac=function(t){return new(t||bt)(i.\u0275\u0275inject(xi),i.\u0275\u0275inject(We.oq))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:bt,factory:bt.\u0275fac,providedIn:"root"})}}var le=h(6530),un;(function(r){r[r.json=1]="json",r[r.xml=2]="xml"})(un||(un={}));var dn;(function(r){r[r.Undefined=0]="Undefined",r[r.Get=1]="Get",r[r.Post=2]="Post",r[r.Put=3]="Put",r[r.Patch=4]="Patch",r[r.Delete=5]="Delete"})(dn||(dn={}));var X;(function(r){r.Text="Text",r.Integer="Integer",r.Float="Float",r.Boolean="Boolean",r.DateTime="DateTime",r.Guid="Guid",r.Date="Date",r.Time="Time",r.Object="Object"})(X||(X={}));var Zt;(function(r){r[r.Undefined=0]="Undefined",r[r.Body=1]="Body",r[r.UrlSegment=2]="UrlSegment",r[r.QueryString=3]="QueryString",r[r.HttpHeader=4]="HttpHeader",r[r.Cookie=5]="Cookie"})(Zt||(Zt={}));const lr={string:X.Text,boolean:X.Boolean,decimal:X.Float,float:X.Float,double:X.Float,dateTime:X.DateTime,time:X.Time,date:X.Date,hexBinary:X.Text,base64Binary:X.Text,integer:X.Integer,nonPositiveInteger:X.Text,negativeInteger:X.Text,long:X.Integer,int:X.Integer,short:X.Integer,byte:X.Integer,nonNegativeInteger:X.Text,unsignedLong:X.Text,unsignedInt:X.Text,unsignedShort:X.Integer,unsignedByte:X.Integer,positiveInteger:X.Text,char:X.Integer,guid:X.Guid,anyType:X.Text};class On{constructor(e){e&&(this.uId=e.uId,this.name=e.name,this.parentSchemaUId=e.parentSchemaUId),this.uId=this.uId||(0,le.qv)()}update(e){this.uId=e.uId,this.name=e.name}equal(e){if(e==null)return!1;let t=this.uId===e.uId&&this.name===e.name;return(this.parentSchemaUId||e.parentSchemaUId)&&(t=t&&this.parentSchemaUId===e.parentSchemaUId),t}clone(){return new On(this)}getLocalizableValues(e){}loadLocalizableValues(e,t=!1){}}class hn extends On{constructor(){super(...arguments),this.itemProperties=[]}static parseValue(e,t){switch(e.dataValueTypeName){case X.Boolean:return!!t;case X.DateTime:case X.Date:case X.Time:return new Date(t);default:return t}}}const Te=r=>r?.includes(":")?r.split(":")[1]:r,Vn=(r,e)=>{if(!e)return"";const t=r&&r.includes(":")?r.split(":")[0]:"";return t?e.lookupNamespaceURI(t):""},$e=r=>r?r.replace(/\./g,"\\.").replace(/:/g,"\\:"):null;class xt{static _getTypeElementByName(e,t){if(!e)return null;let n=e.querySelector(`types > schema > complexType[name=${$e(t)}]`);return n||(n=e.querySelector(`types > schema > simpleType[name=${$e(t)}]`)),this._getTypeDefinitionElement(n)}static _getTypeDefinitionElement(e){if(!e)return null;const t=e.getAttribute("type");if(!t)return e;const n=Te(t);return this._getTypeElementByName(e.ownerDocument,n)}static _getIsRestrictionElement(e){if(!e)return!1;let t=e.querySelector("simpleType:not(element > simpleType)");return e.localName==="simpleType"&&(t=e),t?!!t.querySelector("restriction:not(element > simpleType > restriction)"):!1}static _isMixedTextElement(e){return e.getAttribute("mixed")==="true"&&Array.from(e.children).every(t=>Te(t.nodeName)==="anyAttribute")}static getIsArray(e){return e?e.getAttribute("maxOccurs")==="unbounded":!1}static getSimpleTypeName(e){if(!e)return"";let t=e.querySelector("simpleType");if(e.localName==="simpleType"&&(t=e),t){const n=t.querySelector("restriction");return n?Te(n.getAttribute("base")):"string"}else return""}static getDataValeTypeName(e){let t=Te(e.getAttribute("type"));if(t||(t=this.getSimpleTypeName(e)),!lr[t]){const s=this._getTypeDefinitionElement(e);if(this._getIsRestrictionElement(s)&&(t=this.getSimpleTypeName(s)),this._isMixedTextElement(s))return X.Text}return lr[t]}static getSchemaElementByName(e,t){return e?e.querySelector(`definitions > types > schema > element[name=${$e(t)}]`):null}static getElementDefinition(e){if(!e)return null;const t=Te(e.getAttribute("ref")),n=this.getSchemaElementByName(e.ownerDocument,t);return n&&n.setAttribute("maxOccurs",e.getAttribute("maxOccurs")),n??e}static getIsExtensionType(e){if(!e)return!1;const t=this._getTypeDefinitionElement(e),n=!!t.querySelector("complexType > complexContent > extension"),s=!!t.querySelector("complexType > simpleContent > extension");return n||s}static getExtensionInfo(e){if(!e)return null;const n=this._getTypeDefinitionElement(e).querySelector("complexType extension"),s=Te(n.getAttribute("base")),a=this._getTypeElementByName(e.ownerDocument,s),o=this.getSimpleTypeName(a),c=n.querySelectorAll("extension > sequence > element");return{baseTypeName:o||s,baseTypeElementRef:a,nodes:Array.from(c)}}static getComplexTypeChildElements(e){if(!e)return[];const t=this._getTypeDefinitionElement(e),n=t.localName==="complexType"?"sequence > element":"complexType > sequence > element",s=t.querySelectorAll(n);return Array.from(s)}}class Ye{constructor(e){this.nested=[],e&&(this.typeName=e.typeName,this.referenceDataTypeName=e.referenceDataTypeName,this.baseTypeName=e.baseTypeName,this.isExtension=e.isExtension===!0,this.nodes=e.nodes||[],this.caption=e.caption,this.path=e.path,this.dataValueType=e.dataValueType,this.isArray=e.isArray,this.isSoapHeader=e.isSoapHeader,this.sequenceElementName=e.sequenceElementName,this.nested=e.nested||[],this.parent=e.parent,this.namespace=e.namespace)}get isObject(){return this.dataValueType===X.Object}get isSimpleType(){return!this.isObject}static _generatePrefixForNamespace(e,t){for(let n=0;n<1e3;n++){const s="ns"+n;if(!t.find(a=>a.prefix===s))return s}}static getPrefixForNamespace(e,t){return t.find(s=>s.name===e)||t.push({prefix:this._generatePrefixForNamespace(e,t),name:e}),t.find(s=>s.name===e).prefix}static fromElement(e){const t=xt.getElementDefinition(e),n=t.getAttribute("name"),s=xt.getDataValeTypeName(t),a=t.getAttribute("type"),o=Te(a),c=Vn(a,t),d=new Ye({typeName:n,referenceDataTypeName:o,caption:n,path:n,dataValueType:s??X.Object,isArray:xt.getIsArray(t),namespace:c});if(d.isSimpleType)return d;if(xt.getIsExtensionType(t)){const C=xt.getExtensionInfo(t),I=lr[C.baseTypeName];if(I)return d.dataValueType=I,d;const O=Ye.fromElement(C.baseTypeElementRef);d.isExtension=!0,d.baseTypeName=C.baseTypeName,d.nodes=[...C.nodes,...O.nodes]}else d.nodes=xt.getComplexTypeChildElements(t);return d}_buildPath(e,t){const n=Ye.getPrefixForNamespace(e.namespace,t);let s=e.isArray&&!e.isObject?"":`${n}:${e.path}`,a=e.parent;for(;a&&!a.isArray;)s=`${Ye.getPrefixForNamespace(a.namespace,t)}:${a.path}${s?"/"+s:""}`,a=a.parent;return s}_buildCaption(e){let t=e.isArray&&!e.isObject?"":e.path,n=e.parent;for(;n&&!n.isArray;)t=`${n.path}${t?" "+t:""}`,n=n.parent;return t}toServiceParameter(e){const t=new hn;return t.caption=this._buildCaption(this),t.path=this._buildPath(this,e),t.dataValueTypeName=this.dataValueType,t.isArray=this.isArray,t.isSoapHeader=this.isSoapHeader,t.isRequired=!1,t.sequenceElementName=this.sequenceElementName,t.type=Zt.Body,this.nested&&(t.itemProperties=this.nested.map(n=>n.toServiceParameter(e))),t}}class St extends On{}class Ln extends On{}class Io extends Ln{}class wo extends Ln{}class Eo{constructor(e,t,n=""){this.doc=e,this.namespaces=t,this.schemaNamePrefix=n,this._maxNameLength=200}_getSoapAction(e,t){const n=e.querySelector(`operation[name=${$e(t)}] > operation`);return n?n.getAttribute("soapAction"):null}_exitFromLoop(e,t){let n=!1;if(t.has(e)){let s=t.get(e);s===2?n=!0:t.set(e,++s)}else t.set(e,1);return n}_flattenWsdlElement(e,t){if(!e.nested.length)return[e];if(e.isArray&&e.isObject){const n=e.parent||e,s=e.nested.flatMap(o=>(o.parent=e,this._flattenWsdlElement(o)));return[new Ye({caption:n.caption,path:t||n.path,dataValueType:n.dataValueType,isArray:!0,isSoapHeader:e.isSoapHeader,sequenceElementName:e.sequenceElementName,namespace:n.namespace,nested:s,parent:n.parent})]}return e.nested.flatMap(n=>(n.parent=e,this._flattenWsdlElement(n)))}_getSequenceElementName(e,t){return Ye.getPrefixForNamespace(e,this.namespaces)+":"+t}_getComplexType(e,t,n){if(this._exitFromLoop(e.referenceDataTypeName,n))return null;const s=e.namespace||t;return e.nodes.forEach(a=>{const o=this._getWsdlElementFromSequenceElement(a,s,n);o&&e.nested.push(o)}),e.namespace=t,e}_getWsdlElementFromSequenceElement(e,t="",n){const s=Ye.fromElement(e);return s.sequenceElementName=this._getSequenceElementName(t,s.typeName),s.isSimpleType?(s.namespace=t,s):this._getComplexType(s,t,new Map(n))}_getParameterFromSequenceElement(e,t,n){const s=this._getWsdlElementFromSequenceElement(e,t);return(s?this._flattenWsdlElement(s,n):[]).map(o=>o.toServiceParameter(this.namespaces))}_getParametersByElementName(e,t,n){const s=xt.getSchemaElementByName(this.doc,e),a=s.getAttribute("type");let o;if(a){const d=$e(Te(a));o=this.doc.querySelectorAll(`definitions > types > schema > complexType[name=${d}] > sequence > element`)}else o=s.querySelectorAll(":scope > complexType > sequence > element");let c=[];return n?c=[...this._getParameterFromSequenceElement(s,t,e)]:o.forEach(d=>{const p=this._getParameterFromSequenceElement(d,t,e);c=[...c,...p]}),c}_getParametersFromMessage(e,t){const n=this.doc.querySelectorAll(`definitions > message[name=${$e(e)}] > part`),s=[];return n.forEach(a=>{const o=a.getAttribute("element");if(!o){const p=a.getAttribute("type"),C=Vn(p,a);s.push(...this._getParameterFromSequenceElement(a,C));return}const c=Te(o),d=Vn(o,a);s.push(...this._getParametersByElementName(c,d,t))}),s}_truncateName(e){return e.length<=this._maxNameLength?e:e.substr(e.length-this._maxNameLength,this._maxNameLength)}_reduceByUpperCaseChars(e){const t=e.match(/[A-Z][a-z]+/g);return t?t.map((n,s,a)=>s!==a.length-1?n.charAt(0):n).join(""):e}_getPrefixedName(e,t=""){const n=this._reduceByUpperCaseChars((t+e).split(" ").join(""));return this._truncateName(this.schemaNamePrefix+n)}_generateParametersNames(e,t="",n=null){n=n||new Set,e.forEach(s=>{const a=this._getPrefixedName(s.caption,t);let o=a,c=1;for(;n.has(o);)o=a+c,o=this._truncateName(o),c++;n.add(o),s.name=o,s.itemProperties&&this._generateParametersNames(s.itemProperties,s.caption,n)})}_generateMethodName(e){const t=this._getPrefixedName(e),s=(0,le.qv)().split("-").shift();return`${t}_${s}`}_hasCommonCaptionPart(e){const t=e.length&&e[0].caption;return!e.find(n=>{const s=n.caption.split(" ");return s.length<=1||s[0]!==t.split(" ")[0]})}_removeCommonCaptionPart(e){e.forEach(t=>{const n=t.caption.split(" ");n.shift(),t.caption=n.join(" ")})}_normalizeParametersCaption(e){this._hasCommonCaptionPart(e)&&this._removeCommonCaptionPart(e)}_getParametersForInput(e,t){const n=Te(e.getAttribute("message")),s=this._getParametersFromMessage(n,t);return this._normalizeParametersCaption(s),this._generateParametersNames(s),s}_getRootElementCode(e){const t=Te(e.getAttribute("message")),s=this.doc.querySelector(`definitions > message[name=${$e(t)}] > part`).getAttribute("element");return Te(s)}_getSoapHeaderForOperation(e,t){const n=e.getAttribute("name");if(!n)return null;const s=`operation[name="${n}"]>input>header`;return t.querySelector(s)??null}_getHeaderParameters(e,t){const n=this._getSoapHeaderForOperation(e,t);let s=[];return n&&(s=this._getParametersForInput(n,!0),this._markParameterAsHeader(s)),s}_getRequest(e,t){const n=new Io,s=e.querySelector("input");n.contentType=un.xml,n.methodType=dn.Post,n.uri=this._getRootElementCode(s)||e.getAttribute("name");const a=this._getParametersForInput(s,!1),o=this._getHeaderParameters(e,t);return n.parameters=[...a,...o],n}_markParameterAsHeader(e=[]){e.length&&e.forEach(t=>{t.isSoapHeader=!0,t.itemProperties&&t.itemProperties.length>0&&this._markParameterAsHeader(t.itemProperties)})}_getResponse(e){const t=new wo;t.contentType=un.xml;const n=e.querySelector("output");return t.parameters=this._getParametersForInput(n,!1),t}getMethod(e,t){const n=new St;return n.caption=t.getAttribute("name"),n.name=this._generateMethodName(n.caption),n.soapAction=this._getSoapAction(e,n.caption),n.request=this._getRequest(t,e),n.response=this._getResponse(t),n}}class xo extends On{constructor(){super(...arguments),this.namespaces=[],this.serviceMethods=[]}}class cr extends Error{constructor(e,t){super(t),this.fileName=e}}class pn extends cr{constructor(){super(null,"Wsdl parsing error"),this.errorCode="WsdlParsingError"}}class F extends cr{constructor(e,t){super(null,t.message),this.errorCode="DownloadXmlSchemaError",this.urls=e}}class x extends cr{constructor(e){super(e,`File '${e}' not found`),this.errorCode="SchemaDocumentFileNotFoundError"}}var f=h(73308);class j{constructor(e){this.httpClient=e,this.downloadWsdlEndpointUrl="/rest/DownloadWsdlEndpoint/",this.getXmlSchemaContentMethod="GetXmlSchemaFilesContent"}download(e=[]){if(!e||e.length===0)return(0,u.of)(new Map);const t=`${this.downloadWsdlEndpointUrl}${this.getXmlSchemaContentMethod}`;return this.httpClient.post(t,e).pipe((0,l.tap)(n=>{if(!n.success)throw new F(e,n.errorInfo)}),(0,l.map)(n=>{const s=new TextDecoder("utf-8");return n.files.map(a=>{const o=new Uint8Array(a.Value),c=s.decode(o);return[a.Key,c]})}),(0,l.map)(n=>new Map(n)))}static{this.\u0275fac=function(t){return new(t||j)(i.\u0275\u0275inject(P.HttpClient))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:j,factory:j.\u0275fac})}}class z{constructor(e){this.downloadWsdl=e}static getDocumentOwnSchemaNodes(e){return Array.from(e.querySelectorAll("schema"))}static getDocument(e){return new DOMParser().parseFromString(e,"text/xml")}concatFiles(e){return new Map([...this.files,...e])}findWsdl(e){let t;return e.forEach((n,s)=>{new DOMParser().parseFromString(n,"text/xml").querySelector("definitions > service")&&(t=[s,n])}),t}getLocation(e,t){const n=e.getAttribute("schemaLocation");n&&t.push(n)}getImportsForSchema(e){const n=new DOMParser().parseFromString(e,"text/xml"),s=[],a=n.querySelectorAll("definitions > types > schema > import"),o=n.querySelectorAll("definitions > types > schema > include");return a.forEach(c=>this.getLocation(c,s)),o.forEach(c=>this.getLocation(c,s)),s}findMissingImports(){const e=[],t=this.findWsdl(this.files);if(!t)return(0,u.throwError)(()=>new pn);const n=new Map([t]),s=new Set;for(;n.size;){const[a,o]=n.entries().next().value;this.getImportsForSchema(o).forEach(d=>{s.has(d)||(this.files.has(d)?n[d]=this.files[d]:e.push(d))}),s.add(a),n.delete(a)}return(0,u.of)(e)}downloadMissingImports(e){return e.length?this.downloadWsdl.download(e):(0,u.of)(new Map)}reInitialize(e){this.wsdlFileName=null,this.documents=new Map,this.mergedFiles=new Set,e.forEach((t,n)=>{const s=z.getDocument(t);this.documents.set(n,s),s.querySelector("definitions > service")&&(this.wsdlFileName=n)})}getDocumentByName(e){var t=this;return(0,f.A)(function*(){if(t.documents.has(e))return t.documents.get(e).cloneNode(!0);throw new x(e)})()}getInsertedSchemaNodes(e,t){var n=this;return(0,f.A)(function*(){const s=[],a=Array.from(e.querySelectorAll(t));for(const o of a){const c=o.getAttribute("schemaLocation"),d=yield n.getDocumentSchemaNodes(c);s.push(...d),o.parentElement.removeChild(o)}return s})()}getDocumentSchemaNodes(e){var t=this;return(0,f.A)(function*(){if(!e||t.mergedFiles.has(e))return[];t.mergedFiles.add(e);const n=yield t.getDocumentByName(e);return[...yield t.getInsertedSchemaNodes(n,"schema > import"),...yield t.getInsertedSchemaNodes(n,"schema > include"),...z.getDocumentOwnSchemaNodes(n)]})()}mergeSchemas(e,t){var n=this;return(0,f.A)(function*(){const s=Array.from(e.querySelectorAll(t));for(const a of s){const o=a.getAttribute("schemaLocation"),c=yield n.getDocumentSchemaNodes(o),d=a.parentElement;for(const p of c)d.insertAdjacentElement("beforebegin",p);a.parentElement.removeChild(a)}return e})()}mergeWsdl(){var e=this;return(0,f.A)(function*(){if(e.wsdlFileName==null)throw new pn;const t=yield e.getDocumentByName(e.wsdlFileName);return yield e.mergeSchemas(t,"definitions > types > schema > import"),yield e.mergeSchemas(t,"definitions > types > schema > include"),t})()}merge(e){return this.files=e,this.findMissingImports().pipe((0,l.concatMap)(t=>this.downloadMissingImports(t)),(0,l.map)(t=>this.concatFiles(t)))}mergeDocument(e){return this.merge(e).pipe((0,l.mergeMap)(t=>(this.reInitialize(t),this.mergeWsdl())))}static{this.\u0275fac=function(t){return new(t||z)(i.\u0275\u0275inject(j))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:z,factory:z.\u0275fac,providedIn:"root"})}}class _e{constructor(e,t){this.sysSettingsService=e,this.wsdlMerge=t,this.schemaNamePrefixSysSettingCode="SchemaNamePrefix"}static getServiceType(e){const t="http://schemas.xmlsoap.org/wsdl/soap/",n="http://schemas.xmlsoap.org/wsdl/soap12/";switch(e.querySelector("address").namespaceURI){case t:return oe.soap11;case n:return oe.soap12;default:return oe.undefined}}static getBaseUri(e){return e.querySelector("address").getAttribute("location")}static getTargetNamespace(e){return{prefix:"tem",name:e.querySelector("definitions").getAttribute("targetNamespace")??"http://tempuri.org"}}getMethods(e,t,n,s){const a=[],o=Te(t.getAttribute("binding")),c=e.querySelector(`definitions > binding[name=${$e(o)}]`),d=Te(c.getAttribute("type"));return e.querySelectorAll(`definitions > portType[name=${$e(d)}] > operation`).forEach(C=>{const I=new Eo(e,n,s);a.push(I.getMethod(c,C))}),a}getService(e,t=""){const n=e.querySelector("definitions > service"),s=[];return e.querySelectorAll("definitions > service > port").forEach(o=>{const c=new xo;c.namespaces=[_e.getTargetNamespace(e)],c.type=_e.getServiceType(o),c.caption=n.getAttribute("name"),c.name=t+c.caption,c.portName=o.getAttribute("name"),c.serviceMethods=this.getMethods(e,o,c.namespaces,t),c.baseUri=_e.getBaseUri(o),s.push(c)}),s}getSchemaNamePrefix$(){return this.sysSettingsService.getByCodes([this.schemaNamePrefixSysSettingCode]).pipe((0,l.map)(e=>{if(!e.success)throw new Error(e.errorInfo.message);return e.values[this.schemaNamePrefixSysSettingCode].value}))}build(e){return(0,u.combineLatest)([this.getSchemaNamePrefix$(),this.wsdlMerge.mergeDocument(e)]).pipe((0,l.map)(([t,n])=>{const s=this.getService(n,t);if(!s||s.length===0)throw new pn;return s}))}static{this.\u0275fac=function(t){return new(t||_e)(i.\u0275\u0275inject(xi),i.\u0275\u0275inject(z))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:_e,factory:_e.\u0275fac})}}var $=h(23023),Tt=h(50301);function Xl(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"div",1),i.\u0275\u0275listener("click",function(s){i.\u0275\u0275restoreView(t);const a=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(a.onClick(s))}),i.\u0275\u0275element(1,"mat-spinner",2),i.\u0275\u0275elementEnd()}if(r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275styleProp("opacity",t.opacity),i.\u0275\u0275classProp("containerized-mask",t.containerized)}}class Ke{constructor(e){this._cdr=e,this._isVisible=!0,this._opacity=.6,this.containerized=!1}get isVisible(){return this._isVisible}set isVisible(e){this._isVisible!==e&&(this._isVisible=e,this._cdr.detectChanges())}set opacity(e){this._opacity=e,this._cdr.detectChanges()}get opacity(){return this._opacity}_assertIsBodyMask(){if(this.containerized)throw new Error("Is not body mask")}onClick(e){e.stopImmediatePropagation()}hideBodyMask(){this._assertIsBodyMask(),this.isVisible=!1}showBodyMask(){this._assertIsBodyMask(),this.isVisible=!0}static{this.\u0275fac=function(t){return new(t||Ke)(i.\u0275\u0275directiveInject(i.ChangeDetectorRef))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:Ke,selectors:[["ts-mask"]],inputs:{isVisible:"isVisible",opacity:"opacity"},decls:1,vars:1,consts:[["class","mask-wrap",3,"containerized-mask","opacity","click",4,"ngIf"],[1,"mask-wrap",3,"click"],["mode","indeterminate","diameter","32","aria-hidden","true",1,"mask-element"]],template:function(t,n){t&1&&i.\u0275\u0275template(0,Xl,2,4,"div",0),t&2&&i.\u0275\u0275property("ngIf",n.isVisible)},dependencies:[v.NgIf,Tt.MatProgressSpinner],styles:[".component-mask[_nghost-%COMP%]   .mask-wrap[_ngcontent-%COMP%], .component-mask   [_nghost-%COMP%]   .mask-wrap[_ngcontent-%COMP%]{position:absolute}.component-mask[_nghost-%COMP%]   .mask-wrap[_ngcontent-%COMP%]   .mask-element[_ngcontent-%COMP%], .component-mask   [_nghost-%COMP%]   .mask-wrap[_ngcontent-%COMP%]   .mask-element[_ngcontent-%COMP%]{position:absolute}.mask-wrap[_ngcontent-%COMP%]{position:fixed;top:0;left:0;z-index:2011;width:100%;height:100%;background-color:#fff}.mask-wrap[_ngcontent-%COMP%]   .mask-element[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;margin-top:-16px;margin-left:-16px;z-index:999}.mask-wrap.containerized-mask[_ngcontent-%COMP%], .mask-wrap.containerized-mask[_ngcontent-%COMP%]   .mask-element[_ngcontent-%COMP%]{position:absolute}"],changeDetection:0})}}var ee=h(4091),me=h(70987);const tm=["uploadWsdl"];class ur{constructor(){this.urlChanged=new i.EventEmitter,this.filesSelected=new i.EventEmitter}getFileContent(e){return(0,f.A)(function*(){return new Promise((t,n)=>{const s=new FileReader;s.onloadend=a=>{t(s.result)},s.readAsText(e)})})()}onWsdlSelected(e){var t=this;return(0,f.A)(function*(){if(e.length===0)return;const n=new Map;for(const s of Array.from(e)){const a=yield t.getFileContent(s);n.set(s.name,a)}t.uploadWsdlElementRef.nativeElement.value=null,t.filesSelected.next(n)})()}onWsdlSelect(){this.uploadWsdlElementRef.nativeElement.click()}onUrlChange(e){this.urlChanged.next(e.target.value)}static{this.\u0275fac=function(t){return new(t||ur)}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:ur,selectors:[["ts-wsdl-upload"]],viewQuery:function(t,n){if(t&1&&i.\u0275\u0275viewQuery(tm,5),t&2){let s;i.\u0275\u0275queryRefresh(s=i.\u0275\u0275loadQuery())&&(n.uploadWsdlElementRef=s.first)}},outputs:{urlChanged:"urlChanged",filesSelected:"filesSelected"},decls:16,vars:10,consts:[["uploadWsdl",""],[1,"content"],[1,"upload"],["type","file","data-item-marker","upload_wsdl",2,"display","none",3,"change","multiple"],["mat-flat-button","","cdkFocusInitial","",1,"upload-file",3,"click"],["alt","upload","src","data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2Ij48ZGVmcz48c3R5bGU+LmEsLmIsLmN7ZmlsbDpub25lO30uYSwuYntzdHJva2U6IzRlN2JkODtzdHJva2UtbWl0ZXJsaW1pdDoxMDt9LmF7c3Ryb2tlLXdpZHRoOjAuOHB4O308L3N0eWxlPjwvZGVmcz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMTguNSAtNDM4LjA0MykiPjxwYXRoIGNsYXNzPSJhIiBkPSJNLTMxNSw0NDUuNTQybDUsNC41LDUtNC41IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwKSIvPjwvZz48bGluZSBjbGFzcz0iYiIgeTE9IjExIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4LjUgMC41KSIvPjxsaW5lIGNsYXNzPSJiIiB4Mj0iMTIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIuNSAxNC41KSIvPjxyZWN0IGNsYXNzPSJjIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiLz48L3N2Zz4="],[1,"upload-file-separator"],[1,"wsdl-link-field"],["matInput","","autocomplete","off",3,"input","placeholder"]],template:function(t,n){if(t&1){const s=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"div",1)(1,"div"),i.\u0275\u0275text(2),i.\u0275\u0275pipe(3,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(4,"div",2)(5,"input",3,0),i.\u0275\u0275listener("change",function(o){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.onWsdlSelected(o.target.files))}),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(7,"button",4),i.\u0275\u0275listener("click",function(){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.onWsdlSelect())}),i.\u0275\u0275element(8,"img",5)(9,"span",6),i.\u0275\u0275text(10),i.\u0275\u0275pipe(11,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(12,"div")(13,"mat-form-field",7)(14,"input",8),i.\u0275\u0275pipe(15,"translate"),i.\u0275\u0275listener("input",function(o){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.onUrlChange(o))}),i.\u0275\u0275elementEnd()()()()()}t&2&&(i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(3,4,"WsdlFileAndUrlPromptCaption")),i.\u0275\u0275advance(3),i.\u0275\u0275property("multiple",!0),i.\u0275\u0275advance(5),i.\u0275\u0275textInterpolate1(" ",i.\u0275\u0275pipeBind1(11,6,"WsdlUploadButtonCaption")," "),i.\u0275\u0275advance(4),i.\u0275\u0275property("placeholder",i.\u0275\u0275pipeBind1(15,8,"WsdlLinkPlaceholderText")))},dependencies:[ee.MatLegacyFormField,$.MatLegacyButton,me.MatLegacyInput,m.TranslatePipe],styles:[".content[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-size:13px;font-family:Open Sans,sans-serif}.upload[_ngcontent-%COMP%]{margin-top:8px}.upload[_ngcontent-%COMP%]   .wsdl-link-field[_ngcontent-%COMP%]{width:100%;margin-top:1.5em}.mat-flat-button.upload-file[_ngcontent-%COMP%]{text-transform:none;font-size:13px;color:#006ce0;background-color:#f2f5ff;border-radius:2px}.mat-flat-button.upload-file[_ngcontent-%COMP%]:hover{background-color:#f2f5ff}.mat-flat-button.upload-file[_ngcontent-%COMP%]   span.upload-file-separator[_ngcontent-%COMP%]{width:.6em}"]})}}var To=h(91592);class nm{}class Ti extends To.X{constructor(){super(...arguments),this.getRegisteredEvents=()=>[{name:"selectMethod",dataType:nm}]}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=i.\u0275\u0275getInheritedFactory(Ti)))(n||Ti)}})()}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:Ti,selectors:[["ts-custom-cell"]],features:[i.\u0275\u0275InheritDefinitionFeature],decls:2,vars:1,consts:[[1,"caption",3,"click"]],template:function(t,n){t&1&&(i.\u0275\u0275elementStart(0,"div",0),i.\u0275\u0275listener("click",function(){return n.fireEvent("selectMethod")}),i.\u0275\u0275text(1),i.\u0275\u0275elementEnd()),t&2&&(i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(n.record==null?null:n.record.caption))},styles:[".caption[_ngcontent-%COMP%]{line-height:36px}"]})}}var im=h(53707),At=h(13053),sm=h(62225),Cd=h(37845),Ae=h(31843),Ao;(function(r){r.None="None",r.ExpandOnlyRoot="ExpandOnlyRoot"})(Ao||(Ao={}));var G=h(52989),Ge=h(53135),Z=h(56711),Ai=h(93277),Do=h(90865),bd=h(24897),yS=h(4930);const ec="crtInput:",tc="crtOutput:",Sd="crtValidationInput:",rm="crtInject:";function re(r){return function(e,t){r||(r={propertyBindable:!1}),Reflect.defineMetadata(ec+t.toString(),r,e.constructor)}}const am=["input"];class Dt{constructor(e,t,n){this.ngControl=e,this.autofillMonitor=t,this.focusMonitor=n,this._disabled=!1,this._placeholder="",this._required=!1,this._focused=!1,this.destroy=new u.Subject,this.autofilled=!1,this.stateChanges=new u.Subject,this.onTouched=()=>{},e&&(this.ngControl.valueAccessor=this)}set elementRef(e){e&&(this._elementRef=e)}get elementRef(){return this._elementRef}get disabled(){return this._disabled}set disabled(e){this.setDisabledState((0,bd.coerceBooleanProperty)(e)),this.stateChanges.next()}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.stateChanges.next()}get required(){return this._required}set required(e){this._required=(0,bd.coerceBooleanProperty)(e),this.stateChanges.next()}get value(){return this.innerValue}set value(e){this.writeValue(e)}get innerValue(){return this._innerValue}set innerValue(e){this.setInnerValueSilent(e),this.callChangeHandler()}get empty(){return!this.autofilled&&!this.value}get focused(){return this._focused}set focused(e){this._focused=e,this.stateChanges.next()}get shouldLabelFloat(){return this.focused||!this.empty}setInnerValueSilent(e){this._innerValue=e}callChangeHandler(){this.onChange?this.onChange(this._innerValue):this.stateChanges.next()}focusElementViaMouse(){this.focusMonitor.focusVia(this.elementRef.nativeElement,"mouse")}initMonitors(){this.focusMonitor.monitor(this.elementRef.nativeElement,!0).pipe((0,l.takeUntil)(this.destroy)).subscribe(e=>{this.focused=!!e}),this.autofillMonitor.monitor(this.elementRef).pipe((0,l.map)(e=>e.isAutofilled),(0,l.filter)(e=>e),(0,l.startWith)(!1),(0,l.takeUntil)(this.destroy)).subscribe(e=>this.autofilled=e)}onContainerClick(e){e.target.tagName.toLowerCase()!=="input"&&this.focusElementViaMouse()}setDescribedByIds(){}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}writeValue(e){this._innerValue=e,this.stateChanges.next()}setDisabledState(e){if(this._disabled===e)return;this._disabled=e;const t=this.ngControl?.control;t&&t.disabled!==e&&(e?t.disable():t.enable())}ngDoCheck(){this.ngControl&&(this.errorState=this.ngControl.invalid&&this.ngControl.touched,this.stateChanges.next())}ngAfterViewInit(){this.initMonitors()}ngOnDestroy(){this.focusMonitor.stopMonitoring(this.elementRef?.nativeElement),this.autofillMonitor.stopMonitoring(this.elementRef),this._elementRef=null,this.stateChanges.next(),this.stateChanges.complete(),this.destroy.next(),this.destroy.complete()}static{this.\u0275fac=function(t){return new(t||Dt)(i.\u0275\u0275directiveInject(Z.NgControl),i.\u0275\u0275directiveInject(Do.AutofillMonitor),i.\u0275\u0275directiveInject(Ai.FocusMonitor))}}static{this.\u0275dir=i.\u0275\u0275defineDirective({type:Dt,viewQuery:function(t,n){if(t&1&&i.\u0275\u0275viewQuery(am,5,i.ElementRef),t&2){let s;i.\u0275\u0275queryRefresh(s=i.\u0275\u0275loadQuery())&&(n.elementRef=s.first)}},hostVars:2,hostBindings:function(t,n){t&1&&i.\u0275\u0275listener("focusout",function(){return n.onTouched()}),t&2&&i.\u0275\u0275classProp("floating",n.shouldLabelFloat)},inputs:{disabled:"disabled",placeholder:"placeholder",required:"required",value:"value"}})}}(0,y.__decorate)([re(),(0,y.__metadata)("design:type",Boolean),(0,y.__metadata)("design:paramtypes",[Boolean])],Dt.prototype,"disabled",null),(0,y.__decorate)([re(),(0,y.__metadata)("design:type",String),(0,y.__metadata)("design:paramtypes",[String])],Dt.prototype,"placeholder",null),(0,y.__decorate)([re(),(0,y.__metadata)("design:type",Boolean),(0,y.__metadata)("design:paramtypes",[Boolean])],Dt.prototype,"required",null),(0,y.__decorate)([re(),(0,y.__metadata)("design:type",Object),(0,y.__metadata)("design:paramtypes",[Object])],Dt.prototype,"value",null);var om=h(30046),No=h.n(om),dr=h(63193);const lm=["originalPickerToggle"];function cm(r,e){r&1&&i.\u0275\u0275element(0,"mat-icon",11)}function um(r,e){r&1&&i.\u0275\u0275element(0,"mat-icon",12)}function dm(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"button",9),i.\u0275\u0275listener("click",function(){i.\u0275\u0275restoreView(t);const s=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(s.onPickerIconClick())}),i.\u0275\u0275template(1,cm,1,0,"mat-icon",10)(2,um,1,0,"ng-template",null,3,i.\u0275\u0275templateRefExtractor),i.\u0275\u0275elementEnd()}if(r&2){const t=i.\u0275\u0275reference(3),n=i.\u0275\u0275nextContext();i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",n.type==="time")("ngIfElse",t)}}class mn extends Dt{get convertedValue(){return this._convertedValue}set convertedValue(e){this._convertedValue=e,this.innerValue=e.toDate()}constructor(e,t,n,s,a){super(e,t,n),this._matIconRegistry=s,this._domSanitizer=a,this.controlType="ts-datetime-picker",this.type="datetime",this._registerIcons()}_registerIcons(){["datetime-picker-toggle-date","datetime-picker-toggle-time"].forEach(e=>{this._matIconRegistry.addSvgIconLiteral(e,this._domSanitizer.bypassSecurityTrustHtml(h(48104)("./"+e+"-icon.svg")))}),this._matIconRegistry.addSvgIconLiteral("read-only",this._domSanitizer.bypassSecurityTrustHtml(h(75670)))}writeValue(e){this._convertedValue=No()(e),super.writeValue(e)}onPickerIconClick(){this.originalPickerToggle.nativeElement.dispatchEvent(new MouseEvent("click"))}static{this.\u0275fac=function(t){return new(t||mn)(i.\u0275\u0275directiveInject(Z.NgControl,10),i.\u0275\u0275directiveInject(Do.AutofillMonitor),i.\u0275\u0275directiveInject(Ai.FocusMonitor),i.\u0275\u0275directiveInject(G.MatIconRegistry),i.\u0275\u0275directiveInject(g.DomSanitizer))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:mn,selectors:[["ts-datetime-picker"]],viewQuery:function(t,n){if(t&1&&i.\u0275\u0275viewQuery(lm,5,i.ElementRef),t&2){let s;i.\u0275\u0275queryRefresh(s=i.\u0275\u0275loadQuery())&&(n.originalPickerToggle=s.first)}},inputs:{label:"label",minDate:"minDate",maxDate:"maxDate",type:"type"},features:[i.\u0275\u0275ProvidersFeature([{provide:ee.MatLegacyFormFieldControl,useExisting:mn}]),i.\u0275\u0275InheritDefinitionFeature],decls:8,vars:10,consts:[["input",""],["originalPickerToggle",""],["datetimePicker",""],["dateIcon",""],[1,"datetime-picker-input-wrapper"],["matInput","","type","text","autocomplete","false","spellcheck","false",3,"ngModelChange","ngModel","matDatetimepicker","required","min","max","disabled"],[3,"for"],["mat-icon-button","",3,"click",4,"ngIf"],["openOnFocus","true","mode","portrait",3,"type","disabled"],["mat-icon-button","",3,"click"],["svgIcon","datetime-picker-toggle-time",4,"ngIf","ngIfElse"],["svgIcon","datetime-picker-toggle-time"],["svgIcon","datetime-picker-toggle-date"]],template:function(t,n){if(t&1){const s=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"div",4)(1,"input",5,0),i.\u0275\u0275twoWayListener("ngModelChange",function(o){return i.\u0275\u0275restoreView(s),i.\u0275\u0275twoWayBindingSet(n.convertedValue,o)||(n.convertedValue=o),i.\u0275\u0275resetView(o)}),i.\u0275\u0275elementEnd(),i.\u0275\u0275element(3,"mat-datetimepicker-toggle",6,1),i.\u0275\u0275template(5,dm,4,2,"button",7),i.\u0275\u0275element(6,"mat-datetimepicker",8,2),i.\u0275\u0275elementEnd()}if(t&2){const s=i.\u0275\u0275reference(7);i.\u0275\u0275advance(),i.\u0275\u0275twoWayProperty("ngModel",n.convertedValue),i.\u0275\u0275property("matDatetimepicker",s)("required",n.required)("min",n.minDate)("max",n.maxDate)("disabled",n.disabled),i.\u0275\u0275advance(2),i.\u0275\u0275property("for",s),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",!n.disabled),i.\u0275\u0275advance(),i.\u0275\u0275property("type",n.type)("disabled",n.disabled)}},dependencies:[v.NgIf,Z.DefaultValueAccessor,Z.NgControlStatus,Z.RequiredValidator,Z.NgModel,$.MatLegacyButton,dr.MatDatetimepickerComponent,dr.MatDatetimepickerToggleComponent,dr.MatDatetimepickerInputDirective,G.MatIcon,me.MatLegacyInput],styles:[`ts-datetime-picker{width:100%}ts-datetime-picker .datetime-picker-input-wrapper{display:flex;align-items:center;position:relative;min-width:calc(18ch + 26px)}ts-datetime-picker .datetime-picker-input-wrapper mat-datetimepicker-toggle{display:none}ts-datetime-picker .datetime-picker-input-wrapper button[mat-icon-button]{height:26px;width:26px;line-height:26px;position:absolute;right:0}ts-datetime-picker .datetime-picker-input-wrapper button[mat-icon-button] mat-icon{height:16px!important;width:16px!important;line-height:16px;position:relative;bottom:2px}
`],encapsulation:2})}}const hm=r=>[r];function pm(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"mat-form-field",6)(1,"input",7,0),i.\u0275\u0275listener("input",function(s){i.\u0275\u0275restoreView(t);const a=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(a.onValueChanged(s.target.value))}),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(3,"mat-placeholder",8),i.\u0275\u0275text(4),i.\u0275\u0275pipe(5,"async"),i.\u0275\u0275elementEnd()()}if(r&2){const t=i.\u0275\u0275reference(2),n=i.\u0275\u0275nextContext();i.\u0275\u0275classProp("required",t.errors&&(t.dirty||t.touched)),i.\u0275\u0275advance(),i.\u0275\u0275property("type",n.getInputType())("ngModel",n.value)("required",n.required)("disabled",!n.enabled),i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(5,7,n.getPlaceholder(n.name)))}}function mm(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"mat-form-field",6)(1,"ts-datetime-picker",9,1),i.\u0275\u0275listener("ngModelChange",function(s){i.\u0275\u0275restoreView(t);const a=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(a.onValueChanged(s))}),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(3,"mat-placeholder",8),i.\u0275\u0275text(4),i.\u0275\u0275pipe(5,"async"),i.\u0275\u0275elementEnd()()}if(r&2){const t=i.\u0275\u0275reference(2),n=i.\u0275\u0275nextContext();i.\u0275\u0275classProp("required",t.errors&&(t.dirty||t.touched)),i.\u0275\u0275advance(),i.\u0275\u0275property("type",n.getDateTimeInputType())("ngModel",n.value)("required",n.required)("disabled",!n.enabled),i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(5,7,n.getPlaceholder(n.name)))}}function gm(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"mat-checkbox",10),i.\u0275\u0275listener("change",function(s){i.\u0275\u0275restoreView(t);const a=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(a.onValueChanged(s.checked))}),i.\u0275\u0275elementEnd()}if(r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275property("checked",t.value)("disabled",!t.enabled)}}class hr{constructor(e,t){this.translateService=e,this._directionality=t,this.name="",this.valueChanged=new i.EventEmitter}isRtl(){return this._directionality?.value==="rtl"}getPlaceholder(e){return this.translateService.get("ServiceClientParameterPlaceholder").pipe((0,l.map)(t=>t.replace("{0}",e)))}onValueChanged(e){this.valueChanged.next(e)}getDateTimeInputType(){return{[X.Date]:"date",[X.DateTime]:"datetime",[X.Time]:"time"}[this.valueType]}getInputType(){return{[X.Text]:"text",[X.Guid]:"text",[X.Integer]:"number",[X.Float]:"number"}[this.valueType]}static{this.\u0275fac=function(t){return new(t||hr)(i.\u0275\u0275directiveInject(m.TranslateService),i.\u0275\u0275directiveInject(At.Directionality))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:hr,selectors:[["ts-editable-value"]],inputs:{name:"name",value:"value",valueType:"valueType",required:"required",enabled:"enabled"},outputs:{valueChanged:"valueChanged"},decls:5,vars:6,consts:[["valueInput","ngModel"],["dateInput","ngModel"],["matForm","",1,"editable-value"],["floatLabel","never","hideRequiredMarker","",3,"required",4,"ngIf"],[3,"ngClass"],["class","boolean-value",3,"checked","disabled","change",4,"ngIf"],["floatLabel","never","hideRequiredMarker",""],["matInput","","autocomplete","off",3,"input","type","ngModel","required","disabled"],[1,"placeholder"],[3,"ngModelChange","type","ngModel","required","disabled"],[1,"boolean-value",3,"change","checked","disabled"]],template:function(t,n){t&1&&(i.\u0275\u0275elementStart(0,"div",2),i.\u0275\u0275template(1,pm,6,9,"mat-form-field",3)(2,mm,6,9,"mat-form-field",3),i.\u0275\u0275elementStart(3,"div",4),i.\u0275\u0275template(4,gm,1,2,"mat-checkbox",5),i.\u0275\u0275elementEnd()()),t&2&&(i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",n.getInputType()),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",n.getDateTimeInputType()),i.\u0275\u0275advance(),i.\u0275\u0275property("ngClass",i.\u0275\u0275pureFunction1(4,hm,n.isRtl()?"checkboxContainer-rtl":"checkboxContainer")),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",n.valueType==="Boolean"))},dependencies:[ee.MatLegacyFormField,ee.MatLegacyPlaceholder,Z.DefaultValueAccessor,Z.NgControlStatus,Z.RequiredValidator,Z.NgModel,mn,v.NgClass,v.NgIf,me.MatLegacyInput,Ge.MatLegacyCheckbox,v.AsyncPipe],styles:["mat-form-field[_ngcontent-%COMP%]{margin-top:15px;width:100%}mat-form-field[_ngcontent-%COMP%]   ts-datetime-picker[_ngcontent-%COMP%]{width:100%;margin-bottom:-1px}mat-form-field[_ngcontent-%COMP%]   ts-datetime-picker[_ngcontent-%COMP%]   button[mat-icon-button][_ngcontent-%COMP%]{position:relative}.editable-value[_ngcontent-%COMP%]{padding-right:5px;text-align:right}.editable-value[_ngcontent-%COMP%]   mat-checkbox[_ngcontent-%COMP%]{padding-right:5px}.editable-value[_ngcontent-%COMP%]   .checkboxContainer[_ngcontent-%COMP%], .editable-value[_ngcontent-%COMP%]   .checkboxContainer-rtl[_ngcontent-%COMP%]{width:100%}.editable-value[_ngcontent-%COMP%]   .checkboxContainer[_ngcontent-%COMP%]{text-align:left}.editable-value[_ngcontent-%COMP%]   .checkboxContainer-rtl[_ngcontent-%COMP%]{text-align:right}"]})}}const Md=r=>["checklist-leaf-node",r],nc=(r,e)=>[r,e],fm=(r,e,t)=>[r,e,t];function _m(r,e){r&1&&i.\u0275\u0275element(0,"button",8)}function ym(r,e){if(r&1&&(i.\u0275\u0275elementContainerStart(0),i.\u0275\u0275template(1,_m,1,0,"button",7),i.\u0275\u0275elementContainerEnd()),r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",t.hasLeaves)}}function Cm(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"mat-checkbox",9),i.\u0275\u0275listener("change",function(){i.\u0275\u0275restoreView(t);const s=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(s.selectAll())}),i.\u0275\u0275elementStart(1,"label"),i.\u0275\u0275text(2),i.\u0275\u0275elementEnd()()}if(r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275property("ngClass",i.\u0275\u0275pureFunction1(5,Md,t.hasLeaves?"":"checkbox-padding-left"))("checked",t.allSelected())("indeterminate",t.partiallySelected())("disabled",t.readonly),i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(t.caption)}}function bm(r,e){r&1&&i.\u0275\u0275element(0,"button",8)}function Sm(r,e){if(r&1&&(i.\u0275\u0275elementContainerStart(0),i.\u0275\u0275elementStart(1,"div",10),i.\u0275\u0275template(2,bm,1,0,"button",7),i.\u0275\u0275elementStart(3,"label",11),i.\u0275\u0275text(4),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(5,"label",12),i.\u0275\u0275text(6),i.\u0275\u0275pipe(7,"translate"),i.\u0275\u0275elementEnd()(),i.\u0275\u0275elementContainerEnd()),r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",t.hasLeaves),i.\u0275\u0275advance(),i.\u0275\u0275property("ngClass",t.hasLeaves?"editable-label-header-item":"editable-label-item-margin"),i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(t.caption),i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(7,4,"TreeHeaderValueColumnCaption"))}}function Mm(r,e){r&1&&i.\u0275\u0275element(0,"button",8)}function vm(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"mat-checkbox",15),i.\u0275\u0275listener("change",function(){i.\u0275\u0275restoreView(t);const s=i.\u0275\u0275nextContext().$implicit,a=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(a.parameterLeafSelectionToggle(s))}),i.\u0275\u0275elementStart(1,"span",11),i.\u0275\u0275text(2),i.\u0275\u0275elementEnd()()}if(r&2){const t=i.\u0275\u0275nextContext().$implicit,n=i.\u0275\u0275nextContext();i.\u0275\u0275property("ngClass",i.\u0275\u0275pureFunction1(5,Md,n.hasLeaves?"":"checkbox-padding-left"))("checked",n.parameterSelection.isSelected(t))("disabled",n.readonly),i.\u0275\u0275advance(),i.\u0275\u0275property("ngClass",i.\u0275\u0275pureFunction2(7,nc,n.isRtl()?"parameter-rtl":"parameter",t.dataValueTypeName)),i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(t.caption)}}function Im(r,e){r&1&&(i.\u0275\u0275elementStart(0,"span",21),i.\u0275\u0275text(1,"*"),i.\u0275\u0275elementEnd())}function wm(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"ts-editable-value",22),i.\u0275\u0275listener("valueChanged",function(s){i.\u0275\u0275restoreView(t);const a=i.\u0275\u0275nextContext(2).$implicit,o=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(o.valueChanged(s,a.uId))}),i.\u0275\u0275elementEnd()}if(r&2){const t=i.\u0275\u0275nextContext(2).$implicit,n=i.\u0275\u0275nextContext();i.\u0275\u0275property("value",t.value)("name",t.caption)("valueType",t.dataValueTypeName)("required",t.isRequired)("enabled",!n.readonly),i.\u0275\u0275attribute("data-item-marker",t.value)}}function Em(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"button",23),i.\u0275\u0275listener("click",function(s){i.\u0275\u0275restoreView(t);const a=i.\u0275\u0275nextContext(2).$implicit,o=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(o.onCreateCollectionItem(s,a))}),i.\u0275\u0275element(1,"mat-icon",24),i.\u0275\u0275elementEnd()}}function xm(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"button",25),i.\u0275\u0275listener("click",function(s){i.\u0275\u0275restoreView(t);const a=i.\u0275\u0275nextContext(2).$implicit,o=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(o.onRemoveCollectionItem(s,a))}),i.\u0275\u0275element(1,"mat-icon",26),i.\u0275\u0275elementEnd()}}function Tm(r,e){if(r&1&&(i.\u0275\u0275elementContainerStart(0),i.\u0275\u0275elementStart(1,"span",11),i.\u0275\u0275text(2),i.\u0275\u0275template(3,Im,2,0,"span",16),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(4,"div",12),i.\u0275\u0275template(5,wm,1,6,"ts-editable-value",17),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(6,"div",18),i.\u0275\u0275template(7,Em,2,0,"button",19)(8,xm,2,0,"button",20),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementContainerEnd()),r&2){const t=i.\u0275\u0275nextContext().$implicit,n=i.\u0275\u0275nextContext();i.\u0275\u0275advance(),i.\u0275\u0275property("ngClass",i.\u0275\u0275pureFunction3(9,fm,n.isRtl()?"parameter-rtl":"parameter",t.dataValueTypeName,n.hasLeaves?"editable-label-item":"editable-label-item-margin")),i.\u0275\u0275attribute("data-item-marker",t.caption),i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate1(" ",t.caption," "),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",t.isRequired),i.\u0275\u0275advance(),i.\u0275\u0275classProp("has-button",n.isCollectionItem(t)&&!n.readonly),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",!t.isArray),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",t.isArray&&n.canManageCollectionItems),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",n.isCollectionItem(t)&&n.canManageCollectionItems)}}function Am(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"mat-tree-node",13),i.\u0275\u0275template(1,Mm,1,0,"button",7)(2,vm,3,10,"mat-checkbox",14)(3,Tm,9,13,"ng-container",2),i.\u0275\u0275elementEnd()),r&2){const t=e.$implicit,n=i.\u0275\u0275nextContext();i.\u0275\u0275attribute("data-item-marker","leaf "+t.caption),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",n.hasLeaves),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",n.canSelect),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",n.showValues)}}function Dm(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"mat-checkbox",31),i.\u0275\u0275listener("change",function(){i.\u0275\u0275restoreView(t);const s=i.\u0275\u0275nextContext().$implicit,a=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(a.parameterSelectionToggle(s))}),i.\u0275\u0275elementStart(1,"span",11),i.\u0275\u0275text(2),i.\u0275\u0275elementEnd()()}if(r&2){const t=i.\u0275\u0275nextContext().$implicit,n=i.\u0275\u0275nextContext();i.\u0275\u0275property("checked",n.descendantsAllSelected(t))("indeterminate",n.descendantsPartiallySelected(t))("disabled",n.readonly),i.\u0275\u0275advance(),i.\u0275\u0275property("ngClass",i.\u0275\u0275pureFunction2(5,nc,n.isRtl()?"parameter-rtl":"parameter",t.dataValueTypeName)),i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(t.caption)}}function Nm(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"span",11),i.\u0275\u0275text(1),i.\u0275\u0275elementEnd()),r&2){const t=i.\u0275\u0275nextContext().$implicit,n=i.\u0275\u0275nextContext();i.\u0275\u0275property("ngClass",i.\u0275\u0275pureFunction2(2,nc,n.isRtl()?"parameter-rtl":"parameter",t.dataValueTypeName)),i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(t.caption)}}function Pm(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"button",23),i.\u0275\u0275listener("click",function(s){i.\u0275\u0275restoreView(t);const a=i.\u0275\u0275nextContext().$implicit,o=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(o.onCreateCollectionItem(s,a))}),i.\u0275\u0275element(1,"mat-icon",24),i.\u0275\u0275elementEnd()}}function Rm(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"button",25),i.\u0275\u0275listener("click",function(s){i.\u0275\u0275restoreView(t);const a=i.\u0275\u0275nextContext().$implicit,o=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(o.onRemoveCollectionItem(s,a))}),i.\u0275\u0275element(1,"mat-icon",26),i.\u0275\u0275elementEnd()}}function Om(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"mat-tree-node",27)(1,"button",28),i.\u0275\u0275element(2,"mat-icon"),i.\u0275\u0275elementEnd(),i.\u0275\u0275template(3,Dm,3,8,"mat-checkbox",29)(4,Nm,2,5,"span",30),i.\u0275\u0275elementStart(5,"div",18),i.\u0275\u0275template(6,Pm,2,0,"button",19)(7,Rm,2,0,"button",20),i.\u0275\u0275elementEnd()()),r&2){const t=e.$implicit,n=i.\u0275\u0275nextContext();i.\u0275\u0275attribute("data-item-marker","collection "+t.caption),i.\u0275\u0275advance(),i.\u0275\u0275attribute("aria-label","Toggle "+t.caption),i.\u0275\u0275advance(),i.\u0275\u0275classProp("expanded",n.treeControl.isExpanded(t)),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",n.canSelect),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",n.showValues),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",t.isArray&&n.canManageCollectionItems),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",n.isCollectionItem(t)&&n.canManageCollectionItems)}}class CS{}class Vm{}class Di{constructor(e){this._directionality=e,this._nestedNodeMap=new Map,this._expanded=[],this._destroyed$=new u.Subject,this.parameters=[],this.selectedParameters=[],this.canSelect=!0,this.showValues=!1,this.canManageCollectionItems=!1,this.initialExpandMode=Ao.None,this.expandedChanged=new i.EventEmitter,this.selectedChange=new i.EventEmitter,this.valueChange=new i.EventEmitter,this.createCollectionItem=new i.EventEmitter,this.removeCollectionItem=new i.EventEmitter,this.parameterSelection=new sm.SelectionModel(!0),this._getLevel=t=>t.level,this._isExpandable=t=>t.expandable,this._getChildren=t=>t.itemProperties,this._transformer=(t,n)=>{const s=this._nestedNodeMap.get(t.uId),a=s&&s.caption===t.caption?s:new Vm;return a.caption=t.caption,a.uId=t.uId,a.dataValueTypeName=t.dataValueTypeName,a.level=n,a.expandable=!!t.itemProperties?.length,a.itemProperties=t.itemProperties,a.value=t.value,a.isRequired=t.isRequired,a.isArray=t.isArray,this._nestedNodeMap.set(t.uId,a),a},this.hasChild=(t,n)=>n.expandable,this._treeFlattener=new Ae.MatTreeFlattener(this._transformer,this._getLevel,this._isExpandable,this._getChildren),this.treeControl=new Cd.FlatTreeControl(this._getLevel,this._isExpandable),this.dataSource=new Ae.MatTreeFlatDataSource(this.treeControl,this._treeFlattener)}get hasLeaves(){return this.parameters?.some(e=>e?.itemProperties?.length>0)}getParameterLevel(e,t,n=0){const s=t||[];for(const a of s){if(a.uId===e.uId)return n;const o=this.getParameterLevel(e,a.itemProperties,n+1);if(o!==-1)return o}return-1}_checkAllParentsSelection(e){let t=this._getParentNode(e);for(;t;)this._checkRootNodeSelection(t),t=this._getParentNode(t);this.selectedChange.next(this.parameterSelection.selected)}_checkRootNodeSelection(e){const t=this.parameterSelection.isSelected(e),n=this.treeControl.getDescendants(e),s=n.length>0&&n.some(a=>this.parameterSelection.isSelected(a));t&&!s?this.parameterSelection.deselect(e):!t&&s&&this.parameterSelection.select(e)}_getParentNode(e){const t=this._getLevel(e);if(t<1)return null;const n=this.treeControl.dataNodes.indexOf(e)-1;for(let s=n;s>=0;s--){const a=this.treeControl.dataNodes[s];if(this._getLevel(a)<t)return a}return null}isRtl(){return this._directionality?.value==="rtl"}allSelected(){const e=this.treeControl.dataNodes;return e?.length>0&&e.every(t=>this.parameterSelection.isSelected(t))}partiallySelected(){return this.treeControl.dataNodes?.some(n=>this.parameterSelection.isSelected(n))&&!this.allSelected()}selectAll(){const e=this.partiallySelected();this.treeControl.dataNodes.forEach(t=>{e&&this.parameterSelection.isSelected(t)||(t.expandable?this.parameterLeafSelectionToggle(t):this.parameterSelectionToggle(t))})}descendantsAllSelected(e){const t=this.treeControl.getDescendants(e);return t.length>0&&t.every(n=>this.parameterSelection.isSelected(n))}isCollectionItem(e){const t=this._getParentNode(e);return!!t&&t.isArray}descendantsPartiallySelected(e){return this.treeControl.getDescendants(e).some(s=>this.parameterSelection.isSelected(s))&&!this.descendantsAllSelected(e)}parameterSelectionToggle(e){this.parameterSelection.toggle(e);const t=this.treeControl.getDescendants(e);this.parameterSelection.isSelected(e)?this.parameterSelection.select(...t):this.parameterSelection.deselect(...t),t.forEach(n=>this.parameterSelection.isSelected(n)),this._checkAllParentsSelection(e)}parameterLeafSelectionToggle(e){this.parameterSelection.toggle(e),this._checkAllParentsSelection(e)}ngOnChanges(){if(this.dataSource=new Ae.MatTreeFlatDataSource(this.treeControl,this._treeFlattener),this.parameters&&(this.dataSource.data=this.parameters,this.selectedParameters)){const e=this.selectedParameters.map(t=>{const n=this.getParameterLevel(t,this.parameters);return this._transformer(t,n)});this.parameterSelection.select(...e)}}ngOnInit(){this.initialExpandMode===Ao.ExpandOnlyRoot&&this.treeControl.dataNodes.filter(e=>e.level===0).forEach(e=>{this.treeControl.expand(e)}),this.treeControl.expansionModel.changed.pipe((0,l.takeUntil)(this._destroyed$)).subscribe(e=>{this._expanded=[...this._expanded,...e.added.filter(t=>t.expandable)],e.removed&&(this._expanded=this._expanded.filter(t=>!e.removed.find(n=>n.uId===t.uId))),this.expandedChanged.next(this._expanded)}),this.initialExpanded&&this.treeControl.dataNodes.filter(e=>this.initialExpanded.find(t=>t.uId===e.uId)).forEach(e=>{this.treeControl.expand(e)})}valueChanged(e,t){this.valueChange.next({recordId:t,value:e})}onCreateCollectionItem(e,t){this.createCollectionItem.next(t.uId),t.expandable=!0,this.dataSource.data=this.parameters,this.treeControl.expand(t),e.stopPropagation()}onRemoveCollectionItem(e,t){this.removeCollectionItem.next(t.uId),this.dataSource.data=this.parameters}trackBy(e,t){return t.uId+t.expandable}static{this.\u0275fac=function(t){return new(t||Di)(i.\u0275\u0275directiveInject(At.Directionality))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:Di,selectors:[["ts-parameters-tree"]],inputs:{initialExpanded:"initialExpanded",parameters:"parameters",selectedParameters:"selectedParameters",canSelect:"canSelect",showValues:"showValues",canManageCollectionItems:"canManageCollectionItems",readonly:"readonly",caption:"caption",initialExpandMode:"initialExpandMode"},outputs:{expandedChanged:"expandedChanged",selectedChange:"selectedChange",valueChange:"valueChange",createCollectionItem:"createCollectionItem",removeCollectionItem:"removeCollectionItem"},features:[i.\u0275\u0275NgOnChangesFeature],decls:8,vars:7,consts:[[1,"content"],[1,"header"],[4,"ngIf"],[3,"ngClass","checked","indeterminate","disabled","change",4,"ngIf"],[1,"parameters-tree",3,"dataSource","treeControl","trackBy"],["matTreeNodeToggle","","matTreeNodePadding","","matTreeNodePaddingIndent","24",4,"matTreeNodeDef"],["matTreeNodePadding","","matTreeNodePaddingIndent","24",4,"matTreeNodeDef","matTreeNodeDefWhen"],["mat-icon-button","","disabled","",4,"ngIf"],["mat-icon-button","","disabled",""],[3,"change","ngClass","checked","indeterminate","disabled"],[1,"editable-header-block"],[3,"ngClass"],[1,"editable-value-item"],["matTreeNodeToggle","","matTreeNodePadding","","matTreeNodePaddingIndent","24"],[3,"ngClass","checked","disabled","change",4,"ngIf"],[3,"change","ngClass","checked","disabled"],["class","required",4,"ngIf"],[3,"value","name","valueType","required","enabled","valueChanged",4,"ngIf"],[1,"tree-button"],["mat-icon-button","",3,"click",4,"ngIf"],["class","delete-button","mat-icon-button","",3,"click",4,"ngIf"],[1,"required"],[3,"valueChanged","value","name","valueType","required","enabled"],["mat-icon-button","",3,"click"],[1,"add-button-icon"],["mat-icon-button","",1,"delete-button",3,"click"],[1,"trash-icon"],["matTreeNodePadding","","matTreeNodePaddingIndent","24"],["mat-icon-button","","matTreeNodeToggle","",1,"toggle"],[3,"checked","indeterminate","disabled","change",4,"ngIf"],[3,"ngClass",4,"ngIf"],[3,"change","checked","indeterminate","disabled"]],template:function(t,n){t&1&&(i.\u0275\u0275elementStart(0,"div",0)(1,"div",1),i.\u0275\u0275template(2,ym,2,1,"ng-container",2)(3,Cm,3,7,"mat-checkbox",3)(4,Sm,8,6,"ng-container",2),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(5,"mat-tree",4),i.\u0275\u0275template(6,Am,4,4,"mat-tree-node",5)(7,Om,8,8,"mat-tree-node",6),i.\u0275\u0275elementEnd()()),t&2&&(i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",!n.showValues),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",n.canSelect),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",n.showValues),i.\u0275\u0275advance(),i.\u0275\u0275property("dataSource",n.dataSource)("treeControl",n.treeControl)("trackBy",n.trackBy),i.\u0275\u0275advance(2),i.\u0275\u0275property("matTreeNodeDefWhen",n.hasChild))},dependencies:[v.NgClass,v.NgIf,$.MatLegacyButton,G.MatIcon,Ae.MatTreeNodeDef,Ae.MatTreeNodePadding,Ae.MatTreeNodeToggle,Ae.MatTree,Ae.MatTreeNode,Ge.MatLegacyCheckbox,hr,m.TranslatePipe],styles:[".toggle[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{background:no-repeat top url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2Ij48ZGVmcz48c3R5bGU+LmEsLmJ7ZmlsbDpub25lO30uYntzdHJva2U6IzgwOTViMzt9PC9zdHlsZT48L2RlZnM+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCAxNikgcm90YXRlKC05MCkiPjxyZWN0IGNsYXNzPSJhIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiLz48cGF0aCBjbGFzcz0iYiIgZD0iTTYsMCwwLDZjLjAwOC0uMDA4LDYsNiw2LDYiIHRyYW5zZm9ybT0ibWF0cml4KDAuMDM1LCAtMC45OTksIDAuOTk5LCAwLjAzNSwgMS4zOTgsIDExLjI4OCkiLz48L2c+PC9zdmc+)}.toggle[_ngcontent-%COMP%]   .expanded[_ngcontent-%COMP%]{transform:rotate(90deg);background-position-y:4px;background-position-x:0}.content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{top:0;position:sticky;z-index:1000;padding-top:15px;padding-bottom:2px;display:flex}.content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .mat-icon-button[_ngcontent-%COMP%]{height:0;width:36px}.content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-left:1px}.content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   label.editable-label-item-margin[_ngcontent-%COMP%]{margin-left:9px;width:calc(50% + 20px)}.content[_ngcontent-%COMP%]   .editable-header-block[_ngcontent-%COMP%]{display:flex;width:100%}.content[_ngcontent-%COMP%]   .editable-label-item[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   .editable-label-header-item[_ngcontent-%COMP%]{flex-basis:100%}.content[_ngcontent-%COMP%]   .editable-label-item-margin[_ngcontent-%COMP%]{width:50%;margin-left:9px}.content[_ngcontent-%COMP%]   .checkbox-padding-left[_ngcontent-%COMP%]{padding-left:9px}.content[_ngcontent-%COMP%]   .editable-value-item[_ngcontent-%COMP%]{flex-basis:400px;flex-shrink:0}.content[_ngcontent-%COMP%]   .has-button[_ngcontent-%COMP%]{flex-basis:364px}.content[_ngcontent-%COMP%]   .delete-button[_ngcontent-%COMP%]{visibility:hidden}.content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]:hover   .delete-button[_ngcontent-%COMP%]{visibility:visible}.content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]{height:36px;min-height:36px}.content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:36px;height:36px}.content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{width:16px;line-height:16px}.content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]{padding-right:.6em}.content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]   .parameter[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]   .parameter-rtl[_ngcontent-%COMP%]{background-position-y:2px;background-repeat:no-repeat}.content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]   .parameter[_ngcontent-%COMP%]{padding-left:22px;background-position:left}.content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]   .parameter-rtl[_ngcontent-%COMP%]{padding-right:22px;background-position:right}.content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]   .tree-button[_ngcontent-%COMP%]{margin-left:auto;margin-right:1em}.content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]   .tree-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin:auto}.content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]   .trash-icon[_ngcontent-%COMP%]{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2Ij48ZGVmcz48c3R5bGU+LnRyYXNoX2F7ZmlsbDojNGU3YmQ4O30udHJhc2hfYntmaWxsOm5vbmU7fTwvc3R5bGU+PC9kZWZzPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIgMSkiPjxyZWN0IGNsYXNzPSJ0cmFzaF9hIiB3aWR0aD0iMSIgaGVpZ2h0PSI3IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzIDQpIi8+PHJlY3QgY2xhc3M9InRyYXNoX2EiIHdpZHRoPSIxIiBoZWlnaHQ9IjciIHRyYW5zZm9ybT0idHJhbnNsYXRlKDcgNCkiLz48cmVjdCBjbGFzcz0idHJhc2hfYSIgd2lkdGg9IjEiIGhlaWdodD0iNyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNSA0KSIvPjxwYXRoIGNsYXNzPSJ0cmFzaF9hIiBkPSJNMTAyNi0xNTNoLTN2LTJoLTV2MmgtM3YxaDF2OC45bDEuNDEsMS4xaDYuMTVsMS40NS0xLjFWLTE1MmgxWm0tNy0xaDN2MWgtM1ptNSwxMC40LS43OC42aC01LjQ3bC0uNzUtLjU5Vi0xNTJoN1oiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xMDE1IDE1NSkiLz48L2c+PHJlY3QgY2xhc3M9InRyYXNoX2IiIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIvPjwvc3ZnPg0K)}.content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]   .add-button-icon[_ngcontent-%COMP%]{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld2JveD0iMCAwIDE2IDE2Ij48ZGVmcy8+PGxpbmUgeTI9IjEzIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4LjUgMikiIHN0eWxlPSJmaWxsOiBub25lOyBzdHJva2U6ICM0ZTdiZDg7Ii8+PGxpbmUgeTI9IjEzIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNSA4LjUpIHJvdGF0ZSg5MCkiIHN0eWxlPSJmaWxsOiBub25lOyBzdHJva2U6ICM0ZTdiZDg7Ii8+PHJlY3Qgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiBzdHlsZT0iZmlsbDogbm9uZTsiLz48L3N2Zz4NCg==)}.content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]   .parameter.Text[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]   .parameter-rtl.Text[_ngcontent-%COMP%]{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMTYgMTYiIHdpZGh0PSIxNiIgaGVpZ2h0PSIxNiI+DQoJPHBhdGggZD0iTTEzLjEsMS40bDAuMSwzaC0wLjRjLTAuMS0wLjUtMC4yLTAuOS0wLjMtMS4xYy0wLjItMC40LTAuNC0wLjYtMC44LTAuOGMtMC4zLTAuMi0wLjctMC4zLTEuMy0wLjNIOC45djkuNmMwLDAuOCwwLjEsMS4zLDAuMywxLjRjMC4yLDAuMywwLjYsMC40LDEuMSwwLjRoMC40VjE0SDUuM3YtMC4zaDAuNGMwLjUsMCwwLjktMC4yLDEuMS0wLjVDNywxMyw3LjEsMTIuNSw3LjEsMTEuOFYyLjJINS42Yy0wLjYsMC0xLDAtMS4zLDAuMUM0LDIuNSwzLjcsMi43LDMuNSwzQzMuMywzLjMsMy4xLDMuOCwzLjEsNC40SDIuN2wwLjEtM0gxMy4xeiIgZmlsbD0iIzZjYjAzOSIvPg0KPC9zdmc+)}.content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]   .parameter.Collection[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]   .parameter-rtl.Collection[_ngcontent-%COMP%]{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMTYgMTYiIHdpZGh0PSIxNiIgaGVpZ2h0PSIxNiI+DQoJPHBhdGggZD0iTTQsMXYySDJ2MkgwdjExaDEydi0yaDJ2LTJoMlYxSDR6IE0xMSwxNUgxVjZoMTBWMTV6IE0xMywxM2gtMVY1SDNWNGgxMFYxM3ogTTE1LDExaC0xVjNINVYyaDEwVjExeiIgZmlsbD0iI2I2OTFjZSIvPg0KPC9zdmc+)}.content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]   .parameter.Object[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]   .parameter-rtl.Object[_ngcontent-%COMP%]{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMTYgMTYiIHdpZGh0PSIxNiIgaGVpZ2h0PSIxNiI+DQoJPHBhdGggZD0iTTQsMXYySDJ2MkgwdjExaDEydi0yaDJ2LTJoMlYxSDR6IE0xMSwxNUgxVjZoMTBWMTV6IE0xMywxM2gtMVY1SDNWNGgxMFYxM3ogTTE1LDExaC0xVjNINVYyaDEwVjExeiIgZmlsbD0iI2I2OTFjZSIvPg0KPC9zdmc+)}.content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]   .parameter.Integer[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]   .parameter-rtl.Integer[_ngcontent-%COMP%]{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMTYgMTYiIHdpZGh0PSIxNiIgaGVpZ2h0PSIxNiI+DQoJPGcgZmlsbD0iI2VlYWY0YiI+DQoJCTxwYXRoIGQ9Ik0xLjgsNS4yTDEuOCw1LjJMMC41LDUuOUwwLjIsNS4xTDIsNC4yaDAuOVYxMmgtMVY1LjJ6Ii8+DQoJCTxwYXRoIGQ9Ik00LjYsMTJ2LTAuNmwwLjgtMC44YzItMS45LDIuOS0yLjksMi45LTQuMWMwLTAuOC0wLjQtMS41LTEuNS0xLjVjLTAuNywwLTEuMywwLjQtMS43LDAuN0w0LjgsNC45QzUuMyw0LjQsNi4xLDQuMSw3LDQuMWMxLjcsMCwyLjQsMS4yLDIuNCwyLjNjMCwxLjQtMSwyLjYtMi43LDQuMmwtMC42LDAuNnYwaDMuNVYxMkg0LjZ6Ii8+DQoJCTxwYXRoIGQ9Ik0xMC43LDEwLjhjMC4zLDAuMiwxLDAuNSwxLjcsMC41YzEuNCwwLDEuOC0wLjksMS44LTEuNWMwLTEuMS0xLTEuNi0yLTEuNmgtMC42VjcuNGgwLjZjMC44LDAsMS43LTAuNCwxLjctMS4zYzAtMC42LTAuNC0xLjItMS40LTEuMmMtMC42LDAtMS4yLDAuMy0xLjYsMC41bC0wLjMtMC44YzAuNC0wLjMsMS4yLTAuNiwyLTAuNmMxLjUsMCwyLjIsMC45LDIuMiwxLjljMCwwLjgtMC41LDEuNS0xLjQsMS44djBjMSwwLjIsMS43LDAuOSwxLjcsMmMwLDEuMi0xLDIuMy0yLjgsMi4zYy0wLjksMC0xLjYtMC4zLTItMC41TDEwLjcsMTAuOHoiLz4NCgk8L2c+DQo8L3N2Zz4=)}.content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]   .parameter.Float[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]   .parameter-rtl.Float[_ngcontent-%COMP%]{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMTYgMTYiIHdpZGh0PSIxNiIgaGVpZ2h0PSIxNiI+DQoJPGcgZmlsbD0iI2VmN2U2MyI+PHBhdGggZD0iTTYuNiw3LjljMCwyLjktMS4xLDQuNS0yLjksNC41QzIsMTIuNCwwLjksMTAuOCwwLjksOGMwLTIuOCwxLjItNC40LDIuOS00LjRDNS42LDMuNiw2LjYsNS4yLDYuNiw3Ljl6IE0yLDhjMCwyLjIsMC43LDMuNCwxLjcsMy40YzEuMiwwLDEuNy0xLjQsMS43LTMuNWMwLTIuMS0wLjUtMy40LTEuNy0zLjRDMi43LDQuNSwyLDUuNywyLDh6Ii8+DQoJCTxwYXRoIGQ9Ik03LjMsMTEuNWMwLTAuNSwwLjMtMC44LDAuOC0wLjhzMC44LDAuMywwLjgsMC44YzAsMC41LTAuMywwLjgtMC44LDAuOEM3LjYsMTIuNCw3LjMsMTIsNy4zLDExLjV6Ii8+DQoJCTxwYXRoIGQ9Ik0xNSw0LjdoLTMuMmwtMC4zLDIuMmMwLjIsMCwwLjQtMC4xLDAuNy0wLjFjMC43LDAsMS4zLDAuMSwxLjgsMC41YzAuNywwLjQsMS4yLDEuMSwxLjIsMi4yYzAsMS43LTEuMywyLjktMy4xLDIuOWMtMC45LDAtMS43LTAuMy0yLjEtMC41bDAuMy0wLjljMC40LDAuMiwxLDAuNSwxLjgsMC41YzEuMSwwLDItMC43LDItMS44YzAtMS4xLTAuNy0xLjktMi40LTEuOWMtMC41LDAtMC45LDAuMS0xLjIsMC4xbDAuNS00LjFoNFY0Ljd6Ii8+DQoJPC9nPg0KPC9zdmc+)}.content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]   .parameter.Boolean[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]   .parameter-rtl.Boolean[_ngcontent-%COMP%]{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMTYgMTYiIHdpZGh0PSIxNiIgaGVpZ2h0PSIxNiI+DQoJPHBhdGggZD0iTTE0LDJ2MTJIMlYySDE0IE0xNSwxSDF2MTRoMTRWMUwxNSwxeiIgZmlsbD0iIzViYzhjNCIvPg0KCTxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzViYzhjNCIgc3Ryb2tlLXdpZHRoPSIxLjIiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgZD0iTSA1IDcuNSA3LjUgMTAuNSAxMS41IDQuNSIvPg0KPC9zdmc+)}.content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]   .parameter.DateTime[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]   .parameter-rtl.DateTime[_ngcontent-%COMP%]{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMTYgMTYiIHdpZGh0PSIxNiIgaGVpZ2h0PSIxNiI+DQoJPGcgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjOGU4ZWI3IiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiPg0KCQk8cGF0aCBkPSJNIDE0IDMuNSAxNS41IDMuNSAxNS41IDE1LjUgMS41IDE1LjUgMS41IDMuNSAzIDMuNSIvPg0KCQk8cGF0aCBkPSJNIDYsMy41IDExLDMuNSIvPg0KCQk8cGF0aCBkPSJNIDEsNy41IDE2LDcuNSIvPg0KCTwvZz4NCgk8ZyBmaWxsPSIjOGU4ZWI3Ij4NCgkJPHBhdGggZD0iTTUsMnYzSDRWMkg1IE02LDFIM3Y1aDNWMUw2LDF6Ii8+DQoJCTxwYXRoIGQ9Ik0xMywydjNoLTFWMkgxMyBNMTQsMWgtM3Y1aDNWMUwxNCwxeiIvPg0KCTwvZz4NCjwvc3ZnPg==)}.content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]   .parameter.Date[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]   .parameter-rtl.Date[_ngcontent-%COMP%]{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMTYgMTYiIHdpZGh0PSIxNiIgaGVpZ2h0PSIxNiI+DQoJPGcgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjOGU4ZWI3IiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiPg0KCQk8cGF0aCBkPSJNIDE0IDMuNSAxNS41IDMuNSAxNS41IDE1LjUgMS41IDE1LjUgMS41IDMuNSAzIDMuNSIvPg0KCQk8cGF0aCBkPSJNIDYsMy41IDExLDMuNSIvPg0KCQk8cGF0aCBkPSJNIDEsNy41IDE2LDcuNSIvPg0KCTwvZz4NCgk8ZyBmaWxsPSIjOGU4ZWI3Ij4NCgkJPHBhdGggZD0iTTUsMnYzSDRWMkg1IE02LDFIM3Y1aDNWMUw2LDF6Ii8+DQoJCTxwYXRoIGQ9Ik0xMywydjNoLTFWMkgxMyBNMTQsMWgtM3Y1aDNWMUwxNCwxeiIvPg0KCTwvZz4NCjwvc3ZnPg==)}.content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]   .parameter.Time[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]   .parameter-rtl.Time[_ngcontent-%COMP%]{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMTYgMTYiIHdpZGh0PSIxNiIgaGVpZ2h0PSIxNiI+DQoJPGcgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjOGU4ZWI3IiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiPg0KCQk8cGF0aCBkPSJNIDE0IDMuNSAxNS41IDMuNSAxNS41IDE1LjUgMS41IDE1LjUgMS41IDMuNSAzIDMuNSIvPg0KCQk8cGF0aCBkPSJNIDYsMy41IDExLDMuNSIvPg0KCQk8cGF0aCBkPSJNIDEsNy41IDE2LDcuNSIvPg0KCTwvZz4NCgk8ZyBmaWxsPSIjOGU4ZWI3Ij4NCgkJPHBhdGggZD0iTTUsMnYzSDRWMkg1IE02LDFIM3Y1aDNWMUw2LDF6Ii8+DQoJCTxwYXRoIGQ9Ik0xMywydjNoLTFWMkgxMyBNMTQsMWgtM3Y1aDNWMUwxNCwxeiIvPg0KCTwvZz4NCjwvc3ZnPg==)}.content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]   .parameter.Guid[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   mat-tree-node[_ngcontent-%COMP%]   .parameter-rtl.Guid[_ngcontent-%COMP%]{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMTYgMTYiIHdpZGh0PSIxNiIgaGVpZ2h0PSIxNiI+DQoJPGcgZmlsbD0iIzk3YmFkMiI+PHBhdGggZD0iTTUuMiwyLjJ2MS4zSDMuOXYxMC4xaDEuMnYxLjNIMS4ydi0xLjNoMS4yVjMuNEgxLjJWMi4ySDUuMnoiLz4NCgkJPHBhdGggZD0iTTE0LjcsMTQuOGgtMS40di0xLjVoMGMtMC43LDEuMi0xLjcsMS43LTMuMSwxLjdjLTEuMSwwLTItMC40LTIuNy0xLjJzLTEtMS45LTEtMy4zYzAtMS41LDAuNC0yLjcsMS4xLTMuNnMxLjctMS4zLDMtMS4zYzEuMiwwLDIuMSwwLjUsMi43LDEuNWgwVjEuNWgxLjRWMTQuOHogTTEzLjMsMTAuN1Y5LjRjMC0wLjctMC4yLTEuMy0wLjctMS44cy0xLjEtMC44LTEuOC0wLjhjLTAuOSwwLTEuNiwwLjMtMi4xLDFzLTAuOCwxLjUtMC44LDIuN2MwLDEsMC4yLDEuOSwwLjcsMi41czEuMSwwLjksMS45LDAuOWMwLjgsMCwxLjUtMC4zLDItMC45UzEzLjMsMTEuNiwxMy4zLDEwLjd6Ii8+DQoJPC9nPg0KPC9zdmc+)}"]})}}const Lm=["*"];class pr{constructor(e){this.translateService=e,this.listMode="multi",this.methodChecked=new i.EventEmitter,this.parameterChecked=new i.EventEmitter,this.dataSchema={columns:[{name:"caption",caption:this.translateService.instant("WizardMethodCaption"),valueType:E.r.Text,cellComponentClass:Ti}],rowCssClass:this.getRowCssClass.bind(this)}}get parameters(){return this.selectedMethod?.[this.parametersKey].parameters}get selectedMethod(){return this.methods?.find(e=>e.uId===this._selectedMethod?.uId)?this._selectedMethod:(this._selectedMethod=this.methods&&this.methods[0],this._selectedMethod)}set selectedMethod(e){this._selectedMethod=e}get eventHandlers(){return{caption:{selectMethod:this.onMethodSelected.bind(this)}}}get editParametersEnabled(){return!!this.selected?.find(e=>e.uId===this.selectedMethod?.uId)}get tableConfig(){return{selectMode:this.listMode,sortColumn:"caption"}}getRowCssClass(e){return e.uId===this.selectedMethod?.uId?"selected":""}onMethodSelected(e){this.listMode==="multi"&&(this.selectedMethod=this.methods.find(t=>t.uId===e.uId))}onMethodChecked(e){this.listMode==="multi"?this.methodChecked.next(e):this.selectedMethod=this.methods?.find(t=>t.uId===e?.[0].uId)}onParameterChecked(e){this.parameterChecked.next(e)}static{this.\u0275fac=function(t){return new(t||pr)(i.\u0275\u0275directiveInject(m.TranslateService))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:pr,selectors:[["ts-soap-service-request-builder"]],inputs:{methods:"methods",selected:"selected",selectedParameters:"selectedParameters",listMode:"listMode",parametersKey:"parametersKey",parametersCaption:"parametersCaption"},outputs:{methodChecked:"methodChecked",parameterChecked:"parameterChecked"},ngContentSelectors:Lm,decls:7,vars:11,consts:[["tsTable",""],[1,"soap-service-request-builder"],[1,"caption"],[1,"container"],[1,"panel","method-selector",3,"selectedChange","data","dataSchema","headerSticky","minWidthPerColumn","config","selected","eventHandlers"],[1,"panel","parameter-selector",3,"selectedChange","parameters","selectedParameters","caption","readonly"]],template:function(t,n){if(t&1){const s=i.\u0275\u0275getCurrentView();i.\u0275\u0275projectionDef(),i.\u0275\u0275elementStart(0,"div",1)(1,"div",2),i.\u0275\u0275projection(2),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(3,"div",3)(4,"ts-table",4,0),i.\u0275\u0275listener("selectedChange",function(o){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.onMethodChecked(o))}),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(6,"ts-parameters-tree",5),i.\u0275\u0275listener("selectedChange",function(o){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.onParameterChecked(o))}),i.\u0275\u0275elementEnd()()()}t&2&&(i.\u0275\u0275advance(4),i.\u0275\u0275property("data",n.methods)("dataSchema",n.dataSchema)("headerSticky",!0)("minWidthPerColumn",0)("config",n.tableConfig)("selected",n.selected)("eventHandlers",n.eventHandlers),i.\u0275\u0275advance(2),i.\u0275\u0275property("parameters",n.parameters)("selectedParameters",n.selectedParameters)("caption",n.parametersCaption)("readonly",!(n.editParametersEnabled||n.listMode==="single")))},dependencies:[im.O,Di],styles:[".soap-service-request-builder[_ngcontent-%COMP%]{flex-basis:100%;overflow:hidden;width:860px;display:flex;flex-direction:column;align-items:stretch;justify-content:flex-start}.soap-service-request-builder[_ngcontent-%COMP%]   .caption[_ngcontent-%COMP%]{flex-shrink:0}.soap-service-request-builder[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{flex-basis:100%;margin-top:10px;display:flex;flex-direction:row;align-items:stretch}.soap-service-request-builder[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]{flex-basis:50%;overflow-y:auto}.soap-service-request-builder[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .panel.parameter-selector[_ngcontent-%COMP%]{margin-left:10px}"]})}}var Qe=h(63035),Yt=h(283);function km(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"div")(1,"mat-option",5)(2,"div",6)(3,"div",7),i.\u0275\u0275text(4),i.\u0275\u0275elementEnd()()()()),r&2){const t=e.$implicit,n=i.\u0275\u0275nextContext();i.\u0275\u0275advance(),i.\u0275\u0275property("value",t.uId),i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate2(" ",t.portName," (",n.getSoapVersion(t.type),") ")}}class Ni{constructor(){this.serviceSelected=new i.EventEmitter}onServiceSelect(e){this.serviceSelected.next(e)}getSoapVersion(e){let t="";return e===oe.soap11&&(t="SOAP 1.1"),e===oe.soap12&&(t="SOAP 1.2"),t}static{this.\u0275fac=function(t){return new(t||Ni)}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:Ni,selectors:[["ts-soap-select-service"]],inputs:{services:"services",selectedServiceUId:"selectedServiceUId"},outputs:{serviceSelected:"serviceSelected"},decls:7,vars:5,consts:[[1,"soap-select-service"],[1,"caption"],["floatLabel","always",1,"service-select-field"],["mat-basic","","disableOptionCentering","","required","","data-item-marker","select_service",3,"valueChange","selectionChange","value"],[4,"ngFor","ngForOf"],[3,"value"],[1,"service-select-option"],[1,"col-service-name"]],template:function(t,n){t&1&&(i.\u0275\u0275elementStart(0,"div",0)(1,"div",1),i.\u0275\u0275text(2),i.\u0275\u0275pipe(3,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(4,"mat-form-field",2)(5,"mat-select",3),i.\u0275\u0275twoWayListener("valueChange",function(a){return i.\u0275\u0275twoWayBindingSet(n.selectedServiceUId,a)||(n.selectedServiceUId=a),a}),i.\u0275\u0275listener("selectionChange",function(a){return n.onServiceSelect(a)}),i.\u0275\u0275template(6,km,5,3,"div",4),i.\u0275\u0275elementEnd()()()),t&2&&(i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(3,3,"SelectSoapService")),i.\u0275\u0275advance(3),i.\u0275\u0275twoWayProperty("value",n.selectedServiceUId),i.\u0275\u0275advance(),i.\u0275\u0275property("ngForOf",n.services))},dependencies:[ee.MatLegacyFormField,v.NgForOf,Qe.MatLegacySelect,Yt.MatLegacyOption,m.TranslatePipe],styles:[".soap-select-service[_ngcontent-%COMP%]{margin-bottom:10px}.soap-select-service[_ngcontent-%COMP%]   .service-select-field[_ngcontent-%COMP%]{width:250px}.service-select-option[_ngcontent-%COMP%]{display:flex;line-height:19px;margin-top:5px;margin-bottom:5px}.service-select-option[_ngcontent-%COMP%]   .col-service-name[_ngcontent-%COMP%]{flex:1}"]})}}const jm=["wizardStepper"];function Fm(r,e){r&1&&i.\u0275\u0275element(0,"ts-mask",21)}function Bm(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"ts-soap-select-service",22),i.\u0275\u0275listener("serviceSelected",function(s){i.\u0275\u0275restoreView(t);const a=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(a.onServiceSelected(s))}),i.\u0275\u0275elementEnd()}if(r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275property("services",t.services)("selectedServiceUId",t.selectedService==null?null:t.selectedService.uId)}}var gn;(function(r){r.Success="Success",r.Error="Error",r.Skip="SkipQuickSetup",r.Close="Close"})(gn||(gn={}));class mr{get wizardCaption(){if(this.selectedService){const e=this.translateService.instant("SoapWizardServiceSelectedCaption"),t=this.selectedService.caption;return e.replace("##service-caption##",t.charAt(0).toUpperCase()+t.slice(1))}return this.translateService.instant("SoapWizardCaption")}constructor(e,t,n,s,a,o,c,d){this._dialogRef=e,this.featureService=t,this.translateService=n,this.changeDetector=s,this.builder=a,this.snackBar=o,this.downloadWsdl=c,this.googleTagManager=d,this.services=[],this.selectedRequestParameters=[],this.selectedResponseParameters=[],this.step=Pe.upload}_getGtmActionFromResultCode(e){return{[ke.Close]:gn.Close,[ke.Skip]:gn.Skip,[ke.Error]:gn.Error,[ke.Success]:gn.Success}[e]}_closeDialog(e,t=[]){const n=this._getGtmActionFromResultCode(e);this._sendGTMData(n);const s={services:t,resultCode:e};this._dialogRef.close(s)}_sortServices(e){return e.sort((t,n)=>t.type===n.type?t.portName.localeCompare(n.portName):n.type-t.type)}_flattenParameter(e){const t=[e];return e.itemProperties&&e.itemProperties.forEach(n=>{const s=this._flattenParameter(n);t.push(...s)}),t}_flattenParameters(e,t){const n=[];return e?.serviceMethods.forEach(s=>{s[t]?.parameters?.forEach(a=>{n.push(...this._flattenParameter(a))})}),n}_getWsdlParseErrorText(e){if(!e)return this.translateService.instant("WsdlParsingError");switch(e.errorCode){case"SchemaDocumentFileNotFoundError":return this.translateService.instant(e.errorCode).replace(/{\d}/,e.fileName);case"DownloadXmlSchemaError":return e.message;default:return this.translateService.instant("WsdlParsingError")}}_showErrorMessage(e){this._sendGTMData(gn.Error);const t=this._getWsdlParseErrorText(e);this.snackBar.open(t,"",{duration:5e3})}_getGTMModuleName(){return this.wizardStepper.selectedIndex===0?"QuickSetupStartPage":"QuickSetupMethodSelection"}_sendGTMData(e){const t={action:e,moduleName:this._getGTMModuleName(),schemaName:"WebServiceSetup"};this.googleTagManager.track(t)}onKeyUp(){this._closeDialog(ke.Close)}onSkipQuickSetupClick(){this._closeDialog(ke.Skip)}onCloseQuickSetupClick(){this._closeDialog(ke.Close)}onWsdlFilesSelected(e){this.builder.build(e).subscribe({next:t=>this.onServiceParsed(t),error:t=>this._showErrorMessage(t)})}onWsdlUrlChanged(e){this._wsdlUrl=e}onStepChange(e){e.selectedIndex===0&&(this.selectedService=null,this.services=null,this.changeDetector.detectChanges())}getSelectedParameters(e,t){return[...e.filter(n=>{const s=t.find(a=>a.uId===n.uId);return s&&n?.itemProperties?.length>0&&(n.itemProperties=[...this.getSelectedParameters(n.itemProperties,t)]),!!s})]}onSaveService(){const e={...this.selectedService};e.serviceMethods=[...e.serviceMethods.filter(t=>this.selectedMethods.includes(t))],e.serviceMethods.forEach(t=>{t.request.parameters=this.getSelectedParameters(t.request?.parameters,this.selectedRequestParameters),t.response.parameters=this.getSelectedParameters(t.response?.parameters,this.selectedResponseParameters)}),this._closeDialog(ke.Success,[e])}onParseWsdlByLink(){this.isLoading=!0,this.downloadWsdl.download([this._wsdlUrl]).subscribe({next:e=>{this.isLoading=!1,this.onWsdlFilesSelected(e)},error:e=>{this.isLoading=!1,this._showErrorMessage(e)}})}onServiceParsed(e){this.featureService.getFeatureState("NotUseWsdlWizardSteps").subscribe(t=>{if(t)this._closeDialog(ke.Success,e);else{const n=e.filter(s=>s.type!==oe.undefined);this.services=this._sortServices(n),this.selectedService=this.services[0],this.selectedMethods=[...this.selectedService.serviceMethods],this.selectedRequestParameters=this._flattenParameters(this.selectedService,"request"),this.selectedResponseParameters=this._flattenParameters(this.selectedService,"response"),this._sendGTMData(gn.Success),this.wizardStepper.next()}})}onServiceSelected(e){this.selectedService=this.services.find(t=>t.uId===e.value),this.selectedMethods=[...this.selectedService.serviceMethods],this.changeDetector.detectChanges(),this.selectedMethods=[...this.selectedService.serviceMethods],this.selectedRequestParameters=this._flattenParameters(this.selectedService,"request"),this.selectedResponseParameters=this._flattenParameters(this.selectedService,"response")}onMethodChecked(e){this.selectedMethods=[...e]}onParameterChecked(e){this.selectedRequestParameters=[...e]}onResponseParameterChecked(e){this.selectedResponseParameters=[...e]}ngOnInit(){this.googleTagManager.initialize()}static{this.\u0275fac=function(t){return new(t||mr)(i.\u0275\u0275directiveInject(N.MatLegacyDialogRef),i.\u0275\u0275directiveInject(at),i.\u0275\u0275directiveInject(m.TranslateService),i.\u0275\u0275directiveInject(i.ChangeDetectorRef),i.\u0275\u0275directiveInject(_e),i.\u0275\u0275directiveInject(b.MatLegacySnackBar),i.\u0275\u0275directiveInject(j),i.\u0275\u0275directiveInject(bt))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:mr,selectors:[["ts-web-service-wizard"]],viewQuery:function(t,n){if(t&1&&i.\u0275\u0275viewQuery(jm,5),t&2){let s;i.\u0275\u0275queryRefresh(s=i.\u0275\u0275loadQuery())&&(n.wizardStepper=s.first)}},hostBindings:function(t,n){t&1&&i.\u0275\u0275listener("keyup.esc",function(){return n.onKeyUp()},!1,i.\u0275\u0275resolveWindow)},decls:48,vars:44,consts:[["wizardStepper",""],["wsdlUpload",""],["class","component-mask",4,"ngIf"],[1,"web-service-wizard"],["mat-dialog-title",""],["mat-icon-button","",1,"close-dialog",3,"click"],["alt","close","src","data:image/svg+xml;base64,PHN2ZyBpZD0iR3JvdXBfNyIgZGF0YS1uYW1lPSJHcm91cCA3IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2IiBmaXQ9IiIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQgbWVldCIgZm9jdXNhYmxlPSJmYWxzZSI+DQogIDxyZWN0IGlkPSJSZWN0YW5nbGVfNyIgZGF0YS1uYW1lPSJSZWN0YW5nbGUgNyIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiBmaWxsPSJub25lIj48L3JlY3Q+DQogIDxsaW5lIGlkPSJMaW5lXzUiIGRhdGEtbmFtZT0iTGluZSA1IiB5MT0iMTAiIHgyPSIxMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMyAzKSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjOTk5IiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHN0cm9rZS13aWR0aD0iMSI+PC9saW5lPg0KICA8bGluZSBpZD0iTGluZV82IiBkYXRhLW5hbWU9IkxpbmUgNiIgeDI9IjEwIiB5Mj0iMTAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDMgMykiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzk5OSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBzdHJva2Utd2lkdGg9IjEiPjwvbGluZT4NCjwvc3ZnPg=="],[3,"selectionChange"],[1,"soap-service-wizard-step-content","step-0"],[1,"upload-wsdl",3,"filesSelected","urlChanged"],["mat-dialog-actions","",1,"actions"],["mat-button","",1,"continue-without-setup",3,"click"],["mat-flat-button","","color","accent",1,"next","step-one-next-button",3,"click","disabled"],[1,"soap-service-wizard-step-content","step-1"],["class","select-service",3,"services","selectedServiceUId","serviceSelected",4,"ngIf"],[1,"request-builder",3,"methodChecked","parameterChecked","methods","selected","selectedParameters","parametersKey","parametersCaption"],["mat-button","","matStepperPrevious",""],["mat-flat-button","","color","accent","matStepperNext",""],[1,"soap-service-wizard-step-content","step-2"],[1,"response-builder",3,"parameterChecked","methods","selectedParameters","listMode","parametersKey","parametersCaption"],["mat-flat-button","","color","accent",3,"click"],[1,"component-mask"],[1,"select-service",3,"serviceSelected","services","selectedServiceUId"]],template:function(t,n){if(t&1){const s=i.\u0275\u0275getCurrentView();i.\u0275\u0275template(0,Fm,1,0,"ts-mask",2),i.\u0275\u0275elementStart(1,"div",3)(2,"div",4)(3,"span"),i.\u0275\u0275text(4),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(5,"button",5),i.\u0275\u0275listener("click",function(){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.onCloseQuickSetupClick())}),i.\u0275\u0275element(6,"img",6),i.\u0275\u0275elementEnd()(),i.\u0275\u0275elementStart(7,"mat-horizontal-stepper",7,0),i.\u0275\u0275listener("selectionChange",function(o){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.onStepChange(o))}),i.\u0275\u0275elementStart(9,"mat-step")(10,"div",8)(11,"ts-wsdl-upload",9,1),i.\u0275\u0275listener("filesSelected",function(o){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.onWsdlFilesSelected(o))})("urlChanged",function(o){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.onWsdlUrlChanged(o))}),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(13,"div",10)(14,"button",11),i.\u0275\u0275listener("click",function(){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.onSkipQuickSetupClick())}),i.\u0275\u0275text(15),i.\u0275\u0275pipe(16,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(17,"button",12),i.\u0275\u0275pipe(18,"async"),i.\u0275\u0275listener("click",function(){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.onParseWsdlByLink())}),i.\u0275\u0275text(19),i.\u0275\u0275pipe(20,"translate"),i.\u0275\u0275elementEnd()()()(),i.\u0275\u0275elementStart(21,"mat-step")(22,"div",13),i.\u0275\u0275template(23,Bm,1,2,"ts-soap-select-service",14),i.\u0275\u0275elementStart(24,"ts-soap-service-request-builder",15),i.\u0275\u0275pipe(25,"translate"),i.\u0275\u0275listener("methodChecked",function(o){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.onMethodChecked(o))})("parameterChecked",function(o){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.onParameterChecked(o))}),i.\u0275\u0275text(26),i.\u0275\u0275pipe(27,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(28,"div",10)(29,"button",16),i.\u0275\u0275text(30),i.\u0275\u0275pipe(31,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(32,"button",17),i.\u0275\u0275text(33),i.\u0275\u0275pipe(34,"translate"),i.\u0275\u0275elementEnd()()()(),i.\u0275\u0275elementStart(35,"mat-step")(36,"div",18)(37,"ts-soap-service-request-builder",19),i.\u0275\u0275pipe(38,"translate"),i.\u0275\u0275listener("parameterChecked",function(o){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.onResponseParameterChecked(o))}),i.\u0275\u0275text(39),i.\u0275\u0275pipe(40,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(41,"div",10)(42,"button",16),i.\u0275\u0275text(43),i.\u0275\u0275pipe(44,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(45,"button",20),i.\u0275\u0275listener("click",function(){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.onSaveService())}),i.\u0275\u0275text(46),i.\u0275\u0275pipe(47,"translate"),i.\u0275\u0275elementEnd()()()()()()}if(t&2){const s=i.\u0275\u0275reference(12);i.\u0275\u0275property("ngIf",n.isLoading),i.\u0275\u0275advance(4),i.\u0275\u0275textInterpolate(n.wizardCaption),i.\u0275\u0275advance(11),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(16,22,"SkipWizardButtonCaption")),i.\u0275\u0275advance(2),i.\u0275\u0275property("disabled",!i.\u0275\u0275pipeBind1(18,24,s.urlChanged)),i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(20,26,"WizardNext")),i.\u0275\u0275advance(4),i.\u0275\u0275property("ngIf",(n.services==null?null:n.services.length)>1),i.\u0275\u0275advance(),i.\u0275\u0275property("methods",n.selectedService==null?null:n.selectedService.serviceMethods)("selected",n.selectedMethods)("selectedParameters",n.selectedRequestParameters)("parametersKey","request")("parametersCaption",i.\u0275\u0275pipeBind1(25,28,"WizardRequestParametersCaption")),i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate1(" ",i.\u0275\u0275pipeBind1(27,30,"WizardActionCaption")," "),i.\u0275\u0275advance(4),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(31,32,"WizardBack")),i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(34,34,"WizardNext")),i.\u0275\u0275advance(4),i.\u0275\u0275property("methods",n.selectedMethods)("selectedParameters",n.selectedResponseParameters)("listMode","single")("parametersKey","response")("parametersCaption",i.\u0275\u0275pipeBind1(38,36,"WizardResponseParametersCaption")),i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate1(" ",i.\u0275\u0275pipeBind1(40,38,"WizardResponseActionCaption")," "),i.\u0275\u0275advance(4),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(44,40,"WizardBack")),i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(47,42,"WizardSave"))}},dependencies:[v.NgIf,$.MatLegacyButton,N.MatLegacyDialogTitle,N.MatLegacyDialogActions,K.MatStep,K.MatStepper,K.MatStepperNext,K.MatStepperPrevious,Ke,ur,pr,Ni,v.AsyncPipe,m.TranslatePipe],styles:[".web-service-wizard[_ngcontent-%COMP%]{margin-top:-8px;min-width:500px;max-height:80vh;display:flex;flex-direction:column}.web-service-wizard[_ngcontent-%COMP%]   [mat-dialog-actions][_ngcontent-%COMP%]{flex-shrink:0;display:flex;flex-direction:row;justify-content:flex-end;margin-bottom:0;margin-top:16px}.web-service-wizard[_ngcontent-%COMP%]   .mat-dialog-title[_ngcontent-%COMP%]{flex-shrink:0;margin-bottom:10px}.web-service-wizard[_ngcontent-%COMP%]   .soap-service-wizard-step-content[_ngcontent-%COMP%]{overflow:hidden;flex-basis:100%;display:flex;flex-direction:column;align-items:stretch;justify-content:flex-start}.web-service-wizard[_ngcontent-%COMP%]   .soap-service-wizard-step-content[_ngcontent-%COMP%]   .upload-wsdl[_ngcontent-%COMP%]{flex-basis:100%}.web-service-wizard[_ngcontent-%COMP%]   .soap-service-wizard-step-content[_ngcontent-%COMP%]   .select-service[_ngcontent-%COMP%]{flex-shrink:0}.web-service-wizard[_ngcontent-%COMP%]   .soap-service-wizard-step-content[_ngcontent-%COMP%]   .request-builder[_ngcontent-%COMP%], .web-service-wizard[_ngcontent-%COMP%]   .soap-service-wizard-step-content[_ngcontent-%COMP%]   .response-builder[_ngcontent-%COMP%]{flex-basis:100%;overflow:hidden;display:flex;flex-direction:column}"]})}}var Kt=h(29957),Pi;(function(r){r[r.Primary=0]="Primary",r[r.Secondary=1]="Secondary",r[r.Cancel=2]="Cancel",r[r.Delete=3]="Delete"})(Pi||(Pi={}));const ic={caption:"ConfirmationDialog.YES",result:Pi.Secondary},Um={caption:"ConfirmationDialog.NO",result:Pi.Primary},bS={caption:"ConfirmationDialog.CANCEL",result:Pi.Cancel},SS={caption:"ConfirmationDialog.DELETE",result:Pi.Delete};function zm(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"button",6),i.\u0275\u0275text(1),i.\u0275\u0275pipe(2,"translate"),i.\u0275\u0275elementEnd()),r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275property("mat-dialog-close",t.secondaryButton.result),i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate1(" ",i.\u0275\u0275pipeBind1(2,2,t.secondaryButton.caption)," ")}}function Hm(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"button",6),i.\u0275\u0275text(1),i.\u0275\u0275pipe(2,"translate"),i.\u0275\u0275elementEnd()),r&2){const t=e.$implicit;i.\u0275\u0275property("mat-dialog-close",t.result),i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate1(" ",i.\u0275\u0275pipeBind1(2,2,t.caption)," ")}}class Ri{constructor(e){this.data=e,this.buttons=[],e&&(this.primaryButton=e.primaryButton,this.secondaryButton=e.secondaryButton,this.message=e.message,this.buttons=e.buttons),this.buttons?.length||(this.primaryButton??=Um,this.secondaryButton??=ic)}static{this.\u0275fac=function(t){return new(t||Ri)(i.\u0275\u0275directiveInject(N.MAT_LEGACY_DIALOG_DATA))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:Ri,selectors:[["ts-confirmation-dialog"]],decls:9,vars:7,consts:[["mat-dialog-content",""],[1,"message"],["mat-dialog-actions",""],["mat-flat-button","","color","primary","cdkFocusInitial","",1,"action-button",3,"mat-dialog-close"],["class","action-button","mat-button","",3,"mat-dialog-close",4,"ngIf"],["class","action-button","mat-button","",3,"mat-dialog-close",4,"ngFor","ngForOf"],["mat-button","",1,"action-button",3,"mat-dialog-close"]],template:function(t,n){t&1&&(i.\u0275\u0275elementStart(0,"div",0)(1,"span",1),i.\u0275\u0275text(2),i.\u0275\u0275elementEnd()(),i.\u0275\u0275elementStart(3,"div",2)(4,"button",3),i.\u0275\u0275text(5),i.\u0275\u0275pipe(6,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275template(7,zm,3,4,"button",4)(8,Hm,3,4,"button",5),i.\u0275\u0275elementEnd()),t&2&&(i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(n.data==null?null:n.data.message),i.\u0275\u0275advance(2),i.\u0275\u0275property("mat-dialog-close",n.primaryButton.result),i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate1(" ",i.\u0275\u0275pipeBind1(6,5,n.primaryButton.caption)," "),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",n.secondaryButton),i.\u0275\u0275advance(),i.\u0275\u0275property("ngForOf",n.buttons))},dependencies:[v.NgForOf,v.NgIf,$.MatLegacyButton,N.MatLegacyDialogClose,N.MatLegacyDialogContent,N.MatLegacyDialogActions,m.TranslatePipe],styles:["[mat-dialog-content][_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{white-space:pre-line;word-break:break-word}[mat-dialog-actions][_ngcontent-%COMP%]{margin:27px 0 0!important;justify-content:flex-end}"]})}}class Oi{constructor(e){this.data=e}static{this.\u0275fac=function(t){return new(t||Oi)(i.\u0275\u0275directiveInject(N.MAT_LEGACY_DIALOG_DATA))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:Oi,selectors:[["ts-error-dialog"]],decls:7,vars:4,consts:[["mat-dialog-content",""],[1,"message"],["mat-dialog-actions",""],["type","button","mat-flat-button","","color","warn","cdkFocusInitial","",1,"action-button",3,"mat-dialog-close"]],template:function(t,n){t&1&&(i.\u0275\u0275elementStart(0,"div",0)(1,"span",1),i.\u0275\u0275text(2),i.\u0275\u0275elementEnd()(),i.\u0275\u0275elementStart(3,"div",2)(4,"button",3),i.\u0275\u0275text(5),i.\u0275\u0275pipe(6,"translate"),i.\u0275\u0275elementEnd()()),t&2&&(i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(n.data==null?null:n.data.message),i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate1(" ",i.\u0275\u0275pipeBind1(6,2,"InfoDialog.OK")," "))},dependencies:[$.MatLegacyButton,N.MatLegacyDialogClose,N.MatLegacyDialogContent,N.MatLegacyDialogActions,m.TranslatePipe],styles:["[mat-dialog-content][_ngcontent-%COMP%]{max-height:450px;overflow-y:auto!important}[mat-dialog-content][_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{white-space:pre-line;word-break:break-word}[mat-dialog-actions][_ngcontent-%COMP%]{justify-content:right;margin:27px 0 0!important}"]})}}class Vi{constructor(e){this.data=e}static{this.\u0275fac=function(t){return new(t||Vi)(i.\u0275\u0275directiveInject(N.MAT_LEGACY_DIALOG_DATA))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:Vi,selectors:[["ts-info-dialog"]],decls:7,vars:4,consts:[["mat-dialog-content",""],[1,"message"],["mat-dialog-actions",""],["type","button","mat-flat-button","","color","primary","cdkFocusInitial","",1,"action-button",3,"mat-dialog-close"]],template:function(t,n){t&1&&(i.\u0275\u0275elementStart(0,"div",0)(1,"span",1),i.\u0275\u0275text(2),i.\u0275\u0275elementEnd()(),i.\u0275\u0275elementStart(3,"div",2)(4,"button",3),i.\u0275\u0275text(5),i.\u0275\u0275pipe(6,"translate"),i.\u0275\u0275elementEnd()()),t&2&&(i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(n.data==null?null:n.data.message),i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate1(" ",i.\u0275\u0275pipeBind1(6,2,"InfoDialog.OK")," "))},dependencies:[$.MatLegacyButton,N.MatLegacyDialogClose,N.MatLegacyDialogContent,N.MatLegacyDialogActions,m.TranslatePipe],styles:["[mat-dialog-content][_ngcontent-%COMP%]{max-height:450px;overflow-y:auto!important}[mat-dialog-content][_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{white-space:pre-line;word-break:break-word}[mat-dialog-actions][_ngcontent-%COMP%]{justify-content:right;margin:27px 0 0!important}"]})}}class lt{constructor(e,t,n,s){this.document=e,this._ngZone=t,this._translateService=n,this.dialog=s}_stopEventPropagation(e,t){e.afterOpened().pipe((0,l.takeUntil)(t)).subscribe(n=>{const a=this.document.getElementsByClassName("cdk-overlay-container")[0];a&&a.addEventListener("click",function(o){o.stopImmediatePropagation()})})}getMessageDialogConfig(e){const t={width:"450px",panelClass:["dialog-top-border"],data:{}};if(typeof e=="string")return t.data.message=e,t;e.panelClass&&e.panelClass.length&&t.panelClass.push(...e.panelClass);const n=e;return n.primaryButton&&(t.data.primaryButton=n.primaryButton),n.secondaryButton&&(t.data.secondaryButton=n.secondaryButton),n.buttons&&(t.data.buttons=n.buttons),t.data.message=n.message,t}open(e,t){return this._ngZone.run(()=>{const n=this.dialog.open(e,t),s=n.afterClosed();return this._stopEventPropagation(n,s),s})}openInfoDialog(e){return this.open(Vi,this.getMessageDialogConfig(e))}openErrorDialog(e){return this.open(Oi,this.getMessageDialogConfig(e))}openConfirmationDialog(e){return this.open(Ri,this.getMessageDialogConfig(e))}openOperationPermissionsErrorDialog(e){const t=Kt.String.format(this._translateService.instant("OperationPermissionsErrorDialog.ErrorTemplate"),e);return this.openInfoDialog(t)}closeById(e){this.dialog.getDialogById(e)?.close()}closeAll(){this.dialog.closeAll()}hasOpenDialogs(){return!!this.dialog.openDialogs?.length}getOpenDialogs(){return this.dialog.openDialogs}static{this.\u0275fac=function(t){return new(t||lt)(i.\u0275\u0275inject(v.DOCUMENT),i.\u0275\u0275inject(i.NgZone),i.\u0275\u0275inject(m.TranslateService),i.\u0275\u0275inject(N.MatLegacyDialog))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:lt,factory:lt.\u0275fac})}}class kn{constructor(e){this._dialogService=e,this._destroyed$=new u.Subject}showWizard(){return this._dialogService.open(mr,{disableClose:!0,panelClass:"dialog-top-border"})}ngOnDestroy(){this._destroyed$.next()}static{this.\u0275fac=function(t){return new(t||kn)(i.\u0275\u0275inject(lt))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:kn,factory:kn.\u0275fac})}}var Po=h(50304);const Wm="OpenAuthenticationPage",$m="OpenWebServiceWizard",Gm="WebServicesCreated",Zm="OpenServiceClient";class gr{get caption(){return this.schema.caption}get dataValueTypeName(){return this.schema.dataValueTypeName}get uId(){return this.instanceUId}get isRequired(){return this.schema.isRequired}get isArray(){return this.schema.isArray}constructor(e,t=""){this.schema=e,this.value=hn.parseValue(e,t),this.instanceUId=(0,le.qv)()}}class fr{constructor(e){this.httpClient=e,this.callServiceSchemaEndpointUrl="/rest/CallServiceSchemaService/",this.callServiceSchemaMethodName="Execute"}sendRequest(e,t,n){const s=`${this.callServiceSchemaEndpointUrl}${this.callServiceSchemaMethodName}`;return this.httpClient.post(s,{serviceName:e,methodName:t,parameters:n||[]}).pipe((0,l.map)(a=>a.ExecuteResult))}static{this.\u0275fac=function(t){return new(t||fr)(i.\u0275\u0275inject(P.HttpClient))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:fr,factory:fr.\u0275fac,providedIn:"root"})}}var Nt=h(88763),Ym=h(32483),_r=h(67102),ct=h(39371);class Li{constructor(){this.showDelay=100,this.hideDelay=100,this.infoTooltipClass="",this.icon="info-tooltip",this.tooltipPosition="above"}static{this.\u0275fac=function(t){return new(t||Li)}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:Li,selectors:[["ts-info-tooltip-icon"]],inputs:{message:"message",showDelay:"showDelay",hideDelay:"hideDelay",infoTooltipClass:"infoTooltipClass",icon:"icon",tooltipPosition:"tooltipPosition"},decls:1,vars:6,consts:[[3,"svgIcon","matTooltip","matTooltipClass","matTooltipShowDelay","matTooltipHideDelay","matTooltipPosition"]],template:function(t,n){t&1&&i.\u0275\u0275element(0,"mat-icon",0),t&2&&i.\u0275\u0275property("svgIcon",n.icon)("matTooltip",n.message)("matTooltipClass",n.infoTooltipClass)("matTooltipShowDelay",n.showDelay)("matTooltipHideDelay",n.hideDelay)("matTooltipPosition",n.tooltipPosition)},dependencies:[G.MatIcon,ct.MatTooltip],styles:["[_nghost-%COMP%]{height:22px;width:22px}mat-icon[_ngcontent-%COMP%]{color:#22ac14;width:22px;height:22px;cursor:pointer}"]})}}const Km=["codemirrorContainer"];function qm(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"div",3),i.\u0275\u0275element(1,"ts-info-tooltip-icon",4),i.\u0275\u0275elementEnd()),r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275advance(),i.\u0275\u0275property("message",t.tooltipMessage)}}class jn{get _languageOptions(){return this.languagesOptions.get(this.language)}get code(){return this._code}set codemirrorContainer(e){this._renderCodemirrorComponent(e)}set text(e){if(e===this._innerCode)return;const t=this._normalizeToEOL(e);this._code=t,this._innerCode=t,this._applyCodemirrorProperty("value",t)}set lineSeparator(e){e!==this._lineSeparator&&(this._lineSeparator=e,this._applyCodemirrorProperty("lineSeparator",e))}get lineSeparator(){return this._lineSeparator}set language(e){this._language=e,this._applyCodemirrorProperty("language",e),this._applyCodemirrorProperty("languageOptions",this._languageOptions)}get language(){return this._language}set readOnly(e){this._readOnly=e,this._applyCodemirrorProperty("readOnly",e)}get readOnly(){return this._readOnly}get tooltipMessage(){return this._tooltipKeys.map(e=>this._translateService.instant(e)).join(`\r
`)}constructor(e,t,n,s){this._translateService=e,this._changeDetector=t,this._featureValues=n,this._destroyRef=s,this._readOnly=!1,this._lineSeparator=_r.C.CRLF,this._keyBinding=[{key:"F11",run:function(){return this.toggleFullScreenMode(),!0}.bind(this)},{key:"Escape",run:function(){return this.escapeFullScreenMode(),!0}.bind(this)}],this._tooltipKeys=["CodeMirror.HotkeysDescription","CodeMirror.SelectAll","CodeMirror.Undo","CodeMirror.Redo","CodeMirror.Find","CodeMirror.FindNext","CodeMirror.FindPrev","CodeMirror.Replace","CodeMirror.ReplaceAll","CodeMirror.DeleteLine","CodeMirror.GoLineStart","CodeMirror.GoLineEnd","CodeMirror.JmpToLine","CodeMirror.Fullscreen","CodeMirror.FullscreenExit","CodeMirror.Autocomplete"],this._defaultIndentUnitValue="	",this._eolNormalizationTemplate=new RegExp(`${_r.C.CRLF}|${_r.C.CR}|${_r.C.LF}`,"g"),this.isFullScreen=!1,this.diagnostics=[],this.hideTooltip=!1,this.languagesOptions=new Map([[Po.F.Javascript,{parserOptions:{ecmaVersion:2020},rules:{semi:["warn"]}}]]),this.textChange=new i.EventEmitter}get useNormalizeEndLine(){return!this._featureValues.DisableNormalizeEndLineInCodeMirror}get useNormalizeEndLineInPasteOperation(){return!this._featureValues.DisableNormalizeEndOfLineInPasteOperationInCodeMirror}_applyCodemirrorProperty(e,t){this._codemirrorComponent&&(this._codemirrorComponent[e]=t)}_renderCodemirrorComponent(e){h.e(877).then(h.bind(h,20877)).then(t=>{const n=t.CodemirrorComponent;this._codemirrorComponent=e.createComponent(n).instance,this._codemirrorComponent.value=this._code,this._codemirrorComponent.registerOnChange(this.onTextChange.bind(this)),this._codemirrorComponent.language=this._language,this._codemirrorComponent.languageOptions=this._languageOptions,this._codemirrorComponent.readOnly=this._readOnly,this._codemirrorComponent.keyBinding=this._keyBinding,this.useNormalizeEndLine&&(this._codemirrorComponent.lineSeparator=this._lineSeparator),this._codemirrorComponent.indentUnitValue=this._defaultIndentUnitValue,this.useNormalizeEndLineInPasteOperation&&this._codemirrorComponent.registerOnPaste(this.handleTextPasted.bind(this)),this._codemirrorComponent.diagnostics.pipe((0,Ym.takeUntilDestroyed)(this._destroyRef)).subscribe(s=>{this.diagnostics=s}),this._changeDetector.detectChanges()})}_normalizeToEOL(e){return this.useNormalizeEndLine?e.replace(this._eolNormalizationTemplate,this._lineSeparator):e}_normalizeToInternalCodeMirrorEOL(e){return e.replace(this._eolNormalizationTemplate,_r.C.LF)}_getSelectionRange(){const t=this._codemirrorComponent._editorView.state.selection.main,n=t?t.from:this._codemirrorComponent.value.length,s=t?t.to:n;return{selectionStart:n,selectionEnd:s}}escapeFullScreenMode(){this.isFullScreen&&this.toggleFullScreenMode()}handleTextPasted(e){if(!this.useNormalizeEndLineInPasteOperation)return;e.preventDefault();const t=e.clipboardData?.getData("text")||"",n=this._normalizeToEOL(t),{selectionStart:s,selectionEnd:a}=this._getSelectionRange(),o=s+this._normalizeToInternalCodeMirrorEOL(t).length;this._codemirrorComponent._editorView.dispatch({changes:{from:s,to:a,insert:n},selection:{anchor:o},userEvent:"input.paste"})}toggleFullScreenMode(){this.isFullScreen=!this.isFullScreen,this._changeDetector.detectChanges()}onTextChange(e){const t=this._normalizeToEOL(e);t!==this._innerCode&&(this._innerCode=t,this.textChange.emit(t))}static{this.\u0275fac=function(t){return new(t||jn)(i.\u0275\u0275directiveInject(m.TranslateService),i.\u0275\u0275directiveInject(i.ChangeDetectorRef),i.\u0275\u0275directiveInject(fe),i.\u0275\u0275directiveInject(i.DestroyRef))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:jn,selectors:[["ts-code-editor"]],viewQuery:function(t,n){if(t&1&&i.\u0275\u0275viewQuery(Km,5,i.ViewContainerRef),t&2){let s;i.\u0275\u0275queryRefresh(s=i.\u0275\u0275loadQuery())&&(n.codemirrorContainer=s.first)}},inputs:{hideTooltip:"hideTooltip",text:"text",lineSeparator:"lineSeparator",language:"language",readOnly:"readOnly",languagesOptions:"languagesOptions"},outputs:{textChange:"textChange"},decls:4,vars:2,consts:[["codemirrorContainer",""],["class","CodeMirror-hotkeys-tooltip-infoButton",4,"ngIf"],[3,"className"],[1,"CodeMirror-hotkeys-tooltip-infoButton"],[1,"field-tooltip",3,"message"]],template:function(t,n){t&1&&(i.\u0275\u0275template(0,qm,2,1,"div",1),i.\u0275\u0275elementStart(1,"div",2),i.\u0275\u0275elementContainer(2,null,0),i.\u0275\u0275elementEnd()),t&2&&(i.\u0275\u0275property("ngIf",!n.hideTooltip),i.\u0275\u0275advance(),i.\u0275\u0275property("className",n.isFullScreen?"CodeMirror-Wrapper-Full-Screen":"CodeMirror-Wrapper"))},dependencies:[v.NgIf,Li],styles:[`.CodeMirror-hotkeys-tooltip-infoButton{display:flex;justify-content:flex-end;position:sticky;top:0;margin-top:-22px;transform:translate(-10px,10px);pointer-events:none;z-index:99}.CodeMirror-hotkeys-tooltip-infoButton .field-tooltip{pointer-events:auto}
`],encapsulation:2})}}const Jm=[[["",8,"left-caption"]],[["",8,"right-caption"]]],Qm=[".left-caption",".right-caption"];class yr{static{this.\u0275fac=function(t){return new(t||yr)}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:yr,selectors:[["ts-double-side-panel"]],inputs:{request:"request",response:"response",language:"language"},ngContentSelectors:Qm,decls:11,vars:8,consts:[[1,"double-side-panel"],["data-item-marker","request-panel",1,"panel","panel-left"],[1,"header"],[1,"body"],[3,"language","text","readOnly","hideTooltip"],["data-item-marker","response-panel",1,"panel"]],template:function(t,n){t&1&&(i.\u0275\u0275projectionDef(Jm),i.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"div",2),i.\u0275\u0275projection(3),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(4,"div",3),i.\u0275\u0275element(5,"ts-code-editor",4),i.\u0275\u0275elementEnd()(),i.\u0275\u0275elementStart(6,"div",5)(7,"div",2),i.\u0275\u0275projection(8,1),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(9,"div",3),i.\u0275\u0275element(10,"ts-code-editor",4),i.\u0275\u0275elementEnd()()()),t&2&&(i.\u0275\u0275advance(5),i.\u0275\u0275property("language",n.language)("text",n.request)("readOnly",!0)("hideTooltip",!0),i.\u0275\u0275advance(5),i.\u0275\u0275property("language",n.language)("text",n.response)("readOnly",!0)("hideTooltip",!0))},dependencies:[jn],styles:[".double-side-panel[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:stretch;width:100%;height:100%}.double-side-panel[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]{flex-basis:100%;overflow:hidden;display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch}.double-side-panel[_ngcontent-%COMP%]   .panel.panel-left[_ngcontent-%COMP%]{margin-right:20px}.double-side-panel[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{height:32px;flex-shrink:0}.double-side-panel[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{flex-basis:100%;border-width:1px;border-style:solid;margin-top:16px;overflow:hidden;display:flex;flex-direction:row;align-items:stretch;justify-content:stretch}.double-side-panel[_ngcontent-%COMP%]   .panel[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]   ts-code-editor[_ngcontent-%COMP%]{font-size:1.6em;overflow:hidden}"],changeDetection:0})}}class Cr{get errorMessage(){return`Error code: ${this.errorInfo?.errorCode}

Error message: ${this.errorInfo?.message}

Stack trace:
`+this.errorInfo?.stackTrace}static{this.\u0275fac=function(t){return new(t||Cr)}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:Cr,selectors:[["ts-service-execution-error"]],inputs:{errorInfo:"errorInfo"},decls:1,vars:3,consts:[[3,"text","readOnly","hideTooltip"]],template:function(t,n){t&1&&i.\u0275\u0275element(0,"ts-code-editor",0),t&2&&i.\u0275\u0275property("text",n.errorMessage)("readOnly",!0)("hideTooltip",!0)},dependencies:[jn],styles:["ts-code-editor[_ngcontent-%COMP%]{font-size:1.6em}"]})}}const Xm=r=>({"mat-dialog-title-rtl-text":r}),vd=r=>[r];function eg(r,e){r&1&&i.\u0275\u0275element(0,"ts-mask",13)}function tg(r,e){r&1&&(i.\u0275\u0275elementStart(0,"span",14),i.\u0275\u0275text(1),i.\u0275\u0275pipe(2,"translate"),i.\u0275\u0275elementEnd()),r&2&&(i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(2,1,"ServiceClientRequestTabCaption")))}function ng(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"ts-parameters-tree",22),i.\u0275\u0275pipe(1,"translate"),i.\u0275\u0275listener("valueChange",function(s){i.\u0275\u0275restoreView(t);const a=i.\u0275\u0275nextContext(2);return i.\u0275\u0275resetView(a.onParameterValueChange(s))})("expandedChanged",function(s){i.\u0275\u0275restoreView(t);const a=i.\u0275\u0275nextContext(2);return i.\u0275\u0275resetView(a.onRequestParametersExpandChange(s))})("createCollectionItem",function(s){i.\u0275\u0275restoreView(t);const a=i.\u0275\u0275nextContext(2);return i.\u0275\u0275resetView(a.onCreateCollectionItem(s))})("removeCollectionItem",function(s){i.\u0275\u0275restoreView(t);const a=i.\u0275\u0275nextContext(2);return i.\u0275\u0275resetView(a.onRemoveCollectionItem(s))}),i.\u0275\u0275elementEnd()}if(r&2){const t=i.\u0275\u0275nextContext(2);i.\u0275\u0275property("parameters",t.requestParameters)("initialExpanded",t.requestExpanded)("caption",i.\u0275\u0275pipeBind1(1,8,"ServiceClientRequestParameters"))("readonly",!1)("canSelect",!1)("showValues",!0)("canManageCollectionItems",!0)("initialExpandMode","ExpandOnlyRoot")}}function ig(r,e){r&1&&(i.\u0275\u0275elementStart(0,"div",23)(1,"div",24),i.\u0275\u0275element(2,"div",25),i.\u0275\u0275elementStart(3,"div",26)(4,"span"),i.\u0275\u0275text(5),i.\u0275\u0275pipe(6,"translate"),i.\u0275\u0275elementEnd()()()()),r&2&&(i.\u0275\u0275advance(5),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(6,1,"RequestParametersEmptyMessage")))}function sg(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"div",15)(1,"div",16)(2,"span",17),i.\u0275\u0275text(3),i.\u0275\u0275pipe(4,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(5,"button",18),i.\u0275\u0275listener("click",function(){i.\u0275\u0275restoreView(t);const s=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(s.onOpenAuthenticationPageButtonClick())}),i.\u0275\u0275element(6,"div",3),i.\u0275\u0275elementStart(7,"span",19),i.\u0275\u0275text(8),i.\u0275\u0275pipe(9,"translate"),i.\u0275\u0275elementEnd()()(),i.\u0275\u0275template(10,ng,2,10,"ts-parameters-tree",20)(11,ig,7,3,"div",21),i.\u0275\u0275elementEnd()}if(r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate2("",i.\u0275\u0275pipeBind1(4,6,"ServiceClientRequestPrompt")," ",t.serviceMethod==null?null:t.serviceMethod.caption,""),i.\u0275\u0275advance(3),i.\u0275\u0275property("ngClass",i.\u0275\u0275pureFunction1(10,vd,t.isRtl()?"open-authentication-settings-icon-rtl":"open-authentication-settings-icon")),i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(9,8,"OpenAuthenticationSettingsButtonCaption")),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",!t.requestParametersEmpty),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",t.requestParametersEmpty)}}function rg(r,e){r&1&&(i.\u0275\u0275elementStart(0,"span",27),i.\u0275\u0275text(1),i.\u0275\u0275pipe(2,"translate"),i.\u0275\u0275elementEnd()),r&2&&(i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(2,1,"ServiceClientResponseTabCaption")))}function ag(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"div",15)(1,"span",17),i.\u0275\u0275text(2),i.\u0275\u0275pipe(3,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275element(4,"ts-parameters-tree",28),i.\u0275\u0275pipe(5,"translate"),i.\u0275\u0275elementEnd()),r&2){const t=i.\u0275\u0275nextContext(2);i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate2("",t.serviceMethod==null?null:t.serviceMethod.caption," ",i.\u0275\u0275pipeBind1(3,7,"ServiceClientResponseTabCaption")," "),i.\u0275\u0275advance(2),i.\u0275\u0275property("parameters",t.responseParameters)("caption",i.\u0275\u0275pipeBind1(5,9,"ServiceClientRequestParameters"))("readonly",!0)("canSelect",!1)("showValues",!0)}}function og(r,e){r&1&&(i.\u0275\u0275elementStart(0,"mat-tab"),i.\u0275\u0275template(1,rg,3,3,"ng-template",8)(2,ag,6,11,"ng-template",9),i.\u0275\u0275elementEnd())}function lg(r,e){r&1&&(i.\u0275\u0275elementStart(0,"span",29),i.\u0275\u0275text(1),i.\u0275\u0275pipe(2,"translate"),i.\u0275\u0275elementEnd()),r&2&&(i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(2,1,"ServiceClientErrorTabCaption")))}function cg(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"div",15)(1,"span",17),i.\u0275\u0275text(2),i.\u0275\u0275pipe(3,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(4,"div",30),i.\u0275\u0275element(5,"ts-service-execution-error",31),i.\u0275\u0275elementEnd()()),r&2){const t=i.\u0275\u0275nextContext(2);i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(3,2,"ServiceClientErrorTabInfo")),i.\u0275\u0275advance(3),i.\u0275\u0275property("errorInfo",t.serviceLastResponse==null?null:t.serviceLastResponse.errorInfo)}}function ug(r,e){r&1&&(i.\u0275\u0275elementStart(0,"mat-tab"),i.\u0275\u0275template(1,lg,3,3,"ng-template",8)(2,cg,6,4,"ng-template",9),i.\u0275\u0275elementEnd())}function dg(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"span",32),i.\u0275\u0275text(1),i.\u0275\u0275elementEnd()),r&2){const t=i.\u0275\u0275nextContext(2);i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(t.bodyTabCaption)}}function hg(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"div",33)(1,"ts-double-side-panel",34)(2,"span",35),i.\u0275\u0275text(3),i.\u0275\u0275pipe(4,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(5,"span",36),i.\u0275\u0275text(6),i.\u0275\u0275pipe(7,"translate"),i.\u0275\u0275elementEnd()()()),r&2){const t=i.\u0275\u0275nextContext(2);i.\u0275\u0275advance(),i.\u0275\u0275property("language",t.bodyCodeEditorLanguage)("request",t.requestBody)("response",t.responseBody),i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(4,5,"ServiceClientRawRequesCaption")),i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(7,7,"ServiceClientRawResponseCaption"))}}function pg(r,e){r&1&&(i.\u0275\u0275elementStart(0,"mat-tab"),i.\u0275\u0275template(1,dg,2,1,"ng-template",8)(2,hg,8,9,"ng-template",9),i.\u0275\u0275elementEnd())}function mg(r,e){r&1&&(i.\u0275\u0275elementStart(0,"span",37),i.\u0275\u0275text(1,"Raw http"),i.\u0275\u0275elementEnd())}function gg(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"div",15)(1,"ts-double-side-panel",34)(2,"span",35),i.\u0275\u0275text(3),i.\u0275\u0275pipe(4,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(5,"span",36),i.\u0275\u0275text(6),i.\u0275\u0275pipe(7,"translate"),i.\u0275\u0275elementEnd()()()),r&2){const t=i.\u0275\u0275nextContext(2);i.\u0275\u0275advance(),i.\u0275\u0275property("language",t.rawDataCodeEditorLanguage)("request",t.requestRawData)("response",t.responseRawData),i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(4,5,"ServiceClientRawRequesCaption")),i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(7,7,"ServiceClientRawResponseCaption"))}}function fg(r,e){r&1&&(i.\u0275\u0275elementStart(0,"mat-tab"),i.\u0275\u0275template(1,mg,2,0,"ng-template",8)(2,gg,8,9,"ng-template",9),i.\u0275\u0275elementEnd())}class br{get serviceMethod(){return this.serviceSchema.serviceMethods[0]}get requestParametersEmpty(){return this.requestParameters?.length===0}get hasResponse(){return this.serviceLastResponse!=null}get hasResponseError(){return this.hasResponse&&this.serviceLastResponse.errorInfo!=null}get hasRawData(){return!M.isEmpty(this.requestRawData)||!M.isEmpty(this.responseRawData)}get hasBodyData(){return!M.isEmpty(this.requestBody)||!M.isEmpty(this.responseBody)}get requestBody(){return this.hasResponse?this.serviceLastResponse.RequestBody:""}get responseBody(){return this.hasResponse?this.serviceLastResponse.ResponseBody:""}get requestRawData(){return this.hasResponse?this.serviceLastResponse.RequestRawData:""}get responseRawData(){return this.hasResponse?this.serviceLastResponse.ResponseRawData:""}get bodyCodeEditorLanguage(){return this.serviceMethod.request.contentType===un.json?Po.F.Json:Po.F.Xml}get bodyTabCaption(){return this.serviceMethod.request.contentType===un.json?"json":"xml"}constructor(e,t,n,s,a){this.httpClient=e,this.serviceClientData=t,this.callService=n,this.customEventService=s,this._directionality=a,this.isLoading=!1,this.rawDataCodeEditorLanguage=Po.F.Http,this.serviceSchema=t.schema,this._requestParametersDefaultValuesMap=t.parametersValues||new Map,this.requestParameters=this._createParametersInstances(this.serviceMethod.request.parameters,this._requestParametersDefaultValuesMap),this._createDefaultEmptyCollectionItems(this.requestParameters)}_createParametersInstances(e,t=null){return e&&e.map(n=>{const s=n.name,a=t?.get(s)||"";return new gr(n,a)})}_createDefaultEmptyCollectionItems(e){e?.forEach(t=>{t.isArray&&this.onCreateCollectionItem(t.uId)})}_getSimpleArrayValues(e){return e.itemProperties?.map(t=>t.value)}_prepareNestedForRequest(e){return e&&e.map(t=>t.itemProperties.map(n=>this._getParameterValue(n)))}_getParameterRealValue(e){return e.dataValueTypeName===X.Object?null:e.isArray?this._getSimpleArrayValues(e):e.value}_getParameterValue(e){const t=this._getParameterRealValue(e);return{code:e.schema.name,value:t,nested:e.dataValueTypeName===X.Object?this._prepareNestedForRequest(e.itemProperties):null}}_getParametersValues(e){return!e||e.length===0?null:e.map(t=>this._getParameterValue(t))}_createParameter(e,t){const n=new hn;return n.name=e.schema.sequenceElementName,n.caption=t,n.dataValueTypeName=e.schema.dataValueTypeName,n}_createNestedParameters(e){if(e.schema.dataValueTypeName===X.Object)e.itemProperties=e.value?.map((t,n)=>{const s=this._createParameter(e,`Item ${n}`),a=new gr(s);return a.itemProperties=this._createResponseParameters(e.schema.itemProperties,t),a});else{const t=e.schema.dataValueTypeName;e.schema.dataValueTypeName=X.Object,e.itemProperties=e.value?.map((n,s)=>{const a=this._createParameter(e,`Item ${s}`);return a.dataValueTypeName=t,new gr(a,n)})}}_findParameterValue(e,t){return t[e.schema.name]}_createResponseParameters(e,t){const n=this._createParametersInstances(e);return n.forEach(s=>{s.value=this._findParameterValue(s,t),s.schema.isArray&&this._createNestedParameters(s)}),n}_parseResponse(e){const t=JSON.parse(e);return this._createResponseParameters(this.serviceMethod.response.parameters,t)}_treeSearch(e,t){let n=null;return!e||(n=e.find(s=>s.uId===t),n)||e.forEach(s=>{n||(n=this._treeSearch(s.itemProperties,t))}),n}_findParameterParent(e,t){const n=this._treeSearch(e,t);return n?this._treeSearch(e,n.parentUId):null}_getMaxCollectionIndex(e){return!e||e.length===0?-1:Math.max(...e.map(t=>t.caption.split(" ")[1]))}_generateInstance(e){e.itemProperties=e.itemProperties||[];const t=new hn;t.name=e.schema.sequenceElementName,t.caption=`Item ${this._getMaxCollectionIndex(e.itemProperties)+1}`,t.dataValueTypeName=e.schema.dataValueTypeName,t.itemProperties=[...e.schema.itemProperties];const n=new gr(t);return n.parentUId=e.uId,n}_addSimpleItem(e){const t=this._generateInstance(e);e.itemProperties=[...e.itemProperties,t]}_addComplexItem(e){const t=this._generateInstance(e);t.itemProperties=e.schema.itemProperties.map(n=>{const s=this._requestParametersDefaultValuesMap.get(n.name)||"";return new gr(n,s)}),e.itemProperties=[...e.itemProperties,t],t.itemProperties.forEach(n=>{n.isArray&&this.onCreateCollectionItem(n.uId)})}isRtl(){return this._directionality?.value==="rtl"}onRequestParametersExpandChange(e){this.requestExpanded=e}onParameterValueChange(e){const t=this._treeSearch(this.requestParameters,e.recordId);t.value=e.value,this.requestParameters=[...this.requestParameters]}onCreateCollectionItem(e){const t=this._treeSearch(this.requestParameters,e);t.dataValueTypeName!==X.Object?this._addSimpleItem(t):this._addComplexItem(t)}onRemoveCollectionItem(e){const t=this._findParameterParent(this.requestParameters,e);t&&(t.itemProperties=t.itemProperties.filter(n=>n.uId!==e))}onSendRequestButtonClick(){this.isLoading=!0;const e=this._getParametersValues(this.requestParameters);this.callService.sendRequest(this.serviceSchema.name,this.serviceMethod?.name,e).subscribe(t=>{this.isLoading=!1,this.serviceLastResponse=t,t.success&&t.StatusCode===200?(this.responseParameters=this._parseResponse(t.ParameterValues),this.tabIndex=1):t.errorInfo?this.tabIndex=2:this.tabIndex=4})}onOpenAuthenticationPageButtonClick(){this.customEventService.createOutboundChannel(Wm).next()}static{this.\u0275fac=function(t){return new(t||br)(i.\u0275\u0275directiveInject(P.HttpClient),i.\u0275\u0275directiveInject(N.MAT_LEGACY_DIALOG_DATA),i.\u0275\u0275directiveInject(fr),i.\u0275\u0275directiveInject(T.Dj),i.\u0275\u0275directiveInject(At.Directionality))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:br,selectors:[["ts-service-client-form"]],decls:21,vars:19,consts:[["class","component-mask",4,"ngIf"],[1,"service-client-form"],["mat-dialog-title",""],[3,"ngClass"],["mat-icon-button","","mat-dialog-close","",3,"ngClass"],["alt","close","src","data:image/svg+xml;base64,PHN2ZyBpZD0iR3JvdXBfNyIgZGF0YS1uYW1lPSJHcm91cCA3IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2IiBmaXQ9IiIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQgbWVldCIgZm9jdXNhYmxlPSJmYWxzZSI+DQogIDxyZWN0IGlkPSJSZWN0YW5nbGVfNyIgZGF0YS1uYW1lPSJSZWN0YW5nbGUgNyIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiBmaWxsPSJub25lIj48L3JlY3Q+DQogIDxsaW5lIGlkPSJMaW5lXzUiIGRhdGEtbmFtZT0iTGluZSA1IiB5MT0iMTAiIHgyPSIxMCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMyAzKSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjOTk5IiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHN0cm9rZS13aWR0aD0iMSI+PC9saW5lPg0KICA8bGluZSBpZD0iTGluZV82IiBkYXRhLW5hbWU9IkxpbmUgNiIgeDI9IjEwIiB5Mj0iMTAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDMgMykiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzk5OSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBzdHJva2Utd2lkdGg9IjEiPjwvbGluZT4NCjwvc3ZnPg=="],[1,"dialog-content"],["mat-align-tabs","start",1,"tab-group",3,"selectedIndexChange","selectedIndex"],["mat-tab-label",""],["matTabContent",""],[4,"ngIf"],["mat-dialog-actions",""],["data-item-marker","send-request","color","accent","mat-flat-button","",1,"send-request-action",3,"click"],[1,"component-mask"],["data-item-marker","request-parameters-tab",1,"request-parameters-tab"],[1,"tab-content"],[1,"tree-header"],[1,"service-method-caption"],["data-item-marker","OpenAuthenticationSettingsButton",1,"open-authentication-settings-button",3,"click"],[1,"open-authentication-settings-label"],["class","panel parameter-selector","data-item-marker","request-parameters-tree",3,"parameters","initialExpanded","caption","readonly","canSelect","showValues","canManageCollectionItems","initialExpandMode","valueChange","expandedChanged","createCollectionItem","removeCollectionItem",4,"ngIf"],["class","blank-slate-wrapper",4,"ngIf"],["data-item-marker","request-parameters-tree",1,"panel","parameter-selector",3,"valueChange","expandedChanged","createCollectionItem","removeCollectionItem","parameters","initialExpanded","caption","readonly","canSelect","showValues","canManageCollectionItems","initialExpandMode"],[1,"blank-slate-wrapper"],[1,"blank-slate-inner-ct"],[1,"blank-slate-image"],[1,"blank-slate-title"],["data-item-marker","response-parameters-tab",1,"response-parameters-tab"],["data-item-marker","response-parameters-tree",1,"panel","parameter-selector",3,"parameters","caption","readonly","canSelect","showValues"],["data-item-marker","response-error-tab",1,"response-parameters-tab"],[1,"errorWrapper"],[1,"show-error",3,"errorInfo"],["data-item-marker","raw-body-tab",1,"response-parameters-tab"],[1,"tab-content","body-content"],[3,"language","request","response"],[1,"left-caption","service-method-caption"],[1,"right-caption","service-method-caption"],["data-item-marker","raw-http-tab",1,"response-parameters-tab"]],template:function(t,n){t&1&&(i.\u0275\u0275template(0,eg,1,0,"ts-mask",0),i.\u0275\u0275elementStart(1,"div",1)(2,"div",2)(3,"span",3),i.\u0275\u0275text(4),i.\u0275\u0275pipe(5,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(6,"button",4),i.\u0275\u0275element(7,"img",5),i.\u0275\u0275elementEnd()(),i.\u0275\u0275elementStart(8,"mat-dialog-content",6)(9,"mat-tab-group",7),i.\u0275\u0275twoWayListener("selectedIndexChange",function(a){return i.\u0275\u0275twoWayBindingSet(n.tabIndex,a)||(n.tabIndex=a),a}),i.\u0275\u0275elementStart(10,"mat-tab"),i.\u0275\u0275template(11,tg,3,3,"ng-template",8)(12,sg,12,12,"ng-template",9),i.\u0275\u0275elementEnd(),i.\u0275\u0275template(13,og,3,0,"mat-tab",10)(14,ug,3,0,"mat-tab",10)(15,pg,3,0,"mat-tab",10)(16,fg,3,0,"mat-tab",10),i.\u0275\u0275elementEnd()(),i.\u0275\u0275elementStart(17,"div",11)(18,"button",12),i.\u0275\u0275listener("click",function(){return n.onSendRequestButtonClick()}),i.\u0275\u0275text(19),i.\u0275\u0275pipe(20,"translate"),i.\u0275\u0275elementEnd()()()),t&2&&(i.\u0275\u0275property("ngIf",n.isLoading),i.\u0275\u0275advance(3),i.\u0275\u0275property("ngClass",i.\u0275\u0275pureFunction1(15,Xm,n.isRtl())),i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate2("",i.\u0275\u0275pipeBind1(5,11,"ServiceClientHeaderCaption")," ",n.serviceSchema.caption,""),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngClass",i.\u0275\u0275pureFunction1(17,vd,n.isRtl()?"close-rtl-dialog":"close-dialog")),i.\u0275\u0275advance(3),i.\u0275\u0275twoWayProperty("selectedIndex",n.tabIndex),i.\u0275\u0275advance(4),i.\u0275\u0275property("ngIf",!!n.responseParameters),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",n.hasResponseError),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",n.hasBodyData),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",n.hasRawData),i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(20,13,"SendRequestButtonCaption")))},dependencies:[v.NgClass,v.NgIf,$.MatLegacyButton,N.MatLegacyDialogClose,N.MatLegacyDialogTitle,N.MatLegacyDialogContent,N.MatLegacyDialogActions,Ke,Nt.MatLegacyTabGroup,Nt.MatLegacyTabLabel,Nt.MatLegacyTab,Nt.MatLegacyTabContent,yr,Cr,Di,m.TranslatePipe],styles:[".service-client-form[_ngcontent-%COMP%]{margin-top:-8px;width:920px;display:flex;flex-direction:column;height:60vh}.service-client-form[_ngcontent-%COMP%]   ts-double-side-panel[_ngcontent-%COMP%]{height:100%}.service-client-form[_ngcontent-%COMP%]   .errorWrapper[_ngcontent-%COMP%]{margin-top:1.3em;flex-basis:100%;overflow-y:auto}.service-client-form[_ngcontent-%COMP%]   .mat-dialog-content[_ngcontent-%COMP%]{flex-basis:100%;display:flex;flex-direction:column;max-height:none}.service-client-form[_ngcontent-%COMP%]   .mat-dialog-content[_ngcontent-%COMP%]   .tab-group[_ngcontent-%COMP%]{flex-basis:100%;height:100%}.service-client-form[_ngcontent-%COMP%]   [mat-dialog-actions][_ngcontent-%COMP%]{flex-shrink:0;display:flex;flex-direction:row;justify-content:flex-end;margin-bottom:0;margin-top:28px}.service-client-form[_ngcontent-%COMP%]   .mat-dialog-title[_ngcontent-%COMP%]{flex-shrink:0;margin-bottom:10px}.service-client-form[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;align-items:stretch}.service-client-form[_ngcontent-%COMP%]   .service-method-caption[_ngcontent-%COMP%]{flex-grow:0;display:inline-block;margin-top:16px;height:17px;text-align:left;opacity:1}.service-client-form[_ngcontent-%COMP%]   .parameter-selector[_ngcontent-%COMP%], .service-client-form[_ngcontent-%COMP%]   .show-error[_ngcontent-%COMP%]{flex-basis:100%;overflow-y:auto}.service-client-form[_ngcontent-%COMP%]   .tree-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.service-client-form[_ngcontent-%COMP%]   .open-authentication-settings-button[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:10px;height:25px;border:0;border-radius:4px;display:flex;align-items:center}.service-client-form[_ngcontent-%COMP%]   .open-authentication-settings-icon[_ngcontent-%COMP%], .service-client-form[_ngcontent-%COMP%]   .open-authentication-settings-icon-rtl[_ngcontent-%COMP%]{width:16px;height:16px;background-position:center;background-repeat:no-repeat;background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGVuYWJsZS1iYWNrZ3JvdW5kPSJuZXcgMCAwIDI0IDI0IiBoZWlnaHQ9IjI0cHgiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjI0cHgiIGZpbGw9IiNGRkZGRkYiPjxyZWN0IGZpbGw9Im5vbmUiIGhlaWdodD0iMjQiIHdpZHRoPSIyNCIvPjxwYXRoIGQ9Ik05LDV2Mmg2LjU5TDQsMTguNTlMNS40MSwyMEwxNyw4LjQxVjE1aDJWNUg5eiIvPjwvc3ZnPg==);border-radius:3px;background-size:15px}.service-client-form[_ngcontent-%COMP%]   .open-authentication-settings-icon[_ngcontent-%COMP%]{margin-right:10px}.service-client-form[_ngcontent-%COMP%]   .open-authentication-settings-icon-rtl[_ngcontent-%COMP%]{margin-left:10px}.service-client-form[_ngcontent-%COMP%]   .open-authentication-settings-label[_ngcontent-%COMP%]{letter-spacing:0px;margin-bottom:3px}.service-client-form[_ngcontent-%COMP%]   .blank-slate-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex-basis:100%;overflow-y:scroll}.service-client-form[_ngcontent-%COMP%]   .blank-slate-wrapper[_ngcontent-%COMP%]   .blank-slate-inner-ct[_ngcontent-%COMP%]{color:#999;flex-basis:100%;display:flex;flex-direction:column;align-items:center;justify-content:center}.service-client-form[_ngcontent-%COMP%]   .blank-slate-wrapper[_ngcontent-%COMP%]   .blank-slate-inner-ct[_ngcontent-%COMP%]   .blank-slate-image[_ngcontent-%COMP%]{margin-bottom:40px;width:120px;height:125px;background-position:center;background-repeat:no-repeat;background-size:contain;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIcAAACLCAYAAABLJYpxAAAABGdBTUEAALGPC/xhBQAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAABATSURBVHhe7Z0LlJVVFcd5idFCs7QULEq0zDTThYAp2gPTUPFtUChpptHK1FKKspdY0tsMUrOXkS50Gfl+rLQ00VILzDCyVDQzUsuEfPTW/j9m7+bOvXtm7szce+f7zj17rd+C+b7vnO+cs/c933nuMyR1Oea6B0aIHcSh4hSxSFwhfip+K/4inhbPVfEfsVb8QawQ14vFYr54l3ijeJG9JkvRRcoaKrYTx4rviF+Kf4lqxTeSP4prxSfFW8RoS06WwRYp4yVitlgiqAUiBf5N3CG+L84U1CCEmS6miAni1ca29u9rxWSxt5gp5ghqDYzuBvGgeFZUv+u/4mfiE2KSGGZJzdIKUYFjEO8Ty0S1gp4Rt4qvCAxgohjbJLYR+4kPCwzv96IyLbBGLBR7iGwozRAVLG2HA8WVgl9npQJWirPEQWKciBTZKnYR1ExXC2qsynSuFh8XYy1bWQYiKshNxamCX2BlQd8pThPNrBkGyivEOwW1SqWhYNyXiimWzSx9ERUcNQA9i8qexF/F18UbRKSMIrO1OEnQ9vH8wG2CGm+oZT1Ld6JCGiNoL/xTeAH+Rpwo+CVGBV823iwuFv8WnkdqwmlWDFkqRQUzSnxK0KD0AvuFeLvYUkSFXHZ2EtSOlXm+WexkxZJFhTFDPGSFA/yKZomoQFMEI/mG8NqSHhh/b2ZF1H6izNOuuEq4UTwi3i9SrSl6Y1dxjfDy+LOYZcXVPqJMv0c8aYXAt5exAMYNokJrNw4T9wk3ErrFY6zo0hVlcjNxuWUaGOKeKqJCamdofNMw90Yrtch0K8b0RJljlPBPllky/VnxMhEVTqYD5mt+J/zH9FWxgRVpGqIM0RX1XwHzEvuKqDAytYwX5ws3EKYHyv+ZUSZGCqa6PWPMYDK5FRVCpmdop/mgIDXwBCvm8okSv4m40TLDkDGfkXbtiTSKN4n7BWXK+MgBVtzlESX6pWKVZeLvggUyUWYzfYc1KywL8B/dHCv24osSyzyCd8UeE7l90XheLpYKyhhOseIvriiRjFU8bAnmu7ibiDKXGTh8oll85AYyz9RQPFHi+JS4YdAjYW1DlKlMY2F+xg1krqmjOKJEMZvqnxIMg6V3UUYyzaHSQIrTBlFiRgtWaJMwPiWvF1EGMs3lWwId0Eg9yNQzeKJEDBeM/ZOodWJPESU803xog1wi0AXd3ImmpsERJYDxfxLDFoBDRJToTOugF8OeHHTCLPeWpqrWil7MmgsSAUy1R4nNtB62Vnj7j2WII01lrRG9kH0dPpR7nogSmRk8WGf7lEA/Z5vami96GUv6fPSTKmywtwNkYt4t0BEcbOprruhFZ9sLWQ2+s4gSlikG3xTo6nHR3PaHXvBWexkcLaIEZYrDVoLV++jrh6I5WyAUMeMZvuXvAhElJlM82ArhG8qPMnU2VhQxWw55AQNdeU1GufiiQHd8XjY3lTZGFCHL533T8lEiSkCmuDD+cY9Af4tNrY0RRchmGyJm6Xz08kzxYdslOoTJptqBiSI63CJk002eNyk3lwl0yeDYwBqnigDXBz7axt6S6IWZ8sAyClbmoc+BTc4pAtoXRMSkGsOy0Qsz5cKn9+8W/XMoo4AbCNZmENEZInpRpnzgQM+nPmaauvsmCniERcBI6CtF9KJMOfHZ9DtN3X0TBWSrIhHQR45ekCkvTJz+Q6DfvUzl9YkCsH+VgERANRS9ICXwHPghwXZDPA6yQ+91Ino2Fb4n0PG1pvb6RAHwY0VAIogiTgV8ivlKtmpwVHuhYJ9IFLbs4GaTfDK4Od5U37PoQVw5+lj8PiKKOAWYRHTfpRjCLeIcgeOU5cKN5AGBT9EojrJDnsnj6ab+nkUPzrUAvxJRhCnAp/JR4fmM1r4eIHBvzTOsX2EIuvqZsoM/V/KHt8bhZgLdix7yX808EUWYAr5SG//nr7JrEQwa4RuDZ/FKHD1TZvADgo938jfVTCAWPcBAFw9Sze4oogjLDjWA+wV9m13rCa9JmbiK7pcdXIOTv3PNDGLRA3jY5UF2x0cRpQB7d8kjn5V6dv2zPMG9Jm9v11LCF4rT/hphplArunm7PYiL5iiiFMCrMHn8ecW13mBDOGFwgRDdLzN4V3pCkL89zRS6im7gr8vXbKS8NpSzV8gj7pSi+9WwB9gHjFLd5umztWeYOXQV3fDhctYcRhGkAqOD/iOoR9luTPy6UvVhdoIgjyvMHLqKbtC/5wFWl0cRpATHcZBXtg9G9x2MwR2lpLxuls4HeeRH80IziU7RRV9Gxjc5iiAlOIjHG5nMHUUNU3o13pJnDUSRT2hoBO5Oal8ziQ7RBdob3IDXiChwanxaeJ5xqc2pBrh2nCY+KnyRE0Z0nIjiSImLBPldYGbRIbpAgXCj3kZaKtAriw4AdBgAO1JEYVPjZEGef2Rm0SG6wFFU3OCQmChgyvC9xdMh3XgO9GOBE20SRkTbaR2Lb1h7zMyiQ3SBxhY3FogoYCZ92B3HyDh20OkEV3/cZRfbpQrNxNwrsIPOBUD6w+camOOPAmXaA/bTYgfHuWFwyB4X6OOmOC3dHZwCxZR8PXACdRRHaviu/I6RUv2HaWkusAc2CpAqeFUm3/VAFzeKIzU4WZv8LnHj8FlK+vpRgFRx46C9hfIjfEEQ/4/iSA2c75Pfju6s/kMjdP0FEQVIFTcOvBNF94FPSjsZB+tbyO9KNw4f/GBRcRQgVbJx1IIvD/K7xo2DIzu5wMRbFCBVsnHUwhYN8rvWjeMzdqHdvAJm46iF5Qzk91k3Dt8a9yURBUiVbBy1+Bri57JxZOOoJhuHkY2jlhrj+Jxd+JqIAqRKNo5aWMvTxThybyW+D+1mHN5bWefGwe5yLrAkLgqQKtk4amEOifw+6sZxjF1gRi4KkCrZOGo5WJDfVW4cbBjmwh0iCpAq2ThqOVaQ32VuHLiP5AKuq6MAqZKNo5aPCPJ7iRsHF7nAWfPs7qoOkCrZOGrxEzG+7MYxVOCAlovtdKpjNo5arhLk9/j1xoHoD/xUcBFvxVGgFMnGUctKQX73N9NYbxw/sIu4YIgCpUg2jq6w9dO/IFuZaaw3Dh8IS91BXCXZOLrCuXDk9UnR6Rddf/hO8nZaKpiNoyvvFevLw8yiQ3SBKoUb9FjGiyhwamTj6Ir7SVtoZtEpuugFwbkcUeDUyMbRFbwqktcZZhKdoosX2032jUaBUyMbRyfsCfatkLWnSOriHLuJs5IogtTIxtGJH52y2syhq+gGPil5gHbHNiKKJCWycXSyWJDPRWYOtaKbPhjGBEwUSUpk4+jE89k5+FUtuslSQR5aKqJIUiIbRwfulwPXVs83U6gV3dzVHmTXPZ+ZKLJUcOPgsKHrusHPQ0vZODgMgDwuNTOIRQ8wCfeQPcxB+VFkqeDGUQ+pGgeO8vBmRB4PNTPoXvQQ57nx8A0iijAV8A6Ik7h6SNWJnu+NZch8lJlA96KH6KkQgH4vJ1FHkWbS4EqBrs8z9fcuevgmC5TPd0sXtj4ybIGeJ5jqexc9PMMC4Wqxnbz9tBP88NHxclN7faIAnETNmlIC4xc7ijxTXphcfVyg3yNM7fWLAuHAlcA4rm2ntaXtAKdwoVvGcTYwldcvCjRa+AF5zPVHL8mUD8avvPt6kqm776LAbmHUHuNE9LJMuXCncDgI7L372p0ocGXtwbbJ6GWZ8sBhh37q1Amm5v4LkVhkRJrPtC83iwS65Kzckabi/osioefis7Xt5qYhJdjZ6IdJH27qHbgosv0sUgZN8DgXvTxTbH4s0OFNptbGiSL1vS2cqpi7tuXCmwb8uHcwlTZO7CXuQJ99LtUJyBQThslZloDe5ps6Gy+KnOOseAk7o9rFWXyZYUr+eoHOOPVzQ1Nl40WRs97DN9uyr5IDXKJEZYqBu1Tgc7KLqbF5opdsIfzw/3baPlk2WKDkhyXPM/U1X/SyvYUfvZkn5ooHi5N8RR8HHgwz1bVG9ELffM06S47liBKZaT1sbfX1OBjIi01lrRO9dJjw9gfnkqR+KG9Z+K5AJ3QaJpq6Wi96+UbC91jSGt5WRAnOtIbTBbqAWaamwRMlgpVizPCRIAbIthZRwjPN5UThhnGqqWfwRYlhoGWdJYxh2ry0sLWwz9k7COeYWoojStRu4hlL4JkiykSm8bB11SfULhTDTSXFESWK2Vs/MG+WiDKSaSwMI3iNcZkonmEgSpi7RsZA6E5Fmck0Ds7ap7y9xhhhqiieKHE+hn+WiDKTaQz88NxFE3D8WjFrDESJowtLQjnVmkUlUaYyA4dy9h8hnCY6Pf8VUZRAP+a63U5eaCUsslotKGcaoLOt+IsrSiQJ99YyLiurM5UZOIxhPC0oY8aUdrfiL7YooV+wRK8QUcYy/Wc74ZudYZnYwoq+2KKEbi6esoTn7mtjwYnbI4KypbvK0HhxeyTVosT6yZK51mgcuL2orC3YRlCOz4iLEswcirc13iGijGbqh22KnA7uNTG1BT++0Vbk5REl2lej3yiizGbqg5X87EV2rwZATTzJirpcooSzBI1M4P0Hb/tRpjM9g1EwYcY+ZDcKRpeZK2ntyq1GiRL+PHGfIDOM1EUZz3QPvjFY+OtjFrBWsLJuYyvmcooy4CdYs3eWrlZUAM2C47TLutufrRwc7PyEqDQKfM1vYsVbXlEmmJb3WcBWeznmU7ZGYJTfFhx5yr6M6NmisLP4mFgu3CCA9sUHxEZWtOUWZWRj4Z+Ty0VUGM2AmoI5BF9mXwlOSPDbPVsUZQXaVEGv43bBXJOnlfbZFWK6KO5EWV9FmWEzEy6vySS/3lZ9TlD6/cIL+GpB4Z4vfOWZw8YdDk5mVvhI0Qo3max4myY4Gw/F+3qWSm4TJ4sxVpxpiTLm592jgANFVFCNhAOBONrDC5iRwqPF/2cg9f8NBX67F4rKxl0lhGOZPt96GoEYzV6CZY31bgbH4QkzzYcI5jjwD3+puEdQHtXvZA6EVfnHi3GW3DRFGTxMePXIApOoABvFTHGL8IJmT8wC0eu3Wc8wiMSQMz0oVsT74TI9wcbwhwWO01D2rwV7Pfibtk2k/GrwfESNhvHRrW/eftQiiTK6u3Dn8BeISKEDhbbCXLFKeIEz8nquGGtJ6bMo7CgxSWAwGBifRdoBzGpWtgXqgU8YxoOzfE5txtMitVa/01dqUcZZP+DTxIyCNnLpH3Hhd/si4cPFwP9ZnNz06ljveIFgIzhtE5gi6G7Sw+Bv2lXsC+67K8aURQWyj/CV5LeKRvQE+M4zTMxZcu4vwuFX+UFR/v5+yiIF0ejysYyfiP4YBr88agbcGi4R94pKYwC+6Xw69rBXZymqSEmbCtoVrjyW/O0oJhsc1MNAFKvMafVTC9BW+LzAFQPP3yUY9as0AofvPIcaMyJI9Z1OXz9lkaLopvnCkkaAIbAOgb0UzBkwFpA/GWUSKQw/GzeLSMFAV46aAHCk/qC4W9AOuUbwyeDTMF8ww7i/2F60R3cuWRky5H+qu+L1QQx6mwAAAABJRU5ErkJggg==)}.service-client-form[_ngcontent-%COMP%]   .blank-slate-wrapper[_ngcontent-%COMP%]   .blank-slate-inner-ct[_ngcontent-%COMP%]   .blank-slate-title[_ngcontent-%COMP%]{max-width:240px;margin-bottom:30px}"]})}}var Sr;(function(r){r[r.None=0]="None",r[r.Const=1]="Const",r[r.SysSetting=2]="SysSetting"})(Sr||(Sr={}));class Fn{constructor(e,t){this.dialogService=e,this.sysSettingsService=t,this._destroyed$=new u.Subject}getFlatParameters(e){const t=[...e];return e.forEach(n=>{n.itemProperties&&t.push(...this.getFlatParameters(n.itemProperties))}),t}getParametersConstValuesEntries(e){const t=e.filter(n=>n.defValue.source===Sr.Const).map(n=>[n.name,n.defValue.value]);return(0,u.of)(t)}getSysSettingsValuesEntries(e){const t=e.filter(s=>s.defValue.source===Sr.SysSetting),n=t.map(s=>s.defValue.value);return n.length===0?(0,u.of)([]):this.sysSettingsService.getByCodes(n).pipe((0,l.map)(s=>s.values),(0,l.map)(s=>t.map(a=>[a.name,s[a.defValue.value].value])))}getParametersValues(e){const t=this.getFlatParameters(e);return(0,u.combineLatest)([this.getSysSettingsValuesEntries(t),this.getParametersConstValuesEntries(t)]).pipe((0,l.map)(([n,s])=>[...n,...s]),(0,l.map)(n=>new Map(n)))}show(e){this.getParametersValues(e.serviceMethods[0].request.parameters).subscribe(t=>{this.dialogService.open(br,{data:{schema:e,parametersValues:t},disableClose:!0,panelClass:"dialog-top-border"})})}ngOnDestroy(){this._destroyed$.next()}static{this.\u0275fac=function(t){return new(t||Fn)(i.\u0275\u0275inject(lt),i.\u0275\u0275inject(xi))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Fn,factory:Fn.\u0275fac})}}class _g{constructor(){this.source=Sr.None}}class Bn{_getCaptionFromDto(e){if(typeof e=="string")return e;const t=Object.keys(e);return`${e[t[0]]}`}_convertFromObjectCollectionDto(e,t){return e?Object.keys(e.items).map(s=>{const a=e.items[s];return t(a)}):[]}_parameterValueFromDtoConverter(e){const t=new _g;return e&&(t.source=e.source,t.value=e.value),t}_parameterFromDtoConverter(e){const t=new hn;return t.uId=e.uId,t.name=e.name,t.caption=this._getCaptionFromDto(e.caption),t.path=e.path,t.type=e.type,t.isArray=e.isArray,t.isRequired=e.isRequired,t.isSoapHeader=e.isSoapHeader,t.sequenceElementName=e.sequenceElementName,t.dataValueTypeName=e.dataValueTypeName,t.defValue=this._parameterValueFromDtoConverter(e.defValue),t.itemProperties=this._convertFromObjectCollectionDto(e.itemProperties,n=>this._parameterFromDtoConverter(n)),t}_convertRequestSchemaFromDto(e){if(!e)return null;const t=new Io;return t.uri=e.uri,t.uId=e.uId,t.name=e.name,t.methodType=e.httpMethodType,t.contentType=e.contentType,t.parameters=this._convertFromObjectCollectionDto(e.parameters,n=>this._parameterFromDtoConverter(n)),t}_convertResponseSchemaFromDto(e){if(!e)return null;const t=new wo;return t.uId=e.uId,t.name=e.name,t.contentType=e.contentType,t.parameters=this._convertFromObjectCollectionDto(e.parameters,n=>this._parameterFromDtoConverter(n)),t}_methodFromDtoConverter(e){const t=new St;return t.uId=e.uId,t.name=e.name,t.caption=this._getCaptionFromDto(e.caption),t.timeout=e.requestTimeout,t.soapAction=e.soapAction,t.request=this._convertRequestSchemaFromDto(e.request),t.response=this._convertResponseSchemaFromDto(e.response),t}_convertToObjectCollectionDto(e,t){const n={};return e?.forEach(s=>{const a=t(s),o=a.uId;n[o]=a}),{items:n}}_parameterToDtoConverter(e){const t={};return t.uId=e.uId,t.name=e.name,t.caption=e.caption,t.path=e.path,t.type=e.type,t.isArray=e.isArray,t.isRequired=e.isRequired,t.isSoapHeader=e.isSoapHeader,t.sequenceElementName=e.sequenceElementName,t.dataValueTypeName=e.dataValueTypeName,t.itemProperties=this._convertToObjectCollectionDto(e.itemProperties,n=>this._parameterToDtoConverter(n)),t}_convertRequestSchemaToDto(e){if(!e)return null;const t={};return t.uri=e.uri,t.httpMethodType=e.methodType,t.contentType=e.contentType,t.parameters=this._convertToObjectCollectionDto(e.parameters,n=>this._parameterToDtoConverter(n)),t}_convertResponseSchemaToDto(e){if(!e)return null;const t={};return t.contentType=e.contentType,t.parameters=this._convertToObjectCollectionDto(e.parameters,n=>this._parameterToDtoConverter(n)),t}_methodToDtoConverter(e){const t={};return t.uId=e.uId,t.name=e.name,t.caption=e.caption,t.requestTimeout=e.timeout,t.soapAction=e.soapAction,t.request=this._convertRequestSchemaToDto(e.request),t.response=this._convertResponseSchemaToDto(e.response),t}convertToDto(e){const t={};return t.uId=e.uId,t.name=e.name,t.baseUri=e.baseUri,t.caption=e.caption,t.type=e.type,t.retryCount=e.retryCount,t.namespaces=e.namespaces.map(n=>n),t.methods=this._convertToObjectCollectionDto(e.serviceMethods,n=>this._methodToDtoConverter(n)),t}convertFromDto(e){const t=new xo;return t.uId=e.uId,t.name=e.name,t.baseUri=e.baseUri,t.caption=this._getCaptionFromDto(e.caption),t.type=e.type,t.retryCount=e.retryCount,t.namespaces=this._convertFromObjectCollectionDto(e.namespaces,n=>{const s={};return s.name=n.name,s.prefix=n.prefix,s}),t.serviceMethods=this._convertFromObjectCollectionDto(e.methods,n=>this._methodFromDtoConverter(n)),t}static{this.\u0275fac=function(t){return new(t||Bn)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Bn,factory:Bn.\u0275fac})}}class Mr{constructor(e){this.data=e}static{this.\u0275fac=function(t){return new(t||Mr)(i.\u0275\u0275directiveInject(N.MAT_LEGACY_DIALOG_DATA))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:Mr,selectors:[["ts-info-with-header-dialog"]],decls:9,vars:10,consts:[[1,"header-message"],[1,"message"],[1,"action-button",3,"mat-dialog-close"]],template:function(t,n){t&1&&(i.\u0275\u0275elementStart(0,"div",0),i.\u0275\u0275text(1),i.\u0275\u0275pipe(2,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(3,"div",1),i.\u0275\u0275text(4),i.\u0275\u0275pipe(5,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(6,"button",2),i.\u0275\u0275text(7),i.\u0275\u0275pipe(8,"translate"),i.\u0275\u0275elementEnd()),t&2&&(i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(2,4,n.data==null?null:n.data.headerMessage)),i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(5,6,n.data==null?null:n.data.message)),i.\u0275\u0275advance(2),i.\u0275\u0275property("mat-dialog-close",n.data==null||n.data.button==null?null:n.data.button.result),i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate1(" ",i.\u0275\u0275pipeBind1(8,8,n.data==null||n.data.button==null?null:n.data.button.caption),`
`))},dependencies:[N.MatLegacyDialogClose,m.TranslatePipe],styles:[".header-message[_ngcontent-%COMP%]{margin-bottom:24px}.message[_ngcontent-%COMP%]{margin-bottom:40px;white-space:pre-wrap}.action-button[_ngcontent-%COMP%]{float:right;text-transform:none;border-radius:16px;padding:0 16px}"]})}}class ut{static{this.\u0275fac=function(t){return new(t||ut)}}static{this.\u0275mod=i.\u0275\u0275defineNgModule({type:ut})}static{this.\u0275inj=i.\u0275\u0275defineInjector({providers:[lt,{provide:Ai.FocusTrapFactory,useClass:Ai.ConfigurableFocusTrapFactory}],imports:[v.CommonModule,$.MatLegacyButtonModule,N.MatLegacyDialogModule,m.TranslateModule]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&i.\u0275\u0275setNgModuleScope(ut,{declarations:[Ri,Oi,Vi,Mr],imports:[v.CommonModule,$.MatLegacyButtonModule,N.MatLegacyDialogModule,m.TranslateModule],exports:[Ri,Vi,Mr,Oi]})})();const yg=["tooltipEl"],Cg=r=>({rtl:r});class qt{constructor(e,t){this._directionality=e,this._sanitizer=t,this._defaultCssClass="base-tooltip crt-base-tooltip"}setInnerHTML(){this.tooltipEl&&(this.tooltipEl.nativeElement.innerHTML=this._sanitizer.sanitize(i.SecurityContext.HTML,this._tooltipConfig?.value))}set tooltipConfig(e){this._tooltipConfig!==e&&(this._tooltipConfig=e)}get tooltipConfig(){return this._tooltipConfig}get cssClasses(){let e=this._tooltipConfig?.cssClasses||this._defaultCssClass;const t=typeof e=="string";return t&&(e=e.split(" ")),e.includes("base-tooltip")&&this._directionality.value==="rtl"&&!e.includes("base-tooltip_rtl")&&e.push("base-tooltip_rtl"),t?e.join(" "):e}isRtl(){return this._directionality.value==="rtl"}ngAfterViewInit(){this.setInnerHTML()}static{this.\u0275fac=function(t){return new(t||qt)(i.\u0275\u0275directiveInject(At.Directionality),i.\u0275\u0275directiveInject(g.DomSanitizer))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:qt,selectors:[["crt-base-tooltip"]],viewQuery:function(t,n){if(t&1&&i.\u0275\u0275viewQuery(yg,5,i.ElementRef),t&2){let s;i.\u0275\u0275queryRefresh(s=i.\u0275\u0275loadQuery())&&(n.tooltipEl=s.first)}},inputs:{tooltipConfig:"tooltipConfig"},decls:3,vars:6,consts:[["tooltipEl",""],[1,"tooltip-value",3,"ngClass"]],template:function(t,n){t&1&&(i.\u0275\u0275elementStart(0,"div"),i.\u0275\u0275element(1,"span",1,0),i.\u0275\u0275elementEnd()),t&2&&(i.\u0275\u0275classMap(n.cssClasses),i.\u0275\u0275advance(),i.\u0275\u0275property("ngClass",i.\u0275\u0275pureFunction1(4,Cg,n.isRtl())))},dependencies:[v.NgClass],styles:[".base-tooltip[_ngcontent-%COMP%]{max-width:320px;max-height:50vh;overflow-y:auto;overflow-x:auto;box-shadow:0 2px 4px #18181840;padding-left:8px;padding-right:8px;margin:10px;opacity:1;word-wrap:break-word}.base-tooltip_rtl[_ngcontent-%COMP%]{padding-left:0;padding-right:8px}.base-tooltip[_ngcontent-%COMP%]   .rtl[_ngcontent-%COMP%]{direction:rtl;text-align:right}  .base-tooltip img{max-width:100%;height:auto}"]})}}class vr{constructor(e){this.showEvent="mouseenter",this.hideEvent="mouseleave",this.capture=!1,this.closeOnOutsideClick=!1,T.cn.isMobile&&(e.closeOnOutsideClick=!0,e.showEvent="touchstart",e.hideEvent="touched"),Object.assign(this,e)}}var Ro=h(31555),Id=h(73969),Un=h(67041);const bg=500;class Jt{constructor(e,t,n,s){this._overlay=e,this._overlayPositionBuilder=t,this._elementRef=n,this._ngZone=s,this._delayTime=bg,this._allowedKeyboardEvent=[Un.Key.Enter,Un.Key.Escape,Un.Key.Tab],this._class="crt-tooltip-trigger"}set tooltipConfig(e){if(!e)return;this._tooltipConfig=this._normalizeTooltipEvents(e);const t=T.cn.isMobile?"touchstart":"click";if(this._tooltipConfig.showEvent.includes(t)||this._elementRef.nativeElement.addEventListener(t,this._handleScreenReaderEnterEvent.bind(this)),this._tooltipRef){if(this._tooltipRef.instance.tooltipConfig=this._tooltipConfig.tooltipConfig,!this._tooltipRef.instance.tooltipConfig)return;this._tooltipRef.instance.tooltipConfig.cssClasses=this._tooltipConfig?.panelClass}}get tooltipConfig(){return this._tooltipConfig}set crtTooltip(e){!e||Array.isArray(e)&&e.length===0||(this.tooltipConfig=new vr({tooltipConfig:{value:Array.isArray(e)?e.join("<br>"):e},componentType:qt}))}_createEventObservables(e,t){return e?e?.map(n=>(0,u.fromEvent)(t,n,{capture:this._tooltipConfig?.capture})):[]}_createShowEventStream(e){const t=this._createEventObservables(this._tooltipConfig?.showEvent,this._elementRef.nativeElement);return this._ngZone.runOutsideAngular(()=>(0,u.merge)(...t).pipe((0,l.auditTime)(this._delayTime),(0,l.takeUntil)(e)))}_createHideEventStream(e){const t=this._createEventObservables(this._tooltipConfig?.hideEvent,e);return this._ngZone.runOutsideAngular(()=>(0,u.merge)(...t))}_createEventsStream(e,t){this._subscription=t.subscribe(),this._subscription.add(e.subscribe());const n=(0,u.merge)(e,t);n.pipe((0,l.takeUntil)(t));const s=n.subscribe(a=>{if(this._tooltipConfig.showEvent?.includes(a.type)&&this.show(a),this._tooltipConfig.hideEvent?.includes(a.type)){let o=a.relatedTarget;this._overlayRef?.overlayElement.contains(o)||(o=this._elementRef.nativeElement,this.hide(),this._subscription.unsubscribe());const c=this._createHideEventStream(o),d=this._createShowEventStream(c);this._createEventsStream(d,c)}});this._subscription.add(s)}_createKeyboardEvent(){const e=this._ngZone.runOutsideAngular(()=>(0,u.fromEvent)(this._elementRef.nativeElement,"keydown",{capture:this._tooltipConfig?.capture}).pipe((0,l.filter)(n=>this._allowedKeyboardEvent.includes(n.key)))),t=this._ngZone.runOutsideAngular(()=>(0,u.fromEvent)(this._elementRef.nativeElement,"blur",{capture:this._tooltipConfig?.capture}));this._createKeyboardEventsStream(e,t)}_createKeyboardEventsStream(e,t){this._keypressSubscription=t.subscribe();const n=(0,u.merge)(e,t);n.pipe((0,l.takeUntil)(t));const s=n.subscribe(a=>{a instanceof KeyboardEvent?this._onHandleKeyboardEvent(a):a instanceof FocusEvent&&this._onHandleFocusEvent(a)});this._keypressSubscription.add(s)}_onHandleKeyboardEvent(e){switch(e.key){case Un.Key.Enter:e.stopPropagation(),this._overlayRef?.hasAttached()?this.hide():this.show(e);break;case Un.Key.Escape:this._overlayRef?.hasAttached()&&e.stopPropagation(),this.hide(),this._keypressSubscription.unsubscribe(),this._createKeyboardEvent();break;case Un.Key.Tab:this._overlayRef?.hasAttached()&&(this.hide(),this._keypressSubscription.unsubscribe(),this._createKeyboardEvent());break}}_handleScreenReaderEnterEvent(e){e.stopPropagation();const t=document.activeElement===this._elementRef.nativeElement;if(e.isPrimary&&e.buttons===1&&t){const n=new KeyboardEvent("keydown",{key:"Enter",code:"Enter",keyCode:13,charCode:13,bubbles:!0,cancelable:!0});this._onHandleKeyboardEvent(n)}}_onHandleFocusEvent(e){if(e.type!=="blur")return;const t=e.relatedTarget;this._overlayRef?.overlayElement.contains(t)||(this.hide(),this._keypressSubscription.unsubscribe()),this._createKeyboardEvent()}_getPreferredPositions(){return[{originX:"end",originY:"center",overlayX:"start",overlayY:"center",offsetX:0,offsetY:0,panelClass:this._tooltipConfig?.panelClass},{originX:"end",originY:"bottom",overlayX:"center",overlayY:"top",offsetX:0,offsetY:0,panelClass:this._tooltipConfig?.panelClass},{originX:"center",originY:"center",overlayX:"end",overlayY:"top",offsetX:0,offsetY:0,panelClass:this._tooltipConfig?.panelClass}]}_prepareTooltipConfigFromOverlayConfig(e){const t=e.tooltipConfig;return this._tooltipConfig.tooltipConfig&&e.panelClass&&(t.cssClasses=e.panelClass),t}_createOverlay(){if(!this._tooltipConfig)return;const e=this._tooltipConfig?.preferredPositions??this._getPreferredPositions(),t=this._overlayPositionBuilder.flexibleConnectedTo(this._elementRef).withPositions(e),n={scrollStrategy:this._overlay.scrollStrategies.close(),positionStrategy:t};this._tooltipConfig?.width&&Object.assign(n,{width:this._tooltipConfig?.width}),this._tooltipConfig?.height&&Object.assign(n,{height:this._tooltipConfig?.height}),this._overlayRef=this._overlay.create(n),this._tooltipConfig.closeOnOutsideClick&&this._overlayRef.outsidePointerEvents().subscribe(()=>this.hide()),this._overlayRef.keydownEvents().pipe((0,l.filter)(s=>s.key===Un.Key.Escape)).subscribe(()=>{this.hide()})}_subscribeOnClickToHide(){this._ngZone.runOutsideAngular(()=>(0,u.fromEvent)(this._elementRef.nativeElement,T.cn.isMobile?"touchstart":"click").subscribe(e=>{e.ignoreHandle=this._overlayRef?.hasAttached(),this.hide()}))}_normalizeTooltipEvents(e){const t=Array.isArray(e.showEvent)?e.showEvent:[e.showEvent],n=Array.isArray(e.hideEvent)?e.hideEvent:[e.hideEvent];return{...e,showEvent:t,hideEvent:n}}hide(){this._overlayRef?.hasAttached()&&(this._overlayRef.detach(),this._overlayRef.dispose(),this._overlayRef=null)}show(e){if(e.ignoreHandle)return;const t=e.relatedTarget;!this._tooltipConfig||t&&!document.body.contains(t)||(e?.stopPropagation(),this._overlayRef||this._createOverlay(),this._overlayRef.hasAttached()||(this._tooltipRef=this._overlayRef.attach(new Id.ComponentPortal(this._tooltipConfig.componentType))),this._tooltipRef&&(this._tooltipRef.instance.tooltipConfig=this._prepareTooltipConfigFromOverlayConfig(this._tooltipConfig),this._tooltipRef.location.nativeElement.setAttribute("id",this.id)))}ngAfterViewInit(){const e=this._createHideEventStream(this._elementRef.nativeElement),t=this._createShowEventStream(e);this._createEventsStream(t,e),this._createKeyboardEvent(),this._subscribeOnClickToHide()}ngOnDestroy(){this.hide(),this._subscription?.unsubscribe(),this._keypressSubscription?.unsubscribe()}static{this.\u0275fac=function(t){return new(t||Jt)(i.\u0275\u0275directiveInject(Ro.Overlay),i.\u0275\u0275directiveInject(Ro.OverlayPositionBuilder),i.\u0275\u0275directiveInject(i.ElementRef),i.\u0275\u0275directiveInject(i.NgZone))}}static{this.\u0275dir=i.\u0275\u0275defineDirective({type:Jt,selectors:[["","crtTooltip",""]],hostVars:2,hostBindings:function(t,n){t&2&&i.\u0275\u0275classMap(n._class)},inputs:{id:[i.\u0275\u0275InputFlags.None,"crtTooltipId","id"],tooltipConfig:"tooltipConfig",crtTooltip:"crtTooltip"},exportAs:["crtTooltip"]})}}(0,y.__decorate)([re(),(0,y.__metadata)("design:type",String)],Jt.prototype,"id",void 0),(0,y.__decorate)([re(),(0,y.__metadata)("design:type",vr),(0,y.__metadata)("design:paramtypes",[vr])],Jt.prototype,"tooltipConfig",null),(0,y.__decorate)([re(),(0,y.__metadata)("design:type",Object),(0,y.__metadata)("design:paramtypes",[Object])],Jt.prototype,"crtTooltip",null);class Ir{constructor(){this.tooltipId=(0,le.qv)(),this.ariaLabel="",this.type="default",this.tabIndex=0,this.icon="info-icon"}set tooltip(e){e instanceof vr?this._tooltipConfig=e:this._tooltipConfig=this._createTooltipConfig(e)}get tooltip(){return this._tooltipConfig}get tooltipMode(){return{error:"Tooltip.Mode.Error",default:"Tooltip.Mode.Default",none:""}[this.type]||""}get iconClass(){return{error:"invalid-icon",default:"tooltip-icon",none:""}[this.type]||""}_createTooltipConfig(e){return new vr({showEvent:["focus","mouseenter"],hideEvent:["blur","mouseleave"],componentType:qt,tooltipConfig:{value:e},preferredPositions:[{originX:"end",originY:"center",overlayX:"start",overlayY:"center"}]})}static{this.\u0275fac=function(t){return new(t||Ir)}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:Ir,selectors:[["crt-icon-tooltip"]],inputs:{tooltip:"tooltip",ariaLabel:"ariaLabel",type:"type",tabIndex:"tabIndex",icon:"icon"},decls:2,vars:9,consts:[["matSuffix","","crtTooltip","","role","button","aria-hidden","false",3,"crtTooltipId","tooltipConfig","ngClass","svgIcon","tabindex"]],template:function(t,n){t&1&&(i.\u0275\u0275element(0,"mat-icon",0),i.\u0275\u0275pipe(1,"translate")),t&2&&(i.\u0275\u0275property("crtTooltipId",n.tooltipId)("tooltipConfig",n.tooltip)("ngClass",n.iconClass)("svgIcon",n.icon)("tabindex",n.tabIndex),i.\u0275\u0275attribute("aria-label",i.\u0275\u0275pipeBind1(1,7,n.tooltipMode)+" "+n.ariaLabel)("aria-describedby",n.tooltipId))},dependencies:[v.NgClass,G.MatIcon,Jt,m.TranslatePipe],styles:["body[_ngcontent-%COMP%]{--focus-outline-outer-color: var(--crt-palette-secondary-500);--focus-outline-inner-color: white}[_nghost-%COMP%]{height:20px}.mat-icon[_ngcontent-%COMP%]{width:16px;height:16px;padding:2px}.mat-icon[_ngcontent-%COMP%]:focus-visible{box-shadow:inset 0 0 0 1px var(--focus-outline-outer-color),inset 0 0 0 2px var(--focus-outline-inner-color);outline:none;border-radius:4px}"],changeDetection:0})}}function Sg(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"span"),i.\u0275\u0275text(1),i.\u0275\u0275elementEnd()),r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(t.translate("OperationsPoint"))}}function Mg(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"li"),i.\u0275\u0275text(1),i.\u0275\u0275elementEnd()),r&2){const t=e.$implicit;i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(t)}}function vg(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"ol"),i.\u0275\u0275template(1,Mg,2,1,"li",3),i.\u0275\u0275elementEnd()),r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275advance(),i.\u0275\u0275property("ngForOf",t.data==null?null:t.data.byOperations)}}function Ig(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"span"),i.\u0275\u0275text(1),i.\u0275\u0275elementEnd()),r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(t.translate("RecordsPoint"))}}function wg(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"li"),i.\u0275\u0275text(1),i.\u0275\u0275elementEnd()),r&2){const t=e.$implicit;i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(t)}}function Eg(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"ol"),i.\u0275\u0275template(1,wg,2,1,"li",3),i.\u0275\u0275elementEnd()),r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275advance(),i.\u0275\u0275property("ngForOf",t.data==null?null:t.data.byRecords)}}class Oo extends qt{set tooltipConfig(e){this.data=e.value}constructor(e,t,n,s,a){super(e,t),this.directionality=e,this._translateService=n,this._dialogService=s,this._environment=a,this._translatePrefix="ObjectPermissions."}translate(e){return this._translateService.instant(this._translatePrefix+e)}getUrl(){return this._url||(this._url=this._environment.workspaceBaseUrl+"ClientApp/#/AdministratedObjects"),this._url}updateObjectPermissions(){this._dialogService.openConfirmationDialog(this.translate("UpdateObjectPermissionsMessage")).pipe((0,u.map)(e=>{e===ic.result&&this.data.setObjectPermissionsFn(this.data.targetId).subscribe()})).subscribe()}static{this.\u0275fac=function(t){return new(t||Oo)(i.\u0275\u0275directiveInject(At.Directionality),i.\u0275\u0275directiveInject(g.DomSanitizer),i.\u0275\u0275directiveInject(m.TranslateService),i.\u0275\u0275directiveInject(lt),i.\u0275\u0275directiveInject("environment"))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:Oo,selectors:[["crt-object-permissions-warning"]],features:[i.\u0275\u0275InheritDefinitionFeature],decls:17,vars:14,consts:[[4,"ngIf"],["target","_blank",3,"href"],["target","_blank",1,"update-permissions-link",3,"click"],[4,"ngFor","ngForOf"]],template:function(t,n){t&1&&(i.\u0275\u0275elementStart(0,"div")(1,"span"),i.\u0275\u0275text(2),i.\u0275\u0275elementEnd(),i.\u0275\u0275template(3,Sg,2,1,"span",0)(4,vg,2,1,"ol",0)(5,Ig,2,1,"span",0)(6,Eg,2,1,"ol",0),i.\u0275\u0275elementStart(7,"span"),i.\u0275\u0275text(8),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(9,"a",1),i.\u0275\u0275text(10),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(11,"span"),i.\u0275\u0275text(12),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(13,"a",2),i.\u0275\u0275listener("click",function(){return n.updateObjectPermissions()}),i.\u0275\u0275text(14),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(15,"p"),i.\u0275\u0275text(16),i.\u0275\u0275elementEnd()()),t&2&&(i.\u0275\u0275classMapInterpolate1("component-container ",n.cssClasses,""),i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(n.translate("Warning")),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",(n.data==null||n.data.byOperations==null?null:n.data.byOperations.length)>0),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",(n.data==null||n.data.byOperations==null?null:n.data.byOperations.length)>0),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",(n.data==null||n.data.byRecords==null?null:n.data.byRecords.length)>0),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",(n.data==null||n.data.byRecords==null?null:n.data.byRecords.length)>0),i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(n.translate("SetProperPermissionsBegin")),i.\u0275\u0275advance(),i.\u0275\u0275propertyInterpolate("href",n.getUrl(),i.\u0275\u0275sanitizeUrl),i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(n.translate("ObjectPermissions")),i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(n.translate("SetProperPermissionsEnd")),i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(n.translate("Link")),i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(n.translate("End")))},dependencies:[v.NgForOf,v.NgIf],styles:[".component-container[_ngcontent-%COMP%]{min-width:450px;max-width:450px;border-bottom:0px!important}.component-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.component-container[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]{margin:4px;padding-inline-start:20px}.component-container[_ngcontent-%COMP%]   a.update-permissions-link[_ngcontent-%COMP%]{display:block;line-height:40px}"]})}}function xg(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"div"),i.\u0275\u0275text(1),i.\u0275\u0275elementEnd()),r&2){const t=e.$implicit,n=i.\u0275\u0275nextContext();i.\u0275\u0275classMapInterpolate1("rule ",n.getValidationClass(t.valid),""),i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate1(" ",t.caption," ")}}class wr extends qt{set tooltipConfig(e){this.validationTooltipConfig=e.value}constructor(e,t){super(e,t),this.directionality=e}getValidationClass(e){return e?"valid":typeof e=="boolean"?"invalid":"not-validated"}setInnerHTML(){}static{this.\u0275fac=function(t){return new(t||wr)(i.\u0275\u0275directiveInject(At.Directionality),i.\u0275\u0275directiveInject(g.DomSanitizer))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:wr,selectors:[["crt-validation-result-tooltip"]],features:[i.\u0275\u0275InheritDefinitionFeature],decls:5,vars:5,consts:[[1,"header"],[1,"rules"],[3,"class",4,"ngFor","ngForOf"]],template:function(t,n){t&1&&(i.\u0275\u0275elementStart(0,"div")(1,"div",0),i.\u0275\u0275text(2),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(3,"div",1),i.\u0275\u0275template(4,xg,2,4,"div",2),i.\u0275\u0275elementEnd()()),t&2&&(i.\u0275\u0275classMapInterpolate1("component-container ",n.cssClasses,""),i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate1("",n.validationTooltipConfig==null?null:n.validationTooltipConfig.header,":"),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngForOf",n.validationTooltipConfig==null?null:n.validationTooltipConfig.validations))},dependencies:[v.NgForOf],styles:[".component-container[_ngcontent-%COMP%]{max-width:400px;display:flex;flex-direction:column;padding:16px;border-width:1px;border-style:solid}.component-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{text-align:left;font-weight:700;padding-bottom:6px}.component-container[_ngcontent-%COMP%]   .rules[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.component-container[_ngcontent-%COMP%]   .rules[_ngcontent-%COMP%]   .rule[_ngcontent-%COMP%]{width:50%;position:relative;left:24px;text-indent:-24px;padding-right:30px;box-sizing:border-box;margin-bottom:9px}.component-container[_ngcontent-%COMP%]   .rules[_ngcontent-%COMP%]   .rule[_ngcontent-%COMP%]:before{padding-right:8px;top:3px;position:relative}.component-container[_ngcontent-%COMP%]   .rules[_ngcontent-%COMP%]   .rule.valid[_ngcontent-%COMP%]:before{content:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2Ij4KICA8ZyBpZD0iR3JvdXBfMTY1OTUiIGRhdGEtbmFtZT0iR3JvdXAgMTY1OTUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC00ODYgLTU3MikiPgogICAgPHJlY3QgaWQ9IlJlY3RhbmdsZV80MjUxMyIgZGF0YS1uYW1lPSJSZWN0YW5nbGUgNDI1MTMiIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNDg2IDU3MikiIGZpbGw9Im5vbmUiLz4KICAgIDxnIGlkPSJFbGxpcHNlXzMwODciIGRhdGEtbmFtZT0iRWxsaXBzZSAzMDg3IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0ODcgNTczKSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjM2M4MjIzIiBzdHJva2Utd2lkdGg9IjIiPgogICAgICA8Y2lyY2xlIGN4PSI3IiBjeT0iNyIgcj0iNyIgc3Ryb2tlPSJub25lIi8+CiAgICAgIDxjaXJjbGUgY3g9IjciIGN5PSI3IiByPSI2IiBmaWxsPSJub25lIi8+CiAgICA8L2c+CiAgICA8cGF0aCBpZD0iUGF0aF8xMTg3OSIgZGF0YS1uYW1lPSJQYXRoIDExODc5IiBkPSJNMTcuMDkzLDI4LjE4bDIuNSwzLDQuNS01IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0NzMuNDA3IDU1MS4zMikiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzNjODIyMyIgc3Ryb2tlLXdpZHRoPSIyIi8+CiAgPC9nPgo8L3N2Zz4K)}.component-container[_ngcontent-%COMP%]   .rules[_ngcontent-%COMP%]   .rule.invalid[_ngcontent-%COMP%]:before{content:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2Ij4KICA8ZyBpZD0iR3JvdXBfMTY1OTQiIGRhdGEtbmFtZT0iR3JvdXAgMTY1OTQiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC00ODYgLTU3MikiPgogICAgPHJlY3QgaWQ9IlJlY3RhbmdsZV80MjUxMyIgZGF0YS1uYW1lPSJSZWN0YW5nbGUgNDI1MTMiIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNDg2IDU3MikiIGZpbGw9Im5vbmUiLz4KICAgIDxnIGlkPSJFbGxpcHNlXzMwODciIGRhdGEtbmFtZT0iRWxsaXBzZSAzMDg3IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0ODcgNTczKSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjYzIzZjIzIiBzdHJva2Utd2lkdGg9IjIiPgogICAgICA8Y2lyY2xlIGN4PSI3IiBjeT0iNyIgcj0iNyIgc3Ryb2tlPSJub25lIi8+CiAgICAgIDxjaXJjbGUgY3g9IjciIGN5PSI3IiByPSI2IiBmaWxsPSJub25lIi8+CiAgICA8L2c+CiAgICA8cGF0aCBpZD0iUGF0aF8xMTg3NyIgZGF0YS1uYW1lPSJQYXRoIDExODc3IiBkPSJNMTQyOCw0ODF2NiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTE3My41MDkgLTc3MS45ODgpIHJvdGF0ZSg0NSkiIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2MyM2YyMyIgc3Ryb2tlLXdpZHRoPSIyIi8+CiAgICA8cGF0aCBpZD0iUGF0aF8xMTg3OCIgZGF0YS1uYW1lPSJQYXRoIDExODc4IiBkPSJNMTQyOCw0ODF2NiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTg0NS45ODggLTg3LjUwOSkgcm90YXRlKDEzNSkiIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2MyM2YyMyIgc3Ryb2tlLXdpZHRoPSIyIi8+CiAgPC9nPgo8L3N2Zz4K)}.component-container[_ngcontent-%COMP%]   .rules[_ngcontent-%COMP%]   .rule.not-validated[_ngcontent-%COMP%]:before{content:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2Ij4KICA8ZyBpZD0iR3JvdXBfMTY1OTMiIGRhdGEtbmFtZT0iR3JvdXAgMTY1OTMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC00ODYgLTU3MikiPgogICAgPHJlY3QgaWQ9IlJlY3RhbmdsZV80MjUxMyIgZGF0YS1uYW1lPSJSZWN0YW5nbGUgNDI1MTMiIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNDg2IDU3MikiIGZpbGw9Im5vbmUiLz4KICAgIDxnIGlkPSJFbGxpcHNlXzMwODciIGRhdGEtbmFtZT0iRWxsaXBzZSAzMDg3IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0ODcgNTczKSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNzU3NTc1IiBzdHJva2Utd2lkdGg9IjIiPgogICAgICA8Y2lyY2xlIGN4PSI3IiBjeT0iNyIgcj0iNyIgc3Ryb2tlPSJub25lIi8+CiAgICAgIDxjaXJjbGUgY3g9IjciIGN5PSI3IiByPSI2IiBmaWxsPSJub25lIi8+CiAgICA8L2c+CiAgPC9nPgo8L3N2Zz4K)}"]})}}class fn{constructor(e,t){this._domSanitizer=e,this._matIconRegistry=t}addIcons(e){e.forEach(({name:t,icon:n})=>{const s=this._domSanitizer.bypassSecurityTrustHtml(n);this._matIconRegistry.addSvgIconLiteral(t,s)})}static{this.\u0275fac=function(t){return new(t||fn)(i.\u0275\u0275inject(g.DomSanitizer),i.\u0275\u0275inject(G.MatIconRegistry))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:fn,factory:fn.\u0275fac,providedIn:"root"})}}class Pt{constructor(e){this._materialIconsRegistrator=e,this._materialIconsRegistrator.addIcons([{name:"tooltip-icon",icon:h(92825)}])}static{this.\u0275fac=function(t){return new(t||Pt)(i.\u0275\u0275inject(fn))}}static{this.\u0275mod=i.\u0275\u0275defineNgModule({type:Pt})}static{this.\u0275inj=i.\u0275\u0275defineInjector({imports:[v.CommonModule,G.MatIconModule,ct.MatTooltipModule,m.TranslateModule,ut]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&i.\u0275\u0275setNgModuleScope(Pt,{declarations:[Li,qt,Jt,wr,Oo,Ir],imports:[v.CommonModule,G.MatIconModule,ct.MatTooltipModule,m.TranslateModule,ut],exports:[Li,qt,Jt,wr,Ir]})})();class Rt{static{this._visibleMasks=new Set}get maskComponent(){return this.maskComponentRef?.instance}get isVisible(){return!!this.maskComponent?.isVisible}set isVisible(e){e?(this.maskComponent||this.createMaskComponent(),this.maskComponent.isVisible=!0):this.maskComponent&&(this.maskComponent.isVisible=!1)}constructor(e,t){this.document=e,this.ngZone=t,this._defaultMaskDelayMilliseconds=300,this._defaultMinimumMaskDuration=500,this._immediateDisplayAfterHideMaxDelay=50,this._maskShouldBeShown=!1,this._maskShownTimestamp=0,this._maskHiddenTimestamp=0,this.updateMaskStateAttribute()}updateMaskStateAttribute(){const e=this.document?.body;e&&(Rt._visibleMasks.size>0?e.getAttribute("maskstate")!=="visible"&&e.setAttribute("maskstate","visible"):e.getAttribute("maskstate")!=="none"&&e.setAttribute("maskstate","none"))}_internalShow(){this.isVisible||(this.isVisible=!0,Rt._visibleMasks.add(this),this.updateMaskStateAttribute(),this._maskShownTimestamp=Date.now())}_internalHide(){this.isVisible&&(this.isVisible=!1,Rt._visibleMasks.delete(this),this.updateMaskStateAttribute(),this._maskHiddenTimestamp=Date.now())}show(e){this._maskShouldBeShown=!0;const t=Date.now()-this._maskHiddenTimestamp;e?.delay===0||t<this._immediateDisplayAfterHideMaxDelay?this._internalShow():this.ngZone.runOutsideAngular(()=>{setTimeout(()=>{this._maskShouldBeShown&&this.ngZone.run(()=>this._internalShow())},e?.delay||this._defaultMaskDelayMilliseconds)})}hide(){this._maskShouldBeShown=!1;const e=Date.now()-this._maskShownTimestamp;e>=this._defaultMinimumMaskDuration?this._internalHide():this.ngZone.runOutsideAngular(()=>{setTimeout(()=>{this._maskShouldBeShown||this.ngZone.run(()=>this._internalHide())},this._defaultMinimumMaskDuration-e)})}ngOnDestroy(){this.maskComponentRef?.destroy(),this.maskComponentRef=null,Rt._visibleMasks.delete(this)}static{this.\u0275fac=function(t){return new(t||Rt)(i.\u0275\u0275inject(Document),i.\u0275\u0275inject(i.NgZone))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Rt,factory:Rt.\u0275fac})}}const wd=new i.InjectionToken("CRT_MASK_COMPONENT");class Er extends Rt{constructor(e,t,n,s){super(n,s),this._viewContainerRef=e,this._maskComponentType=t,this._tasks=new Set}_setMaskStateAttribute(){const e=this._viewContainerRef?.element.nativeElement.parentElement;if(!e)return;const t=e.getAttribute("maskstate"),n=this.isVisible?"visible":"none";e.setAttribute("aria-busy",this.isVisible?"true":"false"),this.isVisible?e.setAttribute("inert","true"):e.removeAttribute("inert"),t!==n&&e.setAttribute("maskstate",n)}createMaskComponent(){this.maskComponentRef=this._viewContainerRef.createComponent(this._maskComponentType??Ke),this.maskComponentRef.instance.containerized=!0,this.maskComponentRef.instance.isVisible=!1}updateMaskStateAttribute(){super.updateMaskStateAttribute(),this._setMaskStateAttribute()}addTask(e,t){return this.shouldShow!==!1&&(this._tasks.add(e),this.show(t??this.settings)),e}removeTask(e){this.shouldShow!==!1&&(this._tasks.delete(e),this._tasks.size===0&&this.hide())}clearTasks(){this.shouldShow!==!1&&this._tasks.size>0&&(this._tasks.clear(),this.hide())}static{this.\u0275fac=function(t){return new(t||Er)(i.\u0275\u0275directiveInject(i.ViewContainerRef),i.\u0275\u0275directiveInject(wd,8),i.\u0275\u0275directiveInject(v.DOCUMENT),i.\u0275\u0275directiveInject(i.NgZone))}}static{this.\u0275dir=i.\u0275\u0275defineDirective({type:Er,selectors:[["","crtMask",""]],inputs:{shouldShow:[i.\u0275\u0275InputFlags.None,"crtMask","shouldShow"],settings:[i.\u0275\u0275InputFlags.None,"crtMaskSettings","settings"]},features:[i.\u0275\u0275InheritDefinitionFeature]})}}class _n{static{this.\u0275fac=function(t){return new(t||_n)}}static{this.\u0275mod=i.\u0275\u0275defineNgModule({type:_n})}static{this.\u0275inj=i.\u0275\u0275defineInjector({imports:[v.CommonModule,Tt.MatProgressSpinnerModule,m.TranslateModule]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&i.\u0275\u0275setNgModuleScope(_n,{declarations:[Ke,Er],imports:[v.CommonModule,Tt.MatProgressSpinnerModule,m.TranslateModule],exports:[Ke,Er]})})();var yn=h(92011),Ed=h(90824);class dt{static{this.\u0275fac=function(t){return new(t||dt)}}static{this.\u0275mod=i.\u0275\u0275defineNgModule({type:dt})}static{this.\u0275inj=i.\u0275\u0275defineInjector({imports:[v.CommonModule,Z.FormsModule,$.MatLegacyButtonModule,yn.MatDatepickerModule,dr.MatDatetimepickerModule,ee.MatLegacyFormFieldModule,G.MatIconModule,me.MatLegacyInputModule,Ed.MatMomentDatetimeModule]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&i.\u0275\u0275setNgModuleScope(dt,{declarations:[mn],imports:[v.CommonModule,Z.FormsModule,$.MatLegacyButtonModule,yn.MatDatepickerModule,dr.MatDatetimepickerModule,ee.MatLegacyFormFieldModule,G.MatIconModule,me.MatLegacyInputModule,Ed.MatMomentDatetimeModule],exports:[mn]})})();var ki=h(59445),Mt=h(44059),Vo=h(6675),qe=h(55231),zn=h(67047),Lo=h(42828),sc=h(27397);const xd="module",Td="viewElement",Ad="mobileViewElement",rc="interfaceDesignerItem",ac="mobileInterfaceDesignerItem",Dd="requestHandler",Nd="designTimeViewElement",Pd="validator",Rd="converter";function Tg(r,e){Reflect.defineMetadata(xd,r,e)}function Ag(r){const e=Reflect.getMetadata(xd,r);if(!e)throw new Error(`Module metadata was not found on '${r.name}' class`);return e}function Dg(r,e){Reflect.defineMetadata(Td,r,e)}function Ng(r,e){Reflect.defineMetadata(Ad,r,e)}function MS(r){return Reflect.getMetadata(Td,r)}function vS(r){return Reflect.getMetadata(Ad,r)}function IS(r,e){Reflect.defineMetadata(Pd,r,e)}function wS(r){const e=Reflect.getOwnMetadata(Pd,r);if(!e)throw new Error(`Validator metadata was not found on '${r.name}' class`);return e}function Pg(r,e){Reflect.defineMetadata(Rd,r,e)}function ES(r){const e=Reflect.getOwnMetadata(Rd,r);if(!e)throw new Error(`Converter metadata was not found on '${r.name}' class`);return e}function Rg(r,e){Reflect.defineMetadata(rc,r,e)}function Og(r,e){Reflect.defineMetadata(ac,r,e)}function xS(r){return Reflect.getOwnMetadata(rc,r)}function TS(r){return Reflect.getOwnMetadata(ac,r)}function AS(r,e){Reflect.defineMetadata(Nd,r,e)}function DS(r){const e=Reflect.getOwnMetadata(Nd,r);if(!e)throw new Error(`Design time view element metadata was not found on '${r.name}' class`);return e}function NS(r){return Reflect.hasOwnMetadata(rc,r)}function PS(r){return Reflect.hasOwnMetadata(ac,r)}function Vg(r,e){Reflect.defineMetadata(Dd,r,e)}function RS(r){const e=Reflect.getMetadata(Dd,r);if(!e)throw new Error(`Request handler metadata was not found on '${r.name}' class`);return e}function OS(r){const e=Reflect.getMetadata("requestType",r);if(!e)throw new Error(`requestType was not found on '${r.name}' class`);return{requestType:e,typeRef:r}}function Lg(r){const t=Reflect.getMetadataKeys(r).filter(n=>n.startsWith(ec));return Object.fromEntries(t.map(n=>{const s=Reflect.getMetadata(n,r);return[n.replace(ec,""),s]}))}function kg(r){const t=Reflect.getMetadataKeys(r).filter(n=>n.startsWith(tc));return Object.fromEntries(t.map(n=>{const s=Reflect.getMetadata(n,r);return[n.replace(tc,""),s]}))}function jg(r){const t=Reflect.getMetadataKeys(r).filter(n=>n.startsWith(Sd));return Object.fromEntries(t.map(n=>{const s=Reflect.getMetadata(n,r);return[n.replace(Sd,""),s]}))}function Fg(r){const t=Reflect.getOwnMetadataKeys(r).filter(n=>n.startsWith(crtInjectPrefix));return Object.fromEntries(t.map(n=>{const s=Number(n.replace(crtInjectPrefix,"")),a=Reflect.getMetadata(n,r);return[s,a]}))}function Bg(r){const e=r.prototype?Object.getPrototypeOf(r.prototype):null;return e?e.constructor:null}function Ug(r){const e=Reflect.getOwnMetadata("design:paramtypes",r);if(!e){if(r.length>0)throw new Error(`Dependency Injection error. Cannot read dependencies of class '${r.name}'. Please make sure class '${r.name}' has decorator and 'emitDecoratorMetadata' option is enabled in your 'tsconfig.json' file.`);const n=Bg(r);return n&&n!==Object?Ug(n):[]}const t=Fg(r);return Object.entries(t).forEach(([n,s])=>e[n]=s),e}function Od(r){return e=>Tg(r,e)}function zg(r,e){if(r&1&&i.\u0275\u0275element(0,"mat-icon",5),r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275property("svgIcon",t.icon)}}function Hg(r,e){if(r&1&&i.\u0275\u0275element(0,"mat-icon",10),r&2){const t=i.\u0275\u0275nextContext().$implicit;i.\u0275\u0275property("svgIcon",t==null?null:t.icon)}}function Wg(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"button",8),i.\u0275\u0275listener("click",function(s){const a=i.\u0275\u0275restoreView(t).$implicit,o=i.\u0275\u0275nextContext(2);return i.\u0275\u0275resetView(o.onActionClick(a==null?null:a.handler,s))}),i.\u0275\u0275template(1,Hg,1,1,"mat-icon",9),i.\u0275\u0275elementStart(2,"span"),i.\u0275\u0275text(3),i.\u0275\u0275elementEnd()()}if(r&2){const t=e.$implicit;i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",t==null?null:t.icon),i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(t==null?null:t.caption)}}function $g(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"div",6),i.\u0275\u0275template(1,Wg,4,2,"button",7),i.\u0275\u0275elementEnd()),r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275advance(),i.\u0275\u0275property("ngForOf",t.actions)}}function Gg(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"button",11),i.\u0275\u0275pipe(1,"translate"),i.\u0275\u0275listener("click",function(s){i.\u0275\u0275restoreView(t);const a=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(a.onClose(s))}),i.\u0275\u0275element(2,"mat-icon",12),i.\u0275\u0275elementEnd()}r&2&&i.\u0275\u0275attribute("aria-label",i.\u0275\u0275pipeBind1(1,1,"Dialog.Close"))}class ji{constructor(e,t){this.snackBarRef=e,this.data=t,this.message=t.message,this.actions=t.actions,this.closeMode=t.closeMode,this.icon=t.icon}onClose(e){e?.stopPropagation(),this.snackBarRef.dismiss()}onActionClick(e,t){var n=this;return(0,f.A)(function*(){yield e?.call(n,t),n.snackBarRef.dismiss()})()}static{this.\u0275fac=function(t){return new(t||ji)(i.\u0275\u0275directiveInject(b.MatLegacySnackBarRef),i.\u0275\u0275directiveInject(b.MAT_LEGACY_SNACK_BAR_DATA))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:ji,selectors:[["ts-notify"]],decls:7,vars:6,consts:[[1,"crt-notify-container"],["class","crt-notify-icon",3,"svgIcon",4,"ngIf"],["data-qa","notificationPopup",1,"crt-notify-message"],["class","crt-notify-actions",4,"ngIf"],["mat-flat-button","","class","crt-notify-close-button-icon","type","button",3,"click",4,"ngIf"],[1,"crt-notify-icon",3,"svgIcon"],[1,"crt-notify-actions"],["type","button","mat-flat-button","",3,"click",4,"ngFor","ngForOf"],["type","button","mat-flat-button","",3,"click"],["class","crt-notify-action-button-icon",3,"svgIcon",4,"ngIf"],[1,"crt-notify-action-button-icon",3,"svgIcon"],["mat-flat-button","","type","button",1,"crt-notify-close-button-icon",3,"click"],["svgIcon","icon_close_24"]],template:function(t,n){t&1&&(i.\u0275\u0275elementStart(0,"div",0),i.\u0275\u0275template(1,zg,1,1,"mat-icon",1),i.\u0275\u0275elementStart(2,"output",2),i.\u0275\u0275text(3),i.\u0275\u0275pipe(4,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275template(5,$g,2,1,"div",3)(6,Gg,3,3,"button",4),i.\u0275\u0275elementEnd()),t&2&&(i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",n.icon),i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(4,4,n.message)),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",n.actions==null?null:n.actions.length),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",n.closeMode!=="auto"))},dependencies:[v.NgForOf,v.NgIf,$.MatLegacyButton,G.MatIcon,m.TranslatePipe],styles:[".crt-notify-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center}.crt-notify-container[_ngcontent-%COMP%]   .crt-notify-message[_ngcontent-%COMP%]{flex:1}.crt-notify-container[_ngcontent-%COMP%]   .crt-notify-icon[_ngcontent-%COMP%]{width:16px;margin-inline-end:8px}.crt-notify-container[_ngcontent-%COMP%]   .crt-notify-close-button-icon[_ngcontent-%COMP%]{padding:0;min-width:initial;margin-inline-start:16px}.crt-notify-container[_ngcontent-%COMP%]   .crt-notify-actions[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;margin-inline-start:40px}.crt-notify-container[_ngcontent-%COMP%]   .crt-notify-actions[_ngcontent-%COMP%]   .crt-notify-action-button-icon[_ngcontent-%COMP%]{width:16px;margin-inline-end:4px}"]})}}class Fi{constructor(e,t,n){this._snackBar=e,this._zone=t,this._environment=n,this._defaultDuration=this._environment?.defaultNotifyPopupDuration||5e3}show(e){const{message:t,duration:n,panelClass:s,icon:a,closeMode:o="default",actions:c=[]}=e||{},d=s?Array.isArray(s)?s:[s]:[],p=this._zone.run(()=>this._snackBar.openFromComponent(ji,{data:{message:t,actions:c,closeMode:o,icon:a},duration:o==="manual"?0:n??this._defaultDuration,verticalPosition:"bottom",panelClass:["crt-notify",...d]}));return Promise.resolve(p)}error({message:e,duration:t}){return this.show({message:e,duration:t,panelClass:"notify-service-error"})}warn({message:e,duration:t}){return this.show({message:e,duration:t,panelClass:"notify-service-warn"})}info({message:e,duration:t}){return this.show({message:e,duration:t,panelClass:"notify-service-info"})}static{this.\u0275fac=function(t){return new(t||Fi)(i.\u0275\u0275inject(b.MatLegacySnackBar),i.\u0275\u0275inject(i.NgZone),i.\u0275\u0275inject("environment",8))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Fi,factory:Fi.\u0275fac})}}class Bi{constructor(e){this._materialIconsRegistrar=e,this._materialIconsRegistrar.addIcons([{name:"icon_close_24",icon:h(26242)}])}static{this.\u0275fac=function(t){return new(t||Bi)(i.\u0275\u0275inject(fn))}}static{this.\u0275mod=i.\u0275\u0275defineNgModule({type:Bi})}static{this.\u0275inj=i.\u0275\u0275defineInjector({providers:[Fi],imports:[v.CommonModule,$.MatLegacyButtonModule,G.MatIconModule,b.MatLegacySnackBarModule,m.TranslateModule]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&i.\u0275\u0275setNgModuleScope(Bi,{declarations:[ji],imports:[v.CommonModule,$.MatLegacyButtonModule,G.MatIconModule,b.MatLegacySnackBarModule,m.TranslateModule],exports:[ji]})})();var Ui=h(14276);const Zg={macrosName:"ResourceString",macrosHandler:function(r,e){if(!r)throw new Error("Context is not defined");if(!r.Resources?.Strings)throw new Error("Context does not contain property Resources.Strings");const t=r.Resources.Strings[e[0]];return t instanceof Promise?(0,u.from)(t):(0,u.of)(t)}};function Yg(r){return{macrosName:"ResourceString",macrosHandler:function(e,t){if(e?.strings){for(const n of t){const s=e.strings[n];if(s)return(0,u.of)(r.findLocalizableValue(s))}throw new Error(`Localized resource string not found. ${t}`)}if(e?.Strings){for(const n of t){const s=e.Strings[n];if(s)return(0,u.from)(s)}throw new Error(`Localized string in ViewModel metadata not found. ${t}`)}return Zg.macrosHandler(e,t)}}}function Kg(r=!1){return{macrosName:"DataSourceEntityName",macrosHandler:(e,t)=>{if(!e)throw new Error("Context is not defined");let n=t[0],s;if(r)e.constructor.name==="BaseViewModel"?s=e.dataSchemas?.[n]?.dataSourceConfig?.config?.entitySchemaName:s=e.modelConfig?.dataSources?.[n]?.config?.entitySchemaName;else{n||(n=e.modelConfig.primaryDataSourceName);const a=e.modelConfig.dataSources?.[n];if(!a)throw new Error(`DataSource '${n}' is not defined`);s=a.config.entitySchemaName}return(0,u.of)(s)}}}function qg(r,e=!1){return{macrosName:"MacrosTemplateString",macrosHandler:(t,n)=>{const s=n.join(", "),a=/\[#([^\]]*)#\]/.test(s);return e||!a?(0,u.of)(s):r.getTemplate(s)}}}const ko=new i.InjectionToken("MACROS_HANDLER");function Vd(r){return r===null||typeof r!="object"?[]:Object.keys(r).filter(e=>r[e]instanceof Object).map(e=>Vd(r[e]).map(t=>[e,...t])).reduce((e,t)=>[...e,...t],Object.keys(r).map(e=>[e]))}function Ld(r,e){return Object.keys(r).every(t=>Object.prototype.hasOwnProperty.call(e,t)?typeof r[t]=="object"?Jg(r[t],e[t]):!0:!1)}function Jg(r,e){return Ld(r,e)&&Ld(e,r)}function Qg(r,e){const t=Array.isArray(e)?e:e.split(".");let n=r;for(const s of t)if(n instanceof Map)n=n.get(s);else if(n&&typeof n=="object")n=n[s];else return;return n}function VS(r){const e=JSON.stringify(r);let t=5381;for(let n=0;n<e.length;n++)t=(t<<5)+t+e.charCodeAt(n);return t.toString(16)}class Xe{static create(e){const t=new Xe;return Object.assign(t,e),t}get isDebugEnabled(){return!!window.Terrasoft?.isDebug}static{this.\u0275fac=function(t){return new(t||Xe)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Xe,factory:Xe.\u0275fac,providedIn:"root"})}}class zi{constructor(e,t,n){this.handlers=e,this._featureValues=t,this._applicationInfo=n}get _includeProcessedHandlers(){return!!this._featureValues?.IncludeProcessedMacrosHandlers}_findClosingBracket(e,t){let n=t,s=1;for(;s>0&&n<e.length;){const a=e[++n];a==="("?s++:a===")"&&s--}return n}_getMacroses(e){const t=new Array;let n=e.indexOf("#");for(;n>=0;){const s=e.indexOf("(",n);if(s<0)return t;const a=this._findClosingBracket(e,s),o=e.indexOf("#",a);if(o<0)return t;t.push({macrosName:e.substring(n+1,s),macrosArgs:e.substring(s+1,a),macrosBody:e.substring(n,o+1)}),n=e.indexOf("#",o+1)}return t}_processMacroses({macroses:e,macrosNameFilter:t,context:n,options:s,value:a}){let o={...a};const c=d=>!!(t&&t!==d&&t.split(",").indexOf(d)===-1);return(0,u.forkJoin)({...e.map(({macrosName:d,macrosArgs:p,macrosBody:C})=>{if(c(d))return(0,u.of)(null);const I=this.getHandler(d);return I?this.internalHandle(p,n,t,s).pipe((0,l.switchMap)(O=>{const Y=I(n,`${O.value}`.split(",").map(te=>te.trim()));return(Y instanceof u.Observable?Y:(0,u.of)(Y)).pipe((0,l.catchError)(te=>(this._applicationInfo.isDebugEnabled&&console.warn(te),(0,u.of)(C))),(0,l.tap)(te=>{const se=typeof te=="number"?te:te||"";o={isChanged:!0,value:o.value.replace(C,se)}}))}),(0,l.catchError)(O=>(s&&s.errorHandler?s.errorHandler(O):this._applicationInfo.isDebugEnabled&&console.warn(O),(0,u.of)(C)))):(0,u.of)(null)}),default:(0,u.of)(null)}).pipe((0,l.map)(()=>o))}_forEachStringInObject(e,t,n=[],s=[]){if(!(e instanceof Object))return;const a=c=>!n.includes(c),o=(c,d)=>{typeof c=="string"?t(s.concat(d),c):typeof c=="object"&&c!==null&&(s.push(d),this._forEachStringInObject(c,t,n,s),s.pop())};if(e instanceof Map)for(const c of Array.from(e.keys()).filter(a))o(e.get(c),c);else Object.keys(e).filter(a).forEach(c=>{o(e[c],c)})}_set(e,t,n){const s=t.slice(),a=s.pop(),o=s.length===0?e:Qg(e,s);o&&(o[a]=n)}getHandler(e){return this.handlers.filter(t=>t.macrosName===e).pop()?.macrosHandler}internalHandle(e,t,n,s){const a={value:e,isChanged:!1};return(0,u.of)(a).pipe((0,l.switchMap)(c=>{if(typeof e!="string")return(0,u.of)(c);const d=this._getMacroses(e);return d.length?this._processMacroses({macroses:d,macrosNameFilter:n,context:t,options:s,value:a}):(0,u.of)(c)}))}handle(e,t){const n=(0,M.cloneDeep)(e);return(0,u.forkJoin)([...Vd(n).map(s=>{const a=(0,M.get)(n,s);return this.internalHandle(a,t).pipe((0,l.tap)(({value:o})=>{(0,M.set)(n,s,o)}))}),(0,u.of)(null)]).pipe((0,l.map)(()=>n))}handleMarcos(...e){return this.handleMacros.call(this,...e)}handleResourceMacros(e,t,n){return this.handleMacros("MacrosTemplateString,ResourceString",(0,M.cloneDeep)(e),t,n)}handleMacros(e,t,n,s){const a=[(0,u.of)(null)];return this._forEachStringInObject(t,(o,c)=>{const d=this._getMacroses(c);if(!d.length)return;const p=this._processMacroses({macroses:d,context:n,options:s,macrosNameFilter:e,value:{isChanged:!1,value:c}}).pipe((0,l.tap)(C=>{C.isChanged!==!1&&(s?.setPropertyFn?s.setPropertyFn({source:t,keys:o,value:C.value}):this._set(t,o,C.value))}));a.push(p)},this._includeProcessedHandlers?[]:["__preprocessed"]),(0,u.forkJoin)(a).pipe((0,l.map)(()=>t))}static{this.\u0275fac=function(t){return new(t||zi)(i.\u0275\u0275inject(ko),i.\u0275\u0275inject(fe,8),i.\u0275\u0275inject(Xe))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:zi,factory:zi.\u0275fac})}}var Hi;(function(r){r.string="Strings",r.image="Images"})(Hi||(Hi={}));const xr="Resources";class Wi extends Array{constructor(e){super(),Object.setPrototypeOf(this,Object.create(Wi.prototype)),Array.isArray(e)&&this._fillFromSource(e)}_fillFromSource(e){e.filter(t=>t?.cultureName!=null).forEach(t=>{this.setValueLocalizableString(t.cultureName,t.value)})}getValue(e){const t=this.getLocalizableString(e);return t?t.value:""}hasCultureValue(e,t=!1){const n=this.getLocalizableString(e);return t?(n?.value||null)!=null:n?.value!=null}getLocalizableString(e){return this.find(t=>t.cultureName===e)||null}setValueLocalizableString(e,t){const n=this.getLocalizableString(e);return n?n.value=t:this.push({cultureName:e,value:t}),this}setValues(e,t=!1){return e.forEach(n=>{this.hasCultureValue(n.cultureName)&&t||this.setValueLocalizableString(n.cultureName,n.value)}),this}clone(){return new Wi(this)}}class Hn{constructor(e){this.userInfo=e,this._resourceMacrosRegExpPattern="(?<macrosBody>#ResourceString\\((?<macrosArgs>[^)]*)\\)#)",this._viewModelAttributeRegExpPattern=`\\$${xr}.${Hi.string}.(?<macrosArgs>[\\S\\s]*)`,this._sysCultureName=this.userInfo.cultureInfo.sysCultureName,this._defCultureName=this.userInfo.defCultureInfo.sysCultureName}_getLczResource(e){const t={};return e.forEach(n=>t[n.cultureName]=n.value),t}_getResourceValueMatches(e){const t=new RegExp(this._resourceMacrosRegExpPattern,"g"),n=new RegExp(this._viewModelAttributeRegExpPattern,"g");let s=[...(e??"").matchAll(n)];return s.length||(s=[...(e??"").matchAll(t)]),s}_findStringPropertyResource(e,t){const{resourceName:n,useMacrosTemplate:s}=this.findResourcesName(e);if(n)return{path:t,resourceName:n,useMacrosTemplate:s}}_findArrayPropertyResources(e,t=""){return e.flatMap((n,s)=>this.findPropertyResources(n,t?`${t}.${s}`:`${s}`))}_findObjectPropertyResources(e,t=""){return Object.entries(e).flatMap(([n,s])=>this.findPropertyResources(s,t?`${t}.${n}`:n))}findLocalizableValue(e){if(typeof e=="string")return e;if(!e||typeof e!="object")return null;let t;return Array.isArray(e)?t=e?.filter(n=>n.value).reduce((n,s)=>Object.assign(n,{[s.cultureName]:s.value}),{}):t=e,(t[this._sysCultureName]??t[this._defCultureName])?.toString()??null}findResourcesName(e){const n=this._getResourceValueMatches(e)[0]?.groups.macrosArgs,s=e?.startsWith("#MacrosTemplateString");return{resourceName:n,useMacrosTemplate:s}}findLocalizationFromResourceString(e,t,n=""){const{resourceName:s}=this.findResourcesName(e),a=s!==void 0&&t.strings[s];if(a){const d=Object.entries(a).map(([p,C])=>({cultureName:p,value:C}));return new Wi(d)}const o=s===void 0&&e||n,c=this._sysCultureName||this._defCultureName;return new Wi([{cultureName:c,value:o}])}findValueFromResource(e,t){const n=this.findLocalizationFromResourceString(e,t),s=this._getLczResource(n);return this.findLocalizableValue(s)}findViewModelResourceValue(e,t,n){var s=this;return(0,f.A)(function*(){const{resourceName:a}=s.findResourcesName(e);let o;return a&&(o=yield t.Strings[a]),o||n||e})()}findPropertyResources(e,t=""){return e?Array.isArray(e)?this._findArrayPropertyResources(e,t):typeof e=="object"?this._findObjectPropertyResources(e,t):typeof e=="string"?[this._findStringPropertyResource(e,t)].filter(Boolean):[]:[]}static{this.\u0275fac=function(t){return new(t||Hn)(i.\u0275\u0275inject(We.oq))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Hn,factory:Hn.\u0275fac,providedIn:"root"})}}class Tr{constructor(e){this._httpClient=e,this._serviceEndpoint="rest/MacrosHelperService"}static isMacros(e){return typeof e!="string"?!1:e?.startsWith("#")??!1}getTemplate(e,t){return this.getTemplateByEntity({textTemplate:e},t)}getTemplateByEntity(e,t){const n=`${this._serviceEndpoint}/GetTemplate`;return this._httpClient.post(n,{request:e}).pipe((0,l.map)(s=>{const a=s?.GetTemplateResult;return a?.success?t?a.textTemplate:a.textTemplate.replace(/\s?<.+?>(.+?)<(.+?)\/?(.+?)>/g,""):e.textTemplate}))}getMultiLanguageTemplate(e,t,n){const s=`${this._serviceEndpoint}/GetMultiLanguageTextTemplate`;return this._httpClient.post(s,{request:{entityId:e,entityName:t,templateId:n}}).pipe((0,l.map)(a=>a?.GetMultiLanguageTextTemplateResult))}static{this.\u0275fac=function(t){return new(t||Tr)(i.\u0275\u0275inject(P.HttpClient))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Tr,factory:Tr.\u0275fac,providedIn:"root"})}}const Wn=new i.InjectionToken("IS_DESIGN_TIME");class $i{static{this.\u0275fac=function(t){return new(t||$i)}}static{this.\u0275mod=i.\u0275\u0275defineNgModule({type:$i})}static{this.\u0275inj=i.\u0275\u0275defineInjector({providers:[zi,{provide:ko,useFactory:Yg,deps:[Hn],multi:!0},{provide:ko,useFactory:Kg,deps:[[new i.Optional,Wn]],multi:!0},{provide:ko,useFactory:qg,deps:[Tr,[new i.Optional,Wn]],multi:!0}],imports:[v.CommonModule]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&i.\u0275\u0275setNgModuleScope($i,{imports:[v.CommonModule]})})();class Gi{constructor(e,t){this.caption="",e.addSvgIconLiteral("placeholder",t.bypassSecurityTrustHtml(h(49967)))}static{this.\u0275fac=function(t){return new(t||Gi)(i.\u0275\u0275directiveInject(G.MatIconRegistry),i.\u0275\u0275directiveInject(g.DomSanitizer))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:Gi,selectors:[["crt-view-element-placeholder"]],inputs:{caption:"caption"},decls:4,vars:1,consts:[[1,"placeholder-container"],["svgIcon","placeholder",1,"icon"]],template:function(t,n){t&1&&(i.\u0275\u0275elementStart(0,"div",0),i.\u0275\u0275element(1,"mat-icon",1),i.\u0275\u0275elementStart(2,"span"),i.\u0275\u0275text(3),i.\u0275\u0275elementEnd()()),t&2&&(i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate(n.caption))},dependencies:[G.MatIcon],styles:[".placeholder-container[_ngcontent-%COMP%]{display:flex;width:100%;height:100%;align-content:center;justify-content:center;border-radius:8px;position:relative;overflow:hidden}.placeholder-container[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{height:100%;max-height:64px;width:72px;align-self:center}.placeholder-container[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;top:50%;left:8px;right:8px;transform:translateY(-50%);overflow:hidden;width:calc(100% - 16px);text-overflow:ellipsis}@supports (background: -webkit-named-image(i)){.placeholder-container[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:initial;height:initial}}"]})}}class Cn{static{this.\u0275fac=function(t){return new(t||Cn)}}static{this.\u0275mod=i.\u0275\u0275defineNgModule({type:Cn})}static{this.\u0275inj=i.\u0275\u0275defineInjector({imports:[v.CommonModule,G.MatIconModule]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&i.\u0275\u0275setNgModuleScope(Cn,{declarations:[Gi],imports:[v.CommonModule,G.MatIconModule],exports:[Gi]})})();const Xg=new i.InjectionToken("A factory of expression interpreter");var Re;(function(r){r.ChangeAttributeValue="change-attribute-value",r.ModelDataLoaded="model-data-loaded-event",r.BeforeModelLoad="before-model-load",r.LoadDefaultValues="load-default-values",r.StartLoadModelAttributes="start-load-model-attributes",r.FinishLoadModelAttributes="finish-load-model-attributes",r.ViewEvent="view-event"})(Re||(Re={}));function Ar(r,e){return oc.apply(this,arguments)}function oc(){return oc=(0,f.A)(function*(r,e){const t=typeof e=="string"?e.split("."):e;let n=t.shift(),s=r;for(;n;)s=yield s[n],n=t.shift();return s}),oc.apply(this,arguments)}const $n=Symbol("InternalViewModelInjector");class Dr extends Error{constructor(e){super(`Argument with name '${e}' is out of range.`)}}class et{constructor(e){this._featureValues=e,this._consequentMeasureStartTimeCorrection=.001,this._lastNowStartTime=0,this.rendering$=new u.BehaviorSubject(null),this._useMeasurePerformanceTools=this._featureValues?.UseMeasurePerformanceTools}_getNowStartTimeWithCorrection(){const e=performance.now(),t=e<=this._lastNowStartTime?this._lastNowStartTime+this._consequentMeasureStartTimeCorrection:e;return this._lastNowStartTime=t,t}measure(e,t,n){if(!this._useMeasurePerformanceTools)return t();const s=n||this._getNowStartTimeWithCorrection(),a=t();return performance.measure(e,{start:s}),a}measureCallback(e,t){var n=this;return(0,f.A)(function*(){if(!n._useMeasurePerformanceTools)return t();const s=n._getNowStartTimeWithCorrection(),a=yield t();return performance.measure(e,{start:s}),a})()}measure$(e){if(!this._useMeasurePerformanceTools)return n=>n;let t;return n=>(0,u.of)(null).pipe((0,l.tap)(()=>t=this._getNowStartTimeWithCorrection()),(0,u.switchMap)(()=>n),(0,l.tap)(()=>{const s=typeof e=="string"?e:e();performance.measure(s,{start:t})}))}static{this.\u0275fac=function(t){return new(t||et)(i.\u0275\u0275inject(fe,8))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:et,factory:et.\u0275fac,providedIn:"root"})}}var U;(function(r){r.Init="init",r.Create="create",r.Update="update",r.Copy="copy",r.Delete="delete",r.Unknown="unknown"})(U||(U={}));const jo=new i.InjectionToken("SCOPE_NAME"),ef=new i.InjectionToken("VIEW_EVENT_ZONE_NAME"),tf=new i.InjectionToken("INJECTION_CONTEXT");class tt extends Array{constructor(...e){return super(),this._itemsChanged=new u.Subject,this._itemAttributeChanged=new u.Subject,this._destroyed$=new u.Subject,this._changed=new u.Subject,this._trackChanges=!0,this._createdItems=[],this._deletedItems=[],this._isDestroyed=!1,typeof e[0]=="number"?new Array(e[0]):([this._viewModelGenerator,this._viewModelConfig={},this._model,this._host,this._hostAttributeName]=e,this._measurePerformanceService=this._host?.[$n]?.get(et,null,{optional:!0}),this._featureValues=this._host?.[$n]?.get(fe,{},{optional:!0})??{},this._ngZone=this._host?.[$n]?.get(i.NgZone,null,{optional:!0}),Object.setPrototypeOf(this,Object.create(tt.prototype)),this._subscribeItemsModelModesChanges(),this._subscribeItemsAttributesChanges(),new Proxy(this,{set:(t,n,s,a)=>{const o=t[n];return t[n]=s,this._trackChanges&&(n==="length"&&s!==o?this._onItemsChanged():isNaN(parseInt(n))||this._onItemsChanged()),!0}}))}get changed(){return this._changed.asObservable().pipe((0,T.BV)(this._ngZone),(0,l.takeUntil)(this._destroyed$))}get itemAttributeChanged(){return this._itemAttributeChanged.asObservable().pipe((0,l.takeUntil)(this._destroyed$))}get isChanged(){return this.getChangedItems().length>0}get formApiModel(){return this._formApiModel||this._updateFormApiModelValues({emitEvent:!1}),this._formApiModel}_isItemPrimaryAttributeEqual(e,t){return(0,f.A)(function*(){if(!e)return!1;const n=yield e[e.primaryAttributeName];return t.includes(n)})()}_insertItem(e,t){typeof t!="number"&&(t=this.length),t=Math.max(t,0),t=Math.min(t,this.length),this.splice(t,0,e)}_generateItem(e){const t=()=>{const n=this._model?.createCollectionItemModel(U.Create),s=this._host?.[$n],a=this._viewModelGenerator.generate({viewModelConfig:this._viewModelConfig,modelConfig:n?{primaryDataSourceName:n.name}:void 0,models:n?[n]:void 0,parentViewModel:this._host,businessRulesActive:e.businessRulesActive??!1},s?i.Injector.create({providers:[{provide:jo,useValue:null}],parent:s}):null).pipe((0,l.tap)(o=>{n?.name&&(o.dataSchemas[n.name]=this._host.dataSchemas[n.name])}),(0,l.switchMap)(o=>n?.name?o.create(n.name,e.initialModelValues).pipe((0,l.map)(()=>o)):(0,u.of)(o)),(0,l.tap)(o=>{Object.entries(e.initialAttributeValues??{}).forEach(([c,d])=>o[c]=d),o._markAsPristine(e.initialAttributeValues??{}),this._model?.childrenChange()}));return(0,u.lastValueFrom)(a)};return this._measurePerformanceService?this._measurePerformanceService.measureCallback("ViewModelCollection.generateItem",()=>t()):t()}_mergeItems(e,t){const n=()=>{const s=(e[0]||t[0])?.primaryAttributeName;for(const a of t){const o=e.findIndex(c=>{const d=c.attributes?.[s],p=a.attributes?.[s];return d&&d===p});o===-1?e.push(a):e.splice(o,1,a)}return e};return this._measurePerformanceService?this._measurePerformanceService.measure("ViewModelCollection.mergeItems",()=>n()):n()}_triggerChangesAfter(e){this._trackChanges=!1;const t=e.call(this);return this._trackChanges=!0,this._isDestroyed||this._onItemsChanged(),t}_onItemsChanged(){const e=this.map(t=>({item:t,itemModelMode:t?.getPrimaryModelMode?.()}));this._updateCollectionState(e,!0)}_subscribeItemsModelModesChanges(){this._itemsChanged.pipe((0,l.switchMap)(()=>this._getItemsModelModesChanges()),(0,l.tap)(e=>this._updateCollectionState([e],!1)),(0,l.takeUntil)(this._destroyed$)).subscribe()}_subscribeItemsAttributesChanges(){this._itemsChanged.pipe((0,l.switchMap)(()=>this._getItemsAttributesChanges()),(0,l.filter)(e=>!e.payload.silent),(0,l.tap)(()=>this._itemAttributeChanged.next()),(0,l.takeUntil)(this._destroyed$)).subscribe()}_getItemsAttributesChanges(){const e=this.map(t=>t?.events$?.pipe((0,l.filter)(n=>n.type===Re.ChangeAttributeValue))).filter(Boolean);return e.length?(0,u.merge)(...e):u.EMPTY}_getItemsModelModesChanges(){const e=[...this,...this._deletedItems].map(t=>t?._getPrimaryModelModeChanges?.()?.pipe((0,l.map)(n=>({item:t,itemModelMode:n})))).filter(Boolean);return e.length?(0,u.merge)(...e):u.EMPTY}_updateCollectionState(e,t){this._trackChanges=!1;const n=e.map(s=>this._onItemModelModeChanged(s)).some(s=>!!s);this._trackChanges=!0,!(!t&&!n)&&(this._updateFormApiModelValues(),this._updateFormApiModelPristineState(),this._changed.next(),this._itemsChanged.next())}_onItemModelModeChanged(e){const{item:t,itemModelMode:n}=e;if(!t||n==null)return!1;switch(n){case U.Create:return this._onCreateItem(t);case U.Update:return this._onUpdateItem(t);case U.Delete:return this._onDeleteItem(t);default:return!1}}_onCreateItem(e){const t=this._deletedItems.indexOf(e);return t!==-1?(this._deletedItems.splice(t,1),!0):(this._createdItems.indexOf(e)===-1&&this._createdItems.push(e),!1)}_onUpdateItem(e){const t=this._createdItems.indexOf(e);if(t!==-1)return this._createdItems.splice(t,1),!1;const n=this._deletedItems.indexOf(e);if(n!==-1){const s=this._deletedItems.splice(n,1);super.push(...s)}return!0}_onDeleteItem(e){const t=this._createdItems.indexOf(e),n=this._deletedItems.indexOf(e);return t!==-1?this._createdItems.splice(t,1):n===-1&&this._deletedItems.push(e),super.splice(this.indexOf(e),1),!0}_updateFormApiModelValues(e){if(this._featureValues.DisableBaseViewModelCollectionOptimization){this._formApiModel??=new Z.FormArray([]),this._formApiModel.clear({emitEvent:!1}),this.filter(n=>n?.formApiModel).forEach(n=>{this._formApiModel.push(n.formApiModel,{emitEvent:!1})}),e?.emitEvent!==!1&&this._formApiModel.updateValueAndValidity();return}if(!this._formApiModel||!this._formApiModel.length){const n=new Z.FormArray(this.filter(s=>s?.formApiModel)?.map(s=>s.formApiModel));this._formApiModel||(this._formApiModel=n),this._formApiModel.length||this._host?.formApiModel?.setControl(this._hostAttributeName,n)}else this._formApiModel.clear({emitEvent:!1}),this.filter(n=>n?.formApiModel).forEach(n=>{this._formApiModel.push(n.formApiModel,{emitEvent:!1})}),e?.emitEvent!==!1&&this._formApiModel.updateValueAndValidity()}_updateFormApiModelPristineState(){const e=this.formApiModel.pristine,t=this.some(n=>n?.formApiModel?.dirty);if(t&&e){this.formApiModel.markAsDirty();return}!t&&!e&&this.formApiModel.markAsPristine()}_reload(e){const t=()=>{for(const a of[...this._deletedItems,...this])this.removeChildModel(a,{triggerNotification:!1});this._model?.childrenChange();const n=[],s=a=>n.push(a.destroy());return this._createdItems.forEach(s),this._createdItems.splice(0,this._createdItems.length),this._deletedItems.forEach(s),this._deletedItems.splice(0,this._deletedItems.length),this.forEach(s),this.splice(0,this.length,...e),(0,u.forkJoin)(n).pipe((0,l.defaultIfEmpty)(void 0),(0,l.map)(()=>{}))};return this._measurePerformanceService?this._measurePerformanceService.measure("ViewModelCollection.reload",()=>t()):t()}removeChildModel(e,t){const n=t?.triggerNotification??!0,s=this._model?.name,a=e.getModelByName(s);this._model?.removeChild(a),n&&this._model?.childrenChange()}copyWithin(e,t,n){return this._triggerChangesAfter(()=>super.copyWithin(e,t,n))}fill(e,t,n){return this._triggerChangesAfter(()=>super.fill(e,t,n))}push(...e){return this._triggerChangesAfter(()=>super.push(...e))}reverse(){return this._triggerChangesAfter(()=>super.reverse())}shift(){return this._triggerChangesAfter(()=>super.shift())}sort(e){return this._triggerChangesAfter(()=>super.sort(e))}splice(e,t,...n){return this._triggerChangesAfter(()=>super.splice(e,t,...n))}unshift(...e){return this._triggerChangesAfter(()=>super.unshift(...e))}getChangedItems(){const e=[...this._deletedItems];return this.filter(n=>{if(n.attributes.IsChanged)return!0;const s=n.getPrimaryModelMode();return s&&s!==U.Update}).concat(e)}createItem(e){var t=this;const n=function(){var s=(0,f.A)(function*(){const a=yield t._generateItem(e||{});return t._insertItem(a,e?.index),a});return function(){return s.apply(this,arguments)}}();return this._measurePerformanceService?this._measurePerformanceService.measureCallback("ViewModelCollection.createItem",()=>n()):n()}getPrimaryAttributeValues(){return Promise.all(this.map(e=>e?.[e?.primaryAttributeName]))}findByPrimaryAttribute(e){var t=this;return(0,f.A)(function*(){for(const n of t)if(yield t._isItemPrimaryAttributeEqual(n,[e]))return n})()}filterByPrimaryAttributes(e){var t=this;return(0,f.A)(function*(){const n=[];for(const s of t)(yield t._isItemPrimaryAttributeEqual(s,e))&&n.push(s);return n})()}merge(e){const t=()=>{this._triggerChangesAfter(()=>{const n=this._mergeItems([...this],e);super.splice(0,this.length,...n),this._createdItems.splice(0,this._createdItems.length),e instanceof tt&&this._mergeItems(this._deletedItems,e._deletedItems)})};return this._measurePerformanceService?this._measurePerformanceService.measure("ViewModelCollection.merge",()=>t()):t()}reload(e){return(0,u.lastValueFrom)(this._reload(e))}remove(e){const[t,n]=typeof e=="number"?[e,this[e]]:[this.indexOf(e),e];if(t>=0&&t<this.length)return this.splice(t,1),(0,u.lastValueFrom)(n.destroy())}clear(){return this.reload([])}moveTo(e,t){if(t>=this.length)throw new Dr("Target index cannot be greater than collection length");const n=this.indexOf(e);n===t||t<0||this._triggerChangesAfter(()=>{super.splice(t,0,super.splice(n,1)[0])})}destroy(){this._isDestroyed=!0,this._host=null;const e=this._reload([]);return this._formApiModel.clear({emitEvent:!1}),this._itemAttributeChanged.complete(),this._itemsChanged.complete(),this._destroyed$.next(),this._destroyed$.complete(),(0,u.lastValueFrom)(e)}}function nf(r,e){return!r?.length||!e?.length?null:r[e.length-1]??null}function Nr(r){for(;r.parent;)r=r.parent;return r}function lc(r,e){const t=r.split(".").slice(0,-1),n=kd(e),s=n.map(a=>a.viewModel$.pipe((0,l.take)(1)));return(0,u.forkJoin)(s).pipe((0,l.map)(a=>({viewModels:a,rootViewModel:nf(a,n)})),(0,l.filter)(({rootViewModel:a})=>!a?._destroyed),(0,l.map)(({viewModels:a,rootViewModel:o})=>{const c=[],p=!o?.[$n].get(fe,null)?.["ViewModel.DisableFixedNestedCollectionPathCheck"],C=p?sf:rf;let I=n.length-1,O=[];for(const Y of t){c.push(Y);const te=p?o:a[I];if(te&&C(te,c)&&(O=[...c],I--,I<0))return null}return{context:n[I],contextPath:O.join(".")}}))}function kd(r){const e=[r];return r.parent&&e.push(...kd(r.parent)),e}function sf(r,e){let t=r._attributeConfigs,n=null;for(const s of e){if(n=t?.[s],!n)return!1;t=n.viewModelConfig?.attributes}return n.isCollection}function rf(r,e){let t=r;for(const n of e)t=t?.attributes?t.attributes[n]:t?.[n];return t instanceof tt}function af(r){return(r?.parameters??[]).map(e=>jd(e)).flat()}function jd(r){const e=[];if(r.attributePath&&e.push(r.attributePath),r.attributeProperty){const n=r.attributeProperty.split(":").shift();e.push(n)}const t=(r.converters??[]).map(n=>af(n)).flat();return e.push(...t),e.filter(n=>!isEmpty(n))}function vt(r){return typeof r=="string"&&r.startsWith("$")&&r.length>1}function Fo(r){return vt(r)&&/^\$(\w+\.)*\w+$/.test(r)}function Fd(r){return typeof r=="string"&&r.startsWith(`$${xr}.${Hi.string}.`)}function Bd(r){return/^\$(?<AttributeName>.+):(?<PropertyName>.+?)(?=(?==(?<defValue>.*))|(?=$))/.test(r)}function cc(r){return typeof r=="string"&&/@event\b/.test(r)}function of(r){return typeof r=="string"&&/^([^\d.][\w.]+)(\s*:\s*[\w'".$]+)+.*$/.test(r)}function Ud(r){return!!r.match(/^'.*'$/)}function zd(r){return!isNaN(Number(r))&&!isNaN(parseFloat(r))}function Hd(r){return r==="true"||r==="false"}function lf(r){return Ud(r)||zd(r)||Hd(r)}function uc(r){const e={expression:r},t=r.split("|").map(n=>n.trim());if(vt(r)){const n=t.shift();e.binding=n,Fd(n)&&(e.resourcePath=n.substring(1)),Bd(n)&&(e.attributeProperty=n.substring(1)),Fo(n)&&(e.attributePath=n.substring(1))}else if(cc(r)){const n=t.shift();e.event=n.substring(7)}else if(!of(r))return e.value=r,e;return e.converters=t.map(n=>{const[s,...a]=n.split(":").map(o=>o.trim());return{type:s,parameters:a.map(o=>uc(o))}}),e}function LS(r){if(!isString(r)||isEmpty(r))return[];const e=uc(r);return jd(e)}function kS(r){return vt(r)?r.slice(1):r}function dc(r,e){if(!r)return e;if(!e.startsWith(r))throw new Error(`Attribute path '${e}' should start with '${r}'`);return e.substring(r.length+1)}function cf(r){if(!vt(r))throw new Error(`'${r}' is not binding expression`);const e=r.indexOf("|");return e>-1&&(r=r.substring(0,e).trimEnd()),r.substring(1)}function Wd(r,e){return hc.apply(this,arguments)}function hc(){return hc=(0,f.A)(function*(r,e){const t=e.match(/^(?:(?<attributeHostPath>.+)\.)?(?<attributeName>[^.]+)$/),{attributeHostPath:n,attributeName:s}=t.groups,a=n?yield Ar(r,n):r;return{attributeName:s,attributeHost:a}}),hc.apply(this,arguments)}class $d{getAttributeValuesStream(e,t){return e?e.events$.pipe((0,l.filter)(n=>n.type===Re.ChangeAttributeValue),(0,l.filter)(n=>n?.payload?.attributeName===t),(0,l.switchMap)(n=>t in e?Promise.resolve(e[t]):Promise.resolve(n.payload.value)),(0,l.share)()):(0,u.of)(null)}getAttributeInitialValueStream(e,t,n){return e?(0,u.from)(Ar(e,t)).pipe((0,l.takeUntil)(n)):(0,u.of)(null)}getAttributeLocationChanges(e,t){return lc(e,t).pipe((0,l.tap)(n=>{if(!n)throw new Error(`Target binding context for attribute "${e} was not found"`)}),(0,l.switchMap)(({context:n,contextPath:s})=>(0,u.combineLatest)([n.viewModel$,(0,u.of)(dc(s,e))])),(0,l.switchMap)(([n,s])=>n?Wd(n,s):(0,u.of)({attributeName:void 0,attributeHost:void 0})))}evaluate(e,t){const n=e.slice(1);return this.getAttributeLocationChanges(n,t).pipe((0,l.switchMap)(s=>this.getAttributeValueChanges(s)))}}class Ot extends $d{getAttributeValueChanges({attributeHost:e,attributeName:t}){const n=this.getAttributeValuesStream(e,t),s=this.getAttributeInitialValueStream(e,t,n);return(0,u.merge)(s,n)}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=i.\u0275\u0275getInheritedFactory(Ot)))(n||Ot)}})()}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Ot,factory:Ot.\u0275fac})}}class Gn extends Ot{removeConvertersFromExpression(e){const t=e.indexOf("|");return t===-1?e:(console.warn(`Cannot use converters in control binding expression: ${e}`),e.substring(0,t).trimEnd())}evaluate(e,t){e=this.removeConvertersFromExpression(e);const n=e.slice(1);return this.getAttributeLocationChanges(n,t).pipe((0,l.map)(({attributeHost:s,attributeName:a})=>s?s.getAttributeControl(a):new Z.FormControl(null)))}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=i.\u0275\u0275getInheritedFactory(Gn)))(n||Gn)}})()}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Gn,factory:Gn.\u0275fac})}}const uf="DisableAttributeDeactivationUntilBRulesExecution";class Zi extends $d{constructor(e){super(),this._featureService=e,this._readonlyProperties=["readonly","disabled"]}getAttributeValueChangesInHybridMode(e,t,n,s){const a=e.getControl(t),o=s.slice(1);return this._getValuesStream(e,t,n,()=>{const c=this.getAttributeValuesStream(e,o).pipe((0,l.tap)(C=>a.setPropertyValue(n,C))),d=this.getAttributeValuesStream(e,`${t}:${n}`).pipe((0,l.filter)(()=>{const C=Object.getOwnPropertyDescriptor(e,o),I=!!C?.get,O=!!C?.set;return!(I&&!O)}),(0,l.tap)(C=>e[o]=C)),p=(0,u.from)(Ar(e,o)).pipe((0,l.tap)(C=>a.setPropertyValue(n,C,!0)),(0,l.takeUntil)(c));return(0,u.merge)(p,c,d)})}_getDefaultValue(e){if(!e)return null;try{return JSON.parse(e)}catch{return e}}_getValuesStream(e,t,n,s){return this._readonlyProperties.includes(n)?(0,u.forkJoin)({disableAttributeDeactivation:this._featureService.getFeatureState(uf),hasBRulesAffectingAttribute:e._getIsAffectedByBusinessRules({name:t})}).pipe((0,l.switchMap)(({disableAttributeDeactivation:a,hasBRulesAffectingAttribute:o})=>a||o!==!0?s():e._businessRulesActivated$.pipe((0,l.switchMap)(c=>c?s():(0,u.of)(!0))))):s()}getAttributeValueChanges(e){const{attributeHost:t}=e;if(!t)return(0,u.of)(null);const[n,s]=e.attributeName.split(":"),[a,o]=s.split("="),c=t.getControl(n),d=this._getDefaultValue(o);if(typeof d=="string"&&d?.startsWith("$"))return this.getAttributeValueChangesInHybridMode(t,n,a,d);if(d!=null){const p=c.getPropertyByName(a,!0);p.hasInitialValue||p.setInitialValue(d)}return this._getValuesStream(t,n,a,()=>{const p=this.getAttributeValuesStream(t,`${n}:${a}`),C=(0,u.of)(c.getPropertyValue(a)).pipe((0,l.filter)(I=>I!=null),(0,l.takeUntil)(p));return(0,u.merge)(C,p)})}static{this.\u0275fac=function(t){return new(t||Zi)(i.\u0275\u0275inject(at))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Zi,factory:Zi.\u0275fac})}}class Yi{evaluate(e,t){const n=e.slice(1);return Nr(t).viewModel$.pipe((0,l.switchMap)(s=>s?Ar(s,n):(0,u.of)(null)))}static{this.\u0275fac=function(t){return new(t||Yi)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Yi,factory:Yi.\u0275fac})}}class Pr{static{this.\u0275fac=function(t){return new(t||Pr)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Pr,factory:Pr.\u0275fac})}}const Gd=window;class Rr{constructor(){this.store={typeInfos:new Map}}static{this._prefix="creatio.registry."}static get store(){if(!this._instance){let e=(0,M.get)(Gd,this._prefix+this.registryKey);e||(e=new this,(0,M.set)(Gd,this._prefix+this.registryKey,e)),this._instance=e}return this._instance.store}}function bn(r,e){if(r.split(".").length<2)throw new Error(`Error when register ${r}. Type property should have format "VendorPrefix.${e}"`)}function jS(r,e){return bn(r,e)}function df(r){const[e,t]=r.split("."),n=Zd(t);if(!e||n!==t)throw new Error(`Error when register ${r}. Type property should have Pascal case, e.g. ${e+"."+n}. The first letter of each word in a compound word should be capitalized`)}function Bo(r){const[e,t]=r.split("."),n=Zd(t);if(e.toLowerCase()==="crt"&&n!==t)throw new Error(`Error when register ${r}. Type property should have Pascal case, e.g. ${e+"."+n}. The first letter of each word in a compound word should be capitalized`)}function Zd(r){return(0,M.upperFirst)((0,M.camelCase)(r))}function hf(r,e){if(!e)throw new Error(`Error when resolve ${r}. Type was not registered.`)}function Yd(r,e,t){if(t.has(r)&&!(0,M.isEqual)(t.get(r),e))throw new Error(`Error when register ${r}. Element with this type has already exist`)}class Kd extends Rr{static{this.registryKey="ConverterRegistry"}static has(e){return this.store.typeInfos.has(e)}static find(e){return this.store.typeInfos.get(e)}static get(e){const t=this.find(e);if(!t)throw new Error(`'${e}' converter doesn't exist`);return t}static register(e){bn(e.type,"ConverterTypeName"),Bo(e.type);const t=this.find(e.type);this.store.typeInfos.set(e.type,{...t??{},...e})}static clear(){this.store.typeInfos.clear()}}class Or{constructor(){this._converterRegistry=Kd,this._injector=(0,i.inject)(i.Injector)}get(e,t){return this._converterRegistry.get(e).instantiate(t)}register(e,t){throw new Error("NotImplemented")}clear(){this._converterRegistry.clear()}static{this.\u0275fac=function(t){return new(t||Or)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Or,factory:Or.\u0275fac,providedIn:"root"})}}class qd extends Error{constructor(){super("Next handler already specified")}}class Jd{constructor(){this._refs=new Set,this.lazyLoadingDisabled=!1}static{this._globalInstancePath="creatio._lazyModulesManager"}static get instance(){if(!this._instance){let e=(0,M.get)(window,this._globalInstancePath);e||(e=new this,(0,M.set)(window,this._globalInstancePath,e)),this._instance=e}return this._instance}add(e){this._refs.add(e)}size(){return this._refs.size}loadAll(){return Promise.all(Array.from(this._refs).map(e=>e.loadAndBootstrap()))}clear(){this._refs.clear()}}var pc;(function(r){r[r.Schema=0]="Schema",r[r.Remote=1]="Remote",r[r.Host=2]="Host"})(pc||(pc={}));class pf extends Rr{static{this.registryKey="pkgTopology"}static get items(){return this.store.typeInfos}static get(e){const t=this.items.get(e);if(t===void 0)throw new Error(`Package with name ${e} not found in topology`);return t}}class mf{constructor(e){this._request=e;const t=[...this._request.scopes??[]].reverse().map((n,s)=>[n,s]);this._scopesOrder=Object.fromEntries(t)}_getOrderByScopes(e){if(!e.scopes)return Number.MAX_VALUE;const t=e.scopes.filter(n=>n in this._scopesOrder).map(n=>this._scopesOrder[n]);return Math.min(...t)}_getOrderByPkgTopology(e){return e.source.type===pc.Host?Number.MAX_VALUE:pf.get(e.source.packageName)}compare(e,t){const n=this._getOrderByScopes(e),s=this._getOrderByScopes(t);let a=n-s;if(a)return a;const o=this._getOrderByPkgTopology(e),c=this._getOrderByPkgTopology(t);return a=o-c,a||(a=e.source.type-t.source.type,a)}}function gf(r){console.error("Not supported: lazy modules should not be dependent on other lazy modules. Some functions may not work correctly",r)}function Qd(r){if(!Array.isArray(r))return[];if(r.length===0)return[];const e=new Set,t=[...r];for(;t.length>0;){const n=t.pop();if(!n||e.has(n))continue;if(typeof n!="function"){gf(n);continue}e.add(n);const s=Ag(n)?.includes||[];t.push(...s)}return[...e]}function Xd(r,e){return r?.length?r.some(t=>e?.includes(t)):!0}const mc=window;mc.creatio??={},mc.creatio._bootstrappedCrtModules??=new Map;const eh=mc.creatio._bootstrappedCrtModules;function gc(r){eh.forEach((e,t)=>{e.root&&r(e,t)})}function FS(r){gc(e=>e.options?.onContextCreate?.(r))}function th(r){gc(e=>e.options?.onContextUpdate?.(r))}function ff(r){gc(e=>e.options?.onContextDestroy?.(r))}class _f{constructor(){var e=this;this._handlers=[],this._requestListeners=new Map,this._handlersCache=new Map,this._handlersScopesByContextId=new Map,this.handlerChain$={process:function(){var t=(0,f.A)(function*(n){let s;if(e._hasCacheHandler(n))s=e._getCacheHandler(n);else{const a=e._getMatchedHandlers(n);Jd.instance.lazyLoadingDisabled||(yield e._loadLazyHandlers(n,a)),s=e._buildHandlersChain(n,a)}return e._requestListeners.forEach(a=>a?.(n)),s?.handle(n)});return function(s){return t.apply(this,arguments)}}(),register:t=>(this._handlersCache.delete(t.requestType),this._handlers.push(t),()=>{const n=this._handlers.indexOf(t);n>-1?(this._handlers.splice(n,1),this._handlersCache.delete(t.requestType)):console.warn(`${t?.requestType} not found to unsubscribe`)}),update:t=>{const n=this._handlers.find(s=>s.type===t.type);n&&(n.createHandler=t.createHandler)},subscribe:(t,n)=>{if(!t)return()=>{};const s=(0,le.qv)(),a=o=>{(!n||o.$context===n)&&t(o)};return this._requestListeners.set(s,a),()=>this._requestListeners.delete(s)}}}clearContextedHandlersCache(e){return(this._handlersScopesByContextId.get(e)??[]).every(({requestType:n,scope:s})=>this._handlersCache.get(n)?.delete(s))}clear(){this._handlers.splice(0),this._requestListeners.clear(),this._handlersCache.clear(),this._handlersScopesByContextId.clear()}_getCacheHandler(e){const t=this._handlersCache.get(e.type),n=this._getCacheScopesKey(e);return t.get(n)}_hasCacheHandler(e){const t=this._handlersCache.get(e.type),n=this._getCacheScopesKey(e);return t&&t.has(n)}_getCacheScopesKey(e){const t=this._getInjectionContext(e?.$context)?.id??"";return(e.scopes||[""]).join("_").concat(t)}_getInjectionContext(e){return e?._injectionContext||e?.parent&&this._getInjectionContext(e.parent)}_setContextedScopes(e,t){const n=this._getInjectionContext(e?.$context)?.id,s=this._handlersScopesByContextId.has(n)?this._handlersScopesByContextId.get(n):[];s.push({requestType:e.type,scope:t}),this._handlersScopesByContextId.set(n,s)}_setCacheHandler(e,t){const n=this._handlersCache.has(e.type)?this._handlersCache.get(e.type):new Map,s=this._getCacheScopesKey(e);n.set(s,t),this._getInjectionContext(e?.$context)?.id&&this._setContextedScopes(e,s),this._handlersCache.set(e.type,n)}_isRequestHandler(e){return typeof e.handle=="function"&&typeof e.setNext=="function"}_checkHandlerInstanceOf(e){if(!this._isRequestHandler(e))throw new Error('Handler should implement "BaseRequestHandler"')}_loadLazyHandlers(e,t){var n=this;return(0,f.A)(function*(){const s=new Set;t.forEach(c=>{c.lazy&&!c.createHandler&&s.add(c.lazyModuleRef)});const a=[...s];yield Promise.all(a.map(c=>c.loadAndBootstrap()));const o=n._getInjectionContext(e?.$context);if(o&&s.size){const c=yield Qd(a.map(d=>d.typeRef));for(const d of c)o.addLazyModule(d);th(o)}})()}_getMatchedHandlers(e){return this._handlers.filter(t=>t.requestType!==e.type?!1:Xd(t.scopes,e.scopes))}_buildHandlersChain(e,t){const n=new mf(e);t.sort((c,d)=>n.compare(c,d));const s=this._getInjectionContext(e?.$context),a=t.map(c=>c.createHandler.call(c,s));a.forEach(c=>this._checkHandlerInstanceOf(c)),this._joinHandlersInChain(a);const o=a[0];return this._setCacheHandler(e,o),o}_joinHandlersInChain(e){for(let t=0;t<e.length-1;t++)try{e[t].setNext(e[t+1])}catch(n){throw n instanceof qd?new Error("Handler factory should return new instance of BaseRequestHandler class or its subclass (next handler should not be specified)"):n}}}const nh=window;class Qt{get _chain(){return nh.handlerChain}set _chain(e){nh.handlerChain=e}static get instance(){return Qt._instance||(Qt._instance=new Qt)}constructor(){this._chain||this._createGlobalHandlerChain()}_createGlobalHandlerChain(){this._chain=new _f}clearContextedHandlersCache(e){return this._chain.clearContextedHandlersCache(e)}register(e){return this._chain.handlerChain$.register(e)}update(e){return this._chain.handlerChain$.update(e)}process(e){return this._chain.handlerChain$.process(e)}subscribe(e,t){return this._chain.handlerChain$.subscribe(e,t)}clear(){this._chain.clear()}}var Oe;(function(r){r.LoadNext="loadNext",r.Load="load",r.Reload="reload"})(Oe||(Oe={}));var ce;(function(r){r.PrimaryColumnValue="primaryColumnValue",r.ColumnValue="columnValue",r.Filter="filter",r.PrimaryDisplayValueFilter="primaryDisplayValueFilter",r.Empty="empty",r.Never="never"})(ce||(ce={}));var Vt;(function(r){r.ViewElement="viewElement",r.Page="page"})(Vt||(Vt={}));function yf(r){return r.getFullYear()<1970}function Cf(r){const e=r.getTimezoneOffset()*6e4;return new Date(r.getTime()-e).toISOString().slice(0,-1)}function bf(r){const e=r.getFullYear(),t=Vr(r.getMonth()+1),n=Vr(r.getDate()),s=Vr(r.getHours()),a=Vr(r.getMinutes()),o=Vr(r.getSeconds()),c=Sf(r.getMilliseconds());return`${e}-${t}-${n}T${s}:${a}:${o}.${c}`}function Vr(r){return String(r).padStart(2,"0")}function Sf(r){return String(r).padStart(3,"0")}function ih(r){if(!(r instanceof Date))throw new TypeError;return yf(r)?bf(r):Cf(r)}function sh(r){return`"${ih(r)}"`}function Lt(r){return function(e,t,n){const s=function(...a){return Qt.instance.process({type:r?.requestType?r.requestType:this.requestType,method:r?.methodName?r.methodName:t,args:a})};n?n.value=s:e[t]=s}}class Uo{}class Zn extends Uo{constructor(){super(...arguments),this.requestType="crt.SysSettingsService"}}(0,y.__decorate)([Lt(),(0,y.__metadata)("design:type",Function)],Zn.prototype,"getByCodes",void 0),(0,y.__decorate)([Lt(),(0,y.__metadata)("design:type",Function)],Zn.prototype,"getByCode",void 0),(0,y.__decorate)([Lt(),(0,y.__metadata)("design:type",Function)],Zn.prototype,"update",void 0),(0,y.__decorate)([Lt(),(0,y.__metadata)("design:type",Function)],Zn.prototype,"updateMany",void 0);var Xt;(function(r){r.Model="Model",r.ViewModel="ViewModel"})(Xt||(Xt={}));var Sn;(function(r){r.Unknown="Unknown",r.Init="Init",r.Create="Create",r.Copy="Copy",r.Update="Update"})(Sn||(Sn={}));function Mf(r,e){return!!e?.find(n=>!n.scopeId&&n.triggers.find(s=>s.name===r.name))}function vf(r,e){return!!e?.find(n=>n.scopeName===r.scopeName&&n.triggers?.find(s=>s.name===r.name))}function If(r,e,t){if(e.scopeName===r){if(Mf(e,t))return!1}else if(vf(e,t))return!1;return!0}function rh(r,e){return r===e||ah(r)&&ah(e)}function ah(r){return!r||r==="null"}var Lr;(function(r){r.PTP="PTPMsg",r.BROADCAST="BroadcastMsg",r.SERVER="ServerMsg"})(Lr||(Lr={}));class oh{constructor(e){this.typeName="Terrasoft.Core.BusinessRules.Models.BusinessRuleAction",this.enabled=!0,this.uId=e?.uId||(0,le.qv)(),e&&(this.enabled=e.enabled)}toMetadata(){return{typeName:this.typeName,uId:this.uId,enabled:this.enabled}}getTypeName(){return this.typeName}getApplicability(){return[]}isValid(){return!0}onDataSourceAttributeNameChanged(e,t,n){}isAttributeUsed(e,t){return!1}getAffectedItems(){return[]}getRequiredItems(){return[]}}const wf="businessRuleActionDesignerType";function ht(r){return function(e){Reflect.defineMetadata(wf,r,e)}}var Ki=h(47149),qi;(function(r){r.Const="Const",r.SysValue="SysValue",r.SysSetting="SysSetting",r.AttributeValue="AttributeValue",r.AttributeProperty="AttributeProperty",r.Formula="Formula"})(qi||(qi={}));class Yn{get dataValueTypeName(){return this._dataValueTypeName}set dataValueTypeName(e){this._dataValueTypeName=e}get isLookup(){return this.dataValueTypeName===Ki.Q[E.r.Lookup].name}get referenceSchemaName(){return this._referenceSchemaName}set referenceSchemaName(e){this._referenceSchemaName!==e&&(this._referenceSchemaName=e)}constructor(e){this.typeName="Terrasoft.Core.BusinessRules.Models.Expressions.BusinessRuleExpression",this._dataValueTypeName="",this._referenceSchemaName="",this.type=qi.Const,this.uId=e?.uId||(0,le.qv)(),e&&(this._dataValueTypeName=e.dataValueTypeName??"",this.type=e.type||this.type,this._referenceSchemaName=e.referenceSchemaName??"")}toMetadata(){return{typeName:this.typeName,uId:this.uId,type:this.type,dataValueTypeName:this.dataValueTypeName,referenceSchemaName:this.referenceSchemaName}}copy(){return new Yn({...this.toMetadata(),uId:(0,le.qv)()})}isValid(){return!!this.uId}onDataSourceAttributeNameChanged(e,t,n){}getAffectedItem(){return null}clear(){throw new Error(`clear not implemented for BusinessRuleDesignExpression ${this.constructor.name}`)}setValue(e){throw new Error(`setValue not implemented for BusinessRuleDesignExpression ${this.constructor.name}`)}getValue(){throw new Error(`getValue not implemented for BusinessRuleDesignExpression ${this.constructor.name}`)}isEmpty(){throw new Error(`isEmpty not implemented for BusinessRuleDesignExpression ${this.constructor.name}`)}isAttributeUsed(e,t){return!1}}class zo{static{this._expressionsTypes=new Map}static register(e,t){this._expressionsTypes.set(e,t)}static _getExpressionType(e){return this._expressionsTypes.get(e)??null}get(e){if(!e)return new Yn;const t=zo._getExpressionType(e.typeName);return t?new t(e):new Yn(e)}}function fc(r){return function(e){zo.register(r.typeName,e)}}var _c;let yc=_c=class extends Yn{constructor(e){super(e),this.typeName="Terrasoft.Core.BusinessRules.Models.Expressions.BusinessRuleAttributeExpression",this.path="",this.scopeId="",e&&(this.path=e.path,this.scopeId=e.scopeId==="null"?"":e.scopeId)}toMetadata(){return{...super.toMetadata(),path:this.path,scopeId:this.scopeId}}copy(){return new _c({...this.toMetadata(),uId:(0,le.qv)()})}isValid(){return super.isValid()&&!!this.path}onDataSourceAttributeNameChanged(e,t,n){this.scopeId===e&&this.path===t&&(this.path=n)}getAffectedItem(){return{name:this.path}}isAttributeUsed(e,t){return this.path===t&&rh(this.scopeId,e)}};yc=_c=(0,y.__decorate)([fc({typeName:"Terrasoft.Core.BusinessRules.Models.Expressions.BusinessRuleAttributeExpression"}),(0,y.__metadata)("design:paramtypes",[Object])],yc);var Ho;let Mn=Ho=class extends oh{constructor(e){super(e),this._expressionFactory=new zo,this.typeName="Terrasoft.Core.BusinessRules.Models.BusinessRuleAction",this.executorName="",e&&(this.executorName=e.executorName,this.expression=new yc(e.expression),e.value&&(this.value=this._expressionFactory.get(e.value)))}getExpressionAffectedItems(){const e=this.expression?.getAffectedItem()??null;return e?[e]:[]}toMetadata(){return{...super.toMetadata(),executorName:this.executorName,expression:this.expression?.toMetadata(),value:this.value?.toMetadata()}}clone(){return new Ho(this.toMetadata())}copy(){const e=new Ho({...this.toMetadata(),uId:(0,le.qv)()});return e.expression=this.expression?.copy(),e.value=this.value?.copy(),e}getApplicability(){if(!this.expression?.path)return[];const t=this.expression.path.split(".").shift();return t?[{path:t}]:[]}isValid(){return super.isValid()&&!!this.expression?.isValid()&&!!this.value?.isValid()}getAffectedItems(){const e=this.getExpressionAffectedItems();return[...super.getAffectedItems(),...e]}};Mn=Ho=(0,y.__decorate)([ht("BusinessRuleDesignAction"),(0,y.__metadata)("design:paramtypes",[Object])],Mn);class Ef extends oh{constructor(){super(...arguments),this.typeName="Terrasoft.Core.BusinessRules.Models.Actions.BusinessRuleActionSetProperty"}}class Ji extends Ef{constructor(e){super(e),this.items=[],e&&(Array.isArray(e.items)?this.items=e.items:this.items=e.items?.length>0?e.items.split(","):[])}_getAffectedItems(){return(this.items??[]).map(t=>({name:t}))}toMetadata(){return{...super.toMetadata(),items:this.items?.length>0?this.items.join(","):""}}getApplicability(){return this.isValid()?this.items.map(e=>({path:e})):[]}isValid(){return super.isValid()&&this.items?.length>0}getAffectedItems(){return[...super.getAffectedItems(),...this._getAffectedItems()]}isAttributeUsed(e,t){return this.items.includes(t)}}var Wo;const xf="Terrasoft.Core.BusinessRules.Models.Actions.BusinessRuleActionEditableElement";let Cc=Wo=class extends Ji{constructor(){super(...arguments),this.typeName=xf}clone(){return new Wo(this.toMetadata())}copy(){return new Wo({...this.toMetadata(),uId:(0,le.qv)()})}};Cc=Wo=(0,y.__decorate)([ht("BusinessRuleEditableElementDesignAction")],Cc);var bc;let $o=bc=class extends Yn{constructor(e){super(e),this.typeName="Terrasoft.Core.BusinessRules.Models.Expressions.BusinessRuleFilterLookupExpression",this.path="",this.filterExpression="",e&&(this.path=e.path,this.filterExpression=e.filterExpression==="null"?"":e.filterExpression)}toMetadata(){return{...super.toMetadata(),path:this.path,filterExpression:this.filterExpression}}copy(){return new bc({...this.toMetadata(),uId:(0,le.qv)()})}isValid(){return super.isValid()&&!!this.path&&!!this.filterExpression}getAffectedItem(){return{name:this.path}}isAttributeUsed(e,t){return this.path===t}};$o=bc=(0,y.__decorate)([fc({typeName:"Terrasoft.Core.BusinessRules.Models.Expressions.BusinessRuleFilterLookupExpression"}),(0,y.__metadata)("design:paramtypes",[Object])],$o);var Go;let Sc=Go=class extends Mn{constructor(e){super(e),this.typeName="Terrasoft.Core.BusinessRules.Models.Actions.BusinessRuleActionFilterLookup",this.clearValue=!1,this.populateValue=!1,e?(this.clearValue=e.clearValue??!1,this.populateValue=e.populateValue??!1):(this.clearValue=!0,this.populateValue=!0),this._processMetadata(e)}_isOldMetadataFormat(e){const t=!!e.expression?.path&&e.expression.path!=="null",n=e.value,s=!!n?.value&&n.value!=="null";return t&&s}_convertOldMetadata(e){const t={...e},n=e.expression?.path||"",a=e.value?.value,o={path:a,filterExpression:""},c={path:n,filterExpression:""};if(a.includes(".")){const[d,...p]=a.split(".");o.path=d,o.filterExpression=p.join(".")}return{...t,leftExpression:o,rightExpression:c}}_processMetadata(e){e&&(this._isOldMetadataFormat(e)&&(e=this._convertOldMetadata(e)),delete this.expression,delete this.value,this.leftExpression=new $o(e?.leftExpression),this.rightExpression=new $o(e?.rightExpression))}toMetadata(){return{...super.toMetadata(),leftExpression:this.leftExpression?.toMetadata(),rightExpression:this.rightExpression?.toMetadata(),clearValue:this.clearValue,populateValue:this.populateValue}}clone(){return new Go({...this.toMetadata()})}copy(){return new Go({...super.copy().toMetadata(),leftExpression:this.leftExpression?.toMetadata(),rightExpression:this.rightExpression?.toMetadata(),clearValue:this.clearValue,populateValue:this.populateValue})}getApplicability(){return this.leftExpression?.path?[{path:this.leftExpression.path}]:[]}isValid(){return!!this.leftExpression?.isValid()&&!!this.rightExpression?.path}getAffectedItems(){const e=this.leftExpression?.getAffectedItem()??null,t=[...super.getAffectedItems()];return e&&t.push(e),t}getRequiredItems(){return[this.rightExpression?.getAffectedItem()].filter(e=>e)}isAttributeUsed(e,t){return this.leftExpression.isAttributeUsed(e,t)||this.rightExpression.isAttributeUsed(e,t)}};Sc=Go=(0,y.__decorate)([ht("BusinessRuleFilterLookupAction"),(0,y.__metadata)("design:paramtypes",[Object])],Sc);var Zo;let Mc=Zo=class extends Ji{constructor(){super(...arguments),this.typeName="Terrasoft.Core.BusinessRules.Models.Actions.BusinessRuleActionHideElement"}clone(){return new Zo(this.toMetadata())}copy(){return new Zo({...this.toMetadata(),uId:(0,le.qv)()})}};Mc=Zo=(0,y.__decorate)([ht("BusinessRuleHideElementDesignAction")],Mc);var Yo;const lh="Terrasoft.Core.BusinessRules.Models.Actions.BusinessRuleActionOptionalElement";let vc=Yo=class extends Ji{constructor(){super(...arguments),this.typeName=lh}clone(){return new Yo(this.toMetadata())}copy(){return new Yo({...this.toMetadata(),uId:(0,le.qv)()})}};vc=Yo=(0,y.__decorate)([ht("BusinessRuleOptionalElementDesignAction")],vc);var Ko;const Tf="Terrasoft.Core.BusinessRules.Models.Actions.BusinessRuleActionReadonlyElement";let Ic=Ko=class extends Ji{constructor(){super(...arguments),this.typeName=Tf}clone(){return new Ko(this.toMetadata())}copy(){return new Ko({...this.toMetadata(),uId:(0,le.qv)()})}};Ic=Ko=(0,y.__decorate)([ht("BusinessRuleReadOnlyElementDesignAction")],Ic);var qo;const ch="Terrasoft.Core.BusinessRules.Models.Actions.BusinessRuleActionRequiredElement";let wc=qo=class extends Ji{constructor(){super(...arguments),this.typeName=ch}clone(){return new qo(this.toMetadata())}copy(){return new qo({...this.toMetadata(),uId:(0,le.qv)()})}};wc=qo=(0,y.__decorate)([ht("BusinessRuleRequiredElementDesignAction")],wc);const Af=Symbol("CreateModelFrom");class kt extends Uo{constructor(e){super(),this.requestType="crt.ModelGenerator",this._crtModel=e}static get instance(){return this._instance||(this._instance=new kt),this._instance}get name(){return this._crtModel?.name}static[Af](e){return new kt(e)}static create(e){var t=this;return(0,f.A)(function*(){const n=yield t.instance._create({type:"crt.EntityDataSource",config:{entitySchemaName:e}},"");return new kt(n)})()}getSchema(){return this._crtModel._getAsyncResult(this._crtModel.getSchema())}load(e){return e?.loadOptions&&!e?.options&&(e.options=e.loadOptions),this._crtModel._getAsyncResult(this._crtModel.load(e))}insert(e){return this._crtModel._getAsyncResult(this._crtModel.insert(e))}update(e,t){var n=this;return(0,f.A)(function*(){const s=Object.keys(e);if(s.length){const o=(yield n.getSchema()).primaryAttributeName;s.filter(c=>c!==o).forEach(c=>n._crtModel.attributeChanged(c))}return n._crtModel._getAsyncResult(n._crtModel.update(e,t))})()}copy(e,t={}){return this._crtModel._getAsyncResult(this._crtModel.copy(e,t))}create(e={}){return this._crtModel._getAsyncResult(this._crtModel.create(e))}delete(e){return this._crtModel._getAsyncResult(this._crtModel.delete(e))}canSave(e){return this._crtModel._getAsyncResult(this._crtModel.canSave(e))}canDelete(e){return this._crtModel._getAsyncResult(this._crtModel.canDelete(e))}insertInTransaction(e,t){return this._crtModel.insertInTransaction(e,t)}updateInTransaction(e,t,n){return this._crtModel.updateInTransaction(e,t,n)}deleteInTransaction(e,t){return this._crtModel.deleteInTransaction(e,t)}}(0,y.__decorate)([Lt({methodName:"generateOne"}),(0,y.__metadata)("design:type",Function)],kt.prototype,"_create",void 0);class Df{static _getPrimaryDisplayAttributeName(e){return(0,f.A)(function*(){return(yield e.getSchema()).primaryDisplayAttributeName})()}static getLookupValue(e,t){var n=this;return(0,f.A)(function*(){const s=yield kt.create(e),a=yield s.getSchema(),o=[a.primaryAttributeName,a.primaryDisplayAttributeName];a.primaryColorAttributeName&&o.push(a.primaryColorAttributeName);const c=yield s.load({parameters:[{type:ce.PrimaryColumnValue,value:t}],attributes:o});if(!c||c.length===0)throw new Error(`Can't find value for '${t}'`);if(c.length>1)throw new Error(`Load more than 1 data row for '${t}'`);const d=c[0],p=yield n._getPrimaryDisplayAttributeName(s),C={value:t,displayValue:d[p]};return a.primaryColorAttributeName&&(C.primaryColorValue=d[a.primaryColorAttributeName]),C})()}}var Ec;let xc=Ec=class extends Yn{get value(){return this._value}set value(e){this._value!==e&&(this._displayValueInitialized=!1,this._value=e)}get referenceSchemaName(){return super.referenceSchemaName}set referenceSchemaName(e){this.referenceSchemaName!==e&&(super.referenceSchemaName=e,this._displayValueInitialized=!1)}get displayValue(){return this.isLookup&&this.referenceSchemaName?this._displayValueInitialized?this._displayValue:null:(this._displayValue=this.value,this._displayValueInitialized=!0,this._displayValue)}set displayValue(e){this._displayValue=e??"",this._displayValueInitialized=e!=null}get dataValueTypeName(){return super.dataValueTypeName}set dataValueTypeName(e){this.dataValueTypeName!==e&&(super.dataValueTypeName=e,this._displayValueInitialized=!1)}constructor(e){super(e),this.typeName="Terrasoft.Core.BusinessRules.Models.Expressions.BusinessRuleValueExpression",this._value="",this._displayValue="",this._displayValueInitialized=!1,e&&(this._value=e.value)}initDisplayValue(){var e=this;return(0,f.A)(function*(){if(e._displayValueInitialized)return Promise.resolve(e._displayValue);if(e.isLookup&&e.referenceSchemaName&&e._value){const t=yield Df.getLookupValue(e.referenceSchemaName,e._value);e._displayValue=t.displayValue}else e._displayValue=e.value;return e._displayValueInitialized=!0,Promise.resolve(e._displayValue)})()}toMetadata(){return{...super.toMetadata(),value:this.value}}copy(){return new Ec({...this.toMetadata(),uId:(0,le.qv)()})}isValid(){return super.isValid()?this.isLookup?(0,le.n7)(this.value):this.value!=null&&this.value!=="":!1}clear(){this._value="",this._displayValue="",this._displayValueInitialized=!1}setValue(e){e?(this.value=e.value,this.displayValue=e.displayValue):this.clear()}getValue(){return{value:this.value,displayValue:this.displayValue}}isEmpty(){return!this.value}};xc=Ec=(0,y.__decorate)([fc({typeName:"Terrasoft.Core.BusinessRules.Models.Expressions.BusinessRuleValueExpression"}),(0,y.__metadata)("design:paramtypes",[Object])],xc);var Jo;let Tc=Jo=class extends Mn{constructor(e){super(e),this.typeName="Terrasoft.Core.BusinessRules.Models.Actions.BusinessRuleActionSetFilter",e&&(this.value=new xc(e.value))}clone(){return new Jo(this.toMetadata())}copy(){return new Jo(super.copy().toMetadata())}getApplicability(){return this.expression?.path?[{path:this.expression.path}]:[]}isAttributeUsed(e,t){return this.expression.isAttributeUsed(e,t)}};Tc=Jo=(0,y.__decorate)([ht("BusinessRuleSetFilterAction"),(0,y.__metadata)("design:paramtypes",[Object])],Tc);var Qo;let Ac=Qo=class extends Mn{constructor(){super(...arguments),this.typeName="Terrasoft.Core.BusinessRules.Models.Actions.BusinessRuleActionSetValue"}clone(){return new Qo(this.toMetadata())}copy(){return new Qo(super.copy().toMetadata())}};Ac=Qo=(0,y.__decorate)([ht("BusinessRuleSetValueDesignAction")],Ac);var Dc;(function(r){r.DataSource="DataSource",r.Page="Page"})(Dc||(Dc={}));var Xo;let Nc=Xo=class extends Mn{constructor(e){super(e),this.typeName="Terrasoft.Core.BusinessRules.Models.Expressions.BusinessRuleSetValueItem",this.scope=e?.scopeId??"",this.scope==="null"&&(this.scope="")}clone(){return new Xo(this.toMetadata())}copy(){return new Xo({...super.copy().toMetadata(),scopeId:this.scope})}toMetadata(){return{...super.toMetadata(),scopeId:this.scope}}getApplicability(){if(!this.expression?.path)return[];const t=this.expression.path.split(".").shift();if(!t)return[];const n={path:t};return this.scope!==""&&(n.applicability=Dc.DataSource,n.scope=this.scope),[n]}isAttributeUsed(e,t){return this.expression.path===t&&rh(this.scope,e)}};Nc=Xo=(0,y.__decorate)([ht("BusinessRuleSetValueItem"),(0,y.__metadata)("design:paramtypes",[Object])],Nc);var el;let Pc=el=class extends Mn{constructor(e){super(e),this.typeName="Terrasoft.Core.BusinessRules.Models.Actions.BusinessRuleActionSetValues",this.items=[],e&&(this.items=e.items?.map(t=>new Nc(t)))}getExpressionAffectedItems(){return[]}clone(){return new el(this.toMetadata())}copy(){return new el({...super.copy().toMetadata(),items:this.items.map(e=>e.toMetadata())})}toMetadata(){const e={...super.toMetadata(),items:this.items?.length>0?this.items.map(t=>t.toMetadata()):[]};return this.items?.length>0&&(delete e.expression,delete e.value),e}getApplicability(){return this.items?.length?this.items.flatMap(e=>e.getApplicability()):[]}isValid(){return this.items?.length>0&&this.items.every(e=>e.isValid())}getAffectedItems(){const t=(this.items??[]).map(n=>n.getAffectedItems()).flat();return[...super.getAffectedItems(),...t]}getRequiredItems(){return this.getAffectedItems()}isAttributeUsed(e,t){return this.items.some(n=>n.isAttributeUsed(e,t))}};Pc=el=(0,y.__decorate)([ht("BusinessRuleSetValuesDesignAction"),(0,y.__metadata)("design:paramtypes",[Object])],Pc);var tl;let Rc=tl=class extends Ji{constructor(){super(...arguments),this.typeName="Terrasoft.Core.BusinessRules.Models.Actions.BusinessRuleActionShowElement"}clone(){return new tl(this.toMetadata())}copy(){return new tl({...this.toMetadata(),uId:(0,le.qv)()})}};Rc=tl=(0,y.__decorate)([ht("BusinessRuleShowElementDesignAction")],Rc);class Qi{get(e){return e.typeName==="Terrasoft.Core.BusinessRules.Models.Actions.BusinessRuleActionShowElement"?new Rc(e):e.typeName==="Terrasoft.Core.BusinessRules.Models.Actions.BusinessRuleActionHideElement"?new Mc(e):e.typeName==="Terrasoft.Core.BusinessRules.Models.Actions.BusinessRuleActionReadonlyElement"?new Ic(e):e.typeName==="Terrasoft.Core.BusinessRules.Models.Actions.BusinessRuleActionEditableElement"?new Cc(e):e.typeName===lh?new vc(e):e.typeName===ch?new wc(e):e.typeName==="Terrasoft.Core.BusinessRules.Models.Actions.BusinessRuleActionFilterLookup"?new Sc(e):e.typeName==="Terrasoft.Core.BusinessRules.Models.Actions.BusinessRuleActionSetFilter"?new Tc(e):e.typeName==="Terrasoft.Core.BusinessRules.Models.Actions.BusinessRuleActionSetValue"?new Ac(e):e.typeName==="Terrasoft.Core.BusinessRules.Models.Actions.BusinessRuleActionSetValues"?new Pc(e):new Mn(e)}static{this.\u0275fac=function(t){return new(t||Qi)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Qi,factory:Qi.\u0275fac,providedIn:"root"})}}var nl;(function(r){r[r.Condition=0]="Condition",r[r.Action=1]="Action",r[r.Trigger=2]="Trigger",r[r.Context=3]="Context",r[r.Unknown=4]="Unknown"})(nl||(nl={}));const Nf="crt-business-rules-cache";class Pf{}var il=h(49820);class Xi extends Pf{constructor(e,t){super(),this._httpClient=e,this._cacheManager=t,this._cachedLoadScopesRequests=new Map,this.serviceEndpoint="/ServiceModel/BusinessRulesManagerService.svc/",this.getBusinessRulesConfigMethodName="GetBusinessRules"}_getBusinessRulesCache(){return(0,u.from)(this._cacheManager.get(Nf))}_getCachedBusinessRulesScopes(e){const t=e.map(n=>{const s=this._getContextCacheKey(n.scopeType,n.scopeName);return this._getBusinessRulesCache().pipe((0,u.switchMap)(a=>(0,u.from)(a.get(s))),(0,u.map)(a=>a?{rules:a,scopeName:n.scopeName,scopeType:n.scopeType}:null))});return t.length?(0,u.forkJoin)(t):(0,u.of)([])}_getScopeType(e){return e==="Model"?Xt.Model:Xt.ViewModel}_mapResponseToBusinessRules(e){return!e?.businessRules||e.businessRules.length===0?[]:e.businessRules.map(t=>{const n=JSON.parse(t.businessRulesConfig);return{scopeName:t.schemaName,scopeType:this._getScopeType(t.type),rules:n}})}_getContextsScopeNames(e){return e.map(t=>t.scopeName)}_getContextCacheKey(e,t){return`Type:#${e}#-Name:#${t}#`}_getContextsScopeNamesRequestKey(e){return e.map(n=>this._getContextCacheKey(n.scopeType,n.scopeName)).join("_")}_getCachedLoadScopesRequest(e){const t=e.map(s=>this._getContextCacheKey(s.scopeType,s.scopeName)),n=[...this._cachedLoadScopesRequests.keys()].find(s=>t.every(a=>s.includes(a)));return this._cachedLoadScopesRequests.get(n)}_getNotLoadedBusinessRulesScopes(e){if(e.length===0)return(0,u.of)([]);const t=this._getContextsScopeNames(e),n=this._getCachedLoadScopesRequest(e);if(n)return n.request$.pipe((0,u.map)(c=>c.filter(d=>t.includes(d.scopeName))));const s=`${this.serviceEndpoint}${this.getBusinessRulesConfigMethodName}`,a={scopes:Array.from(new Map(e.map(c=>[this._getContextCacheKey(c.scopeType,c.scopeName),{name:c.scopeName,type:c.scopeType,modelType:c.modelType}])).values())},o=this._httpClient.post(s,a).pipe((0,u.map)(c=>this._mapResponseToBusinessRules(c)),(0,u.switchMap)(c=>{const d=c.map(p=>{const C=this._getContextCacheKey(p.scopeType,p.scopeName);return this._getBusinessRulesCache().pipe((0,u.switchMap)(I=>(0,u.from)(I.set(C,p.rules))))});return d.length?(0,u.forkJoin)(d).pipe((0,u.map)(()=>c)):(0,u.of)(c)}),(0,u.tap)(()=>{const c=this._getContextsScopeNamesRequestKey(e);this._cachedLoadScopesRequests.delete(c)}),(0,u.share)());return this._cachedLoadScopesRequests.set(this._getContextsScopeNamesRequestKey(e),{request$:o,scopeNames:t}),o}getBusinessRulesByContexts(e){const t=e.filter(n=>n.scopeName&&n.modelType!=="crt.PageParametersDataSource");return(0,u.from)(this._getCachedBusinessRulesScopes(t)).pipe((0,u.switchMap)(n=>{const s=t.filter(o=>!n?.some(c=>c?.scopeName===o.scopeName&&c.scopeType===o.scopeType));return this._getNotLoadedBusinessRulesScopes(s).pipe((0,u.map)(o=>[...n,...o].filter(Boolean)),(0,u.catchError)(o=>{const c=t?.map(d=>d.scopeName).join(", ");return console.warn(`An error occurred during getting business rules execution for scopes: ${c}.`,o),(0,u.of)([])}))}))}clearCachedBusinessRules(){return this._getBusinessRulesCache().pipe((0,u.switchMap)(e=>(0,u.from)(e.clear())),(0,u.map)(()=>!0))}static{this.\u0275fac=function(t){return new(t||Xi)(i.\u0275\u0275inject(P.HttpClient),i.\u0275\u0275inject(il.G))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Xi,factory:Xi.\u0275fac,providedIn:"root"})}}var ve;(function(r){r.ChangeAttributeValue="ChangeAttributeValue",r.ChangeAttributeProperty="ChangeAttributeProperty",r.DataLoaded="DataLoaded",r.ContextReady="ContextReady"})(ve||(ve={}));const uh=new Map([[0,ve.ChangeAttributeValue],[1,ve.ChangeAttributeProperty],[2,ve.DataLoaded]]);function sl(r){return uh.has(r)?uh.get(r):ve.DataLoaded}class kr{canExecute(e,t,n){const s=n.map(o=>o.triggers).flat();return s.length===0?!1:(e?.triggers??[]).some(o=>o.type===ve.ContextReady)?n.some(o=>o.triggers.some(c=>sl(c.type)===ve.DataLoaded&&!c.name)):s.some(o=>{const c=sl(o.type);if(c===ve.DataLoaded&&e.scopeType===Xt.Model)return e.triggers.some(p=>p.type===ve.DataLoaded);if(!o.scopeId)return e.triggers.some(p=>p.name===o.name&&p.type===c);const d=t.find(p=>p.scopeId===o.scopeId);return d==null?!1:d.triggers.some(p=>p.name===o.name&&p.type===c)})}static{this.\u0275fac=function(t){return new(t||kr)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:kr,factory:kr.\u0275fac})}}const Rf="Terrasoft.Core.BusinessRules.Models.Conditions.BusinessRuleGroupCondition";function dh(r){return r&&"path"in r?r.path:""}function Of(r){const e=[];return r.conditions&&r.conditions.forEach(t=>{const n=hh(t);e.push(...n)}),e}function hh(r){if(ph(r))return Of(r);const e=r;return[dh(e.leftExpression),dh(e.rightExpression)].filter(t=>t)}function Vf(r,e){return r.flatMap(t=>e.get(t).getRequiredItems()).map(t=>t.name)}function ph(r){return r.typeName===Rf}function mh(r){return r.map(e=>hh(e)).flat().filter(e=>e!=null)}function Lf(r,e){return r.flatMap(t=>t.cases.flatMap(n=>Vf(n.actions,e)))}function kf(r){return!r.cases||r.cases.length===0?[]:r.cases.map(e=>e.condition).filter(e=>e!=null)}function gh(r){return r.map(e=>kf(e)).flat()}const jf=[qi.Const,qi.SysValue,qi.SysSetting],Ff=new Set(jf);function fh(r){return r?!!r.type&&Ff.has(r.type):!0}function Bf(r){return r.conditions?r.conditions.every(e=>_h(e)):!1}function _h(r){if(!r)return!1;if(ph(r))return Bf(r);const e=r;return(0,M.isNil)(e.leftExpression)&&(0,M.isNil)(e.rightExpression)?!1:fh(e.leftExpression)&&fh(e.rightExpression)}function yh(r){return r.some(e=>e.type===ve.ContextReady)}function Uf(r,e){return yh(r)?e.some(t=>_h(t)):!1}function zf(r,e){return yh(r)?e.some(t=>t.cases?.some(n=>!n.condition)):!1}class jr{_canExecuteByConditionsAttributePaths(e,t){const n=e.filter(a=>a.type!==ve.DataLoaded).map(a=>a.name);if(!n||n.length===0)return!1;const s=new Set(mh(t));return n.some(a=>s.has(a))}canExecute(e,t){if(!t||t.length===0)return!1;const n=gh(t),s=Uf(e.triggers,n),a=zf(e.triggers,t);return s||a?!0:this._canExecuteByConditionsAttributePaths(e.triggers,n)}static{this.\u0275fac=function(t){return new(t||jr)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:jr,factory:jr.\u0275fac})}}class Oc extends Error{constructor(e){super(`Argument with name '${e}' is empty.`)}}class ue{static checkArgumentEmpty(e,t){if(t==null)throw new Oc(e)}static checkArrayEmpty(e,t){if(ue.checkArgumentEmpty(e,t),t.length===0)throw new Oc(e)}static checkStringIsNotEmpty(e,t){if(this.checkArgumentEmpty(e,t),t==="")throw new Oc(e);return t}static checkArgumentOutOfRange(e,t,n){if(n.begin&&t<n.begin)throw new Dr(e);if(n.end&&t>n.end)throw new Dr(e)}static checkEnumOutOfRange(e,t,n){if(!n||!Object.values(n).includes(t))throw new Dr(e)}}class Hf{get closed(){return this._closed}constructor(e){this._initialTeardown=e,this._closed=!1}unsubscribe(){this._closed||(this._closed=!0,(0,M.isFunction)(this._initialTeardown)&&this._initialTeardown())}}var Wf=h(52874);const $f=new i.InjectionToken("MessageChannelAccessTokenFactory");var Ch=h(66736);class Fr{constructor(e){this._zone=e,this._message$=new u.Subject}init(e,t){return this._zone.runOutsideAngular(()=>{const n=t?{accessTokenFactory:t,withCredentials:!0}:void 0;return this._connection=new Ch.HubConnectionBuilder().withUrl(e,n).withAutomaticReconnect().withHubProtocol(new Ch.JsonHubProtocol).build(),this._connection.on("ServerMessage",s=>this._zone.run(()=>this._message$.next(s))),(0,u.from)(this._connection.start())})}sendMessage(e){return(0,u.from)(this._connection.send("SendMessage",e))}getMessages(){return this._message$}ngOnDestroy(){this._connection.off("ServerMessage"),this._message$.complete(),this._connection.stop().then()}static{this.\u0275fac=function(t){return new(t||Fr)(i.\u0275\u0275inject(i.NgZone))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Fr,factory:Fr.\u0275fac,providedIn:"root"})}}var Gf=h(5766);const Zf=1e3,bh=3e4,Sh=1e4,Mh="ping",Vc="pong";class Br{constructor(e){this._ngZone=e}_createHeartbeatRequestMessage(){return{Id:(0,le.qv)(),Header:{Sender:"ConsoleCommand",BodyTypeName:"System.String"},Body:Mh}}_isHeartbeatRequestMessage(e){const t=e.Header?.Sender==="ConsoleCommand",n=e.Body===Mh;return t&&n}_isHeartbeatResponseMessage(e){const t=e.Header?.Sender==="CommandService",n=e.Body===Vc;return t&&n}startHeartbeat(e){this.stopHeartbeat(),this._ngZone.runOutsideAngular(()=>{console.log(`WS-Heartbeat: connection ping scheduled for every [${bh/1e3}] sec`);const t=(0,u.timer)(Zf,bh).pipe((0,u.tap)(()=>{e.next(this._createHeartbeatRequestMessage())}),(0,u.concatMap)(()=>(0,u.race)(e.pipe((0,u.filter)(n=>this._isHeartbeatResponseMessage(n)),(0,u.take)(1),(0,u.map)(n=>n.Body)),(0,u.of)("timeout").pipe((0,u.delay)(Sh)))));this._subscription=t.subscribe(n=>{switch(n){case Vc:console.log(`WS-Heartbeat: Server responded with: ${Vc}`);break;case"timeout":console.error(`WS-Heartbeat: Server failed to respond in ${Sh/1e3} seconds`);break}})})}stopHeartbeat(){this._subscription?.unsubscribe()}excludeHeartbeatResponses(){return(0,u.filter)(e=>!this._isHeartbeatRequestMessage(e)&&!this._isHeartbeatResponseMessage(e))}ngOnDestroy(){this.stopHeartbeat()}static{this.\u0275fac=function(t){return new(t||Br)(i.\u0275\u0275inject(i.NgZone))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Br,factory:Br.\u0275fac,providedIn:"root"})}}const vh=[1,2e3,5e3,1e4,2e4,...Array(10).fill(3e4)],Yf=vh.length;class Ur{constructor(e){this._heartbeatService=e,this._reconnectAttempts=0,this._webSocketCreated$=new u.ReplaySubject(1)}_maxReconnectAttemptsReached(){return this._reconnectAttempts>=Yf}_resetReconnectAttempts(){this._reconnectAttempts=0}_getWebSocketUrl(){var e=this;return(0,f.A)(function*(){const t=yield e._accessTokenFactory?.();return t?`${e._serverUrl}?access_token=${encodeURIComponent(t)}`:e._serverUrl})()}_scheduleReconnectionAttempt(e){if(this._maxReconnectAttemptsReached()){console.error("WebSocket: Max reconnect attempts reached",e);return}const t=vh[this._reconnectAttempts];setTimeout(()=>{this._createAndConnectWebSocketAsync({reconnectOnAccessTokenFactoryError:!0}).catch(console.error),this._reconnectAttempts++},t)}_handleWebSocketClosed(e){this._heartbeatService.stopHeartbeat(),this._scheduleReconnectionAttempt(e)}_createAndConnectWebSocketAsync(e){var t=this;return(0,f.A)(function*(){let n;try{n=yield t._getWebSocketUrl()}catch(s){throw e.reconnectOnAccessTokenFactoryError&&t._scheduleReconnectionAttempt(s),s}return new Promise(s=>{t._webSocket$=(0,Gf.webSocket)({url:n,openObserver:{next:()=>{console.log(`Websocket channel opened for url: ${t._serverUrl}`),t._heartbeatService.startHeartbeat(t._webSocket$),t._resetReconnectAttempts(),s()}}}),t._webSocketSubscription?.unsubscribe(),t._webSocketSubscription=t._webSocket$.subscribe({error:a=>t._handleWebSocketClosed(a),complete:()=>t._handleWebSocketClosed()}),t._webSocketCreated$.next(t._webSocket$)})})()}_subscribeToSocketMessages(e,t){return e.pipe(this._heartbeatService.excludeHeartbeatResponses()).subscribe({next:n=>t.next(n),error:()=>{this._maxReconnectAttemptsReached()&&t.error(new Error("Max reconnect attempts reached"))}})}init(e,t){return this._serverUrl=e,this._accessTokenFactory=t,(0,u.from)(this._createAndConnectWebSocketAsync({reconnectOnAccessTokenFactoryError:!1}))}sendMessage(e){return new u.Observable(t=>{this._webSocket$.next(e),t.next(),t.complete()})}getMessages(){return new u.Observable(e=>{let t;const n=this._webSocketCreated$.subscribe(s=>{t?.unsubscribe(),t=this._subscribeToSocketMessages(s,e)});return()=>{t.unsubscribe(),n.unsubscribe()}})}ngOnDestroy(){this._heartbeatService.stopHeartbeat(),this._webSocket$?.complete(),this._webSocketSubscription?.unsubscribe()}static{this.\u0275fac=function(t){return new(t||Ur)(i.\u0275\u0275inject(Br))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Ur,factory:Ur.\u0275fac,providedIn:"root"})}}var rl=h(93248),Lc;(function(r){r.Production="production",r.PreProduction="pre-production",r.Development="development"})(Lc||(Lc={}));const Ih=Xe.create({serviceUrl:"",clientConnectionClassName:""}),BS={provide:Xe,useFactory:()=>Ih};let zr=class Ul{constructor(e,t){this._httpClient=e,this._cacheManager=t,this._serviceEndpoint="ServiceModel/ApplicationInfoService.svc/"}_initApplicationInfo(){const e=this._serviceEndpoint+"GetApplicationInfo";this._applicationInfoObservable$=this._cacheManager.executeWithCache(rl.HO,rl.oy,this._httpClient.post(e,null)).pipe((0,l.map)(t=>{const n=t?.applicationInfo,s=Xe.create(n);return Object.assign(Ih,s),t}),(0,l.shareReplay)({bufferSize:1,refCount:!1})),this._applicationInfoObservable$.subscribe()}loadApplicationInfo(){return this._applicationInfoObservable$||this._initApplicationInfo(),this._applicationInfoObservable$}loadSysValues(){return this.loadApplicationInfo().pipe((0,l.map)(e=>e?.applicationInfo?.sysValues))}getCoreVersion(){return this._coreVersion?(0,u.of)(this._coreVersion):this.loadSysValues().pipe((0,u.tap)(e=>this._coreVersion=e?.coreVersion),(0,l.map)(()=>this._coreVersion))}getIsProductionEnvironment(){return(this._environmentType?(0,u.of)(this._environmentType):this.loadSysValues().pipe((0,u.tap)(t=>this._environmentType=t?.environmentType),(0,l.map)(()=>this._environmentType))).pipe((0,l.map)(t=>t===Lc.Production))}static{this.\u0275fac=function(t){return new(t||Ul)(i.\u0275\u0275inject(P.HttpClient),i.\u0275\u0275inject(il.G))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Ul,factory:Ul.\u0275fac,providedIn:"root"})}};zr=(0,y.__decorate)([(0,T.op)({requestType:"crt.SysValuesService"}),(0,y.__metadata)("design:paramtypes",[P.HttpClient,il.G])],zr);const US={provide:i.APP_INITIALIZER,useFactory:r=>()=>r.loadApplicationInfo(),deps:[zr],multi:!0};let al=class zl{constructor(e,t,n,s){this.injector=s,this._destroyed$=new u.Subject,this.init$=new u.ReplaySubject(1),this.messageEvent$=new u.Subject,!e.clientConnectionClassName||e.clientConnectionClassName===""?t.loadApplicationInfo().subscribe(a=>{this._initialize(a.applicationInfo,n)}):this._initialize(e,n)}_initialize(e,t){this.msgChannel=this._getChannel(e.clientConnectionClassName),this._initChannel(e.serviceUrl,t)}_getChannel(e){switch(e){case"Terrasoft.WebSocketChannel":return this.injector.get(Ur);case"Terrasoft.SignalRChannel":return this.injector.get(Fr)}}_buildMessageEvent(e){let t;if(e.Body&&typeof e.Body=="string")try{t=JSON.parse(e.Body)}catch(n){return(0,i.isDevMode)()&&console.warn(`MessageChannelService. Parse error: ${n}`),null}else e.Body&&typeof e.Body=="object"&&(t=e.Body);return{header:{sender:e?.Header?.Sender,bodyTypeName:e?.Header?.BodyTypeName},body:t,id:e.Id}}_subscribeToMsgChannel(){this.msgChannel.getMessages().pipe((0,l.takeUntil)(this._destroyed$)).subscribe(e=>{const t=this._buildMessageEvent(e);t&&this.messageEvent$.next(t)})}_initChannel(e,t){this.msgChannel.init(e,t).subscribe({complete:()=>{this.init$.next(this.msgChannel),this._subscribeToMsgChannel()}})}_sendMessageInternal(e,t,n){const s={Id:Wf.Guid.create().toString(),Header:{Sender:e,BodyTypeName:"System.String",ChannelType:t},Body:JSON.stringify(n)};return this.init$.pipe((0,u.take)(1),(0,l.switchMap)(()=>this.msgChannel.sendMessage(s)))}getMessages(e){return ue.checkArgumentEmpty("sender",e),this.messageEvent$.pipe((0,l.filter)(t=>t.header.sender===e))}subscribe(e,t){ue.checkArgumentEmpty("sender",e),ue.checkArgumentEmpty("callback",t);const n=this.getMessages(e).subscribe(t);return Promise.resolve(new Hf(()=>n.unsubscribe()))}sendMessage(e,t,n){let s,a;const o=!!n;o?(s=e,a=t,ue.checkStringIsNotEmpty("sender",s),ue.checkEnumOutOfRange("channelType",n,Lr)):(a=e,s=t,ue.checkArgumentEmpty("channelType",s),ue.checkEnumOutOfRange("channelType",s,Lr));const c=this._sendMessageInternal(s,n,a);return o?(0,u.firstValueFrom)(c):c}ngOnDestroy(){this._destroyed$.next(),this._destroyed$.complete(),this.init$.complete(),this.messageEvent$.complete()}static{this.\u0275fac=function(t){return new(t||zl)(i.\u0275\u0275inject(Xe),i.\u0275\u0275inject(zr),i.\u0275\u0275inject($f,8),i.\u0275\u0275inject(i.Injector))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:zl,factory:zl.\u0275fac,providedIn:"root"})}};al=(0,y.__decorate)([(0,T.op)({requestType:"crt.MessageChannelService"}),(0,y.__metadata)("design:paramtypes",[Xe,zr,Function,i.Injector])],al);class kc extends Uo{constructor(){super(...arguments),this.requestType="crt.FeatureService"}}(0,y.__decorate)([Lt(),(0,y.__metadata)("design:type",Function)],kc.prototype,"getFeatureState",void 0),(0,y.__decorate)([Lt(),(0,y.__metadata)("design:type",Function)],kc.prototype,"getFeaturesState",void 0);class Hr{constructor(e,t){this._businessRulesManager=e,this._businessRuleDesignActionFactory=t,this._scopeAttributes=[]}_filterTriggers(e,t){const n=t.filter(o=>o.scopeName===e.parentScopeId),a=t.find(o=>o.scopeName===e.scopeName&&o.scopeType===e.scopeType)?.rules.map(o=>o.triggers).flat();return e.triggers.filter(o=>{if(o.type===ve.ContextReady||o.type===ve.DataLoaded)return!0;const c=a?.some(C=>C&&C.name===o.name&&sl(C.type)===o.type),p=n.flatMap(C=>C.rules.flatMap(I=>I.triggers)).some(C=>C.name===o.name&&sl(C.type)===o.type);return c||p})}_filterAttributes(e){const n=this._scopeAttributes.filter(o=>o.scopeName===e.scopeName).map(o=>o.attributes).flat(),s=this._scopeAttributes.filter(o=>o.scopeName!==e.scopeName).flatMap(o=>[...o.attributes]);return e.attributes.filter(o=>n.includes(o.attributeName)||s.includes(o.attributeName)||o.isSignificant)}_cacheUsedAttributes(e){e.forEach(t=>{if(!this._scopeAttributes.find(n=>n.scopeName===t.scopeName&&n.scopeType===t.scopeType)){const n=gh(t.rules),s=mh(n),a=Lf(t.rules,this._businessRuleDesignActionFactory),o=t.rules.flatMap(c=>c.triggers?.map(d=>d.name)).filter(Boolean);this._scopeAttributes.push({scopeName:t.scopeName,scopeType:t.scopeType,attributes:[...s,...a,...o]})}})}_hasActiveRules(e,t){return(t.find(o=>o.scopeName===e.scopeName&&o.scopeType===e.scopeType)?.rules??[]).filter(o=>o.enabled===!0).length>0}clearCachedScopeAttributes(){this._scopeAttributes=[]}filter(e){return this._businessRulesManager.getBusinessRulesByContexts(e).pipe((0,u.tap)(t=>this._cacheUsedAttributes(t)),(0,u.map)(t=>e.map(s=>({...s,attributes:this._filterAttributes(s),triggers:this._filterTriggers(s,t)})).filter(s=>this._hasActiveRules(s,t)?!0:s.attributes.length>0)))}static{this.\u0275fac=function(t){return new(t||Hr)(i.\u0275\u0275inject(Xi),i.\u0275\u0275inject(Qi))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Hr,factory:Hr.\u0275fac,providedIn:"root"})}}class Wr{constructor(e,t,n,s,a,o,c){this._businessRulesManager=e,this._businessRulesTriggerExecutor=t,this._businessRulesConditionExecutor=n,this._httpClient=s,this._messageChannelService=a,this._featureService=o,this._contextFilter=c,this._businessRulesResponseEventName="BusinessRuleExecutionResponse",this._serviceUrl="ServiceModel/BusinessRulesEngineService.svc/Execute",this._businessRulesRequestEventName="BusinessRuleExecutionRequest",this._businessRuleDesignActionFactory=new Qi,this._configurationStructureChangedSubscribe()}_configurationStructureChangedSubscribe(){this._messageChannelService.getMessages("ConfigurationStructureChanged").pipe((0,l.switchMap)(()=>(this._contextFilter.clearCachedScopeAttributes(),this._businessRulesManager.clearCachedBusinessRules()))).subscribe()}_featureStates(){return(0,u.from)(this._featureService.getFeaturesState(["BRules-UseWebSocketChannel","BRules-DisableContextOptimization"])).pipe((0,l.map)(([e,t])=>({useHttpChannel:!e,disableContextOptimization:t})))}_sendWebSocketMessage(e){const t=(0,le.qv)();return e.businessRulesSessionId=t,new u.Observable(n=>{const s=this._messageChannelService.messageEvent$.pipe((0,l.map)(a=>a.body),(0,l.filter)(a=>a!=null),(0,l.filter)(a=>a.eventName===this._businessRulesResponseEventName),(0,l.filter)(a=>a.businessRulesSessionId===t),(0,l.map)(a=>a.payload)).subscribe({next:a=>{s.unsubscribe(),a.success?n.next(a.businessRulesResponse):(console.error("An error occurred during business rules execution. "+a.errorInfo.errorCode+": "+a.errorInfo.message),n.next([])),n.complete()},error:a=>{s.unsubscribe(),console.error("An error occurred during business rules execution. "+a.errorCode+": "+a.message),n.next([]),n.complete()},complete:()=>{s.unsubscribe(),n.error("WebSocket channel closed")}});this._messageChannelService.sendMessage(e,Lr.PTP).pipe((0,u.take)(1)).subscribe()})}_createWebSocketRequest(e){return{eventName:this._businessRulesRequestEventName,contexts:e}}_executeUsingWebSocket(e){const t=this._createWebSocketRequest(e);return this._sendWebSocketMessage(t)}_logErrorMessageAndReturnDefBusinessRuleResponse(e){return console.error("An error occurred during business rules execution. "+e.errorCode+": "+e.message),(0,u.of)([])}_executeUsingHttp(e){return this._httpClient.post(this._serviceUrl,{contexts:e},{headers:new P.HttpHeaders({"Content-Type":"application/json"})}).pipe((0,l.mergeMap)(t=>t.success?(0,u.of)(t.businessRulesResponse):this._logErrorMessageAndReturnDefBusinessRuleResponse(t.errorInfo)),(0,l.catchError)(t=>this._logErrorMessageAndReturnDefBusinessRuleResponse(t)))}_canExecuteBusinessRulesByContexts(e){return this._businessRulesManager.getBusinessRulesByContexts(e).pipe((0,l.map)(t=>{const n=t.filter(s=>s.rules&&s.rules.length>0);return n.length===0?!1:n.some(s=>{const a=e.find(p=>p.scopeName===s.scopeName&&p.scopeType===s.scopeType),o=e.filter(p=>p.parentScopeId===a.scopeId),c=this._businessRulesTriggerExecutor.canExecute(a,o,s.rules),d=this._businessRulesConditionExecutor.canExecute(a,s.rules);return c||d})}))}_getContextsWithScope(e){return e.filter(t=>t.scopeName&&t.scopeId)}_getBusinessRuleActions(e){return e.cases.map(t=>t.actions).flat().filter(t=>t.enabled).map(t=>this._businessRuleDesignActionFactory.get(t))}_getBusinessRuleAffectedAttributes(e){return this._getBusinessRuleActions(e).map(n=>n.getAffectedItems()).flat()}_getAffectedAttributes(e){let t=e.rules.filter(n=>n.enabled).map(n=>this._getBusinessRuleAffectedAttributes(n)).flat();return t=this._getUniqueAffectedAttributes(t),t.forEach(n=>{n.scopeName=e.scopeName}),t}_getUniqueAffectedAttributes(e){const t=e.map(s=>[s.name,s]);return[...new Map(t).values()]}_execute(e){return this._featureStates().pipe((0,l.switchMap)(({useHttpChannel:t,disableContextOptimization:n})=>(0,u.forkJoin)({useHttpChannel:(0,u.of)(t),executionContexts:n?(0,u.of)(e):this._contextFilter.filter(e)})),(0,l.switchMap)(({useHttpChannel:t,executionContexts:n})=>(t?this._executeUsingHttp(n):this._executeUsingWebSocket(n)).pipe((0,l.map)(s=>({executionResults:s,executionContexts:n})))),(0,l.switchMap)(({executionResults:t,executionContexts:n})=>this._logUnsuccessfulBusinessRulesExecution(t,n).pipe((0,l.map)(()=>t))))}_logUnsuccessfulBusinessRulesExecution(e,t){const n=e?.filter(s=>s?.errors?.length>0).map(s=>s.errors).flat();return n?.length===0?(0,u.of)(void 0):(0,u.from)(this._featureService.getFeatureState("BRules-ShowChildRules")).pipe((0,l.switchMap)(s=>this._businessRulesManager.getBusinessRulesByContexts(t).pipe((0,l.map)(a=>a.map(o=>o.rules).flat()),(0,l.tap)(a=>{n.map(o=>this._getUnsuccessfulBusinessRuleExecutionMessage(o,a,s)).forEach(o=>{console.error(o)})}),(0,l.map)(()=>{}))))}_getUnsuccessfulBusinessRuleExecutionMessage(e,t,n){const s="Business rule execution error: ",a=`Error message: "${e.message}"`,o=e.type===nl.Unknown?"":`The error occurred in the business rule ${nl[e.type]?.toLocaleLowerCase()}s.`;let c=t.find(O=>O.uId===e.businessRuleId);if(!c)return`${s}Rule id - "${e.businessRuleId}". ${a}. ${o}`;!(0,le.gZ)(c.parentUId)&&!n&&(c=t.find(O=>O.uId===c.parentUId));const d=c.caption||"",p=c.name,C=`Rule Title - "${d}"`,I=`Rule Code - "${p}"`;return`${s}${C}, ${I}. ${a}. ${o}`}execute(e){const t=this._getContextsWithScope(e);return t.length===0?(0,u.of)([]):this._canExecuteBusinessRulesByContexts(e).pipe((0,l.switchMap)(n=>n?this._execute(t):(0,u.of)([])),(0,l.catchError)(n=>(console.warn(`An error occurred during business rules execution for scopes: ${e?.map(s=>s.scopeName).join(", ")}.`,n),(0,u.of)([]))))}getAffectedAttributes(e){var t=this;return(0,f.A)(function*(){if(e.length===0)return[];const n=e.filter(o=>o.scopeName!=null),a=(yield(0,u.firstValueFrom)(t._businessRulesManager.getBusinessRulesByContexts(n))).filter(o=>o.rules&&o.rules.length>0);return a.length===0?[]:a.map(o=>t._getAffectedAttributes(o)).flat()})()}static{this.\u0275fac=function(t){return new(t||Wr)(i.\u0275\u0275inject(Xi),i.\u0275\u0275inject(kr),i.\u0275\u0275inject(jr),i.\u0275\u0275inject(P.HttpClient),i.\u0275\u0275inject(al),i.\u0275\u0275inject(kc),i.\u0275\u0275inject(Hr))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Wr,factory:Wr.\u0275fac})}}class Kn{static{this._actionAppliers=new Map}static register(e,t){Kn._actionAppliers.set(e,t)}get(e){const t=Kn._actionAppliers.get(e.typeName);if(!t)throw new Error(`Business rule applier for change type ${e.typeName} not found.`);return new t(e)}static{this.\u0275fac=function(t){return new(t||Kn)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Kn,factory:Kn.\u0275fac})}}class $r{constructor(e){this._actionApplierFactory=e}_applyBusinessRuleAction(e,t,n){const s=this._actionApplierFactory.get(n);return(0,u.firstValueFrom)(s.apply(e,t))}_applyBusinessRule(e,t){var n=this;return(0,f.A)(function*(){const s={id:t.scopeId,name:t.scopeName,type:t.scopeType,triggers:t.triggers};if(t.actions.length===0)return Promise.resolve(null);const a=[];for(const o of t.actions){const c=yield n._applyBusinessRuleAction(e,s,o);a.push(c)}return a})()}_applyBusinessRules(e,t){var n=this;return(0,f.A)(function*(){const s=[];for(const a of t){const o=yield n._applyBusinessRule(e,a);s.push(o)}return s})()}applyRules(e,t){return t&&t.length>0?(0,u.from)(this._applyBusinessRules(e,t)):(0,u.of)(null)}static{this.\u0275fac=function(t){return new(t||$r)(i.\u0275\u0275inject(Kn))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:$r,factory:$r.\u0275fac})}}class Kf{constructor(e={preventAttributeChangeRequest:!1,preventRunBusinessRules:!1,preventStateChange:!1,isMaskedValue:!1}){this._preventAttributeChangeRequest=!1,this._preventStateChange=!1,this._preventRunBusinessRules=!1,this._isMaskedValue=!1,this._setOptions(e)}_setUsingSilent(e){this._preventStateChange=e,this._preventRunBusinessRules=e,this._preventAttributeChangeRequest=!1}_setOptions(e){this._preventAttributeChangeRequest=e?.preventAttributeChangeRequest??this._preventAttributeChangeRequest,this._preventStateChange=e?.preventStateChange??this._preventStateChange,this._preventRunBusinessRules=e?.preventRunBusinessRules??this._preventRunBusinessRules,this._isMaskedValue=e?.isMaskedValue??this._isMaskedValue}getAsSilent(){return this._preventRunBusinessRules&&this._preventStateChange}getIsMaskedValue(){return this._isMaskedValue}setOptions(e){if((0,M.isUndefined)(e?.silent)){const t=(0,M.pick)(e,"preventAttributeChangeRequest","preventStateChange","preventRunBusinessRules","isMaskedValue");this._setOptions(t)}else this._setUsingSilent(e?.silent)}getOptions(){return{preventAttributeChangeRequest:this._preventAttributeChangeRequest,preventRunBusinessRules:this._preventRunBusinessRules,preventStateChange:this._preventStateChange,isMaskedValue:this._isMaskedValue}}reset(){this._preventAttributeChangeRequest=!1,this._preventRunBusinessRules=!1,this._preventStateChange=!1,this._isMaskedValue=!1}}var ol;(function(r){r.EntityDataSource="crt.EntityDataSource",r.WebServiceDataSource="crt.WebServiceDataSource",r.PageParametersDataSource="crt.PageParametersDataSource"})(ol||(ol={}));var es;(function(r){r.Reload="reload",r.Merge="merge"})(es||(es={}));function zS(r){const e=Object.keys(DataValueTypeGroup).find(t=>DataValueTypeGroup[t].includes(r));return DataValueTypeGroup[e]}function HS(r){return r===DataValueType.Lookup||r===DataValueType.Guid}function WS(r){return DataValueTypeItems[r]?.icon||null}function jc(r){return Object.values(Ki.Q).find(e=>e.name===r)?.type}function wh(r){return!(r&&!r?.value)}function qf(r){let e=!1;const t=[];return Object.keys(r).forEach(n=>{Eh(n,r)&&(e=!0,t.push(n))}),{hasCycles:e,cycledModelsNames:t}}function Eh(r,e,t=[]){if(!e[r])return!1;const n=Object.values(e[r]);return n.some(a=>t.includes(xh(a)))?!0:(t.push(r),!n.every(a=>!Eh(xh(a),e,t)))}function xh(r){return r.relationPath.split(".")[0]}class Th{}var ll;(function(r){r.AddTask="addTask",r.RemoveTask="removeTask"})(ll||(ll={}));class Ah extends Th{constructor(e,t,n){super(),this.action=e,this.taskName=t,this.$context=n,this.type="crt.SchemaViewMaskRequest"}}class Fc extends Uo{constructor(){super(...arguments),this.requestType="crt.MaskService"}showMask(e,t){return(0,f.A)(function*(){const n=new Ah(ll.AddTask,e,t);yield Qt.instance.process(n)})()}hideMask(e,t){return(0,f.A)(function*(){const n=new Ah(ll.RemoveTask,e,t);yield Qt.instance.process(n)})()}}(0,y.__decorate)([Lt(),(0,y.__metadata)("design:type",Function)],Fc.prototype,"showBodyMask",void 0),(0,y.__decorate)([Lt(),(0,y.__metadata)("design:type",Function)],Fc.prototype,"hideBodyMask",void 0);const Jf=new i.InjectionToken("DEVKIT_MASK_SERVICE",{providedIn:"root",factory:()=>new Fc});class Dh{constructor(e){this.ngZone=e}run(e,t,n){return this.ngZone.runOutsideAngular(e)}}class Qf extends Dh{constructor(e){super(e)}run(e,t,n){return this.ngZone.run(e,t,n)}}var Bc;(function(r){r.Root="root",r.Angular="angular",r.ExecutionTracking="executionTracking"})(Bc||(Bc={}));var Gr;(function(r){r[r.Busy=0]="Busy",r[r.Idle=1]="Idle"})(Gr||(Gr={}));var cl;(function(r){r.ReadyStateChange="readystatechange"})(cl||(cl={}));class Xf{constructor(e){this._trackedTasks=[],this._trackedEventTasks=[],this._enableDebugTracking=!1,this._disableWaits=!1,this._pendingFunctions=new Map,this.onStateChange$=new i.EventEmitter(!1),this._parentZone=Zone.current,this._rootZone=Zone.root,this._isBusy=!1,this._ignoredTaskSources=["setInterval","requestAnimationFrame"],this._eventTaskFilters=[t=>t.source.startsWith("XMLHttpRequest")&&t.source.endsWith(cl.ReadyStateChange)],this._zone=this._parentZone.fork({name:e,properties:{currentExecutionZone:this},onInvokeTask:this._onInvokeTask.bind(this),onCancelTask:this._onCancelTask.bind(this),onScheduleTask:this._onScheduleTask.bind(this),onHasTask:this._onHasTask.bind(this)})}wait(e){if(this._disableWaits)return e();this._isBusy||(this._isBusy=!0,this.onStateChange$.next(Gr.Busy));const t=(0,le.qv)();return this._pendingFunctions.set(t,this._enableDebugTracking?e:null),e().finally(()=>{this._pendingFunctions.delete(t),!this._pendingFunctions.size&&this._zone.run(()=>new Promise(n=>setTimeout(n)))}).catch(n=>{throw n})}_cancelXMLHttpRequestReadyStateChangeTaskOnRequestComplete(e,t){if(e.type==="eventTask"&&(e.state==="running"||e.state==="scheduled")){const n=e;n.eventName===cl.ReadyStateChange&&n.target.readyState===XMLHttpRequest.DONE&&t.cancelTask(n)}}_onInvokeTask(e,t,n,s,a,o){this._unTrackTask(s);let c;try{c=e.invokeTask(n,s,a,o),this._cancelXMLHttpRequestReadyStateChangeTaskOnRequestComplete(s,t)}catch(d){console.error(d),t.cancelTask(s)}return c}_onCancelTask(e,t,n,s){return this._unTrackTask(s),e.zone.runGuarded(()=>e.cancelTask(n,s))}_onScheduleTask(e,t,n,s){return this._getCanScheduleTask(s)?(this._trackTask(s),e.scheduleTask(n,s)):(s.cancelScheduleRequest(),this._parentZone.scheduleTask(s))}_onHasTask(e,t,n,s){e.hasTask(n,s);const a=s.eventTask||s.macroTask||s.microTask||this._pendingFunctions.size>0;this._isBusy!==a&&(this._rootZone.run(()=>this.onStateChange$.next(a?Gr.Busy:Gr.Idle)),this._isBusy=a)}_trackTask(e){this._enableDebugTracking&&(e.type==="eventTask"&&this._trackedEventTasks.push(e),this._trackedTasks.push(e))}_unTrackTask(e){if(!this._enableDebugTracking)return;const t=this._trackedTasks.indexOf(e);t>-1&&this._trackedTasks.splice(t,1)}_getCanScheduleTask(e){return e.type==="eventTask"?this._eventTaskFilters.some(t=>t(e)):this._ignoredTaskSources.indexOf(e.source)===-1}run(e,t,n){return this._zone.run(e,t,n)}}class ts{constructor(e){this._ngZone=e}createDefaultZones(){return{root:new Dh(this._ngZone),angular:new Qf(this._ngZone)}}createZone(e,t){if(t===Bc.ExecutionTracking)return new Xf(e);throw new Error(`Zone ${e} with type ${t} is not supported`)}static{this.\u0275fac=function(t){return new(t||ts)(i.\u0275\u0275inject(i.NgZone))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:ts,factory:ts.\u0275fac,providedIn:"root"})}}var qn;(function(r){r.Root="root",r.Angular="angular"})(qn||(qn={}));let Uc=class Hl{constructor(e){this._zoneProvider=e,this._zones=e.createDefaultZones()}init(e){var t=this;return(0,f.A)(function*(){t._disableExecutionTrackingZone=yield(0,u.lastValueFrom)(e("DisableExecutionTrackingZone"))})()}runInZone(e,t,n,s){return this._disableExecutionTrackingZone&&e!==qn.Angular&&(e=qn.Root),(this._zones[e]??this._zones[qn.Root]).run(t,n,s)}register(e,t){if(this._zones[e])throw new Error(`Zone ${e} already registered`);const n=this._zoneProvider.createZone(e,t);return this._zones[e]=n,n}get(e){return this._zones[e]}runOutside(e){return this.runInZone(qn.Root,e)}static{this.\u0275fac=function(t){return new(t||Hl)(i.\u0275\u0275inject(ts))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Hl,factory:Hl.\u0275fac,providedIn:"root"})}};Uc=(0,y.__decorate)([(0,T.op)({requestType:"crt.ZoneService"}),(0,y.__metadata)("design:paramtypes",[ts])],Uc);const Nh=new i.InjectionToken("CRT_METADATA_PREPROCESSOR");class e_{constructor(e,t){this.id=e,this._baseHostInjector=t,this._hostModuleTypes=[],this._hostModuleRefs=[],this._lazyModulesBySource=new Map,this._hostInjector=this._baseHostInjector}_createDynamicNgModule(e){const n=this._hostInjector.get(Nh,[]).map(o=>({provide:Nh,useValue:o,multi:!0})),s=(0,i.NgModule)({providers:n})(class{}),a=(0,i.NgModule)({imports:[s,...e]})(class{});return(0,i.createNgModule)(a,this._hostInjector)}inject(e){return this._hostInjector.get(e)}addLazyModule(e){const t=eh.get(e);if(!t)throw new Error("Module was not bootstrapped");const{source:n}=t;this._lazyModulesBySource.has(n)||this._lazyModulesBySource.set(n,new Set),this._lazyModulesBySource.get(n).add(e)}getLazyModules(e){return[...this._lazyModulesBySource.get(e)??[]]}connectHostLazyModules(){const e=this.getLazyModules("host");if((0,M.isEqual)(e,this._hostModuleTypes))return;const t=this._createDynamicNgModule(e);this._hostModuleTypes=e,this._hostModuleRefs.push(t),this._hostInjector=t.injector}destroy(){for(const e of this._hostModuleRefs)e.destroy();this._hostModuleRefs=[]}}class ns extends Ei.S{constructor(){super(...arguments),this._injectionContextsMap=new Map}createContext(e,t){const n=new e_(e,t);return this._injectionContextsMap.set(e,n),n}injectFromContext(e,t){return this._injectionContextsMap.get(e).inject(t)}removeContext(e){return this._injectionContextsMap.get(e)?.destroy(),this._injectionContextsMap.delete(e)}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=i.\u0275\u0275getInheritedFactory(ns)))(n||ns)}})()}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:ns,factory:ns.\u0275fac,providedIn:"root"})}}const t_=new i.InjectionToken("Terrasoft global object",{providedIn:"root",factory:()=>(0,M.get)((0,i.inject)(T.ZP),["Terrasoft"])||{}}),n_=new i.InjectionToken("Flag indicating that this is an angular host",{providedIn:"root",factory:()=>(0,M.get)((0,i.inject)(t_),["isAngularHost"])}),Ph=100;class is extends Ei.S{constructor(){super(...arguments),this._window=(0,i.inject)(T.ZP),this._requestBuffer=[],this._requestIter=0,this._cachedRequestIter=0,this._compressedRequestIter=0}_onRequest(e){const t=e.getEntries();for(const n of t){if(!n.name.startsWith(this._window.location.origin))return;this._requestIter++,n.transferSize||this._cachedRequestIter++,n.encodedBodySize!==n.decodedBodySize&&this._compressedRequestIter++,n.fetchStart&&n.responseStart&&n.responseEnd&&this._requestBuffer.push({name:n.name,initiatorType:n.initiatorType,transferSize:n.transferSize,responseStart:n.responseStart,responseEnd:n.responseEnd,fetchStart:n.fetchStart})}}_calculateLatency(e,t){return e/(t/1e3)/1e3/1e3||0}_normalizeUrl(e,t){try{return(e+new URL(t)?.pathname.replace("/0/","/")).slice(0,Ph)}catch{return t?.slice(0,Ph)}}_reset(){this._resourcePerformanceObserver?.disconnect(),this._markPerformanceObserver?.disconnect(),this._requestBuffer=[],this._compressedRequestIter=0,this._cachedRequestIter=0,this._requestIter=0}_downlink(){let e=0,t=0;return this._requestBuffer.forEach(s=>{s.initiatorType==="xmlhttprequest"&&(e+=s.transferSize,t+=s.responseEnd-s.responseStart)}),+this._calculateLatency(e,t).toFixed(1)}_withCache(){return Math.round(this._cachedRequestIter/this._requestIter*100)||0}_withCompression(){return Math.round(this._compressedRequestIter/this._requestIter*100)||0}_topRequests(e){const t=[];for(let n=this._requestBuffer.length-1;n>=0;n--){const s=this._requestBuffer[n],a=Math.round(s.responseEnd-s.fetchStart);if(a>=e.topRequestThreshold&&t.length<e.topRequestCount){const o=this._normalizeUrl(a,s.name);if(t.push(o),t.length===e.topRequestThreshold)return t}}return t}start(){this._reset(),this._resourcePerformanceObserver=this._resourcePerformanceObserver??new PerformanceObserver(this._onRequest.bind(this)),this._resourcePerformanceObserver.observe({type:"resource",buffered:!this._firstStart}),this._firstStart=!0}measure(e={topRequestThreshold:400,topRequestCount:5}){const t={transferred:0};return this._requestBuffer.sort((n,s)=>n.fetchStart-s.fetchStart),t.duration=this._calculateDuration(),t.transferred=this._calculateTransferred(),t.downlink=this._downlink(),t.cache=this._withCache(),t.compression=this._withCompression(),t.topRequests=this._topRequests(e),this._reset(),t}_calculateDuration(){let e=this._requestBuffer[0]?.responseEnd,t=this._requestBuffer[0]?.responseEnd-this._requestBuffer[0]?.fetchStart;return this._requestBuffer.forEach(n=>{e<n.fetchStart?t+=n.responseEnd-n.fetchStart:e<n.responseEnd&&(t+=n.responseEnd-e),e=Math.max(e,n.responseEnd)}),Math.round(t)||0}_calculateTransferred(){let e=this._requestBuffer.reduce((t,n)=>t+n.transferSize,0);return e=Math.round(e/1e3)||0,e}ngOnDestroy(){this._reset()}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=i.\u0275\u0275getInheritedFactory(is)))(n||is)}})()}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:is,factory:is.\u0275fac,providedIn:"root"})}}var jt;(function(r){r.PageStartLoading="PageStartLoading",r.PageFinishLoading="PageFinishLoading"})(jt||(jt={}));class Zr extends Ei.S{constructor(){super(),this._ngZone=(0,i.inject)(i.NgZone),this._window=(0,i.inject)(T.ZP),this._featureValues=(0,i.inject)(fe,{optional:!0}),this._isAngularHost=(0,i.inject)(n_,{optional:!0}),this._performanceNetworkObserver=(0,i.inject)(is),this._measureName="PageLoadDuration",this._debounceTime=100,this._subscriptions=new u.Subscription,this._measurements=[],this._tasks=new Set,this._loadingStarted=!1,this._loadingStartedCount=new Set,this._loadingFinishedCount=new Set,this._tasksQueueSubject=new u.Subject,this._pageLoadLifeCycleSubject=new u.Subject,this._iterationCounter=0,this.pageLoadDuration$=new u.Subject,this._enableMeasurement=!!this._isAngularHost&&!this._featureValues?.DisablePerformancePageLoadMeasurement,this._initSubscriptions(),(0,M.set)(this._window,"creatio.performance.measurePerformancePageLoadService",this)}_initSubscriptions(){this._enableMeasurement&&(this._subscriptions.add(this._tasksQueueSubject.pipe((0,u.debounceTime)(this._debounceTime),(0,l.filter)(e=>this._loadingStartedCount.size===this._loadingFinishedCount.size&&this._loadingStarted&&e.size===1&&e.has(jt.PageStartLoading))).subscribe({next:()=>this._pageLoadLifeCycleSubject.next(jt.PageFinishLoading)})),this._subscriptions.add(this._pageLoadLifeCycleSubject.subscribe({next:e=>{this._ngZone.runOutsideAngular(()=>{e===jt.PageStartLoading&&this._onStartPageLoadMeasure(),e===jt.PageFinishLoading&&this._onEndPageLoadMeasure()})}})))}_onStartPageLoadMeasure(){this.addTask(jt.PageStartLoading)}_getLocationInfo(){const e=this._window.location.hash,[t,n]=e.slice(1).split("/");return{moduleName:t,schemaName:n,hash:e}}_getMeasurementDetail(){const t=((0,M.get)(this._window,"creatio.performance")??{}).focusLossDuringLoad,n={iteration:this._iterationCounter++,location:this._getLocationInfo(),isReuse:!!this._isReuseMode,focusLossDuringLoad:!!t};return this._featureValues.DisablePerformancePageNetworkMeasurement||(n.network=this._performanceNetworkObserver.measure()),n}_onEndPageLoadMeasure(){this.removeTask(jt.PageFinishLoading),this.removeTask(jt.PageStartLoading);const e={start:this._startTime,detail:this._getMeasurementDetail(),end:this._window.performance.now()};this._measurements.push(()=>this._window.performance.measure(this._measureName,e)),this.pageLoadDuration$.next(e),this._reset()}_reset(){const e=(0,M.get)(this._window,"creatio.performance");e.initialLoad?e.initialLoad=!1:e.focusLossDuringLoad=null,this._startTime=null,this._tasks.clear(),this._loadingStarted=!1,this._loadingStartedCount.clear(),this._loadingFinishedCount.clear(),this._isReuseMode=null}setReuseMode(e){this._enableMeasurement&&this._isReuseMode===null&&(this._isReuseMode=e)}startPageLoadMeasure(e=performance.now()){this._enableMeasurement&&this._ngZone.runOutsideAngular(()=>{this._reset(),this._startTime=e,this._pageLoadLifeCycleSubject.next(jt.PageStartLoading),this._featureValues.DisablePerformancePageNetworkMeasurement||this._performanceNetworkObserver.start()})}addTask(e,t={}){this._enableMeasurement&&this._ngZone.runOutsideAngular(()=>{t.targetTask&&(this._loadingStartedCount.add(e),this._loadingStarted=!0),this._tasks.add(e),this._tasksQueueSubject.next(this._tasks)})}removeTask(e,t={}){this._enableMeasurement&&this._ngZone.runOutsideAngular(()=>{t.targetTask&&this._loadingFinishedCount.add(e),this._tasks.delete(e),this._tasksQueueSubject.next(this._tasks)})}getMeasurements(){const e=this._measurements.map(t=>t());return this._measurements=[],e}getMeasureDataOnTimeout$(){const e={start:this._startTime,end:this._window.performance.now(),detail:this._getMeasurementDetail(),timeout:!0};return this._measurements.push(()=>this._window.performance.measure(this._measureName,e)),this._reset(),(0,u.of)(e)}ngOnDestroy(){this._reset(),this._subscriptions.unsubscribe(),this._tasksQueueSubject.complete(),this._pageLoadLifeCycleSubject.complete(),this.pageLoadDuration$.complete()}static{this.\u0275fac=function(t){return new(t||Zr)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Zr,factory:Zr.\u0275fac,providedIn:"root"})}}var ul;(function(r){r.Readonly="READONLY_PROPERTY",r.Disabled="DISABLED_PROPERTY"})(ul||(ul={}));class Rh{constructor(e,t,n=!1){this.name=e,this._value=t,this._locked=n,this._isValueInitialized=!1,this._pendingValue=void 0,this._onChanged=new i.EventEmitter,this._hasInitialValue=!1,t!=null&&(this._isValueInitialized=!0,this._hasInitialValue=!0,this._initialValue=t)}get onChanged(){return this._onChanged}get value(){return this.getValue()}set value(e){this.setValue(e)}get initialValue(){return this._initialValue}set initialValue(e){this.setInitialValue(e)}get hasInitialValue(){return this._hasInitialValue}get isLocked(){return this._locked}emitValueChanged(e){this.onChanged.emit(e)}areValuesEqual(e,t){return(0,M.isEqual)(e,t)}getValue(){return this._value}setValue(e,t=!1){if(this._locked||(this._isValueInitialized=!0,this._pendingValue=e,this.areValuesEqual(this._value,e)))return;const n=(0,M.cloneDeep)(this._value);this._value=(0,M.cloneDeep)(e),!t&&this.emitValueChanged({name:this.name,value:e,oldValue:n})}resetValue(){this.hasInitialValue&&this.setValue(this.initialValue)}setInitialValue(e){this._hasInitialValue=!0,this._initialValue=e,this._isValueInitialized||this.setValue(e,!0)}setPending(e){const t=typeof this._pendingValue>"u"?this.value:this._pendingValue;this.value=e,this._pendingValue=t}resetPending(){this.value=this._pendingValue,this._pendingValue=void 0}}class Oh extends Rh{constructor(e,t,n,s,a=!1){super(e,t,a),this._validatorTypeResolver=n,this._injectionContext=s,this._onValidatorChanged=new i.EventEmitter}get onValidatorChanged(){return this._onValidatorChanged}_createValidatorInfo(){return{name:this.validatorTypeName,instance:this._validatorTypeResolver.getValidator(this.validatorTypeName,{injectionContext:this._injectionContext}),disabled:!0}}emitValueChanged(e){super.emitValueChanged(e),this.hasValidator&&this.updateValidator(e)&&this._onValidatorChanged.emit()}get hasValidator(){return!1}updateValidator(e){return!1}setValidatorInfo(e,t=!1){this.validatorInfo=e}initializeValidator(e,t=!1){if(!this.hasValidator||this._validatorTypeResolver==null)return e;let n=e.find(a=>a.name===this.validatorTypeName),s=!1;return n==null&&(n=this._createValidatorInfo(),s=!0),this.setValidatorInfo(n,t),s?[...e,n]:e}}class i_{static{this._properties=new Map}static _get(e){if(!e)return Oh;if(this._properties.has(e))return this._properties.get(e);throw new Error(`CrtControlProperty with type ${e} doesn't registered`)}static register(e,t){this._properties.set(e,t)}static create(e){const t=this._get(e.typeName);return new t(e.name,e.value,e.validatorTypeResolver,e.injectionContext,e.locked===!0)}}const s_="DataValueType";class dl extends Rh{get propertiesConfig(){return[{name:"visible",defaultValue:!0},{name:"displayColor"},{name:"required",typeName:"crt.Required",defaultValue:!1}]}get formControl(){return this._formControl||(this._formControl=new Z.FormControl(this.value),this._subscribeOnFormControl(this._formControl)),this._formControl}set formControl(e){this._formControl=e,this._subscribeOnFormControl(this._formControl)}get properties(){return this._properties}get onPropertyChanged(){return this._onPropertyChanged}get visible(){return this.getPropertyByName("visible").getValue()}set visible(e){const t=this.getPropertyByName("visible");t.value=e}get required(){return this.getPropertyByName("required").getValue()}set required(e){const t=this.getPropertyByName("required");t.value=e}get displayColor(){return this.getPropertyByName("displayColor").getValue()}set displayColor(e){const t=this.getPropertyByName("displayColor");t.value=e}get isDirty(){return this.formControl.dirty}constructor(e=null,t,n=null,s=!1,a="",o=[],c,d,p,C){super(a,e),this._featureValues=t,this.validationState=n,this.disabled=s,this._subscription=new u.Subscription,this._appliedValidatorsCache=new Map,this._onPropertyChanged=new i.EventEmitter,this._crtControlStateAdapter=c,this._validatorTypeResolver=d,this._injectionContext=C,this._initProperties(o),this._subscribeOnPropertiesEvents(),this._initializeValidators(p??[],!0)}_subscribeOnFormControl(e){this._formControlSubscription?.unsubscribe(),this._formControlSubscription=e.valueChanges.pipe((0,l.startWith)(e.value),(0,l.distinctUntilChanged)((t,n)=>this.areValuesEqual(t,n))).subscribe(t=>{this.setValue(t)})}_initProperties(e){const t=[...this.propertiesConfig,...e];this._properties=new Map,t.forEach(n=>{const s=i_.create({typeName:n.typeName,name:n.name,value:n.defaultValue,locked:n.locked===!0,validatorTypeResolver:this._validatorTypeResolver,injectionContext:this._injectionContext});this._properties.set(n.name,s)})}_subscribeOnPropertyEvents(e){this._subscription.add(e.onChanged.subscribe(({name:t,value:n,oldValue:s})=>{this.onPropertyChanged.emit({name:t,value:n,oldValue:s})})),this._subscription.add(e.onValidatorChanged.subscribe(()=>{this._refreshValidators()}))}_subscribeOnPropertiesEvents(){this.properties.forEach(e=>{this._subscribeOnPropertyEvents(e)})}_initializeValidators(e,t=!1){this._validatorInfo=e,this._properties.forEach(n=>{this._validatorInfo=n.initializeValidator(this._validatorInfo,t)}),this._refreshValidators()}_useValidatorsMerging(){return!this._featureValues.DisableControlValidatorsMerging}_getEnabledValidatorFns(e=!1){return this._validatorInfo.filter(t=>!t.disabled&&t.instance.isAsync===e).map(t=>{if(this._useValidatorsMerging()){const s=this._appliedValidatorsCache.get(t.name);if(s)return s.validatorFn}const n=this._crtControlStateAdapter.transform(t);return this._useValidatorsMerging()&&this._appliedValidatorsCache.set(t.name,{validatorInfo:t,validatorFn:n}),n})??[]}_mergeValidators(e,t){for(const n of this._appliedValidatorsCache.values())if(n.validatorInfo.instance.isAsync){const a=n.validatorFn;t.includes(a)?this.formControl.hasAsyncValidator(a)||this.formControl.addAsyncValidators(a):this.formControl.removeAsyncValidators(a)}else{const a=n.validatorFn;e.includes(a)?this.formControl.hasValidator(a)||this.formControl.addValidators(a):this.formControl.removeValidators(a)}}_refreshValidators(){const e=this._getEnabledValidatorFns(),t=this._getEnabledValidatorFns(!0);this._useValidatorsMerging()?this._mergeValidators(e,t):(this.formControl.setValidators(e),this.formControl.setAsyncValidators(t)),this.formControl.updateValueAndValidity()}_updateValidator(e,t=!1){const n=this._validatorInfo.find(s=>s.name===e);if(!n)throw new Error(`Validator ${e} does not exist on ${this.name} attribute.`);n.disabled!==t&&(n.disabled=t,this._refreshValidators())}findPropertyByName(e){return this.properties.has(e)?this.properties.get(e):null}static create(e){return new dl(e.value,e.featureValues,null,!1,e.name,e.propertiesConfig??[],e.crtControlStateAdapter,e.validatorTypeResolver,e.validatorsInfo,e.injectionContext)}setValue(e,t){const n=this.formControl;this.areValuesEqual(e,n.value)||(n.dirty||n.markAsDirty(),n.setValue(e,{onlySelf:!!t})),super.setValue(e,t)}enableValidator(e){this._updateValidator(e,!1)}disableValidator(e){this._updateValidator(e,!0)}change(e){this.setValue(e)}getPropertyByName(e,t=!1){let n=this.findPropertyByName(e);return!n&&t&&(n=new Oh(e,null,this._validatorTypeResolver,this._injectionContext),this._properties.set(e,n),this._subscribeOnPropertyEvents(n)),n}hasPropertyValue(e){return!!this.getPropertyByName(e)}getPropertyValue(e){const t=this.getPropertyByName(e);return t?t.getValue():null}setPropertyValue(e,t,n=!1){this.getPropertyByName(e,!0).setValue(t,n)}setPropertyInitialValue(e,t){this.getPropertyByName(e,!0).setInitialValue(t)}getPropertyInitialValue(e){return this.getPropertyByName(e)?.initialValue}getValue(){return this._formControl?this._formControl.value:super.getValue()}destroy(){this._formControlSubscription?.unsubscribe(),this._subscription.unsubscribe()}getInvariabilityPropertyName(){const e=this.getPropertyValue(ul.Readonly),t=this.getPropertyValue(ul.Disabled);return e??t}toggle(e){const t=this.getInvariabilityPropertyName(),n=this.getPropertyByName(t);n&&(e?n.resetPending():n.setPending(!0))}}const hl="maskState",zc="maskedValue",Hc="unMaskedValue";var Wc;(function(r){r.Unmasked="unmasked",r.Masked="masked"})(Wc||(Wc={}));const Vh=Symbol("isAttributeValueMasked"),r_=Symbol("getMaskedValue"),a_=Symbol("getUnmaskedValue"),o_=Symbol("setMaskedState"),l_=Symbol("getMaskedState"),c_="calculated",u_=new i.InjectionToken("View model attribute creator factory");function d_(r){const e=r;return e?!!e?.modelConfig||!!e?.embeddedModel||!!e?.value:!1}function Lh(r){const e=r;return e?!!e.from||!!e.triggers||!!e.converter:!1}function kh(r){return r.replace(/\.+/g,"").replace(/\[+/g,"").replace(/\]+/g,"").replace(/:+/g,"")}const h_="DS",p_="DYN";function Yr(r){for(;r?.parent;)r=r.parent;return r}function Jn(r){return r?.getDataSource()?.scope===Vt.Page}function $S(r){const e=[];return r?._modelsMap.forEach((t,n)=>{Jn(t)&&e.push(n)}),e}class Kr{static{this._dataCache=new WeakMap}static _getDataSourceColumns(e){const t={};let n=!1;for(const[s,a]of Object.entries(e.dataSourceConfig.config.attributes)){const o=a.path;t[kh(s)]=o,o==="Id"&&(n=!0)}return!n&&e.includePrimaryAttributes!==!1&&(t.Id="Id"),t}static _createAttributesConfigMap(e,t,n,s,a){const o={},c=this.getAttributeDataSourceOldName(e,s);for(const[d]of Object.entries(t)){const p=a.config?.useOriginalAttributesName?`${d}`:`${c}_${d}`,C=a.config.attributes[d],I={path:`${n}.${d}`,type:C?.type,functionConfig:C?.functionConfig,aggregationConfig:C?.aggregationConfig};o[p]={modelConfig:I}}return o}static _createAttributePagingConfig(e){return e.pagingConfig||{rowCount:30}}static _createAttributeSortingConfig(e){return e.sortingConfig||{attributeName:e.attributeName+"Sorting"}}static _createAttributeFiltersConfig(e){return e.filtersConfig?.map(t=>{const n={...t};return delete n.value,n})||[]}static _getDataSourceNameForDynamicModel(e,t){return e.getBoundDataSourceNameByAttributePath(t)||this._getAttributeDataSourceDefaultName(t)}static _getDynamicDataSourceNamePrefix(){return`${p_}_`}static _isDynamicDataSourceName(e){return e.startsWith(this._getDynamicDataSourceNamePrefix())}static _getAttributeDataSourceDefaultName(e){return`${e}${h_}`}static _getLoadData(e,t,n,s){let a;return this._dataCache.has(e)?a=this._dataCache.get(e):(a=t.load(n,[]).pipe((0,l.share)(),(0,l.tap)(()=>this._dataCache.delete(e))),this._dataCache.set(e,a)),(0,u.lastValueFrom)(a.pipe((0,u.map)(()=>s())),{defaultValue:null})}static createAttributeConfig(e,t,n){const s=n.attributeName,a=n.dataSourceConfig,o=this._getDataSourceColumns(n),c=this._createAttributesConfigMap(e,o,t,s,a),d=this._createAttributePagingConfig(n),p=this._createAttributeSortingConfig(n),C=this._createAttributeFiltersConfig(n);return{isCollection:!0,modelConfig:{path:t,pagingConfig:d,sortingConfig:p,filterAttributes:C},viewModelConfig:{attributes:c}}}static getAttributeDataSourceOldName(e,t){let n=this._getDataSourceNameForDynamicModel(e,t);return(!n||this._isDynamicDataSourceName(n))&&(n=this._getAttributeDataSourceDefaultName(t)),n}static createDynamicDataSourceNameFromAttributeName(e,t){const n=this._getDynamicDataSourceNamePrefix(),s=this._getDataSourceNameForDynamicModel(e,t);return this._isDynamicDataSourceName(s)?s:`${n}${s}`}static defineAsyncAttribute(e,t,n,s,a){const o=n.modelConfig?.path?.split(".")[0],c=e.getModelByName(o),d="isLookup"in n&&n.isLookup,p="isCollection"in n&&n.isCollection;Object.defineProperty(e,t,{get:()=>c&&p&&!d&&!c?.isLoaded?this._getLoadData(c,e,o,s):Promise.resolve(s()),set:a,configurable:!0})}static deferUpdatingValueAndValidity(e,t,n){if(n?.["ViewModel.DontDeferUpdatingValueAndValidity"])return t();const s=e.formApiModel.updateValueAndValidity;if(s.callbackCount)s.callbackCount++;else{const c=(0,T.S)();c.callbackCount=1,c.originalFn=s.bind(e.formApiModel),e.formApiModel.updateValueAndValidity=c}const a=t(),o=()=>{const c=e.formApiModel.updateValueAndValidity;c.callbackCount===1?(e.formApiModel.updateValueAndValidity=c.originalFn,e.formApiModel.updateValueAndValidity()):c.callbackCount--};return a instanceof Promise?a.finally(o):a.pipe((0,l.finalize)(o))}}class ss{transform(e){return function(t){const{instance:n,params:s}=e,a={value:t.value};return n.validate(a,s)}}static{this.\u0275fac=function(t){return new(t||ss)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:ss,factory:ss.\u0275fac,providedIn:"root"})}}class jh{constructor(e){this.injector=e}}class rs{resolveModelConfig(e){return null}static{this.\u0275fac=function(t){return new(t||rs)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:rs,factory:rs.\u0275fac,providedIn:"root"})}}class pl{constructor(){this.account={attributes:{Name:{},Ships:{isCollection:!0,viewModelConfig:"ship"},Employee:{viewModelConfig:"employee"}}},this.ship={attributes:{Id:{}}},this.employee={attributes:{Name:{},Age:{}}}}resolveModelConfig(e){return(0,u.of)(this[e]).pipe((0,l.delay)(50))}static{this.\u0275fac=function(t){return new(t||pl)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:pl,factory:pl.\u0275fac,providedIn:"root"})}}class qr{constructor(e){this.injector=e,this.initDependencies()}initDependencies(){this.repository=this.injector.get(rs),this.ngZone=this.injector.get(i.NgZone)}static{this.\u0275fac=function(t){return new(t||qr)(i.\u0275\u0275inject(i.Injector))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:qr,factory:qr.\u0275fac})}}const m_=h(85088);class Jr{sort(e,t){const n=[];let s=[];Object.entries(e||{}).forEach(([o,c])=>{if(Lh(c)){let d=c.from;d=Array.isArray(d)?d:[d];const p=d.map(C=>[o,C]);s=s.concat(p)}else n.push(o)});const a=m_(s).reverse();return[...n,...a].filter(Boolean).filter((o,c,d)=>d.indexOf(o)===c).map(o=>{const c=a.includes(o)?e[o]??t[o]:e[o];return[o,c]})}static{this.\u0275fac=function(t){return new(t||Jr)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Jr,factory:Jr.\u0275fac,providedIn:"root"})}}class Qr{constructor(e,t,n,s,a,o,c){this._crtControlStateAdapter=e,this._validatorTypeResolver=t,this._viewModelGenerator=n,this._attributeCreator=s,this._viewModelRepository=a,this._attributesTopologicalSorting=o,this._injector=c,this._featureValues=this._injector.get(fe,null,{optional:!0}),this._measurePerformanceService=this._injector.get(et)}_generateAttributes(e,t,n){const s=this._attributesTopologicalSorting.sort(t,e._attributeConfigs);return Promise.all(s.map(([a,o])=>e._systemAttributes.includes(a)?(console.warn(`Overriding of system attributes is denied. Attribute name:"${a}"`),Promise.resolve()):(n.disableDefaultConfig||(o??={}),e._attributeConfigs[a]=o,o?"viewModelConfig"in o||"viewModelName"in o?o.isCollection?this._generateNestedModelCollectionAttribute(e,a,o,n):this._generateNestedModelAttribute(e,a,o,n):Lh(o)?this._generateCalculatedAttribute(e,a,o,n):this._generateModelAttribute(e,a,o,n):this._removeViewModelAttribute(e,a))))}_generateNestedModelCollectionAttribute(e,t,n,s){var a=this;return this._measurePerformanceService.measureCallback(`BaseViewModelAttributeGenerator.nestedCollectionAttribute.${t}`,(0,f.A)(function*(){const o=e.getBoundDataSourceNameByAttributePath(t),c=e.getModelByName(o),d="viewModelConfig"in n?n.viewModelConfig:yield(0,u.lastValueFrom)(a._viewModelRepository.resolveModelConfig(n.viewModelName)),p=new tt(a._viewModelGenerator,d,c,e,t);a._registerOrSetFormControl(e.formApiModel,t,p.formApiModel);const C=e.attributes[t];e.attributes[t]=p,a._defineNestedModelAttribute(e,t,n,s),a._subscribeOnCollectionChanged(e,t,p,s),C!==void 0&&s.onChangeAttributeValue(t,p,C)}))}_defineNestedModelAttribute(e,t,n,s){const a=c=>{const d=e.attributes[t];e.attributes[t]=c,d instanceof tt&&c instanceof tt&&this._subscribeOnCollectionChanged(e,t,c,s),s.onChangeAttributeValue(t,c,d)},o=()=>e.attributes[t];Kr.defineAsyncAttribute(e,t,n,o,a)}_generateNestedModelAttribute(e,t,n,s){return this._measurePerformanceService.measureCallback(`BaseViewModelAttributeGenerator.nestedModelAttribute.${t}`,()=>{const a="viewModelConfig"in n?n.viewModelConfig:n.viewModelName,o=e?.[$n];return(0,u.lastValueFrom)(this._viewModelGenerator.generate({viewModelConfig:a,parentViewModel:e},o?i.Injector.create({providers:[{provide:jo,useValue:null}],parent:o}):null).pipe((0,u.map)(c=>{this._registerOrSetFormControl(e.formApiModel,t,c.formApiModel);const d=e.attributes[t];e.attributes[t]=c,this._defineNestedModelAttribute(e,t,n,s),d!==void 0&&s.onChangeAttributeValue(t,c,d)})))})}_subscribeOnCollectionChanged(e,t,n,s){if(e._collectionSubscription.has(t)){const o=e._collectionSubscription.get(t);o.unsubscribe(),e._subscriptions.remove(o)}const a=new u.Subscription;a.add(n.changed.subscribe(()=>{s.onChangeAttributeValue(t,n,null)})),a.add(n.itemAttributeChanged.subscribe(()=>{s.onChangeAttributeValue(t,n,null)})),e._collectionSubscription.set(t,a),e._subscriptions.add(a)}_generateCalculatedAttribute(e,t,n,s){this._measurePerformanceService.measure(`BaseViewModelAttributeGenerator.generateCalculatedAttribute.${t}`,()=>{this._attributeCreator.create(c_)?.defineAttribute({viewModel:e,attribute:t,attributeConfig:n,generateOptions:s})})}_getCrtControlPropertiesConfig(e,t,n){const s=Object.entries(n.properties??[]).map(([a,o])=>({name:a,defaultValue:o.defaultValue,locked:o.locked===!0}));return this._addDataValueTypePropertyConfig(s,n),this._addMaskedPropertyConfig(e,t,s,n),this._disableSystemAttributes(e,t,s),s}_addDataValueTypePropertyConfig(e,t){t.dataValueTypeName&&e.push({name:s_,defaultValue:E.r[t.dataValueTypeName]})}_addMaskedPropertyConfig(e,t,n,s){this._isNotAllowMaskedPropertyConfig(e,t,s)||(s.isValueMasked=!0,this._getOrCreatePropertyConfig(n,hl),this._getOrCreatePropertyConfig(n,zc),this._getOrCreatePropertyConfig(n,Hc))}_isNotAllowMaskedPropertyConfig(e,t,n){const a=e.getBoundDataSchemaAttributeByAttributePath(t)?.isValueMasked,o=n.isValueMasked;return a&&o===!1||!a&&!o}_disableSystemAttributes(e,t,n){if(this._featureValues?.DisableBlockingSystemColumns===!0)return;if(e.getBoundDataSchemaAttributeByAttributePath(t)?.isSystem){const a=this._getOrCreatePropertyConfig(n,"readonly");a.locked=!0,a.defaultValue=!0}}_getOrCreatePropertyConfig(e,t){let n=this._findPropertyConfigByName(e,t);return n||(n={name:t},e.push(n)),n}_findPropertyConfigByName(e,t){return e.find(n=>n.name===t)}_generateModelAttribute(e,t,n,s){this._measurePerformanceService.measure(`BaseViewModelAttributeGenerator.generateModelAttribute.${t}`,()=>{const a=e.attributes[t],o=n?.value,c=this._getCrtControlPropertiesConfig(e,t,n),d=dl.create({name:t,value:o,crtControlStateAdapter:this._crtControlStateAdapter,validatorTypeResolver:this._validatorTypeResolver,validatorsInfo:e._validators[t],propertiesConfig:c,injectionContext:e._injectionContext??Yr(e)?._injectionContext,featureValues:this._featureValues});e._subscriptions.add(d.onChanged.subscribe(I=>{e.attributes[t]=I.value,s.onChangeAttributeValue(I.name,I.value,I.oldValue)})),e._subscriptions.add(d.onPropertyChanged.subscribe(({name:I,value:O,oldValue:Y})=>{s.onChangeAttributeValue(`${t}:${I}`,O,Y)})),e._crtControls.set(t,d),this._registerOrSetFormControl(e.formApiModel,t,d.formControl),e.attributes[t]=o??null;const p=e._getDataSourceAttributeDataValueType(t);this._attributeCreator.create(p).defineAttribute({viewModel:e,attribute:t,attributeConfig:n,control:d}),a!==void 0&&s.onChangeAttributeValue(t,o,a)})}_registerOrSetFormControl(e,t,n){this._measurePerformanceService.measure(`BaseViewModelAttributeGenerator.registerOrSetFormControl.${t}`,()=>{if(this._featureValues?.DisableAttributeOnlyRegisteringControl){e.setControl(t,n);return}e.contains(t)?e.setControl(t,n):e.registerControl(t,n)})}_removeViewModelAttribute(e,t){return delete e._attributeConfigs[t],delete e.attributes[t],delete e[t],Promise.resolve()}generate(e,t,n){var s=this;return this._measurePerformanceService.measureCallback("BaseViewModelAttributeGenerator.generateAttributes",()=>Kr.deferUpdatingValueAndValidity(e,(0,f.A)(function*(){yield s._generateAttributes(e,t,n),!s._featureValues?.DisableAttributeOnlyRegisteringControl&&e.formApiModel.updateValueAndValidity()}),this._featureValues))}static{this.\u0275fac=function(t){return new(t||Qr)(i.\u0275\u0275inject(ss),i.\u0275\u0275inject(jh),i.\u0275\u0275inject(qr),i.\u0275\u0275inject(u_),i.\u0275\u0275inject(rs),i.\u0275\u0275inject(Jr),i.\u0275\u0275inject(i.Injector))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Qr,factory:Qr.\u0275fac,providedIn:"root"})}}class Xr{_defineResourceAttribute(e,t,n,s,a){return new u.Observable(o=>{const c=e._getDataSourceAttributeCaption(s,a);if(this._defineResourceProperty(t,n,c),s.includes(".")){const d=s.split(".")[1];this._defineResourceProperty(t,d,c)}o.next(),o.complete()})}_defineResourceProperty(e,t,n){e[t]||Object.defineProperty(e,t,{get:()=>Promise.resolve(n??""),configurable:!0})}_getResourceNameByPath(e){const t=e.split(".");return t.length>1?t.join("_"):e}generate(e,t){return Object.entries(t||{}).map(([n,s])=>{const a=e[xr][Hi.string],o=this._getResourceNameByPath(n);return this._defineResourceAttribute(e,a,o,n,s)})}static{this.\u0275fac=function(t){return new(t||Xr)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Xr,factory:Xr.\u0275fac,providedIn:"root"})}}const ml="HasUnsavedData",ea="IsChanged",$c="PrimaryModelMode",Gc="BusinessRulesActivated",gl="State";var vn;(function(r){r.DebouncingBusinessRules="DebouncingBusinessRules",r.RunningBusinessRules="RunningBusinessRules",r.ProcessingAttributeChangeRequest="ProcessingAttributeChangeRequest",r.AttributeLoading="AttributeLoading"})(vn||(vn={}));var Zc;(function(r){r.Paused="Paused",r.Active="Active"})(Zc||(Zc={}));var ye;(function(r){r.OwnAttribute="Own",r.ForwardReferenceAttribute="ForwardReference",r.BackReferenceAttribute="BackReference",r.AggregationAttribute="Aggregation",r.FunctionAttribute="Function"})(ye||(ye={}));var Fh;(function(r){r[r.General=0]="General",r[r.Advanced=1]="Advanced",r[r.None=2]="None"})(Fh||(Fh={}));class In{get attributes(){return this._parent?[...this._parent.attributes,...this._attributes]:[...this._attributes]}get parent(){return this._parent}constructor(e){if(e!=null){this.name=e.name,this.type=e.type,e.caption&&(this.caption=typeof e.caption=="string"?e.caption:{...e.caption}),this.primaryAttributeName=e.primaryAttributeName,this.primaryDisplayAttributeName=e.primaryDisplayAttributeName,this.primaryColorAttributeName=e.primaryColorAttributeName,this.hierarchyAttributeName=e.hierarchyAttributeName,this.createdByAttributeName=e.createdByAttributeName,this.createdOnAttributeName=e.createdOnAttributeName,this.modifiedByAttributeName=e.modifiedByAttributeName,this.modifiedOnAttributeName=e.modifiedOnAttributeName,e.dataSourceConfig&&(this.dataSourceConfig={...e.dataSourceConfig,config:{...e.dataSourceConfig.config}}),this._parent=e.parent;const t=e.attributes??[];this._attributes=[],t.forEach(n=>{if(this._parent){this._parent.findAttributeByName(n.name)||this._attributes.push(n.clone());return}this._attributes.push(n.clone())})}else this._attributes=[]}clearAttributes(){this._attributes=[]}addAttribute(e){if(this._parent){this._parent.findAttributeByName(e.name)||this._attributes.push(e);return}this._attributes.push(e)}findAttributeByName(e){return this.attributes.find(t=>t.name===e)??null}getPrimaryAttributesNames(){return[this.primaryAttributeName]}getPrimaryLoadAttributes(){const e=[];return this.primaryAttributeName&&e.push(this.primaryAttributeName),this.primaryDisplayAttributeName&&e.push(this.primaryDisplayAttributeName),e}clone(){return new In(this)}createChild(){const e=new In;return e.name=this.name,e.type=this.type,this.caption&&(e.caption=typeof this.caption=="string"?this.caption:{...this.caption}),e.primaryAttributeName=this.primaryAttributeName,e.primaryDisplayAttributeName=this.primaryDisplayAttributeName,e.primaryColorAttributeName=this.primaryColorAttributeName,e.hierarchyAttributeName=this.hierarchyAttributeName,e.createdByAttributeName=this.createdByAttributeName,e.createdOnAttributeName=this.createdOnAttributeName,e.modifiedByAttributeName=this.modifiedByAttributeName,e.modifiedOnAttributeName=this.modifiedOnAttributeName,this.dataSourceConfig&&(e.dataSourceConfig={...this.dataSourceConfig,config:{...this.dataSourceConfig.config}}),e._attributes=[],e._parent=this,e}}class Bh extends Error{get isCritical(){return!0}constructor(e,t){super(t),this.dataSource=e}}class Yc extends Bh{constructor(e,t){super(e,t)}}class g_ extends Bh{get isCritical(){return!1}constructor(e,t){super(e,t)}}class Kc{constructor(e,t){this.dataSourceName=e,this.injector=t,this._errors=[],this.supportTransactions=!1}get scope(){return this._scope}get hasErrors(){return this._errors.length!==0}get hasCriticalErrors(){return this._errors.some(e=>e.isCritical)}get affectedAttributes(){return[]}get isForceUpdateUnchangedData(){return!1}getLastError(){return this.hasErrors?this._errors[this._errors.length-1]:null}get isAggregate(){return!1}getEmptySchema(){return new In}init(e,t){return this.initialConfig=e,this._scope=t,(0,u.of)(this)}load(e,t,n){return this.innerLoad(e,t,n)}save(e,t){return this.innerSave(e,t)}insert(e){return this.innerInsert(e)}delete(e){return this.innerDelete(e)}getSchema(){return this.dataSchema?(0,u.of)(this.dataSchema):this.innerGetSchema().pipe((0,l.tap)(e=>{this.dataSchema=e}))}getLookupDataSchema(e){return this.innerGetLookupDataSchema(e)}getDefaultValues(){return this.innerGetDefaultValues()}canEdit(e){return this.innerCanEdit(e)}canDelete(e){return this.innerCanDelete(e)}canCreate(e){return this.innerCanCreate(e)}getOwnLoadParameters(){return null}getAllowCopyingRecords(){return!1}}const Uh="crt.EntityDataSource",zh="crt.PageParametersDataSource",GS="PageParameters";var Ee=h(78240);class ta{static{this._instanceOfKey="devkit_BaseFilter"}static get _instanceOfKeys(){return[this._instanceOfKey]}static[Symbol.hasInstance](e){return(e?.constructor?._instanceOfKeys??[]).includes(this._instanceOfKey)}constructor(e){this.isEnabled=!0,this.trimDateTimeParameterToDate=!1,this.filterType=e}static fromJson(e,t,n){throw new Error(`fromJson not supported on filter type ${this.constructor.name}`)}serializeItem(e){return typeof e.toJson=="function"?e.toJson():(0,Ee.classToPlain)(e,{exposeUnsetFields:!1,excludePrefixes:["_"]})}toJson(){return(0,Ee.classToPlain)(this,{exposeUnsetFields:!1,excludePrefixes:["_"]})}}class Ft extends ta{static{this._instanceOfKey="devkit_SingleFilter"}static get _instanceOfKeys(){return[...ta._instanceOfKeys,this._instanceOfKey]}constructor(e,t,n){super(e),this.comparisonType=t,this.leftExpression=n?.clone()}toJson(){return{...super.toJson(),leftExpression:this.serializeItem(this.leftExpression)}}_getUsedColumns(){return this.leftExpression._getUsedColumns()}}var Ie;(function(r){r[r.None=0]="None",r[r.Compare=1]="Compare",r[r.IsNull=2]="IsNull",r[r.Between=3]="Between",r[r.In=4]="In",r[r.Exists=5]="Exists",r[r.FilterGroup=6]="FilterGroup"})(Ie||(Ie={}));class Bt extends Ft{static{this._instanceOfKey="devkit_CompareFilter"}static get _instanceOfKeys(){return[...Ft._instanceOfKeys,this._instanceOfKey]}constructor(e,t,n){super(Ie.Compare,e,t),this.filterType=Ie.Compare,this.rightExpression=n?.clone()}static fromJson(e,t,n){return new Bt(e.comparisonType,n.fromJson(e.leftExpression,t),n.fromJson(e.rightExpression,t))}clone(){const e=new Bt(this.comparisonType,this.leftExpression,this.rightExpression);return e.isEnabled=this.isEnabled,e.trimDateTimeParameterToDate=this.trimDateTimeParameterToDate,e}toJson(){return{...super.toJson(),rightExpression:this.serializeItem(this.rightExpression)}}_getUsedColumns(){return[...super._getUsedColumns(),...this.rightExpression._getUsedColumns()]}}var ge;(function(r){r[r.Between=0]="Between",r[r.Contain=11]="Contain",r[r.End_with=13]="End_with",r[r.Equal=3]="Equal",r[r.Exists=15]="Exists",r[r.Greater=7]="Greater",r[r.Greater_or_equal=8]="Greater_or_equal",r[r.Is_not_null=2]="Is_not_null",r[r.Is_null=1]="Is_null",r[r.Less=5]="Less",r[r.Less_or_equal=6]="Less_or_equal",r[r.Not_contain=12]="Not_contain",r[r.Not_end_with=14]="Not_end_with",r[r.Not_equal=4]="Not_equal",r[r.Not_exists=16]="Not_exists",r[r.Not_start_with=10]="Not_start_with",r[r.Start_with=9]="Start_with"})(ge||(ge={}));var Ze;(function(r){r[r.SchemaColumn=0]="SchemaColumn",r[r.Function=1]="Function",r[r.Parameter=2]="Parameter",r[r.SubQuery=3]="SubQuery",r[r.ArithmeticOperation=4]="ArithmeticOperation"})(Ze||(Ze={}));class Ut{static{this._instanceOfKey="devkit_BaseExpression"}static get _instanceOfKeys(){return[this._instanceOfKey]}static[Symbol.hasInstance](e){return(e?.constructor?._instanceOfKeys??[]).includes(this._instanceOfKey)}constructor(e){this.isBlock=!1,this.isBlock=e?.isBlock}static fromJson(e,t,n){throw new Error(`fromJson not supported on expression type ${this.constructor.name}`)}serializeItem(e){return typeof e.toJson=="function"?e.toJson():(0,Ee.classToPlain)(e,{exposeUnsetFields:!1,excludePrefixes:["_"]})}toJson(){return(0,Ee.classToPlain)(this,{exposeUnsetFields:!1,excludePrefixes:["_"]})}}class be extends Ut{static{this._instanceOfKey="devkit_ColumnExpression"}static get _instanceOfKeys(){return[...Ut._instanceOfKeys,this._instanceOfKey]}constructor(e){super(e),this.expressionType=Ze.SchemaColumn,this.columnPath=e?.columnPath}static fromJson(e){return new be({columnPath:e.columnPath})}clone(){return new be(this)}_getUsedColumns(){return[{path:this.columnPath}]}}class we extends Ut{static{this._instanceOfKey="devkit_ParameterExpression"}static get _instanceOfKeys(){return[...Ut._instanceOfKeys,this._instanceOfKey]}constructor(e){super(e),this.expressionType=Ze.Parameter;const t=e?.value;if(t instanceof Date){const n=new Date;n.setTime(t.getTime()),this.value=n}else t?this.value=typeof t=="object"?{...t}:t:this.value=t;this.dataValueType=e?.dataValueType??E.r.Text,this.parameter={dataValueType:this.dataValueType,...this._getParameterValueMetadata()}}static fromJson(e){return new we(e.parameter)}_convertStringToBlobArray(e){const t=[];let n=0;for(let s=0;s<e.length;s++){const a=e.charCodeAt(s);a<128?t[n++]=String.fromCharCode(a):a<2048?(t[n++]=String.fromCharCode(a>>6|192),t[n++]=String.fromCharCode(a&63|128)):(t[n++]=String.fromCharCode(a>>12|224),t[n++]=String.fromCharCode(a>>6&63|128),t[n++]=String.fromCharCode(a&63|128))}return t}_getParameterValueMetadata(){return this.dataValueType===E.r.Blob?{arrayValue:this.value?this._convertStringToBlobArray(this.value):[]}:this.value instanceof Date?{value:sh(this.value)}:{value:this.value}}clone(){return new we(this)}_getUsedColumns(){return[]}}(0,y.__decorate)([(0,Ee.Exclude)(),(0,y.__metadata)("design:type",Object)],we.prototype,"value",void 0),(0,y.__decorate)([(0,Ee.Exclude)(),(0,y.__metadata)("design:type",Number)],we.prototype,"dataValueType",void 0);const f_=new i.InjectionToken("COPILOT_INTENT_REPOSITORY_TOKEN");class Hh{static{this._codeCharactersRegex=new RegExp("^[A-Za-z0-9\\s_]*$")}static{this._wordsMatchRegex=new RegExp(/\w+/g)}static generateCode(e,t=-1){const s=(e.match(this._wordsMatchRegex)||[]).filter(a=>a.length!==0).map(a=>a[0].toUpperCase()+a.substring(1)).join("");return t>=0?s.slice(0,t):s}static isTextUsableForCodeGeneration(e){return this._codeCharactersRegex.test(e)}}class na{constructor(){this._sysSettingsService=(0,i.inject)(Zn),this._defaultCodeMaxLength=41}_checkCodeIsUnique(e,t){return e?!e.includes(t):!0}_generateCode(e){const{prefix:t,options:n,generateFromName:s,name:a}=e,{codeMaxLength:o,defaultNewCode:c}=n;if(s){if(!Hh.isTextUsableForCodeGeneration(a))return null;const d=t+c,p=(o??this._defaultCodeMaxLength)-d.length,C=Hh.generateCode(a,p);return d+C}return T.$A.generateUnique(c,t)}generate(e,t,n){const s={generateFromName:!!t,name:t,prefix:null,options:n};return(0,u.from)(this._sysSettingsService.getByCode("SchemaNamePrefix")).pipe((0,u.map)(a=>a.value),(0,u.tap)(a=>s.prefix=a),(0,u.repeat)(s.generateFromName?1:void 0),(0,u.map)(()=>this._generateCode(s)),(0,u.filter)(a=>this._checkCodeIsUnique(e,a)),(0,u.take)(1),(0,u.defaultIfEmpty)(null))}static{this.\u0275fac=function(t){return new(t||na)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:na,factory:na.\u0275fac})}}class ia{constructor(){this._designItems=new Map}getDesignItem(e){return this._designItems.get(e)}getDesignItems(){return Array.from(this._designItems.values())}setDesignItem(e){this._designItems.set(e.UId,e)}static{this.\u0275fac=function(t){return new(t||ia)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:ia,factory:ia.\u0275fac})}}class Qn{constructor(){this._repository=(0,i.inject)(f_),this._copilotCodeGenerator=(0,i.inject)(na),this._designRepository=(0,i.inject)(ia)}_loadIntentUIdByActionUId(e){return(0,u.from)(kt.create("CopilotAction")).pipe((0,u.switchMap)(t=>t.load({attributes:["Intent"],parameters:[{type:ce.Filter,value:new Bt(ge.Equal,new be({columnPath:"Id"}),new we({value:e}))}]})),(0,u.map)(t=>{const n=t[0]||{};return(0,M.isEmpty)(n)?null:n.Intent?.value}))}_applyActionToIntent(e,t){const s=(e.Actions||[]).findIndex(o=>o.Id===t.Id);if(s===-1)return!1;const a=e.Actions[s];return e.Actions.splice(s,1,{...a,...t}),!0}_applyParameterToIntent(e,t){const n=t.SourceCollection==="InputParameters"?e.InputParameters:e.OutputParameters,s=n.findIndex(a=>a.UId===t.UId);return s!==-1?(n.splice(s,1,{...n[s],...t}),!0):!1}_getSuccessResponse(){return{success:!0}}_getSuccessResponseObservable(){return(0,u.of)(this._getSuccessResponse())}_getDesignIntent(e){return(0,u.of)(this._designRepository.getDesignItem(e))}_getDesignIntents(){return Array.from(this._designRepository.getDesignItems())}_setDesignIntent(e){this._designRepository.setDesignItem(e)}_getIntentByParameterUId(e){for(const t of this._getDesignIntents()){if(t.InputParameters.find(a=>a.UId===e))return(0,u.of)({intent:t,sourceCollection:"InputParameters"});if(t.OutputParameters.find(a=>a.UId===e))return(0,u.of)({intent:t,sourceCollection:"OutputParameters"})}return(0,u.of)({})}getIntent(e){return this._repository.get(e).pipe((0,u.tap)(t=>{this._setDesignIntent(t)}))}getAllSkills(){return this._repository.getAllCodes("CopilotIntent")}getAllAgents(){return this._repository.getAllCodes("CopilotAgent")}getIntentParameter(e){return this._getIntentByParameterUId(e).pipe((0,u.map)(({intent:t,sourceCollection:n})=>n==="InputParameters"?t.InputParameters:t.OutputParameters),(0,u.map)(t=>t.find(n=>n.UId===e)))}getIntentParameters(e,t){return this._getDesignIntent(e).pipe((0,u.map)(n=>t==="InputParameters"?n.InputParameters:n.OutputParameters))}updateIntentParameter(e){return this._getIntentByParameterUId(e.UId).pipe((0,u.switchMap)(({intent:t,sourceCollection:n})=>(e.SourceCollection=n,this._applyParameterToIntent(t,e)?this._getSuccessResponseObservable():this._getSuccessResponseObservable())))}createIntentParameter(e){return this._getDesignIntent(e.Intent.value).pipe((0,u.map)(t=>((e.SourceCollection==="InputParameters"?t.InputParameters:t.OutputParameters).push(e),this._getSuccessResponse())))}deleteIntentParameter(e){return this._getIntentByParameterUId(e).pipe((0,u.map)(({intent:t,sourceCollection:n})=>{const s=n==="InputParameters"?t?.InputParameters:t?.OutputParameters,a=(s??[]).findIndex(o=>o.UId===e);return a!==-1&&s.splice(a,1),t}),(0,u.switchMap)(t=>this._repository.update(t)))}createIntent(e){return this._repository.create(e.UId).pipe((0,u.map)(t=>(Object.assign(t,e),t)),(0,u.switchMap)(t=>this._repository.update(t)))}updateIntent(e){return(0,u.forkJoin)([this._getDesignIntent(e.UId),this._repository.get(e.UId)]).pipe((0,u.map)(([t,n])=>{const s={...n,...t,...e};return this._setDesignIntent(s),s}),(0,u.switchMap)(t=>this._repository.update(t)))}createAction(e){return this._repository.get(e.Intent.value).pipe((0,u.map)(t=>(t.Actions.push(e),t)),(0,u.switchMap)(t=>this._repository.update(t)))}createSubIntent(e,t){return this._repository.createSubIntent(e,t)}deleteSubIntent(e,t){return this._repository.deleteSubIntent(e,t)}getActionByUId(e){return this._loadIntentUIdByActionUId(e).pipe((0,u.switchMap)(t=>t?this._repository.get(t).pipe((0,u.map)(n=>n.Actions.filter(s=>s.Id===e)),(0,u.map)(n=>n[0])):(0,u.of)({})))}getIntentByActionUId(e){return this.getActionByUId(e).pipe((0,u.switchMap)(t=>t?.Intent?this.getIntent(t.Intent.value):(0,u.of)({})))}updateAction(e){return this._loadIntentUIdByActionUId(e.Id).pipe((0,u.switchMap)(t=>this._repository.get(t).pipe((0,u.switchMap)(n=>this._applyActionToIntent(n,e)?this._repository.update(n):(0,u.of)({})))))}generateActionCode(e,t=null){return this._copilotCodeGenerator.generate(e,t,{defaultNewCode:"Action"})}generateSkillCode(e,t=null){return this._copilotCodeGenerator.generate(e,t,{defaultNewCode:"Skill"})}generateAgentCode(e,t=null){return this._copilotCodeGenerator.generate(e,t,{defaultNewCode:"Agent"})}deleteAction(e,t){return this._repository.get(e).pipe((0,u.map)(n=>(n.Actions=n.Actions.filter(s=>s.Id!==t),n)),(0,u.switchMap)(n=>this._repository.update(n)))}static{this.\u0275fac=function(t){return new(t||Qn)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Qn,factory:Qn.\u0275fac})}}var qc;(function(r){r[r.None=0]="None",r[r.Self=1]="Self",r[r.ExplicitEntry=2]="ExplicitEntry",r[r.Delegated=4]="Delegated",r[r.FuncRoleFromOrgRole=8]="FuncRoleFromOrgRole",r[r.UpHierarchy=16]="UpHierarchy",r[r.AsManager=32]="AsManager",r[r.All=63]="All"})(qc||(qc={}));class fl{get queryDtoType(){return this._queryDtoType}constructor(e,t){this.operationType=e,this.rootSchemaName=t,ue.checkArgumentEmpty("_operationType",e),ue.checkArgumentEmpty("_rootSchemaName",t)}getMetadata(){return(0,Ee.instanceToPlain)(this,{exposeUnsetFields:!1,excludePrefixes:["_"]})}}(0,y.__decorate)([(0,Ee.Exclude)(),(0,y.__metadata)("design:type",String)],fl.prototype,"_queryDtoType",void 0),(0,y.__decorate)([(0,Ee.Expose)({name:"__type"}),(0,y.__metadata)("design:type",String),(0,y.__metadata)("design:paramtypes",[])],fl.prototype,"queryDtoType",null);class sa extends Ft{static{this._instanceOfKey="devkit_BetweenFilter"}static get _instanceOfKeys(){return[...Ft._instanceOfKeys,this._instanceOfKey]}constructor(e,t,n){super(Ie.Between,ge.Between,e),this.filterType=Ie.Between,this.rightLessExpression=t?.clone(),this.rightGreaterExpression=n?.clone()}static fromJson(e,t,n){return new sa(n.fromJson(e.leftExpression,t),n.fromJson(e.rightLessExpression,t),n.fromJson(e.rightGreaterExpression,t))}clone(){const e=new sa(this.leftExpression,this.rightLessExpression,this.rightGreaterExpression);return e.isEnabled=this.isEnabled,e.trimDateTimeParameterToDate=this.trimDateTimeParameterToDate,e}toJson(){return{...super.toJson(),rightLessExpression:this.serializeItem(this.rightLessExpression),rightGreaterExpression:this.serializeItem(this.rightGreaterExpression)}}_getUsedColumns(){return[...super._getUsedColumns(),...this.rightLessExpression._getUsedColumns(),...this.rightGreaterExpression._getUsedColumns()]}}class Xn extends Ft{static{this._instanceOfKey="devkit_ExistsFilter"}static get _instanceOfKeys(){return[...Ft._instanceOfKeys,this._instanceOfKey]}constructor(e,t,n=ge.Exists,s=!0){super(Ie.Exists,n,e),this.filterType=Ie.Exists,this.subFilters=t?.clone(),this.isAggregative=s}static fromJson(e,t,n){const s=n.fromJson(e.leftExpression,t),a=e.subFilters;let o;return a&&(o=t.fromJson(e.subFilters)),new Xn(s,o,e.comparisonType,e.isAggregative)}clone(){const e=new Xn(this.leftExpression,this.subFilters,this.comparisonType,this.isAggregative);return e.isEnabled=this.isEnabled,e.trimDateTimeParameterToDate=this.trimDateTimeParameterToDate,e}toJson(){const e=super.toJson();return this.subFilters&&(e.subFilters=this.serializeItem(this.subFilters)),e}_getUsedColumns(){return[...super._getUsedColumns(),...this.subFilters?._getUsedColumns()??[]]}}class en extends Ft{static{this._instanceOfKey="devkit_InFilter"}static get _instanceOfKeys(){return[...Ft._instanceOfKeys,this._instanceOfKey]}constructor(e,t,n){super(Ie.In,e,t),this.filterType=Ie.In,this.rightExpressions=n.map(s=>s?.clone())??[]}static fromJson(e,t,n){const s=e.rightExpressions??[];return new en(e.comparisonType,n.fromJson(e.leftExpression,t),s.map(a=>n.fromJson(a,t)))}clone(){const e=new en(this.comparisonType,this.leftExpression,this.rightExpressions);return e.isEnabled=this.isEnabled,e.trimDateTimeParameterToDate=this.trimDateTimeParameterToDate,e}toJson(){return{...super.toJson(),rightExpressions:this.rightExpressions.map(e=>this.serializeItem(e))}}_getUsedColumns(){const e=this.rightExpressions.map(t=>t._getUsedColumns()).flat();return[...super._getUsedColumns(),...e]}}class tn extends Ft{static{this._instanceOfKey="devkit_IsNullFilter"}static get _instanceOfKeys(){return[...Ft._instanceOfKeys,this._instanceOfKey]}constructor(e,t){[ge.Is_null,ge.Is_not_null].includes(e)||console.warn(`Invalid comparison type: ${ge[e]} in IsNullFilter.`),super(Ie.IsNull,tn._getComparisonType(e),t),this.filterType=Ie.IsNull,this.isNull=!0,this.isNull=this.comparisonType===ge.Is_null}static _getComparisonType(e){return e===ge.Is_not_null?e:ge.Is_null}static fromJson(e,t,n){return new tn(tn._getComparisonType(e.comparisonType),n.fromJson(e.leftExpression,t))}clone(){const e=new tn(tn._getComparisonType(this.comparisonType),this.leftExpression);return e.isEnabled=this.isEnabled,e.trimDateTimeParameterToDate=this.trimDateTimeParameterToDate,e}}var ra;(function(r){r[r.And=0]="And",r[r.Or=1]="Or"})(ra||(ra={}));var as;(function(r){r[r.None=0]="None",r[r.CurrentUser=1]="CurrentUser",r[r.CurrentUserContact=2]="CurrentUserContact",r[r.Yesterday=3]="Yesterday",r[r.Today=4]="Today",r[r.Tomorrow=5]="Tomorrow",r[r.PreviousWeek=6]="PreviousWeek",r[r.CurrentWeek=7]="CurrentWeek",r[r.NextWeek=8]="NextWeek",r[r.PreviousMonth=9]="PreviousMonth",r[r.CurrentMonth=10]="CurrentMonth",r[r.NextMonth=11]="NextMonth",r[r.PreviousQuarter=12]="PreviousQuarter",r[r.CurrentQuarter=13]="CurrentQuarter",r[r.NextQuarter=14]="NextQuarter",r[r.PreviousHalfYear=15]="PreviousHalfYear",r[r.CurrentHalfYear=16]="CurrentHalfYear",r[r.NextHalfYear=17]="NextHalfYear",r[r.PreviousYear=18]="PreviousYear",r[r.CurrentYear=19]="CurrentYear",r[r.PreviousHour=20]="PreviousHour",r[r.CurrentHour=21]="CurrentHour",r[r.NextHour=22]="NextHour",r[r.NextYear=23]="NextYear",r[r.NextNDays=24]="NextNDays",r[r.PreviousNDays=25]="PreviousNDays",r[r.NextNHours=26]="NextNHours",r[r.PreviousNHours=27]="PreviousNHours",r[r.PrimaryColumn=34]="PrimaryColumn",r[r.PrimaryDisplayColumn=35]="PrimaryDisplayColumn",r[r.PrimaryImageColumn=36]="PrimaryImageColumn",r[r.DayOfYearToday=37]="DayOfYearToday",r[r.DayOfYearTodayPlusDaysOffset=38]="DayOfYearTodayPlusDaysOffset",r[r.NextNDaysOfYear=39]="NextNDaysOfYear",r[r.PreviousNDaysOfYear=40]="PreviousNDaysOfYear",r[r.PrimaryColorColumn=41]="PrimaryColorColumn"})(as||(as={}));class _l extends Ut{static{this._instanceOfKey="devkit_FunctionExpression"}static get _instanceOfKeys(){return[...Ut._instanceOfKeys,this._instanceOfKey]}constructor(e){super(e),this.expressionType=Ze.Function}}var Je;(function(r){r[r.None=0]="None",r[r.Macros=1]="Macros",r[r.Aggregation=2]="Aggregation",r[r.DatePart=3]="DatePart",r[r.Length=4]="Length",r[r.Window=5]="Window",r[r.DateAdd=6]="DateAdd",r[r.DateDiff=7]="DateDiff"})(Je||(Je={}));class ei extends _l{static{this._instanceOfKey="devkit_MacrosFunctionExpression"}static get _instanceOfKeys(){return[..._l._instanceOfKeys,this._instanceOfKey]}constructor(e){super(e),this.functionType=Je.Macros,this.macrosType=e?.macrosType,this.functionArgument=e?.functionArgument}static fromJson(e,t,n){const s=t&&n&&e.functionArgument?n.fromJson(e.functionArgument,t):void 0;return new ei({functionArgument:s,macrosType:e.macrosType})}clone(){return new ei(this)}_getUsedColumns(){return this.functionArgument?._getUsedColumns()??[]}}class pt extends ta{static{this._instanceOfKey="devkit_FilterGroup"}static get _instanceOfKeys(){return[...ta._instanceOfKeys,this._instanceOfKey]}get items(){const e={};return this.filters.forEach((t,n)=>{e[n]=this.serializeItem(t)}),e}constructor(e=ra.And,t){super(Ie.FilterGroup),this.filterType=Ie.FilterGroup,this.filters=new Map,this.logicalOperation=e,this.rootSchemaName=t}static fromJson(e,t){const n=e.logicalOperation,s=new pt(n||ra.And,e.rootSchemaName);return Object.entries(e.items).forEach(([a,o])=>{s.add(t.fromJson(o),a)}),s}toJson(){const e={};return e.filterType=this.filterType,e.isEnabled=this.isEnabled,e.logicalOperation=this.logicalOperation,e.trimDateTimeParameterToDate=this.trimDateTimeParameterToDate,e.items=this.items,this.rootSchemaName&&(e.rootSchemaName=this.rootSchemaName),e}_createParameterValueExpressions(e){return e.map(t=>new we({value:t}))}getItemByIndex(e){return this.items[Object.keys(this.items)[e]]}addSchemaColumnFilterWithParameter(e,t,n,s){const a=new be({columnPath:t}),o=new we({value:n}),c=new Bt(e,a,o);this.add(c,s)}addSchemaColumnInFilterWithParameters(e,t,n,s){const a=new be({columnPath:t}),o=this._createParameterValueExpressions(n),c=new en(e,a,o);this.add(c,s)}addPrimarySchemaColumnInFilter(e,t){const n=new ei({macrosType:as.PrimaryColumn}),s=this._createParameterValueExpressions(e),a=new en(ge.Equal,n,s);this.add(a,t)}addSchemaColumnIsNullFilter(e,t){const n=new be({columnPath:e}),s=new tn(ge.Is_null,n);this.add(s,t)}addSchemaColumnIsNotNullFilter(e,t){const n=new be({columnPath:e}),s=new tn(ge.Is_not_null,n);this.add(s,t)}addSchemaColumnBetweenFilterWithParameters(e,t,n,s){const a=new be({columnPath:e}),o=new we({value:t}),c=new we({value:n}),d=new sa(a,o,c);this.add(d,s)}addExistsFilter(e,t,n){const s=new be({columnPath:e}),a=new Xn(s,t);this.add(a,n)}addNotExistsFilter(e,t,n){const s=new be({columnPath:e}),a=new Xn(s,t,ge.Not_exists);this.add(a,n)}add(e,t){ue.checkArgumentEmpty("filter",e);const n=t||(0,le.qv)();this.filters.set(n,e)}clone(){const e=new pt(this.logicalOperation,this.rootSchemaName);return this.filters.forEach((t,n)=>{e.filters.set(n,t.clone())}),e.isEnabled=this.isEnabled,e.trimDateTimeParameterToDate=this.trimDateTimeParameterToDate,e}_getUsedColumns(){const e=[];return this.filters.forEach(t=>{let n=t._getUsedColumns?t._getUsedColumns():[];n=n.map(s=>({path:s.path,schemaName:s.schemaName??this.rootSchemaName})),e.push(...n)}),e}}(0,y.__decorate)([(0,Ee.Exclude)(),(0,y.__metadata)("design:type",Object)],pt.prototype,"filters",void 0),(0,y.__decorate)([(0,Ee.Expose)(),(0,y.__metadata)("design:type",Object),(0,y.__metadata)("design:paramtypes",[])],pt.prototype,"items",null);class yl extends fl{constructor(e,t){super(e,t),this.filters=new pt}clearFilters(){this.filters.filters.clear()}getMetadata(){return{...super.getMetadata(),filters:this.filters.toJson()}}_getUsedColumns(){const e=this.filters._getUsedColumns();return e.forEach(t=>{t.schemaName||(t.schemaName=this.rootSchemaName)}),e}}(0,y.__decorate)([(0,Ee.Exclude)(),(0,y.__metadata)("design:type",Object)],yl.prototype,"filters",void 0);var os;(function(r){r[r.Select=0]="Select",r[r.Insert=1]="Insert",r[r.Update=2]="Update",r[r.Delete=3]="Delete"})(os||(os={}));class Wh extends yl{constructor(e){super(os.Update,e),this._columnValues=new Map,this._queryDtoType="Terrasoft.Nui.ServiceModel.DataContract.UpdateQuery",this.isForceUpdate=!1}get columnValues(){return{items:(0,Ee.classToPlain)(this._columnValues)}}addColumn(e,t,n){ue.checkArgumentEmpty("columnName",e),this._columnValues.set(e,new we({value:t,dataValueType:n}))}}(0,y.__decorate)([(0,Ee.Expose)(),(0,y.__metadata)("design:type",Object),(0,y.__metadata)("design:paramtypes",[])],Wh.prototype,"columnValues",null);class $h extends fl{constructor(e){super(os.Insert,e),this._columnValues=new Map,this._queryDtoType="Terrasoft.Nui.ServiceModel.DataContract.InsertQuery"}get columnValues(){return{items:(0,Ee.classToPlain)(this._columnValues)}}addColumn(e,t,n){ue.checkArgumentEmpty("columnName",e),this._columnValues.set(e,new we({value:t,dataValueType:n}))}}(0,y.__decorate)([(0,Ee.Expose)(),(0,y.__metadata)("design:type",Object),(0,y.__metadata)("design:paramtypes",[])],$h.prototype,"columnValues",null);class __ extends yl{constructor(e){super(os.Delete,e),this._queryDtoType="Terrasoft.Nui.ServiceModel.DataContract.DeleteQuery"}}var Jc;(function(r){r.None="",r.Count="Count",r.Sum="Sum",r.Avg="Avg",r.Min="Min",r.Max="Max",r.TopOne="TopOne"})(Jc||(Jc={}));class y_{constructor(){this._cache=new Map}setToCache(e,t){this._cache.set(e,t)}deleteFromCache(e){this._cache.delete(e)}getFromCache(e){return this._cache.get(e)}}class C_ extends y_{constructor(){super(...arguments),this.httpClient=(0,i.inject)(P.HttpClient)}_createCacheKey(e,t={}){return`${e}!${JSON.stringify(t)}`}_cacheRequest(e,t){const n=this.getFromCache(t);if((0,M.isUndefined)(n)){const s=e().pipe((0,u.shareReplay)({bufferSize:1,refCount:!1}));return this.setToCache(t,s),s}return n}_getMethodEndpoint(e){return`${this.serviceEndpoint.replace(/\/$/,"")}/${e}`}executePostRequestWithCache(e,t={}){const n=this._getMethodEndpoint(e),s=this._createCacheKey(e,t),a=()=>this.httpClient.post(n,t);return this._cacheRequest(a,s)}executeGetRequestWithCache(e){const t=this._getMethodEndpoint(e),n=this._createCacheKey(e),s=()=>this.httpClient.get(t);return this._cacheRequest(s,n)}resetCache(e,t={}){const n=this._createCacheKey(e,t);this.deleteFromCache(n)}}let Qc=class vo extends C_{constructor(){super(...arguments),this.serviceEndpoint="rest/RightsService"}_getSchemaDeleteRights(e){return this.executePostRequestWithCache("GetSchemaDeleteRights",e).pipe((0,l.map)(t=>({result:t&&t.GetSchemaDeleteRightsResult?.length===0,message:t?.GetSchemaDeleteRightsResult})))}_getCanDeleteByRecord(e){const t=`${this.serviceEndpoint}/GetCanDelete`;return this.httpClient.post(t,e).pipe((0,l.map)(n=>({result:n&&n.GetCanDeleteResult?.length===0,message:n?.GetCanDeleteResult})))}_getCanAddData(e){const t=e.map(s=>this.getFromCache(`GetCanAdd_${s}`)).filter(s=>!!s),n=e.filter(s=>!t.find(a=>a.schemaName===s));return{cachedResult:t,requestSchemaNames:n}}getCanExecuteOperation(e){return this.getCanExecuteOperations([e]).pipe((0,l.mergeMap)(t=>(0,u.of)((t||[])[0])))}getCanExecuteOperations(e){return(0,u.combineLatest)(e.map(t=>this.executePostRequestWithCache("GetCanExecuteOperation",{operation:t}).pipe((0,l.map)(n=>n?.GetCanExecuteOperationResult))))}getIsTechnicalUser(){const e=`${this.serviceEndpoint}/GetIsTechnicalUser`;return this.httpClient.post(e,null).pipe((0,l.map)(t=>t?.GetIsTechnicalUserResult))}getCanAdd(e){const t="GetCanAdd",{cachedResult:n,requestSchemaNames:s}=this._getCanAddData(e);if(!s.length)return(0,u.of)(n);const a=`${this.serviceEndpoint}/${t}`;return this.httpClient.post(a,s).pipe((0,l.map)(o=>o.map(c=>({schemaName:c.Key,result:(0,M.isEmpty)(c.Value),errorMessage:c.Value}))),(0,l.tap)(o=>o.forEach(c=>this.setToCache(`${t}_${c.schemaName}`,c))),(0,l.map)(o=>o.concat(n)))}getCanEdit(e){const t=`${this.serviceEndpoint}/GetCanEdit`;return this.httpClient.post(t,e).pipe((0,l.map)(n=>({result:n&&n.GetCanEditResult?.length===0,message:n?.GetCanEditResult})))}getCanDelete(e){if(e.primaryColumnValue)return this._getCanDeleteByRecord(e);const t={schemaName:e.schemaName};return this._getSchemaDeleteRights(t)}copyRights(e){const t=`${this.serviceEndpoint}/CopyRights`;return this.httpClient.post(t,e)}getCanEditColumns(e){return this.executePostRequestWithCache("GetCanEditColumns",e).pipe((0,l.map)(t=>{const n=t?.GetCanEditColumnsResult??[],s={};return n.forEach(a=>s[a.Key]=a.Value),s}))}getCanReadColumns(e){return this.executePostRequestWithCache("GetCanReadColumns",e).pipe((0,l.map)(t=>{const n=t?.GetCanReadColumnsResult??[],s={};return n.forEach(a=>s[a.Key]=a.Value),s}))}getCanExecuteEntityOperation(e,t){const n=`${this.serviceEndpoint}/GetCanExecuteEntityOperation`,s={entitySchemaName:e,entityOperationCode:t};return this.httpClient.post(n,s).pipe((0,l.mergeMap)(a=>(0,u.of)(a?.GetCanExecuteEntityOperationResult)))}getAclGranted(e){return(0,u.firstValueFrom)(this.executeGetRequestWithCache("GetReadDeniedEntityList")).then(t=>!t.GetReadDeniedEntityListResult.includes(e),t=>(console.error(`Error while making request to ReadDeniedEntityList: ${t}`),!0))}applyChanges(e){const t=`${this.serviceEndpoint}/ApplyChanges`;return(0,u.firstValueFrom)(this.httpClient.post(t,e)).then(()=>!0,n=>{throw console.error(`Error while making request to ApplyChanges: ${n}`),n})}getRecordRights(e){return(0,u.firstValueFrom)(this.executePostRequestWithCache("GetRecordRights",e)).then(t=>t,t=>{throw console.error(`Error while making request to GetRecordRights: ${t}`),t})}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=i.\u0275\u0275getInheritedFactory(vo)))(n||vo)}})()}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:vo,factory:vo.\u0275fac,providedIn:"root"})}};Qc=(0,y.__decorate)([(0,T.op)({requestType:"crt.RightsService"})],Qc);class wn{static{this.\u0275fac=function(t){return new(t||wn)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:wn,factory:wn.\u0275fac})}}var Cl;(function(r){r.List="List",r.SelectionWindow="SelectionWindow"})(Cl||(Cl={}));class Xc{get isLookupType(){return this.dataValueType?this.dataValueType===E.r.Lookup:!1}constructor(e){e&&(this.uId=e.uId,this.name=e.name,this.caption=e.caption,this.columnCaptionPath=e.columnCaptionPath,this.dataValueType=e.dataValueType,this.usageType=e.usageType,this.referenceSchemaUId=e.referenceSchemaUId,this.referenceSchemaName=e.referenceSchemaName,this.isRequired=e.isRequired,this.isValueCloneable=e.isValueCloneable,this.isMasked=e.isMasked,this.isFormatValidated=e.isFormatValidated,this.isSensitiveData=e.isSensitiveData,this.isValueMasked=e.isValueMasked,this.valueMaskingSettings=e.valueMaskingSettings,this.defaultValueSchema=e.defaultValueSchema,this.lookupMode=e.lookupMode)}}class b_{constructor(e){e&&(this.uId=e.uId,this.name=e.name,this.caption=e.caption,this.extendParent=e.extendParent,this.packageUId=e.packageUId)}}class Gh extends b_{getPrimaryColumn(){return this.primaryColumnUId&&this.columns?.find(e=>e.uId===this.primaryColumnUId)}getPrimaryDisplayColumn(){return this.primaryDisplayColumnUId&&this.columns?.find(e=>e.uId===this.primaryDisplayColumnUId)}getPrimaryColorColumn(){return this.primaryColorColumnUId&&this.columns?.find(e=>e.uId===this.primaryColorColumnUId)}getHierarchyColumn(){return this.hierarchyColumnUId&&this.columns?.find(e=>e.uId===this.hierarchyColumnUId)}getCreatedOnColumn(){return this.createdOnColumnUId&&this.columns?.find(e=>e.uId===this.createdOnColumnUId)}getCreatedByColumn(){return this.createdByColumnUId&&this.columns?.find(e=>e.uId===this.createdByColumnUId)}getModifiedOnColumn(){return this.modifiedOnColumnUId&&this.columns?.find(e=>e.uId===this.modifiedOnColumnUId)}getModifiedByColumn(){return this.modifiedByColumnUId&&this.columns?.find(e=>e.uId===this.modifiedByColumnUId)}}var S_=h(61843),zt;(function(r){r[r.None=0]="None",r[r.Const=1]="Const",r[r.Settings=2]="Settings",r[r.SystemValue=3]="SystemValue",r[r.Sequence=4]="Sequence"})(zt||(zt={}));class M_{static _getDefaultValue(e){if(!e)return null;if(e.source===zt.Sequence)return{valueSourceType:zt.Sequence,value:"Sequence",sequencePrefix:e.sequencePrefix,sequenceNumberOfChars:e.sequenceNumberOfChars};if(e.source===zt.Const){const t=e.value,n=typeof t=="string"?t:t.value;return{valueSourceType:zt.Const,value:n,valueSource:n,sequenceNumberOfChars:0}}return e.source===zt.Settings?{valueSourceType:zt.Settings,value:e.calculatedValue,valueSource:e.value,sequenceNumberOfChars:0}:e.source===zt.SystemValue?{valueSourceType:zt.SystemValue,value:e.calculatedValue,valueSource:e.sourceValue,sequenceNumberOfChars:0}:{valueSourceType:e.source,value:null,sequenceNumberOfChars:0}}static _getPrimaryDisplayColorColumnUId(e){if(!e.primaryColorColumnName)return null;const t=Object.values(e.columns).find(n=>n.name===e.primaryColorColumnName);if(!t)throw new Error(`Primary color column set in object ${e.name} but column ${e.primaryColorColumnName} does not exist`);return t?.uId}static map(e,t){const n={};return Object.entries(e.columns).forEach(([,s])=>{const a=s,o=a.dataValueTypeName==="Binary"?"Blob":a.dataValueTypeName,c=Object.entries(Ki.Q).find(([,C])=>C.name===o),d=c?Number(c[0]):a.dataValueType,p=this._getDefaultValue(a.defaultValue);n[a.uId]={uId:a.uId,name:a.name,caption:{[t]:a.caption},dataValueType:d,isInherited:!!a.isInherited,isRequired:!!a.isRequired,isValueCloneable:!!a.isValueCloneable,usageType:a.usageType,referenceSchemaName:a.referenceSchemaName,isMasked:!!a.isMasked,isFormatValidated:!!a.isFormatValidated,isSimpleLookup:!!a.isSimpleLookup,isSensitiveData:!!a.isSensitiveData,isValueMasked:!!a.isValueMasked,valueMaskingSettings:a.valueMaskingSettings,defValue:p}}),{administratedByOperations:e.administratedByOperations,administratedByRecords:e.administratedByRecords,useMasterRecordRights:e.useMasterRecordRights,masterRecordSchemaName:e.masterRecordSchemaName,primaryColumnUId:e.primaryColumn?.uId,primaryDisplayColumnUId:e.primaryDisplayColumn?.uId,primaryColorColumnUId:this._getPrimaryDisplayColorColumnUId(e),hierarchyColumnUId:e.hierarchyColumnUId,createdOnColumnUId:e.createdOnColumnUId,createdByColumnUId:e.createdByColumnUId,modifiedOnColumnUId:e.modifiedOnColumnUId,modifiedByColumnUId:e.modifiedByColumnUId,uId:e.uId,name:e.name,caption:{[t]:e.caption},columns:{Items:n},isVirtual:!!e.isVirtual,isDBView:!!e.isDBView,administratedByColumns:!!e.administratedByColumns,description:{[t]:e.description},parentUId:e.parentUId,isTrackChangesInDB:!!e.isTrackChangesInDB,extendParent:!!e.extendParent}}}const v_="runtime-entity-schema";var ls;(function(r){r[r.EntitySchema=3]="EntitySchema",r[r.ClientUnitSchema=4]="ClientUnitSchema"})(ls||(ls={}));var eu=h(41483);class bl{static getPathItemInfo(e){const n=/\[([\w-]+):([\w-]+):?([\w-]*)]$/g.exec(e);if(n){const s=n[1],a=n[2],o=n[3];return{isBackReference:!0,referenceSchemaName:s,referenceSchemaColumnName:a,columnName:o}}return{isBackReference:!1,columnName:e}}static getLastBackwardSchemaNameByColumnPath(e){let t="";return e?.split(".").reverse()?.forEach(s=>{t||s.includes("[")&&(t=this.getPathItemInfo(s).referenceSchemaName)}),t}static getLastForwardColumnPath(e){const t=e?.split(".")||[],n=t.map(s=>s.includes("[")).lastIndexOf(!0);return n===-1?e:t.slice(n+1).join(".")}}let tu=class{constructor(e){this._window=e}_getItems(e,t=[]){var n=this;let s=[];const a=[...t];return new Promise(o=>{this._window.require(e,(0,f.A)(function*(...c){s=yield Promise.all(c.map(d=>n.map(d))),o({schemes:s,notFoundSchemes:a})}),c=>{const d=c.requireModules??[];a.push(...d),e=e.filter(p=>!d.includes(p)),e.length===0&&o({schemes:s,notFoundSchemes:a}),o(this._getItems(e,a))})})}map(e){return Promise.resolve(e)}get(e){var t=this;return new Promise(n=>{this._window.require([e],function(){var s=(0,f.A)(function*(a){const o=yield t.map(a);n(o)});return function(a){return s.apply(this,arguments)}}(),()=>{n(null)})})}getItems(e){return this._getItems(e,[])}};tu=(0,y.__decorate)([(0,y.__param)(0,(0,i.Inject)(T.ZP)),(0,y.__metadata)("design:paramtypes",[Object])],tu);class ti{constructor(e,t){this._userInfo=e,this._httpClient=t}_getServiceUrlSspPart(){return this._userInfo.isSSP?"ssp/":""}_getDataServiceUrlWithSspPart(){return`DataService/${this._getServiceUrlSspPart()}`}getSchemaDesignerServiceEndpoint(){return this._getDataServiceUrlWithSspPart()+"json/SyncReply/SchemaDesignerRequest"}getRuntimeEntitySchemaServiceEndpoint(){return this._getDataServiceUrlWithSspPart()+"json/SyncReply/RuntimeEntitySchemaRequest"}getEntitySchemaServiceEndpoint(){return this._getDataServiceUrlWithSspPart()+"json/SyncReply/EntitySchemaRequest"}getRuntimeEntitySchemeServiceEndpoint(){return this._getDataServiceUrlWithSspPart()+"json/SyncReply/RuntimeEntitySchemesRequest"}getEntity(e){return(0,u.lastValueFrom)(this._httpClient.post(this.getRuntimeEntitySchemaServiceEndpoint(),{name:e}))}getEntities(e){return(0,u.lastValueFrom)(this._httpClient.post(this.getRuntimeEntitySchemeServiceEndpoint(),e))}static{this.\u0275fac=function(t){return new(t||ti)(i.\u0275\u0275inject(We.oq),i.\u0275\u0275inject(P.HttpClient))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:ti,factory:ti.\u0275fac,providedIn:"root"})}}const Zh=new i.InjectionToken("Represents a list of schema change message predicates"),Yh=new i.InjectionToken("Represents a list of schema remove message predicates"),nu=new i.InjectionToken("Represents a list of schema rights message predicates");class ni{constructor(e,t,n,s,a){this._messageChannelService=e,this._broadcastChannelFactory=t,this._changePredicates=n,this._removePredicates=s,this._rightsPredicates=a,this._destroyed$=new u.Subject,this.schemaChanged$=new u.Subject,this.schemaRemoved$=new u.Subject,this.rightsChanged$=new u.Subject,this.requireJsChanged$=new u.Subject,this._subscribeMessageChannelEvent()}_getSchemaType(e){let t;switch(e){case"ClientUnitSchemaManager":t=ls.ClientUnitSchema;break;case"EntitySchemaManager":t=ls.EntitySchema;break}return t}_processMessage(e,t){const n=e.body,s=this._getSchemaType(n.ManagerName);s&&t.next({name:n.Name,uId:n.UId,schemaType:s,userId:n.UserId,isNew:n.IsNew,extendParent:n.ExtendParent})}_subscribeMessageChannelEvent(){this._messageChannelService.messageEvent$.pipe((0,l.filter)(e=>this._changePredicates?.some(t=>t(e))),(0,l.takeUntil)(this._destroyed$)).subscribe(e=>this._processMessage(e,this.schemaChanged$)),this._messageChannelService.messageEvent$.pipe((0,l.filter)(e=>this._removePredicates?.some(t=>t(e))),(0,l.takeUntil)(this._destroyed$)).subscribe(e=>this._processMessage(e,this.schemaRemoved$)),this._messageChannelService.messageEvent$.pipe((0,l.filter)(e=>this._rightsPredicates?.some(t=>t(e))),(0,l.takeUntil)(this._destroyed$)).subscribe(e=>this._processMessage(e,this.rightsChanged$)),this._broadcastChannelFactory.createInstance("schema-requirejs-path-changed").messages$.subscribe(e=>this._processMessage({body:e},this.requireJsChanged$))}ngOnDestroy(){this._destroyed$.next(),this._destroyed$.complete(),this.schemaChanged$.complete()}static{this.\u0275fac=function(t){return new(t||ni)(i.\u0275\u0275inject(al),i.\u0275\u0275inject(T.Vx),i.\u0275\u0275inject(Zh,8),i.\u0275\u0275inject(Yh,8),i.\u0275\u0275inject(nu,8))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:ni,factory:ni.\u0275fac,providedIn:"root"})}}const iu=["SysSettings"];class aa extends tu{constructor(e,t,n,s,a,o){super(e),this._featureValues=t,this._userInfo=n,this._entityHttpService=s,this._cacheManager=a,this._schemaChangeListener=o,this._destroyed$=new u.Subject,this._schemaChangeListener.schemaChanged$.pipe((0,l.filter)(c=>c.schemaType===ls.EntitySchema),(0,l.switchMap)(c=>(0,u.from)(this._clearSchemaCacheByName(c.name))),(0,l.takeUntil)(this._destroyed$)).subscribe()}get _entitySchemaCache(){return this._cacheManager.getOrCreate({name:v_,type:eu.P.Memory})}_clearSchemaCacheByName(e){var t=this;return(0,f.A)(function*(){t._featureValues.DisableRuntimeEntitySchemaCaching||(yield(yield t._entitySchemaCache).delete(e))})()}_getLookupEntities(e){const t=e.flatMap(s=>Object.values(s.columns.Items).filter(a=>a.dataValueType===E.r.Lookup&&a.referenceSchemaName&&!e.find(o=>o.name===a.referenceSchemaName)).map(a=>a.referenceSchemaName)),n=[...new Set(t)];return this.getItems(n)}_getReferenceEntityNameFromBackReferencePath(e){return bl.getPathItemInfo(e).referenceSchemaName}_getReferenceSchemaName(e,t){const n=this._getReferenceEntityNameFromBackReferencePath(e);let s;if(n)s=n;else{const a=Object.entries(t.columns.Items).find(([,c])=>c.name===e);if(!a)throw new Error(`Can't find column '${e}' in EntitySchema '${t.name}'`);const[,o]=a;s=o.referenceSchemaName}return s}_loadSchemasByPath(e,t,n){var s=this;return(0,f.A)(function*(){const a=n.find(I=>I.name===e);if(!a)return{schemas:[],notFoundSchemas:[e]};const o=[...t],c=o.shift(),d=s._getReferenceSchemaName(c,a);if(!d)return{schemas:[],notFoundSchemas:[]};let p=n.find(I=>I.name===d);if(!p)try{if(p=yield s.get(d),p)n.push(p);else return{schemas:[],notFoundSchemas:[d]}}catch{return{schemas:[],notFoundSchemas:[d]}}const C=o.length?yield s._loadSchemasByPath(p.name,o,n):{schemas:[],notFoundSchemas:[]};return{schemas:[p,...C.schemas],notFoundSchemas:C.notFoundSchemas}})()}_getForwardReferenceSchemas(e,t){var n=this;return(0,f.A)(function*(){const s=yield Promise.all(e.filter(a=>a.forwardReferencePaths).flatMap(a=>a.forwardReferencePaths.flatMap(o=>n._loadSchemasByPath(a.name,o.split("."),t))));return{schemes:s.flatMap(a=>a.schemas),notFoundSchemes:s.flatMap(a=>a.notFoundSchemas)}})()}_getEntitiesToLoadLookups(e,t){return t.schemes.filter(n=>e.requests.find(s=>s.loadLookupColumns===!0&&s.name===n.name))}map(e){return Promise.resolve(M_.map(e,this._userInfo.cultureInfo.sysCultureName))}get(e){var t=()=>super.get,n=this;return(0,f.A)(function*(){let s;if(!n._featureValues.DisableRuntimeEntitySchemaCaching){const o=yield(yield n._entitySchemaCache).get(e);if(o)return o}return iu.includes(e)?s=(yield n._entityHttpService.getEntity(e)).schema:s=yield t().call(n,e),n._featureValues.DisableRuntimeEntitySchemaCaching||(yield(yield n._entitySchemaCache).set(e,s)),s})()}getItems(e){var t=()=>super.getItems,n=this;return(0,f.A)(function*(){const s=[...new Set(e)];let a=s,o=[];if(!n._featureValues.DisableRuntimeEntitySchemaCaching){const O=yield n._entitySchemaCache;o=(yield Promise.all(s.map(se=>O.get(se)))).filter(se=>!!se);const te=o.map(se=>se.name);if(a=s.filter(se=>!te.includes(se)),a.length===0)return{schemes:[...o],notFoundSchemes:[]}}const c=a.filter(O=>iu.includes(O)),d=a.filter(O=>!iu.includes(O));let p={success:!0,schemes:[],notFoundSchemes:[]};if(c.length!==0){const O={requests:c.map(Y=>({name:Y,loadLookupColumns:!1}))};p=yield n._entityHttpService.getEntities(O)}const C=yield t().call(n,d),I=[...C.schemes,...p.schemes];return n._featureValues.DisableRuntimeEntitySchemaCaching||(yield(yield n._entitySchemaCache).bulkSet((0,M.uniqBy)(I,"name").map(Y=>({key:Y.name,value:Y})))),{schemes:[...I,...o],notFoundSchemes:[...C.notFoundSchemes,...p.notFoundSchemes]}})()}getEntity(e){var t=this;return(0,f.A)(function*(){const n=yield t.get(e);return{success:!!n,schema:n}})()}getEntities(e){var t=this;return(0,f.A)(function*(){const n=e.requests.map(d=>d.name),s=yield t.getItems(n),a=t._getEntitiesToLoadLookups(e,s),o=yield t._getLookupEntities(a),c=yield t._getForwardReferenceSchemas(e.requests,[...s.schemes,...o.schemes]);return{success:!0,schemes:[...s.schemes,...o.schemes,...c.schemes],notFoundSchemes:[...s.notFoundSchemes,...o.notFoundSchemes,...c.notFoundSchemes]}})()}ngOnDestroy(){this._destroyed$.next(),this._destroyed$.complete()}static{this.\u0275fac=function(t){return new(t||aa)(i.\u0275\u0275inject(T.ZP),i.\u0275\u0275inject(fe),i.\u0275\u0275inject(We.oq),i.\u0275\u0275inject(ti),i.\u0275\u0275inject(il.G),i.\u0275\u0275inject(ni))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:aa,factory:aa.\u0275fac,providedIn:"root"})}}class oa{constructor(e,t,n,s){this.httpClient=e,this._entityRequire=t,this._entityHttp=n,this._featureValues=s}_useRequire(){return this._featureValues?.UseRequireEntitySchema8x??!1}getEntity(e){var t=this;return(0,f.A)(function*(){return t._useRequire()?t._entityRequire.getEntity(e):t._entityHttp.getEntity(e)})()}getEntities(e){var t=this;return(0,f.A)(function*(){return t._useRequire()?t._entityRequire.getEntities(e):t._entityHttp.getEntities(e)})()}static{this.\u0275fac=function(t){return new(t||oa)(i.\u0275\u0275inject(P.HttpClient),i.\u0275\u0275inject(aa),i.\u0275\u0275inject(ti),i.\u0275\u0275inject(fe,8))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:oa,factory:oa.\u0275fac,providedIn:"root"})}}class nt{constructor(e,t,n,s){this.httpClient=e,this._userInfo=t,this._schemaLoader=n,this._entityHttp=s,this._entitySchemaServiceRequests=new Map,this._destroyed$=new u.Subject}_convertToEntitySchema(e){const t=new Gh;return t.uId=e.uId,t.name=e.name,t.caption=this._getCaptionElement(e),t.extendParent=e.extendParent,t.packageUId=e.packageUId,t.administratedByColumns=e.administratedByColumns,t.administratedByOperations=e.administratedByOperations,t.administratedByRecords=e.administratedByRecords,t.description=e.description,t.isDBView=e.isDBView,t.isTrackChangesInDB=e.isTrackChangesInDB,t.isVirtual=e.isVirtual,t.masterRecordSchemaName=e.masterRecordSchemaName,t.primaryColumnUId=e.primaryColumnUId,t.primaryDisplayColumnUId=e.primaryDisplayColumnUId,t.primaryColorColumnUId=e.primaryColorColumnUId,t.hierarchyColumnUId=e.hierarchyColumnUId,t.createdOnColumnUId=e.createdOnColumnUId,t.createdByColumnUId=e.createdByColumnUId,t.modifiedOnColumnUId=e.modifiedOnColumnUId,t.modifiedByColumnUId=e.modifiedByColumnUId,t.useMasterRecordRights=e.useMasterRecordRights,t.parentUId=e.parentUId,t.columns=Object.values(e.columns.Items).map(n=>{const s=new Xc;return s.uId=n.uId,s.name=n.name,s.caption=this._getCaptionElement(n),s.dataValueType=n.dataValueType,s.usageType=n.usageType,s.referenceSchemaUId=n.referenceSchemaUId,s.referenceSchemaName=n.referenceSchemaName,s.isRequired=n.isRequired,s.isValueCloneable=n.isValueCloneable,s.isMasked=n.isMasked,s.isFormatValidated=n.isFormatValidated,s.isSensitiveData=n.isSensitiveData,s.isValueMasked=n.isValueMasked,s.valueMaskingSettings=n.valueMaskingSettings,s.defaultValueSchema=n.defValue,s.lookupMode=n.isSimpleLookup?Cl.List:Cl.SelectionWindow,s}),t}_getCaptionElement(e){return e.caption[this._userInfo.cultureInfo.sysCultureName]||e.caption[S_.dJ]}_createEntitySchemaColumnFromInformationObject(e){const t=new Xc;return t.uId=e.columnUId,t.name=e.columnName,t.caption=e.columnCaption,t.dataValueType=e.columnDataValueType,t.usageType=e.columnUsageType,t.referenceSchemaUId=e.referenceSchemaUId,t.referenceSchemaName=e.referenceSchemaName,t.columnCaptionPath=e.columnCaptionPath,t}_getEntitySchemaFromEndpoint(e,t){return this.httpClient.post(e,t).pipe((0,l.mergeMap)(n=>n.schema?(0,u.of)({success:!0,entitySchema:this._convertToEntitySchema(n.schema)}):(0,u.throwError)({success:!1,entitySchema:null,errorInfo:n.errorInfo})))}_getEntitySchemaColumnByPath(e,t,n="."){const s=`${e}_${n}_${t}`;if(this._entitySchemaServiceRequests.has(s))return this._entitySchemaServiceRequests.get(s);const a=this.httpClient.post(this._entityHttp.getSchemaDesignerServiceEndpoint(),{getSchemaColumnInformation:{entitySchemaUId:e,schemaColumnPath:t,schemaColumnCaptionPathDelimiter:n}}).pipe((0,l.tap)(({success:o})=>{if(!o)throw new Error("SchemaDesignerService request has failed")}),(0,l.map)(({getSchemaColumnInformationResponse:o})=>this._createEntitySchemaColumnFromInformationObject(o)),(0,l.tap)(()=>this._entitySchemaServiceRequests.delete(s)),(0,l.share)());return this._entitySchemaServiceRequests.set(s,a),a}_combineEntitySchemaColumnInformationRequestsWithPaths(e,t){return t.reduce((n,s)=>({...n,[s]:this._getEntitySchemaColumnByPath(e,s)}),{})}getEntitySchemaByUId(e,t){const n=`${e}_${t}`;if(this._entitySchemaServiceRequests.has(n))return this._entitySchemaServiceRequests.get(n);const s=t?this._entityHttp.getEntitySchemaServiceEndpoint():this._entityHttp.getRuntimeEntitySchemaServiceEndpoint(),a={uId:e};t&&(a.packageUId=t);const o=this._getEntitySchemaFromEndpoint(s,a).pipe((0,l.tap)(()=>this._entitySchemaServiceRequests.delete(n)),(0,l.share)());return this._entitySchemaServiceRequests.set(n,o),o}getEntitySchemaByName(e){if(this._entitySchemaServiceRequests.has(e))return this._entitySchemaServiceRequests.get(e);const t=(0,u.from)(this._schemaLoader.getEntity(e)).pipe((0,l.map)(n=>({success:n.success,entitySchema:n.schema?this._convertToEntitySchema(n.schema):null,errorInfo:n.errorInfo})),(0,l.tap)(()=>this._entitySchemaServiceRequests.delete(e)),(0,l.share)(),(0,l.catchError)(n=>(this._entitySchemaServiceRequests.delete(e),(0,u.throwError)(()=>n))));return this._entitySchemaServiceRequests.set(e,t),t}getEntitySchemes(e){const t=JSON.stringify(e);if(this._entitySchemaServiceRequests.has(t))return this._entitySchemaServiceRequests.get(t);const n=(0,u.from)(this._schemaLoader.getEntities(e)).pipe((0,l.map)(s=>({success:s.success,schemes:s.schemes.map(a=>this._convertToEntitySchema(a)),notFoundSchemes:s.notFoundSchemes})),(0,l.tap)(()=>this._entitySchemaServiceRequests.delete(t)),(0,l.share)(),(0,l.catchError)(s=>(0,u.throwError)(()=>s)));return this._entitySchemaServiceRequests.set(t,n),n}getEntitySchemaColumnsInformationByMetaPath(e,t){const n={getSchemaColumnsInformation:{entitySchemaUId:e,schemaColumnMetaPaths:t}};return this.httpClient.post(this._entityHttp.getSchemaDesignerServiceEndpoint(),n).pipe((0,l.tap)(({success:s})=>{if(!s)throw new Error("SchemaDesignerService request is failed")}),(0,l.map)(({getSchemaColumnsInformationResponse:s})=>s.map(a=>({column:this._createEntitySchemaColumnFromInformationObject(a),columnMetaPath:a.columnMetaPath,columnPath:a.columnPath,columnCaptionPath:a.columnCaptionPath}))))}getEntitySchemaColumnsInformationByPath(e,t,n){return this._getEntitySchemaColumnByPath(e,t,n)}getEntitySchemaColumnsInformationByPathsArray(e,t){return(0,u.forkJoin)(this._combineEntitySchemaColumnInformationRequestsWithPaths(e,t))}getColumnCaptionPathByMetaPath(e){const t={getColumnCaptionPathByMetaPath:e};return this.httpClient.post(this._entityHttp.getSchemaDesignerServiceEndpoint(),t).pipe((0,l.tap)(({success:n})=>{if(!n)throw new Error("SchemaDesignerService request is failed")}),(0,l.map)(({columnCaptionPath:n})=>n))}ngOnDestroy(){this._destroyed$.next(),this._destroyed$.complete()}static{this.\u0275fac=function(t){return new(t||nt)(i.\u0275\u0275inject(P.HttpClient),i.\u0275\u0275inject(We.oq),i.\u0275\u0275inject(oa),i.\u0275\u0275inject(ti))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:nt,factory:nt.\u0275fac,providedIn:"root"})}}class la{constructor(e){this.schemaChangeListener=e,this._repository=new Map,this._uIdMap=new Map,this._destroyed$=new u.Subject,this.schemaChangeListener.schemaChanged$.pipe((0,l.filter)(t=>t.schemaType===this.provider.schemaType),(0,l.takeUntil)(this._destroyed$)).subscribe(t=>this.clearSchemaCacheByUId(t.uId))}add(e){this._repository.set(e.name,e),this._uIdMap.set(e.uId,e.name)}getCachedSchema(e){return this._repository.get(e)}getIsSchemaCached(e){return this._repository.has(e)}getCachedSchemesNames(){return[...this._repository.keys()]}getSchemaByName(e){const t=this.getCachedSchema(e);return t?(0,u.of)(t):this.provider.getSchemaByName(e).pipe((0,l.tap)(n=>this.add(n)))}getSchemaByUId(e){const t=this._uIdMap.get(e),n=t&&this.getCachedSchema(t);return n?(0,u.of)(n):this.provider.getSchemaByUId(e).pipe((0,l.tap)(s=>this.add(s)))}clearSchemaCacheByName(e){const t=this.getCachedSchema(e);t&&this._uIdMap.delete(t.uId),this._repository.delete(e)}clearSchemaCacheByUId(e){const t=this._uIdMap.get(e);t&&this._repository.delete(t),this._uIdMap.delete(e)}ngOnDestroy(){this._destroyed$.next(),this._destroyed$.complete()}static{this.\u0275fac=function(t){return new(t||la)(i.\u0275\u0275inject(ni))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:la,factory:la.\u0275fac})}}class ca{constructor(e){this._entitySchemaService=e,this.schemaType=ls.EntitySchema}_getSchema(e){return e.pipe((0,l.switchMap)(t=>t.success===!0?(0,u.of)(t):(0,u.throwError)(()=>new Error(t.errorInfo.message))),(0,l.map)(t=>t.entitySchema))}_getScheme(e){return e.pipe((0,l.switchMap)(t=>t.success===!0?(0,u.of)(t):(0,u.throwError)(()=>new Error(t.errorInfo.message))),(0,l.map)(t=>t.schemes))}getSchemaByUId(e){const t=this._entitySchemaService.getEntitySchemaByUId(e);return this._getSchema(t)}getSchemaByName(e){const t=this._entitySchemaService.getEntitySchemaByName(e);return this._getSchema(t)}getSchemes(e){const t=this._entitySchemaService.getEntitySchemes(e);return this._getScheme(t)}static{this.\u0275fac=function(t){return new(t||ca)(i.\u0275\u0275inject(nt))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:ca,factory:ca.\u0275fac,providedIn:"root"})}}class nn extends la{constructor(e,t){super(t),this.provider=e,this.schemaChangeListener=t}_checkPath(e){if(!e||e.length===0)throw new Error("Path is null or empty")}_checkLookupColumn(e,t){if(!e.isLookupType)throw new Error(`Column '${e.name}' for schema '${t.name}' is not lookup`)}_getEntitySchemaColumn(e,t){const n=e.columns.find(s=>s.name===t);if(!n)throw new Error(`Can not find column '${t}' in schema '${e.name}'`);return n}_findEntitySchemesByPath(e,t){this._checkPath(t);const n=[...t],s=this.getCachedSchema(e);if(!s)return null;const a=n.shift(),o=bl.getPathItemInfo(a);let c=[];if(o.isBackReference)c=this._findEntitySchemesByPath(o.referenceSchemaName,n);else{const p=this._getEntitySchemaColumn(s,o.columnName);if(n.length===0)return[s];this._checkLookupColumn(p,s),c=this._findEntitySchemesByPath(p.referenceSchemaName,n)}if(!c)return null;const d=c.filter(p=>p.name!==s.name);return[s,...d]}_getAreSchemesCached(e){for(const t of e){const n=this.getCachedSchema(t.name);if(!n)return!1;const s=n.columns.filter(o=>o.isLookupType).every(o=>this.getIsSchemaCached(o.referenceSchemaName));if(t.loadLookupColumns&&!s)return!1;const a=t.forwardReferencePaths??[];for(const o of a){const c=o.split(".");if(!this.findEntitySchemaColumnByPath(t.name,c))return!1}}return!0}_addSchemaIfNotExists(e,t){e.has(t.name)||e.set(t.name,t)}_addSchemesIfNotExists(e,t){t.forEach(n=>{this._addSchemaIfNotExists(e,n)})}_getCachedSchemes(e){const t=new Map;return e.forEach(n=>{const s=this.getCachedSchema(n.name);if(!s)return;if(this._addSchemaIfNotExists(t,s),n.loadLookupColumns){const o=s.columns.filter(c=>c.isLookupType).map(c=>this.getCachedSchema(c.referenceSchemaName)).filter(c=>c!=null);this._addSchemesIfNotExists(t,o)}(n.forwardReferencePaths??[]).forEach(o=>{const c=o.split("."),d=this._findEntitySchemesByPath(n.name,c);d&&this._addSchemesIfNotExists(t,d)})}),[...t.values()]}getSchemes(e){if(this._getAreSchemesCached(e))return(0,u.of)(this._getCachedSchemes(e));const t={requests:e,cachedSchemesNames:this.getCachedSchemesNames()};return this.provider.getSchemes(t).pipe((0,l.tap)(n=>n.forEach(s=>this.add(s))),(0,l.map)(()=>this._getCachedSchemes(e)))}findEntitySchemaByPath(e,t){this._checkPath(t);const n=this.getCachedSchema(e);if(!n)return null;const s=[...t],a=s.shift(),o=bl.getPathItemInfo(a);if(o.isBackReference)return this.findEntitySchemaByPath(o.referenceSchemaName,s);const c=this._getEntitySchemaColumn(n,o.columnName);return s.length===0?n:(this._checkLookupColumn(c,n),this.findEntitySchemaByPath(c.referenceSchemaName,s))}findEntitySchemaColumnByPath(e,t){const n=this.findEntitySchemaByPath(e,t);if(!n)return null;const s=[...t].pop(),a=bl.getPathItemInfo(s);return this._getEntitySchemaColumn(n,a.columnName)}static{this.\u0275fac=function(t){return new(t||nn)(i.\u0275\u0275inject(ca),i.\u0275\u0275inject(ni))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:nn,factory:nn.\u0275fac,providedIn:"root"})}}function I_(r){return r=r||new Date,new Date(r.getFullYear(),r.getMonth(),r.getDate())}function Kh(r){return r=r||new Date,new Date(r.getFullYear(),r.getMonth(),r.getDate(),23,59,59,999)}function w_(r){if(!r)return null;function e(){throw new Error(`String "${r}" is not a valid serialized date.`)}typeof r!="string"&&e();const[t,n]=r.split("T");if(n&&(n[n.length-1]==="Z"||n.indexOf("+")!==-1||n.indexOf("-")!==-1)){const a=Date.parse(r);return isNaN(a)&&e(),new Date(a)}try{const[a,o,c]=t.split("-"),[d,p,C]=n.split(":"),[I,O]=C.split(".");return new Date(parseInt(a),parseInt(o)-1,parseInt(c),parseInt(d),parseInt(p),parseInt(I),parseInt(O))}catch{e()}}function ZS(r,e){e==null&&(e=0),r.setSeconds(r.getSeconds()+e*3600)}function YS(r,e,t){const n=t||{hour:"2-digit",minute:"2-digit"};return new Intl.DateTimeFormat(e.sysCultureName,n).format(r)}function qh(r,e){switch(ue.checkArgumentEmpty("dataValueType",e),e){case E.r.Date:case E.r.Time:case E.r.DateTime:return w_(r);default:return r}}function E_(r,e){if(ValidationUtilities.checkArgumentEmpty("columnValueTypes",e),!r)return r;const t={};return Object.keys(r).forEach(n=>{const s=r[n];t[n]=e[n]?qh(s,e[n]):s}),t}function KS(r,e){return ValidationUtilities.checkArgumentEmpty("columnValueTypes",e),r&&r.map(t=>t&&E_(t,e))}var cs;(function(r){r.Entity="Entity",r.ClientUnit="ClientUnit",r.Intent="Intent"})(cs||(cs={}));class ii{constructor(){this._phoneUtil=null,this._phoneNumberType=null,this._phoneMaskOverrides=new Map([["id",["+{62} 000 000 000 000","+{62} 000 000 00"]]])}getAllPhoneMasks(e){let t=[];for(const s in this._phoneNumberType)if(isNaN(Number(s))){const a=this._phoneUtil.getExampleNumberForType(e,this._phoneNumberType[s]);if(!a)continue;const o=a.getCountryCode().toString(),c=this._phoneUtil.format(a,null),d=`+{${o.replace("0","\\0")}} ${c.replace(/-/g," ").replace(/\d/g,"0")}`;t.find(p=>p===d)||t.push(d)}const n=this._phoneMaskOverrides.get(e);return n&&(t.push(...n),t=Array.from(new Set(t))),t}initialize(){var e=this;return(0,f.A)(function*(){if(!(e._phoneUtil&&e._phoneNumberType))try{const t=yield h.e(1588).then(h.t.bind(h,1588,23));e._phoneUtil=t.PhoneNumberUtil.getInstance(),e._phoneNumberType=t.PhoneNumberType}catch(t){throw console.error("Error loading google-libphonenumber:",t),t}})()}isValidPhoneNumber(e){if(!this._phoneUtil)return!0;try{const t=this._phoneUtil.parse(e);return this._phoneUtil.isValidNumber(t)}catch{return!1}}static{this.\u0275fac=function(t){return new(t||ii)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:ii,factory:ii.\u0275fac,providedIn:"root"})}}const su={ShortTextCaption:50,MediumTextCaption:250,LongTextCaption:500},Sl={Integer:{max:2147483647,min:-2147483647},Float:{max:6999999999999999e-2,min:-6999999999999999e-2}};function x_(r){let e;switch(r){case E.r.SHORT_TEXT:e=su.ShortTextCaption;break;case E.r.PHONE_TEXT:case E.r.MEDIUM_TEXT:e=su.MediumTextCaption;break;case E.r.LONG_TEXT:case E.r.EMAIL_TEXT:e=su.LongTextCaption;break;default:return}return{maxLength:e}}function T_(r){if([E.r.Float,E.r.FLOAT1,E.r.FLOAT2,E.r.FLOAT3,E.r.FLOAT4,E.r.FLOAT8,E.r.Money].includes(r))return{minValue:Sl.Float.min,maxValue:Sl.Float.max};if(r===E.r.Integer)return{minValue:Sl.Integer.min,maxValue:Sl.Integer.max}}class ua{get isDate(){return this.dataValueType===E.r.Date||this.dataValueType===E.r.DateTime||this.dataValueType===E.r.Time}get isImage(){return this.dataValueType===E.r.IMAGELOOKUP||this.dataValueType===E.r.Image}get isLookup(){return this.dataValueType===E.r.Lookup}set isSystem(e){this._isSystem=e}get isSystem(){return this._isSystem}get isAggregate(){return this.attributeType===ye.AggregationAttribute?!0:this.attributeType===ye.FunctionAttribute&&this.functionConfig?.type==="aggregation"}constructor(e){if(this._isSystem=!1,e!=null){this.name=e.name,this.caption=e.caption,this.path=e.path,this.dataValueType=e.dataValueType,e.validators&&(this.validators={...e.validators||{}});const t=e.defaultValue;t&&(t instanceof u.Observable?this.defaultValue=t.pipe((0,l.map)(n=>this._getConvertDefaultValue(n))):this.defaultValue=(0,u.of)(this._getConvertDefaultValue(t))),this.defaultValueSchema=e.defaultValueSchema,this.isValueCloneable=e.isValueCloneable,this.attributeType=e.attributeType,this.referenceSchemaName=e.referenceSchemaName,this.functionConfig=e.functionConfig,this.aggregationConfig=e.aggregationConfig,this.isMasked=e.isMasked,this.isFormatValidated=e.isFormatValidated,this.isSensitiveData=e.isSensitiveData,this.isValueMasked=e.isValueMasked,this.valueMaskingSettings=e.valueMaskingSettings,this.usageType=e.usageType,this.isRequired=e.isRequired,this.lookupMode=e.lookupMode,this.isSystem=!!e.isSystem}}_getConvertDefaultValue(e){if(this.isDate)if(e instanceof Date){const t=new Date;return t.setTime(e.getTime()),t}else return e;else return typeof e=="object"?{...e}:e}clone(){return new ua(this)}addDefaultValidators(){const e=this.validators??{};this.isRequired&&(e["crt.Required"]={type:"crt.Required"}),!this.validators&&Object.keys(e).length>0&&(this.validators=e)}}class Jh{constructor(e=null,t,n){e==null?this._dataSchema=new In:this._dataSchema=t?.useClone?e.clone():e.createChild(),this._phoneValidationService=n||i.Injector.create({providers:[{provide:ii,useClass:ii}]}).get(ii)}_createDataSchemaAttributeByConfig(e){const t=new ua;return t.name=e.name,t.caption=e.caption,t.path=e.path,t.dataValueType=e.dataValueType,t.validators={...e.validators||{}},t.defaultValue=(0,u.of)(typeof e.defaultValue=="object"?{...e.defaultValue}:e.defaultValue),t.defaultValueSchema=e.defaultValueSchema,t.isValueCloneable=e.isValueCloneable,t.attributeType=e.attributeType,t.referenceSchemaName=e.referenceSchemaName,t.functionConfig=e.functionConfig,t.aggregationConfig=e.aggregationConfig,t.usageType=e.usageType,t.isMasked=e.isMasked,t.isFormatValidated=e.isFormatValidated,t.isSensitiveData=e.isSensitiveData,t.isValueMasked=e.isValueMasked,t.valueMaskingSettings=e.valueMaskingSettings,t.isRequired=e.isRequired,t.lookupMode=e.lookupMode,t.isSystem=e.isSystem??!1,t}setEntitySchemaColumnValidators(e,t){return e.isRequired&&this.setAttributeRequiredValidator(t),this.setAttributeTextDataValueTypeValidator(t,e.dataValueType).setAttributeNumberDataValueTypeValidator(t,e.dataValueType).setAttributePhoneDataValueTypeValidator(t,e)}setAttributeValidator(e,t,n){const s=this._dataSchema.attributes.find(o=>o.name===e),a=s.validators||{};return a[t]=n,s.validators=a,this}setAttributeRequiredValidator(e){return this.setAttributeValidator(e,"crt.Required",{type:"crt.Required"})}setAttributeMaxLengthValidator(e,t){return this.setAttributeValidator(e,"crt.MaxLength",{type:"crt.MaxLength",params:{maxLength:t}})}setAttributeTextDataValueTypeValidator(e,t){const n=x_(t);return n?this.setAttributeMaxLengthValidator(e,n.maxLength):this}setAttributeMinValueValidator(e,t){return this.setAttributeValidator(e,"crt.Min",{type:"crt.Min",params:{min:t}})}setAttributeMaxValueValidator(e,t){return this.setAttributeValidator(e,"crt.Max",{type:"crt.Max",params:{max:t}})}setAttributeMinMaxValidator(e,t,n){return this.setAttributeMinValueValidator(e,t).setAttributeMaxValueValidator(e,n)}setAttributeNumberDataValueTypeValidator(e,t){const n=T_(t);return n&&this.setAttributeMinMaxValidator(e,n.minValue,n.maxValue),this}setAttributePhoneDataValueTypeValidator(e,t){return[E.r.PHONE_TEXT].includes(t.dataValueType)&&t.isMasked&&(this._phoneValidationService.initialize().then(),this.setAttributeValidator(e,"crt.PhoneNumber",{type:"crt.PhoneNumber"})),this}setAttributesDefaultValue(e){return this._dataSchema.attributes.forEach(t=>{t.defaultValue=e.pipe((0,l.map)(n=>n[t.name]))}),this}addAttribute(e,t){const{name:n,caption:s,dataValueType:a,isValueCloneable:o,referenceSchemaName:c,isMasked:d,isFormatValidated:p,usageType:C,isRequired:I,isSensitiveData:O,isValueMasked:Y,valueMaskingSettings:te}=e,se=new ua;return se.name=t.attributeName||n,se.path=t.attributePath||n,se.caption=s,se.dataValueType=a,se.isValueCloneable=!!o,se.attributeType=t.attributeType||ye.OwnAttribute,se.referenceSchemaName=c,se.validators={},se.isMasked=d,se.isFormatValidated=p,se.isSensitiveData=O,se.isValueMasked=Y,se.valueMaskingSettings=te,se.usageType=C,se.isRequired=I,se.defaultValueSchema=e.defaultValueSchema,se.lookupMode=e.lookupMode,se.isSystem=(0,M.compact)([this._dataSchema.createdByAttributeName,this._dataSchema.createdOnAttributeName,this._dataSchema.modifiedByAttributeName,this._dataSchema.modifiedOnAttributeName,this._dataSchema.primaryAttributeName,"ProcessListeners"]).includes(se.name),this._dataSchema.addAttribute(se),t.attributeType===ye.OwnAttribute&&this.setEntitySchemaColumnValidators(e,se.name),t.attributeType===ye.AggregationAttribute&&(se.aggregationConfig=t.aggregationConfig),t.attributeType===ye.FunctionAttribute&&(se.functionConfig=t.functionConfig),this}addOwnAttribute(e){return this.addAttribute(e,{attributeType:ye.OwnAttribute})}setEntitySchema(e){return this._dataSchema.dataSourceConfig={type:"crt.EntityDataSource",config:{entitySchemaName:e.name}},this._dataSchema.name=e.name,this._dataSchema.type=cs.Entity,this._dataSchema.primaryAttributeName=e.getPrimaryColumn()?.name,this._dataSchema.primaryDisplayAttributeName=e.getPrimaryDisplayColumn()?.name,this._dataSchema.primaryColorAttributeName=e.getPrimaryColorColumn()?.name,this._dataSchema.hierarchyAttributeName=e.getHierarchyColumn()?.name,this._dataSchema.caption=e.caption,this._dataSchema.createdByAttributeName=e.columns.find(t=>t.uId===e.createdByColumnUId)?.name,this._dataSchema.createdOnAttributeName=e.columns.find(t=>t.uId===e.createdOnColumnUId)?.name,this._dataSchema.modifiedByAttributeName=e.columns.find(t=>t.uId===e.modifiedByColumnUId)?.name,this._dataSchema.modifiedOnAttributeName=e.columns.find(t=>t.uId===e.modifiedOnColumnUId)?.name,this._dataSchema.clearAttributes(),e.columns.forEach(t=>{this.addOwnAttribute(t)}),this}setDataSchemaConfig(e){return this._dataSchema.name=e.name,this._dataSchema.type=e.type,this._dataSchema.caption=typeof e.caption=="string"?e.caption:{...e.caption},this._dataSchema.primaryAttributeName=e.primaryAttributeName,this._dataSchema.primaryDisplayAttributeName=e.primaryDisplayAttributeName,this._dataSchema.dataSourceConfig={...e.dataSourceConfig,config:{...e.dataSourceConfig?.config}},(e.attributes||[]).forEach(n=>{const s=this._createDataSchemaAttributeByConfig(n);this._dataSchema.addAttribute(s)}),this}build(){return this._dataSchema.clone()}}class A_ extends Yc{get entitySchemaName(){return this._entitySchemaName}constructor(e,t){super(e,`Entity schema with name '${t}' not found.`),this._entitySchemaName=t}}class D_ extends Yc{constructor(e){super(e,`Entity schema name for data source ${e.dataSourceName} is not provided`)}}class N_ extends Error{constructor(e){super(`Item with key '${e}' does not exist.`)}}var sn;(function(r){r[r.None=0]="None",r[r.Asc=1]="Asc",r[r.Desc=2]="Desc"})(sn||(sn={}));class rn{constructor(e){this.orderDirection=sn.None,this.orderPosition=-1,this.isVisible=!0,this.expression=e}withOrdering(e,t){return ue.checkArgumentEmpty("orderDirection",e),ue.checkArgumentEmpty("orderPosition",t),ue.checkArgumentOutOfRange("orderPosition",t,{begin:-1}),this.orderDirection=e,this.orderPosition=t,this}withOptions(e){return ue.checkArgumentEmpty("options",e),this.isVisible=e.isVisible??!0,this}withCaption(e){return ue.checkArgumentEmpty("caption",e),this.caption=e,this}_getUsedColumns(){return this.expression._getUsedColumns()}toJson(){return(0,Ee.instanceToPlain)(this,{exposeUnsetFields:!1,excludePrefixes:["_"]})}}class P_ extends rn{constructor(e){super(new be({columnPath:e}))}}class da extends Ut{static{this._instanceOfKey="devkit_SubQueryExpression"}static get _instanceOfKeys(){return[...Ut._instanceOfKeys,this._instanceOfKey]}constructor(e){super(e),this.expressionType=Ze.SubQuery,this.columnPath=e?.columnPath;const t=e?.subFilters;typeof t?.clone=="function"?this.subFilters=t.clone():t?(this.subFilters=new pt(t.logicalOperation,t.rootSchemaName),this.subFilters.isEnabled=t.isEnabled,Object.entries(t.items).forEach(([n,s])=>{this.subFilters.add(s,n)})):this.subFilters=t,this.subOrderDirection=e.subOrderDirection,this.subOrderColumn=e.subOrderColumn}static fromJson(e,t){return new da({columnPath:e.columnPath,subFilters:t.fromJson(e.subFilters),subOrderDirection:e.subOrderDirection,subOrderColumn:e.subOrderColumn})}clone(){return new da(this)}toJson(){const e=super.toJson();return this.subFilters&&(e.subFilters=this.serializeItem(this.subFilters)),e}_getUsedColumns(){return[{path:this.columnPath},...this.subFilters?._getUsedColumns()??[]]}}class ha extends da{static{this._instanceOfKey="devkit_AggregationSubQueryExpression"}static get _instanceOfKeys(){return[...da._instanceOfKeys,this._instanceOfKey]}constructor(e){super(e),this.aggregationType=e?.aggregationType,this.functionType=e?.functionType}static fromJson(e,t){const n=super.fromJson(e,t);return new ha({aggregationType:e.aggregationType,functionType:e.functionType,...n})}clone(){return new ha(this)}}class R_ extends rn{constructor(e,t,n,s,a){super(new ha({aggregationType:t,columnPath:e,subFilters:n,subOrderDirection:s,subOrderColumn:a}))}}class O_ extends rn{constructor(e,t){super(new we({value:e,dataValueType:t}))}}class pa extends Ut{static{this._instanceOfKey="devkit_ArithmeticExpression"}static get _instanceOfKeys(){return[...Ut._instanceOfKeys,this._instanceOfKey]}constructor(e){super(e),this.expressionType=Ze.ArithmeticOperation,this.arithmeticOperation=e?.arithmeticOperation,this.leftArithmeticOperand=e?.leftArithmeticOperand.clone(),this.rightArithmeticOperand=e?.rightArithmeticOperand.clone()}static fromJson(e,t,n){const s=n?.fromJson(e.leftArithmeticOperand,t),a=n?.fromJson(e.rightArithmeticOperand,t),o={leftArithmeticOperand:s,rightArithmeticOperand:a,arithmeticOperation:e.arithmeticOperation,isBlock:e.isBlock};return new pa(o)}clone(){return new pa(this)}_getUsedColumns(){return[...this.leftArithmeticOperand._getUsedColumns(),...this.rightArithmeticOperand._getUsedColumns()]}}class V_ extends rn{constructor(e,t,n){super(new pa({arithmeticOperation:e,leftArithmeticOperand:t,rightArithmeticOperand:n}))}}class L_ extends rn{constructor(e){super(new ei({macrosType:e}))}}class En extends _l{static{this._instanceOfKey="devkit_ArgumentFunctionExpression"}static get _instanceOfKeys(){return[..._l._instanceOfKeys,this._instanceOfKey]}constructor(e){super(e),this.functionArgument=e?.functionArgument?.clone()}toJson(){const e=super.toJson();return this.functionArgument&&(e.functionArgument=this.serializeItem(this.functionArgument)),e}_getUsedColumns(){return this.functionArgument?._getUsedColumns()??[]}}class si extends En{static{this._instanceOfKey="devkit_DatePartFunctionExpression"}static get _instanceOfKeys(){return[...En._instanceOfKeys,this._instanceOfKey]}constructor(e){super(e),this.functionType=Je.DatePart,this.datePartType=e?.datePartType}static fromJson(e,t,n){const s=n?.fromJson(e.functionArgument,t),a=e.datePartType;return new si({functionArgument:s,datePartType:a,isBlock:e.isBlock})}clone(){return new si(this)}}class k_ extends rn{constructor(e,t){super(new si({datePartType:e,functionArgument:t}))}get datePartType(){return this.expression?.datePartType}}class ma extends En{static{this._instanceOfKey="devkit_AggregationFunctionExpression"}static get _instanceOfKeys(){return[...En._instanceOfKeys,this._instanceOfKey]}constructor(e){super(e),this.functionType=Je.Aggregation,this.aggregationType=e?.aggregationType,this.aggregationEvalType=e?.aggregationEvalType}static fromJson(e,t,n){const s=n?.fromJson(e.functionArgument,t),a=e.aggregationType,o=e.aggregationEvalType;return new ma({functionArgument:s,aggregationType:a,aggregationEvalType:o,isBlock:e.isBlock})}clone(){return new ma(this)}}class j_ extends rn{constructor(e,t,n){super(new ma({aggregationType:e,aggregationEvalType:t,functionArgument:n}))}}class ga extends En{static{this._instanceOfKey="devkit_LengthFunctionExpression"}static get _instanceOfKeys(){return[...En._instanceOfKeys,this._instanceOfKey]}constructor(e){super(e),this.functionType=Je.Length}static fromJson(e,t,n){const s=n?.fromJson(e.functionArgument,t);return new ga({functionArgument:s,isBlock:e.isBlock})}clone(){return new ga(this)}}class F_ extends rn{constructor(e){super(new ga({functionArgument:e}))}}class fa extends En{static{this._instanceOfKey="devkit_WindowFunctionExpression"}static get _instanceOfKeys(){return[...En._instanceOfKeys,this._instanceOfKey]}constructor(e){super(e),this.functionType=Je.Window}static fromJson(e,t,n){const s=n?.fromJson(e.functionArgument,t);return new fa({functionArgument:s,isBlock:e.isBlock})}clone(){return new fa(this)}}class B_ extends rn{constructor(e){super(new fa({functionArgument:e}))}}var Ml;(function(r){r[r.None=0]="None",r[r.All=1]="All",r[r.Distinct=2]="Distinct"})(Ml||(Ml={}));class _a extends yl{constructor(e){super(os.Select,e),this._columns=new Map,this._queryDtoType="Terrasoft.Nui.ServiceModel.DataContract.SelectQuery",this.isDistinct=!1,this.rowCount=-1,this.rowsOffset=-1,this.useLocalization=!0,this.useRecordDeactivation=!1,this._getIsPageable=()=>this.rowCount>0&&this.rowsOffset>-1}_internalAddColumn(e,t){this._columns.has(e)||this._columns.set(e,t)}getColumn(e){if(!this._columns.has(e))throw new N_(e);return this.findColumn(e)}findColumn(e){return this._columns.get(e)}getMetadata(){return{...super.getMetadata(),columns:{items:(0,Ee.classToPlain)(this._columns,{exposeUnsetFields:!1,excludePrefixes:["_"]})},allColumns:!1,isDistinct:this.isDistinct,ignoreDisplayValues:!1,rowCount:this.rowCount,rowsOffset:this.rowsOffset,adminUnitRoleSources:this.adminUnitRoleSources,isPageable:this._getIsPageable(),conditionalValues:this.conditionalValues?this.conditionalValues:null,isHierarchical:!1,hierarchicalMaxDepth:0,hierarchicalColumnName:null,hierarchicalColumnValue:null,useLocalization:this.useLocalization,useRecordDeactivation:this.useRecordDeactivation}}addColumn(e,t){return this._internalAddColumn(t,e),e}addSchemaColumn(e,t){ue.checkArgumentEmpty("columnPath",e);const n=new P_(e);return this._internalAddColumn(t||e,n),n}addAggregationSubQueryColumn(e,t,n,s){const a=new R_(e,t,n.filter,n.sortByDirection,n.sortByColumn);return this._internalAddColumn(s||e,a),a}addParameterColumn(e,t,n){const s=new O_(e,t);return this._internalAddColumn(n,s),s}addArithmeticColumn(e,t,n,s){const a=new V_(e,t,n);return this._internalAddColumn(s,a),a}addMacrosFunctionColumn(e,t){const n=new L_(e);return this._internalAddColumn(t,n),n}addDatePartFunctionColumn(e,t,n){const s=new be({columnPath:e}),a=new k_(t,s);return this._internalAddColumn(n,a),a}addAggregationFunctionColumn(e,t,n,s=Ml.None){const a=new be({columnPath:e}),o=new j_(t,s,a);return this._internalAddColumn(n,o),o}addLengthFunctionColumn(e,t){const n=new be({columnPath:e}),s=new F_(n);return this._internalAddColumn(t,s),s}addWindowFunctionColumn(e,t,n,s=Ml.None){const a=new ma({aggregationType:t,aggregationEvalType:s,functionArgument:new be({columnPath:e})}),o=new B_(a);return this._internalAddColumn(n,o),o}_getUsedColumns(){const e=[];return this._columns.forEach(t=>{e.push(...t._getUsedColumns())}),e.forEach(t=>{t.schemaName||(t.schemaName=this.rootSchemaName)}),[...e,...super._getUsedColumns()]}}function U_(r){switch(r){case"asc":return sn.Asc;case"desc":return sn.Desc;default:return sn.None}}const z_=new i.InjectionToken("A factory of entity schema column appender"),H_=new i.InjectionToken("A factory of data schema to data source attribute converter");class W_{_getExpressionColumnPath(e,t){const n="[{referenceSchemaName}:{referenceAttributeName}:{attributeName}]",s=e.relationData.map(p=>Kt.String.format(n,p)).join("."),a=e.attributePath.split("."),o=a.length>1?"{ownColumnPath}.{relationString}.{columnPath}":"{relationString}.{columnPath}";a.pop();const d={ownColumnPath:a.join("."),relationString:s,columnPath:t};return Kt.String.format(o,d)}_updateFilterLeftExpression(e,t){switch(e.expressionType){case Ze.SchemaColumn:e.columnPath=this._getExpressionColumnPath(t,e.columnPath);break;case Ze.SubQuery:e.columnPath=this._getExpressionColumnPath(t,e.columnPath);break;case Ze.Function:e.functionType!==Je.Macros&&this._updateFilterLeftExpression(e.functionArgument,t);break}}_updateRelatedFilterGroup(e,t){e instanceof pt?this._updateRelatedFilterGroupInstance(e,t):this._updateRelatedFilterGroupObject(e,t)}_updateRelatedFilterGroupObject(e,t){Object.values(e.items).forEach(n=>{this._updateRelatedFilter(n,t)})}_updateRelatedFilterGroupInstance(e,t){e.filters.forEach(n=>this._updateRelatedFilter(n,t))}_updateRelatedFilter(e,t){if(e.filterType!==Ie.FilterGroup){const n=e.leftExpression;n&&this._updateFilterLeftExpression(n,t)}else this._updateRelatedFilterGroup(e,t)}convertToRelatedFilter(e,t=[]){if(!e)return e;let n;if(e instanceof ta)n=e.clone();else{const s=JSON.stringify(e);n=JSON.parse(s)}return[...t].reverse().forEach(s=>{s.relationData&&s.relationData.length!==0&&this._updateRelatedFilter(n,s)}),n}}const $_="invalidate-data-schema-cache";class xn{constructor(e,t){this._entitySchemaRepository=e,this._broadcastChannelFactory=t,this._dataSchemas=new Map,this._subscribeOnChangesInDesigner()}_subscribeOnChangesInDesigner(){this._broadcastChannelFactory.createInstance($_).messages$.subscribe(({schemaName:e})=>{this._removeCachedSchema(e)})}_createEntityDataSchema(e){const t=new Jh;return t.setEntitySchema(e),(0,u.of)(t.build())}_getEntityDataSchema(e){return this._entitySchemaRepository.getSchemaByName(e).pipe((0,l.switchMap)(t=>this._createEntityDataSchema(t)))}_removeCachedSchema(e){this._dataSchemas.has(e)&&(this._dataSchemas.delete(e),this._entitySchemaRepository.clearSchemaCacheByName(e))}get(e){return this._dataSchemas.has(e)?(0,u.of)(this._dataSchemas.get(e)):this._getEntityDataSchema(e).pipe((0,l.tap)(t=>this._dataSchemas.set(e,t)))}getByEntitySchema(e){const t=e.name;return this._dataSchemas.has(t)?(0,u.of)(this._dataSchemas.get(t)):this._createEntityDataSchema(e).pipe((0,l.tap)(n=>this._dataSchemas.set(t,n)))}static{this.\u0275fac=function(t){return new(t||xn)(i.\u0275\u0275inject(nn),i.\u0275\u0275inject(T.Vx))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:xn,factory:xn.\u0275fac,providedIn:"platform"})}}class ya{constructor(e,t){this._dataSchemaRepository=e,this._featureValues=t}_getDataSchema(e){var t=this;return(0,f.A)(function*(){const n=yield(0,u.firstValueFrom)(t._dataSchemaRepository.get(e));if(!n)throw new Error(`Can not find DataSchema with name '${e}'`);return n})()}_getDataSchemaAttribute(e,t){var n=this;return(0,f.A)(function*(){const s=e instanceof In?e:yield n._getDataSchema(e),a=s.findAttributeByName(t);if(!a)throw new Error(`Can not find column '${t}' in Schema '${s.name}'`);return a})()}_getDataSchemaPrimaryAttribute(e){var t=this;return(0,f.A)(function*(){const n=yield t._getDataSchema(e);return t._getDataSchemaAttribute(n,n.primaryAttributeName)})()}_createRelationPathItemFromForwardPathItem(e,t){var n=this;return(0,f.A)(function*(){const s=yield n._getDataSchemaAttribute(e,t);let a=null,o=null;const c=s.dataValueType===E.r.Lookup;return c&&(a=s.referenceSchemaName,o=(yield n._getDataSchema(a)).primaryAttributeName),{isJoin:c,referenceSchemaName:a,referenceAttributeName:o,ownSchemaAttributeName:t,ownSchemaName:e}})()}_createRelationPathItemFromJoinPathItem(e,t,n,s){var a=this;return(0,f.A)(function*(){const o=n?yield a._getDataSchemaAttribute(t,n):yield a._getDataSchemaPrimaryAttribute(t);return{isJoin:!0,referenceSchemaName:t,referenceAttributeName:o.name,ownSchemaAttributeName:s,ownSchemaName:e}})()}_createRelationPathItem(e,t){const s=/(?<joinType>.*)\[(?<refSchema>.*?):(?<ownColumn>.*?)(?::(?<refColumn>.*))?]/.exec(t);if(s){const a=s.groups;return this._createRelationPathItemFromJoinPathItem(e,a.refSchema,a.refColumn,a.ownColumn)}return this._createRelationPathItemFromForwardPathItem(e,t)}_getReverseRelationPath(e){const t=[...e],n=[];let s;for(;(s=t.pop())!=null;)n.push({isJoin:!0,ownSchemaName:s.referenceSchemaName,ownSchemaAttributeName:s.referenceAttributeName,referenceSchemaName:s.ownSchemaName,referenceAttributeName:s.ownSchemaAttributeName});return n}_buildRelationPath(e,t){var n=this;return(0,f.A)(function*(){const s=t.split("."),a=[];let o=e;for(const c of s){const d=yield n._createRelationPathItem(o,c);o=d.referenceSchemaName,a.push(d)}return a})()}_getRelationPathToSourceSchema(e,t,n){var s=this;return(0,f.A)(function*(){const a=[...t],o=a.pop(),c=n.split("."),p=(yield s._buildRelationPath(e,n)).pop(),C={isJoin:!0,ownSchemaName:o.isJoin?o.referenceSchemaName:o.ownSchemaName,ownSchemaAttributeName:o.isJoin?o.referenceAttributeName:o.ownSchemaAttributeName,referenceSchemaName:p.ownSchemaName,referenceAttributeName:c.pop()},I=[...a,...o.isJoin?[o]:[],C];return s._featureValues.DisableDsDepsJoinOptimization||I.length===1?I:I.filter(O=>{if(!O.isJoin)return!0;const Y=O.ownSchemaName===O.referenceSchemaName,te=O.ownSchemaAttributeName===O.referenceAttributeName;return!(Y&&te)})})()}_buildRelationDataFromPath(e){return e.map(t=>({attributeName:t.ownSchemaAttributeName,referenceAttributeName:t.referenceAttributeName,referenceSchemaName:t.referenceSchemaName}))}_getDataSourceParameterRelationData(e,t){var n=this;return(0,f.A)(function*(){const s=yield n._buildRelationPath(t.dataSchemaName,t.relationPath),a=yield n._getRelationPathToSourceSchema(e,s,t.attributePath),o=n._getReverseRelationPath(a);return n._buildRelationDataFromPath(o)})()}_convertEntityDataSourceParameter(e,t){var n=this;return(0,f.A)(function*(){if(!t.relationsConfigs||t.relationsConfigs.length===0)return t;let s=e.name;const a=[];for(const o of t.relationsConfigs){const c=yield n._getDataSourceParameterRelationData(s,o);s=c[c.length-1].referenceSchemaName,a.push({...o,relationData:c})}return{...t,relationsConfigs:a}})()}convert(e,t,n=!1){return t.length===0?Promise.resolve([]):n?Promise.resolve(t):Promise.all(t.map(s=>this._convertEntityDataSourceParameter(e,s)))}static{this.\u0275fac=function(t){return new(t||ya)(i.\u0275\u0275inject(xn),i.\u0275\u0275inject(fe))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:ya,factory:ya.\u0275fac,providedIn:"root"})}}class us{constructor(e,t){this._dataSchemaRepository=e,this._parametersConverter=t}_createPrimaryColumnValueFilter(e,t){const a=(t.relationsConfigs||[])[0]?.dataSchemaName??e;return this._dataSchemaRepository.get(a).pipe((0,u.map)(o=>{const c=new be({columnPath:o.primaryAttributeName}),d=new we({value:t.value});return new Bt(ge.Equal,c,d)}))}_createColumnValueFilter(e){const t=e.value.attributePath,n=e.value.attributeValue,s=new be({columnPath:t}),a=new we({value:n}),o=new Bt(ge.Equal,s,a);return(0,u.of)(o)}_createPrimaryDisplayValueFilter(e,t){const a=(t.relationsConfigs||[])[0]?.dataSchemaName??e;return this._dataSchemaRepository.get(a).pipe((0,u.map)(o=>{const c=new be({columnPath:o.primaryDisplayAttributeName}),d=new we({value:t.value});return new Bt(t.comparisonType,c,d)}))}_createCustomFilter(e){let t={};return e.value&&(t=typeof e.value=="string"?JSON.parse(e.value):e.value),(0,u.of)(t)}_createEmptyParameterFiler(e){const t=e.relationsConfigs||[];if(t.length===0)return(0,u.of)({});const n=t[0];return this._dataSchemaRepository.get(n.dataSchemaName).pipe((0,u.map)(s=>s.primaryAttributeName),(0,u.map)(s=>{const a=new be({columnPath:s});return new Xn(a,null)}))}_createEsqFilter(e,t){switch(t.type){case ce.PrimaryColumnValue:return this._createPrimaryColumnValueFilter(e,t);case ce.ColumnValue:return this._createColumnValueFilter(t);case ce.PrimaryDisplayValueFilter:return this._createPrimaryDisplayValueFilter(e,t);case ce.Filter:return this._createCustomFilter(t);case ce.Empty:return this._createEmptyParameterFiler(t)}}applyParameters(e,t){if(e.length===0)return(0,u.of)(t);const n=e.map(s=>this._createEsqFilter(t.rootSchemaName,s).pipe((0,u.map)(a=>new W_().convertToRelatedFilter(a,s.relationsConfigs))));return(0,u.forkJoin)(n).pipe((0,u.tap)(s=>{s.forEach(a=>{(0,M.isEmpty)(a)||t.filters.add(a)})}),(0,u.map)(()=>t))}convertToEntityDataSourceParameters(e,t,n=!1){return(0,u.from)(this._parametersConverter.convert(e,t,n))}static{this.\u0275fac=function(t){return new(t||us)(i.\u0275\u0275inject(xn),i.\u0275\u0275inject(ya))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:us,factory:us.\u0275fac,providedIn:"root"})}}class Ca{constructor(e,t,n){this.entitySchemaQueryUtils=e,this._entitySchemaColumnAppenderFactory=t,this._dataSchemaToDataSourceAttributeConverter=n}_addPagingToEsq(e,t){t&&(e.rowsOffset=t.rowsOffset,e.rowCount=t.rowCount)}_addSortingToEsq(e,t){t&&t.columns.forEach((n,s)=>{const a=e.findColumn(n.columnName),o=U_(n.direction);a?a.withOrdering(o,s):e.addSchemaColumn(n.columnName).withOrdering(o,s)})}_addIsDistinctToEsq(e,t){t&&(e.isDistinct=!0)}_addColumnToEsq(e,t){t.filter(Boolean).forEach(n=>{this._entitySchemaColumnAppenderFactory.create(n).addColumn(e,n)})}_prepareAttributePairsForLoad(e,t){return t.map(n=>{if(typeof n=="string"){const s=n,a=e.attributes.find(o=>o.name===s);return a?this._dataSchemaToDataSourceAttributeConverter.create(a.attributeType).convert(a):{name:s,path:s}}else return n})}build(e,t,n,s){if(n.some(a=>a.type===ce.Never))throw new Error('Failed to build entity schema query: parameters contains "Never" model parameter.');return(0,u.forkJoin)([this.entitySchemaQueryUtils.convertToEntityDataSourceParameters(e,n),(0,u.of)(this._prepareAttributePairsForLoad(e,t))]).pipe((0,u.map)(([a,o])=>({esq:new _a(e.name),esqParameters:a,dataSourceAttributes:o})),(0,u.tap)(({esq:a,dataSourceAttributes:o})=>this._addColumnToEsq(a,o)),(0,u.tap)(({esq:a})=>this._addSortingToEsq(a,s?.sortingConfig)),(0,u.tap)(({esq:a})=>this._addPagingToEsq(a,s?.pagingConfig)),(0,u.tap)(({esq:a})=>this._addIsDistinctToEsq(a,s?.isDistinct)),(0,u.switchMap)(({esq:a,esqParameters:o})=>this.entitySchemaQueryUtils.applyParameters(o,a)))}static{this.\u0275fac=function(t){return new(t||Ca)(i.\u0275\u0275inject(us),i.\u0275\u0275inject(z_),i.\u0275\u0275inject(H_))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Ca,factory:Ca.\u0275fac,providedIn:"root"})}}const ru=r=>{switch(r){case E.r.Guid:return E.r.Guid;case E.r.Text:case E.r.SHORT_TEXT:case E.r.PHONE_TEXT:case E.r.WEB_TEXT:case E.r.EMAIL_TEXT:case E.r.MEDIUM_TEXT:case E.r.MAXSIZE_TEXT:case E.r.LONG_TEXT:case E.r.HASH_TEXT:case E.r.SECURE_TEXT:case E.r.RICH_TEXT:return E.r.Text;case E.r.Integer:case E.r.Enum:return E.r.Integer;case E.r.Float:case E.r.FLOAT1:case E.r.FLOAT2:case E.r.FLOAT3:case E.r.FLOAT4:case E.r.FLOAT8:case E.r.Money:return E.r.Float;case E.r.DateTime:case E.r.Date:case E.r.Time:return E.r.DateTime;case E.r.Lookup:case E.r.IMAGELOOKUP:return E.r.Lookup;case E.r.Boolean:return E.r.Boolean;case E.r.Blob:return E.r.Blob;case E.r.Image:return E.r.Image;case E.r.Color:return E.r.Color;default:throw new Error(`Type ${r} not implemented`)}};function qS(r,e=null,t=DataValueType.Float){if(!r||r.length===0)return e;if(r.length===1)return r[0];let n=r.map(s=>ru(s)).map(s=>DataValueTypeGroup.Number.includes(s)?t:s);return n=[...new Set(n)],n.length===1?n[0]:e}class G_ extends Kc{constructor(){super(...arguments),this.supportTransactions=!0}}class ba extends G_{get isForceUpdateUnchangedData(){return!!this.initialConfig?.isForceUpdateUnchangedData}get affectedAttributes(){return[...this._affectedAttributes]}get isAggregate(){return this.dataSchema?this.dataSchema.attributes.some(t=>t.isAggregate):!1}constructor(e,t){super(e,t),this.dataSourceName=e,this.injector=t,this._affectedAttributes=[],this._errorReferenceAttributes=[],this.type=Uh,this._featureValues=t.get(fe),this._queryExecutor=t.get(wn),this._entitySchemaService=t.get(nt),this._httpClient=this.injector.get(P.HttpClient),this._rightsService=this.injector.get(Qc),this.dataSchemaRepository=this.injector.get(xn),this._entitySchemaRepository=this.injector.get(nn),this._entitySchemaQueryBuilder=this.injector.get(Ca),this._entitySchemaQueryUtils=this.injector.get(us),this._window=this.injector.get(T.ZP),this._measurePerformanceService=this.injector.get(et);const n=this.injector.get(We.oq);this._entityDefaultValuesUrl=n.isSSP?"/ssp/rest/EntitySchemaService/GetEntityDefaultValues":"/rest/EntitySchemaService/GetEntityDefaultValues",this.translateService=this.injector.get(m.TranslateService)}_buildSelectEsq(e,t,n){return this.getSchema().pipe((0,l.switchMap)(s=>this._entitySchemaQueryBuilder.build(s,e,t,n)),(0,l.map)(s=>(this._featureValues["DataSource-DisableRecordDeactivation"]!==!0&&(s.useRecordDeactivation=this.initialConfig.useRecordDeactivation),s.adminUnitRoleSources=this._getEsqAdminUnitRoleSources(),s)))}_getEsqAdminUnitRoleSources(){let e;const t=this.initialConfig.adminUnitRoleSources;return(0,M.isNumber)(t)?t:((0,M.isArray)(t)&&t.forEach(n=>{const s=qc[n];(0,M.isNumber)(s)&&(e=e|s)}),e)}_normalizeValue(e,t){switch(t){case E.r.Lookup:return e||null;case E.r.Date:case E.r.Time:case E.r.DateTime:return e instanceof Date?sh(e):typeof e=="string"&&Date.parse(e)>0?`"${e}"`:e;default:return e}}_buildUpdateEsq(e,t){return this.getSchema().pipe((0,l.switchMap)(n=>this._entitySchemaQueryUtils.convertToEntityDataSourceParameters(n,e,!0)),(0,l.map)(n=>({updateQuery:new Wh(this._entitySchemaName),esqParameters:n})),(0,l.tap)(({updateQuery:n})=>{n.isForceUpdate=!!this.initialConfig.isForceUpdate,Object.keys(t).forEach(s=>{const a=this._findEntitySchemaColumn(s);if(!a)throw new Error(`Column ${s} not found`);const o=t[s];this._isEntityColumnValue(o)&&n.addColumn(a.name,this._normalizeValue(o,a.dataValueType),ru(a.dataValueType))})}),(0,l.switchMap)(({updateQuery:n,esqParameters:s})=>this._entitySchemaQueryUtils.applyParameters(s,n)),(0,l.catchError)(n=>(0,u.throwError)(()=>n)))}_buildInsertEsq(e){const t=new $h(this._entitySchemaName);return Object.keys(e).forEach(n=>{const s=this._findEntitySchemaColumn(n);if(!s)throw new Error(`Column ${n} not found`);const a=e[n];this._isEntityColumnValue(a)&&t.addColumn(s.name,this._normalizeValue(a,s.dataValueType),ru(s.dataValueType))}),t}_buildDeleteEsq(e){return this.getSchema().pipe((0,l.switchMap)(t=>this._entitySchemaQueryUtils.convertToEntityDataSourceParameters(t,e,!0)),(0,l.switchMap)(t=>{const n=new __(this._entitySchemaName);return this._entitySchemaQueryUtils.applyParameters(t,n)}))}_checkOwnAttributes(e){return this.getSchema().pipe((0,l.switchMap)(t=>{const n=t.attributes.filter(s=>s.attributeType!==ye.OwnAttribute).filter(s=>!(0,M.isUndefined)(e[s.name]));return n.length!==0?(0,u.throwError)(()=>new Error(`Not valid attributes for this data source: ${n.map(s=>s.name).join(",")}`)):(0,u.of)(null)}))}_findEntitySchemaColumn(e){return this._entitySchema.columns.find(t=>t.name===e)}_isEntityColumnValue(e){const t=n=>typeof n=="object"&&(n===null||"value"in n);return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="bigint"||e instanceof Date||t(e)}_parseDefaultValues(e,t){const n=new Map(e.attributes.map(s=>[s.name,s.dataValueType]));return t.reduce((s,a)=>{const{defaultValue:o,name:c}=a;if((0,M.isNil)(o.value))return s;if(o.displayValue)return{...s,[c]:o};const d=qh(o.value,n.get(c));return{...s,[c]:d}},{})}_getDefaultValues(e){const t=`${this._entityDefaultValuesUrl}?entityName=${e}`;return this._httpClient.get(t).pipe((0,l.catchError)(n=>this._catchErrorResponse(n)),(0,l.map)(n=>n.GetEntityDefaultValuesResult),(0,l.mergeMap)(n=>this.getSchema().pipe((0,l.tap)(s=>{let a=this._window.defaultValueStorage;const o=n?.find(c=>c.name===s.primaryAttributeName)?.defaultValue?.value;if(a=a||{},o){const c=`${e}_${o}`;a[c]=n,this._window.defaultValueStorage=a}}),(0,l.map)(s=>this._parseDefaultValues(s,n)))))}_catchErrorResponse(e){return console.log(e),(0,u.of)({GetEntityDefaultValuesResult:[]})}_requestEntitySchemaColumnsInfo(e){const t=e.map(n=>n.attributePath);return this._entitySchemaService.getEntitySchemaColumnsInformationByPathsArray(this._entitySchema.uId,t).pipe((0,l.map)(n=>e.map(s=>({column:n[s.attributePath],config:s}))))}_getEntitySchemaForwardReferenceColumnsInfo(e){const t={name:this._entitySchemaName,loadLookupColumns:!1,forwardReferencePaths:e.map(n=>n.attributePath)};return this._entitySchemaRepository.getSchemes([t]).pipe((0,l.map)(()=>e.map(n=>{const s=n.attributePath.split("."),a=this._entitySchemaRepository.findEntitySchemaColumnByPath(this._entitySchemaName,s);return{column:new Xc(a),config:n}})))}_createReferenceAttributes(e,t){return t.length===0?(0,u.of)(e):(0,u.of)(this._featureValues["DataSource-DontUseOneRequestForEntitySchemes"]).pipe((0,l.switchMap)(n=>n?this._requestEntitySchemaColumnsInfo(t):this._getEntitySchemaForwardReferenceColumnsInfo(t))).pipe((0,l.tap)(n=>{n.forEach(({column:s,config:a})=>{a.attributeType===ye.AggregationAttribute&&a.aggregationConfig?.aggregationFunction===Jc.Count&&(s.dataValueType=E.r.Integer),e.addAttribute(s,a)})}),(0,l.map)(()=>e))}_createAttributesFromInitialConfig(e,t={}){const n=[];return Object.entries(t).forEach(([s,a])=>{const o=a;o.type===ye.ForwardReferenceAttribute&&n.push({attributeName:s,attributeType:ye.ForwardReferenceAttribute,attributePath:o.path}),o.type===ye.AggregationAttribute&&n.push({attributeName:s,attributeType:ye.AggregationAttribute,attributePath:o.path,aggregationConfig:o.aggregationConfig}),o.type===ye.FunctionAttribute&&n.push({attributeName:s,attributeType:ye.FunctionAttribute,attributePath:o.path,functionConfig:o.functionConfig})}),this._createReferenceAttributes(e,n).pipe((0,l.catchError)(s=>{const a=s.message&&s.toString(),o=new g_(this,a);return this._errors.push(o),n.forEach(c=>{this._errorReferenceAttributes.push(c)}),(0,u.of)(e)}))}_shouldSkipLoad(e){return e.some(t=>t.type===ce.Never)}_setValidValuesForLookupAttributes(e,t){return Object.keys(t).forEach(n=>{const s=e.attributes.find(a=>a.name===n);s&&(s.dataValueType===E.r.Lookup||s.dataValueType===E.r.IMAGELOOKUP)&&t[n]===""&&(t[n]=null)}),t}_throwErrorResponse(e){const t=typeof e=="string"?e:e?.message;return(0,u.throwError)(()=>({success:!1,rowsAffected:0,errorInfo:t}))}_mapOperationResult(e){return{success:e.success,rowsAffected:e.rowsAffected}}_getIsAffectedAttributeStored(e){return this._affectedAttributes.some(t=>t.path===e.path&&t.schemaName===e.schemaName)}_collectUsedAttributes(e){let t=e._getUsedColumns();t=t.filter(n=>!this._getIsAffectedAttributeStored(n)),this._affectedAttributes.push(...t)}_findErrorReferenceAttribute(e){const t=typeof e=="string"?e:e.name;return this._errorReferenceAttributes.find(n=>n.attributeName===t)}_load(e,t,n,s){if(this.hasErrors){if(this.hasCriticalErrors)return(0,u.throwError)(()=>this.getLastError());if(e.length!==0&&e.every(o=>this._findErrorReferenceAttribute(o)!=null))return(0,u.throwError)(()=>this.getLastError())}return this._shouldSkipLoad(t)?(0,u.of)([]):this._buildSelectEsq(e,t,n||{}).pipe((0,l.tap)(a=>this._collectUsedAttributes(a)),(0,l.switchMap)(a=>{let o;const c={throttled:n?.throttled};return s?(a.queryId=s.id,o=this._queryExecutor.executeSelectQuery(a,c,s.transactionId),s.markAsReady()):o=this._queryExecutor.executeSelectQuery(a,c),o.pipe(this._measurePerformanceService.measure$(`EntityDataSource.load.executeSelectQuery.${this.dataSourceName}`),(0,l.catchError)(()=>(0,u.throwError)(()=>new Error(this.translateService.instant("BaseViewModel.LoadingModelErrorMessage")))))}),(0,l.map)(a=>a),(0,l.mergeMap)(a=>this.getSchema().pipe((0,l.map)(o=>(o.attributes&&a.forEach(c=>{this._setValidValuesForLookupAttributes(o,c)}),a)))))}_save(e,t,n){return this.hasCriticalErrors?(0,u.throwError)(()=>this.getLastError()):this._checkOwnAttributes(t).pipe((0,l.switchMap)(()=>this._buildUpdateEsq(e,t)),(0,l.switchMap)(s=>{if(n){s.queryId=n.id;const a=this._queryExecutor.executeUpdateQuery(s,n.transactionId);return n.markAsReady(),a}return this._queryExecutor.executeUpdateQuery(s)}),(0,l.map)(s=>this._mapOperationResult(s)),(0,l.catchError)(s=>this._throwErrorResponse(s)))}_insert(e,t){return this.hasCriticalErrors?(0,u.throwError)(()=>this.getLastError()):this._checkOwnAttributes(e).pipe((0,l.map)(()=>this._buildInsertEsq(e)),(0,l.switchMap)(n=>{let s;return t?(n.queryId=t.id,s=this._queryExecutor.executeInsertQuery(n,t.transactionId),t.markAsReady()):s=this._queryExecutor.executeInsertQuery(n),(0,u.forkJoin)({response:s,dataSchema:this.getSchema()})}),(0,l.map)(({response:n,dataSchema:s})=>({...this._mapOperationResult(n),primaryAttributes:[{[s.primaryAttributeName]:n.id}]})),(0,l.catchError)(n=>this._throwErrorResponse(n)))}_delete(e,t){return this.hasCriticalErrors?(0,u.throwError)(()=>this.getLastError()):this._buildDeleteEsq(e).pipe((0,l.tap)(n=>{n.queryId=t?.id}),(0,l.switchMap)(n=>{if(t){n.queryId=t.id;const s=this._queryExecutor.executeDeleteQuery(n,t.transactionId);return t.markAsReady(),s}return this._queryExecutor.executeDeleteQuery(n)}),(0,l.map)(n=>this._mapOperationResult(n)),(0,l.catchError)(n=>this._throwErrorResponse(n)))}innerLoad(e,t,n){return this._load(e,t,n)}innerSave(e,t){return this._save(e,t)}innerInsert(e){return this._insert(e)}innerDelete(e){return this._delete(e)}innerGetSchema(){return this.hasCriticalErrors?(0,u.throwError)(()=>this.getLastError()):this.dataSchemaRepository.get(this._entitySchemaName).pipe((0,l.map)(e=>new Jh(e)),(0,l.switchMap)(e=>this._createAttributesFromInitialConfig(e,this.initialConfig.attributes)),(0,l.tap)(e=>{const t=this._getDefaultValues(this._entitySchemaName).pipe((0,l.shareReplay)({bufferSize:1,refCount:!0}));e.setAttributesDefaultValue(t)}),(0,l.map)(e=>e.build()))}innerGetLookupDataSchema(e){if(this.hasCriticalErrors)return(0,u.throwError)(()=>this.getLastError());const n=e.split(".")[0],s=this._findEntitySchemaColumn(n);return s?s.dataValueType!==E.r.Lookup?(0,u.throwError)(()=>new Error(`DataValueType for column '${n}' isn't lookup`)):s.referenceSchemaName?this.dataSchemaRepository.get(s.referenceSchemaName):(0,u.throwError)(()=>new Error(`referenceSchemaName for column '${n}' is absent`)):(0,u.throwError)(()=>new Error(`Can't find column with name '${n}'`))}innerGetDefaultValues(){return this.hasCriticalErrors?(0,u.throwError)(()=>this.getLastError()):this._getDefaultValues(this._entitySchemaName)}innerCanDelete(e){return this.hasCriticalErrors?(0,u.of)({result:!1}):this._rightsService.getCanDelete({schemaName:this.initialConfig.entitySchemaName,primaryColumnValue:e.primaryColumnValue})}innerCanCreate(e){if(this.hasCriticalErrors)return(0,u.of)({result:!1});const t={isNew:!0,schemaName:this.initialConfig.entitySchemaName};return this._rightsService.getCanEdit(t)}innerCanEdit(e){if(this.hasCriticalErrors)return(0,u.of)({result:!1});const t={primaryColumnValue:e.primaryColumnValue,isNew:!1,schemaName:this.initialConfig.entitySchemaName};return this._rightsService.getCanEdit(t)}getEmptySchema(){return this._entitySchemaName?new In({name:this._entitySchemaName}):super.getEmptySchema()}init(e,t){return super.init(e,t).pipe((0,l.mergeMap)(n=>{if(!this.initialConfig.entitySchemaName){const s=new D_(this);return this._errors.push(s),(0,u.throwError)(()=>s)}return(0,u.of)(n)}),(0,l.tap)(()=>this._entitySchemaName=this.initialConfig.entitySchemaName),(0,l.mergeMap)(n=>this._entitySchemaRepository.getSchemaByName(this.initialConfig.entitySchemaName).pipe((0,l.tap)(s=>this._entitySchema=s),(0,l.catchError)(()=>{this._entitySchema=new Gh,this._entitySchema.name=this._entitySchemaName,this._entitySchema.columns=[];const s=new A_(this,this._entitySchemaName);return this._errors.push(s),(0,u.throwError)(()=>s)}),(0,l.map)(()=>n))))}getOwnLoadParameters(){return this.initialConfig?.loadParameters}getAllowCopyingRecords(){return this.initialConfig?.allowCopyingRecords}loadInTransaction(e,t,n,s){return this._load(t,n,s,e)}saveInTransaction(e,t,n){return this._save(t,n,e)}insertInTransaction(e,t){return this._insert(t,e)}deleteInTransaction(e,t){return this._delete(t,e)}}class Z_ extends ba{constructor(e,t){super(e,t),this.dataSourceName=e,this.injector=t,this.type="crt.CopilotActionDataSource",this._intentManager=this.injector.get(Qn)}_getActionUId(e){return e.filter(n=>n.type===ce.PrimaryColumnValue)[0]?.value}innerDelete(e){return(0,u.of)(void 0)}innerInsert(e){const t=e;return(0,u.forkJoin)([this._intentManager.createAction(t),this.getSchema()]).pipe((0,u.map)(([n,s])=>({success:n.success,rowsAffected:1,errorInfo:n.errorInfo?.message,primaryAttributes:n.success?[{[s.primaryAttributeName]:t.Id}]:null})))}innerLoad(e,t,n){const s=this._getActionUId(t);return s?this._intentManager.getActionByUId(s).pipe((0,u.map)(a=>[a])):(0,u.of)([])}innerSave(e,t){const n=this._getActionUId(e),s=t;return s.Id=n,this._intentManager.updateAction(s).pipe((0,u.map)(a=>({success:a.success,rowsAffected:1,errorInfo:a.errorInfo?.message})))}}class Qh{}const Y_="CopilotIntentStatus",K_=new Map([["InDevelopment","4670b068-ad03-4364-9350-6cc61efd1b7f"],["Active","1d73b111-07a9-49e2-aa15-c9415cce7470"],["Deactivated","2c547e71-7a05-42e1-8b65-2bf63f200156"]]),q_="CopilotIntentMode",J_={Chat:"Chat",Api:"API"},Q_=new Map([["Chat","326bba59-302a-4a5e-857c-2576e1a38ab0"],["API","5f2dc095-4543-4972-b6bc-6599bf6bc3fd"]]),Xh={System:{value:"35f3b644-4fa3-4d1e-8e62-5c3fdc4d3e52",displayValue:"System",primaryColorValue:"#22AC14"},Skill:{value:"6d940b75-21c8-4a90-89ab-9867e6e4a045",displayValue:"Skill",primaryColorValue:"#7848EE"},Agent:{value:"a8fbe253-be1b-4ec4-bc58-65b8047013da",displayValue:"Agent",primaryColorValue:"#E67E22"}};function X_(){return(0,u.of)(Object.values(Xh))}class Sa{constructor(e){this._entitySchemaService=e}_loadPrimaryColumns(e){return this._entitySchemaService.getEntitySchemaByName(e).pipe((0,l.map)(t=>{const n=t.entitySchema.getPrimaryColumn(),s=t.entitySchema.getPrimaryDisplayColumn();if((0,M.isEmpty)(s))throw new Error(`Entity ${e} should have primary display column`);return{primaryColumnName:n.name,primaryDisplayColumnName:s?.name}}))}getColumnLookupValues(e){if((0,M.isEmpty)(e))return(0,u.of)(null);const t=this._loadPrimaryColumns(e),n=(0,u.from)(kt.create(e));return(0,u.forkJoin)([t,n]).pipe((0,l.switchMap)(([s,a])=>(0,u.from)(a.load({attributes:[s.primaryColumnName,s.primaryDisplayColumnName]})).pipe((0,l.map)(c=>c.map(d=>({value:d[s.primaryColumnName],displayValue:d[s.primaryDisplayColumnName]}))))))}static{this.\u0275fac=function(t){return new(t||Sa)(i.\u0275\u0275inject(nt))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Sa,factory:Sa.\u0275fac,providedIn:"root"})}}class Ma{constructor(e,t){this._columnLookupValuesService=e,this._injector=t,this._intentStatuses=K_,this._intentModes=Q_}convertToDataSourceModel(e){const t=this._injector.get(Qh);return(0,u.combineLatest)([this._columnLookupValuesService.getColumnLookupValues(Y_),this._columnLookupValuesService.getColumnLookupValues(q_),X_(),t.getAllLlmModels()]).pipe((0,u.map)(([n,s,a])=>{const o=this._intentStatuses.get(e.Status),c=n.find(te=>te.value===o),d=this._intentModes.get(e.Mode)??this._intentModes.get(J_.Chat),p=s.find(te=>te.value===d),C=a.find(te=>te.displayValue===e.Type),I=t.getModelByCodeSync(e.LlmModel),O={Id:e.UId,Code:e.Code,Description:e.Description,Prompt:e.Prompt,Type:C,Name:e.Title,Status:c,PackageUId:e.PackageUId,LlmModel:I?{value:I.Id,displayValue:I.Name}:null};return e.Type==="Agent"?{...O,Restrictions:e.Restrictions,RoleDescription:e.RoleDescription}:{...O,Mode:p}}))}convertToModel(e){const t={};for(const[n,s]of Object.entries(e)){let a=n,o=s;n==="Name"&&(a="Title"),n==="Id"&&(a="UId"),n==="Status"&&(o=[...this._intentStatuses].filter(([,c])=>c===e.Status.value).map(([c])=>c).shift()),n==="Mode"&&(o=[...this._intentModes].filter(([,c])=>c===e.Mode.value).map(([c])=>c).shift()),n==="Type"&&(o=Object.values(Xh).filter(c=>c.value===e.Type.value).map(c=>c.displayValue).shift()),n==="LlmModel"&&(o=this._injector.get(Qh).getModelByNameSync(e.LlmModel?.displayValue)?.Code),t[a]=o}return t}static{this.\u0275fac=function(t){return new(t||Ma)(i.\u0275\u0275inject(Sa),i.\u0275\u0275inject(i.Injector))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Ma,factory:Ma.\u0275fac,providedIn:"root"})}}class ey extends ba{constructor(e,t){super(e,t),this.dataSourceName=e,this.injector=t,this._defaultValuesMap=new Map,this.type="crt.CopilotIntentDataSource",this._intentManager=this.injector.get(Qn),this._copilotIntentDataSourceModelConvertor=this.injector.get(Ma),this._initDefaultValuesMap()}_initDefaultValuesMap(){this._defaultValuesMap.set("CopilotIntent",{UId:(0,le.qv)(),Status:"Active",Mode:"Chat",Type:"Skill",Prompt:this.translateService.instant("CopilotIntentDataSource.DefaultValues.Prompt")}),this._defaultValuesMap.set("CopilotAgent",{UId:(0,le.qv)(),Status:"Active",Type:"Agent"})}innerGetDefaultValues(){const e=this.initialConfig.entitySchemaName,t=this._defaultValuesMap.get(e);return this._copilotIntentDataSourceModelConvertor.convertToDataSourceModel(t)}innerInsert(e){const t=this._copilotIntentDataSourceModelConvertor.convertToModel({...e});return(0,u.forkJoin)([this._intentManager.createIntent(t),this.getSchema()]).pipe((0,u.map)(([n,s])=>({success:n.success,rowsAffected:n.success?1:0,errorInfo:n.errorInfo?.message,primaryAttributes:[{[s.primaryAttributeName]:n.schemaUid}]})),(0,l.switchMap)(n=>n.success?(0,u.of)(n):(0,u.throwError)(()=>n)))}innerLoad(e,t,n){const s=t.filter(a=>a.type===ce.PrimaryColumnValue);if(s.length)return this._intentManager.getIntent(s[0].value).pipe((0,l.switchMap)(a=>this._copilotIntentDataSourceModelConvertor.convertToDataSourceModel(a).pipe((0,u.map)(o=>[o]))))}innerSave(e,t){const s=e.filter(o=>o.type===ce.PrimaryColumnValue)[0].value,a=this._copilotIntentDataSourceModelConvertor.convertToModel({...t});return a.UId=s,this._intentManager.updateIntent(a).pipe((0,u.map)(o=>({success:o.success,rowsAffected:o.success?1:0,errorInfo:o.errorInfo?.message})),(0,l.switchMap)(o=>o.success?(0,u.of)(o):(0,u.throwError)(()=>o)))}}class ty{static fromJson(e){throw new Error("not implemented")}}class ny{static resolve(e){return{[Ie.Compare]:Bt,[Ie.FilterGroup]:pt,[Ie.In]:en,[Ie.IsNull]:tn,[Ie.Exists]:Xn,[Ie.Between]:sa}[e]}}class iy{static fromJson(e,t){throw new Error("not implemented")}}class sy{static resolve(e){return{[Je.Macros]:ei,[Je.Length]:ga,[Je.Window]:fa,[Je.DatePart]:si,[Je.DateAdd]:si,[Je.DateDiff]:si}[e.functionType]}}class ry{static resolve(e,t){return{[Ze.SchemaColumn]:be,[Ze.Parameter]:we,[Ze.SubQuery]:ha,[Ze.ArithmeticOperation]:pa,[Ze.Function]:sy.resolve(t)}[e]}}class au extends iy{static fromJson(e,t){const n=e.expressionType;return ry.resolve(n,e).fromJson(e,t,au)}}class ou extends ty{static fromJson(e){const t=e.filterType,n=e.isEnabled,s=e.trimDateTimeParameterToDate,a=ny.resolve(t).fromJson(e,ou,au);return a.isEnabled=n!==!1,a.trimDateTimeParameterToDate=s===!0,a}}class va{convertToDataSourceModel(e){return(0,u.of)({Id:e.UId,Intent:e.Intent,Code:e.Code,Name:e.Name,Description:e.Description,SourceCollection:e.SourceCollection,DataValueTypeUId:e.DataValueTypeUId})}convertToModel(e){const t={};return Object.entries(e).forEach(([n,s])=>{n==="Id"&&(n="UId"),t[n]=s}),t}static{this.\u0275fac=function(t){return new(t||va)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:va,factory:va.\u0275fac,providedIn:"root"})}}class ay extends ba{constructor(e,t){super(e,t),this.dataSourceName=e,this.injector=t,this.type="crt.CopilotIntentParameterDataSource",this._intentManager=this.injector.get(Qn),this._modelConvertor=this.injector.get(va)}_getPrimaryColumnParameter(e){return e.find(t=>t.type===ce.PrimaryColumnValue&&(0,le.n7)(t.value))}_getIsIntentUIdParameter(e){return(e.relationsConfigs??[]).some(t=>t.dataSchemaName==="CopilotIntent"&&t.attributePath==="Intent")}_getSourceCollectionFilterValue(e){const t=e.find(a=>a.type===ce.Filter);if(!t?.value)return null;const n=ou.fromJson(t.value);let s;return n.filters.forEach(a=>{a instanceof Bt&&a.leftExpression instanceof be&&a.leftExpression.columnPath==="SourceCollection"&&a.rightExpression instanceof we&&(s=a.rightExpression.value)}),s}innerGetDefaultValues(){return this._modelConvertor.convertToDataSourceModel({UId:(0,le.qv)()})}innerInsert(e){const t=this._modelConvertor.convertToModel({...e});return this._intentManager.createIntentParameter(t).pipe((0,u.map)(n=>({success:n.success,rowsAffected:n.success?1:0,errorInfo:n.errorInfo?.message,primaryAttributes:[{Id:t.UId}]})),(0,u.switchMap)(n=>n.success?(0,u.of)(n):(0,u.throwError)(()=>n)))}innerLoad(e,t,n){const s=this._getPrimaryColumnParameter(t),a=this._getSourceCollectionFilterValue(t)??"InputParameters";return s?(this._getIsIntentUIdParameter(s)?this._intentManager.getIntentParameters(s.value,a):this._intentManager.getIntentParameter(s.value).pipe((0,u.map)(c=>[c]))).pipe((0,u.mergeMap)(c=>(0,u.from)(c).pipe((0,u.mergeMap)(d=>this._modelConvertor.convertToDataSourceModel(d)),(0,u.toArray)())),(0,u.catchError)(()=>(0,u.of)([]))):(0,u.of)([])}innerSave(e,t){const n=this._getPrimaryColumnParameter(e)?.value,s=this._modelConvertor.convertToModel({...t});return s.UId=n,this._intentManager.updateIntentParameter(s).pipe((0,u.map)(a=>({success:a.success,rowsAffected:a.success?1:0,errorInfo:a.errorInfo?.message})),(0,u.switchMap)(a=>a.success?(0,u.of)(a):(0,u.throwError)(()=>a)))}innerDelete(e){const t=this._getPrimaryColumnParameter(e)?.value;return this._intentManager.deleteIntentParameter(t).pipe((0,u.map)(n=>({success:n.success,rowsAffected:n.success?1:0,errorInfo:n.errorInfo?.message})),(0,u.switchMap)(n=>n.success?(0,u.of)(n):(0,u.throwError)(()=>n)))}}class oy extends ba{innerDelete(e){return(0,u.of)(null)}innerInsert(e){return(0,u.of)(null)}innerLoad(e,t){return(0,u.of)([])}innerSave(e,t){return(0,u.of)(null)}innerGetLookupDataSchema(e){return(0,u.of)(null)}innerGetDefaultValues(){return(0,u.of)(null)}innerCanDelete(e){return(0,u.of)(null)}innerCanEdit(e){return(0,u.of)(null)}innerCanCreate(e){return(0,u.of)(null)}}var It;(function(r){r.Create="create",r.Update="update",r.Delete="delete"})(It||(It={}));const lu=window;class Ia{constructor(){this._event$=new u.Subject}static get instance(){return lu.__modelEventNotificationService||(lu.__modelEventNotificationService=new Ia),lu.__modelEventNotificationService}get event$(){return this._event$.asObservable()}notify(e){this._event$.next(e)}}class wa{constructor(){this.changedValues$=new u.Subject,this._valuesStore={}}setValues(e){if(e){const t={};Object.entries(e).forEach(([n,s])=>{const a=this._valuesStore[n]!==s;this._valuesStore[n]=(0,M.cloneDeep)(s),a&&(t[n]=this._valuesStore[n])}),(0,M.isEmpty)(t)||this.changedValues$.next(t)}}get values(){return this._valuesStore}static{this.\u0275fac=function(t){return new(t||wa)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:wa,factory:wa.\u0275fac})}}const ep="PrimaryValue",tp="DisplayValue",cu="PrimaryColorValue";class Ea{constructor(e,t){this._queryExecutor=e,this._entitySchemaRepository=t}_getInFilter(e){const t=new ei({macrosType:as.PrimaryColumn});return new en(ge.Equal,t,e.map(n=>new we({value:n})))}_getEsq(e,t){const n=new _a(e);return this._entitySchemaRepository.getSchemaByName(e).pipe((0,l.map)(s=>{n.addMacrosFunctionColumn(as.PrimaryColumn,ep),n.addMacrosFunctionColumn(as.PrimaryDisplayColumn,tp);const a=s.getPrimaryColorColumn();a&&n.addSchemaColumn(a.name,cu);const o=this._getInFilter(t);return n.filters.add(o),n}))}_getSchemaLookupData(e,t){const n={};for(let s=0;s<t.length;s++){const a=t[s],[o,c]=e[s];n[o]={};for(const d of c){const p=a.find(C=>C[ep]===d);if(p){const C=[p[tp]];p[cu]&&C.push(p[cu]),n[o][d]=p?C:null}}}return n}load(e){const t=Object.entries(e);return(0,u.forkJoin)(t.map(([n,s])=>this._getEsq(n,s))).pipe((0,u.switchMap)(n=>this._queryExecutor.executeBatchSelectQuery(n).pipe((0,l.map)(s=>this._getSchemaLookupData(t,s)))))}static{this.\u0275fac=function(t){return new(t||Ea)(i.\u0275\u0275inject(wn),i.\u0275\u0275inject(nn))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Ea,factory:Ea.\u0275fac,providedIn:"root"})}}class ly extends Kc{constructor(e,t){super(e,t),this.dataSourceName=e,this._injector=t,this.type=zh,this._schemaParametersStore=this._injector.get(wa),this._lookupDataLoadService=this._injector.get(Ea),this._featureValues=this._injector.get(fe),this._featureValues.DisableCommunicationBetweenSchemas||this._subscribeParametersChanged()}_subscribeParametersChanged(){this._schemaParametersStore.changedValues$.subscribe(e=>{Ia.instance.notify({modelId:(0,le.qv)(),dataSchemaName:this.dataSchema.name,type:It.Update,payload:{primaryAttributesValues:null,changedAttributes:Object.keys(e)}})})}_getCanSuccessfullyExecuteOperationResult(){return(0,u.of)({result:!0})}_fillLookupValues(e,t,n){Object.entries(n).forEach(([s,[a,o]])=>{(t[s]||[]).forEach(d=>{e[d]=o?{value:s,displayValue:a,primaryColorValue:o}:{value:s,displayValue:a}})})}_fillSchemaParameterValueNameMap(e,t,n,s){const a=s;let o=e[t];o||(o={},e[t]=o);let c=o[a];c||(c=[],o[a]=c),c.push(n)}_fillSchemaNamePrimaryValuesMap(e,t,n){const s=n;let a=e[t];a||(a=[],e[t]=a),a.push(s)}_isLookupValue(e){return!!e?.value}_shouldFillSchemaLookupValueMaps(e,t){return e&&t&&t.referenceSchemaName&&!this._isLookupValue(e)}_load(e,t){const n={},s=this._schemaParametersStore.values,a=t.attributes,o={},c={};for(const p of e){const C=s[p],I=a.find(O=>O.name===p);if(this._shouldFillSchemaLookupValueMaps(C,I)){this._fillSchemaNamePrimaryValuesMap(c,I.referenceSchemaName,C),this._fillSchemaParameterValueNameMap(o,I.referenceSchemaName,p,C);continue}n[p]=C??null}return Object.keys(c).length===0?(0,u.of)([n]):this._lookupDataLoadService.load(c).pipe((0,u.map)(p=>{for(const[C,I]of Object.entries(p)){const O=o[C];this._fillLookupValues(n,O,I)}return[n]}))}_getValuesForStore(e){const t={};return Object.entries(e).forEach(([n,s])=>{const a=this.initialConfig.parameters[n];if(!a)return;jc(a.dataValueTypeName)===E.r.Lookup?t[n]=s?.value:t[n]=s}),t}innerLoad(e,t,n){return this.getSchema().pipe((0,u.switchMap)(s=>this._load(e,s)))}innerSave(e,t){const n=this._getValuesForStore(t);return this._schemaParametersStore.setValues(n),(0,u.of)({success:!0,rowsAffected:1})}innerInsert(e){const t=this._getValuesForStore(e);return this._schemaParametersStore.setValues(t),(0,u.of)({success:!0,rowsAffected:1,primaryAttributes:[]})}innerDelete(e){return(0,u.of)({success:!0,rowsAffected:1})}innerGetSchema(){const e=[],t=this.initialConfig.parameters;return t&&Object.entries(t).forEach(([n,s])=>{const a=new ua({name:n,caption:s.caption,dataValueType:jc(s.dataValueTypeName),attributeType:ye.OwnAttribute,path:n,isRequired:!!s.isRequired,referenceSchemaName:s.referenceSchemaName,isMasked:!1,isFormatValidated:!0});a.addDefaultValidators(),e.push(a)}),(0,u.of)(new In({name:this.initialConfig.schemaName,type:cs.ClientUnit,attributes:e}))}innerGetLookupDataSchema(e){return(0,u.of)(null)}innerGetDefaultValues(){return(0,u.of)({})}innerCanEdit(e){return this._getCanSuccessfullyExecuteOperationResult()}innerCanDelete(e){return this._getCanSuccessfullyExecuteOperationResult()}innerCanCreate(e){return this._getCanSuccessfullyExecuteOperationResult()}}class cy extends Kc{constructor(){super(...arguments),this.type="crt.WebServiceDataSource"}innerLoad(e,t,n){throw new Error("Method not implemented.")}innerSave(e,t){throw new Error("Method not implemented.")}innerInsert(e){throw new Error("Method not implemented.")}innerDelete(e){throw new Error("Method not implemented.")}innerGetSchema(){throw new Error("Method not implemented.")}innerGetLookupDataSchema(e){throw new Error("Method not implemented.")}innerGetDefaultValues(){throw new Error("Method not implemented.")}innerCanDelete(e){throw new Error("Method not implemented.")}innerCanEdit(e){throw new Error("Method not implemented.")}innerCanCreate(e){throw new Error("Method not implemented.")}}class xa{resolve(e){let t=null;switch(e){case Uh:t=ba;break;case zh:t=ly;break;case"crt.WebServiceDataSource":t=cy;break;case"crt.CopilotIntentDataSource":t=ey;break;case"crt.CopilotIntentParameterDataSource":t=ay;break;case"crt.CopilotActionDataSource":t=Z_;break;case"crt.DashboardDataSource":t=oy;break}return(0,u.of)(t)}static{this.\u0275fac=function(t){return new(t||xa)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:xa,factory:xa.\u0275fac})}}class ri{constructor(e,t){this.injector=e,this.resolver=t}create(e,t,n){const{type:s,scope:a,config:o}=t;return this.resolver.resolve(s).pipe((0,l.switchMap)(d=>d?new d(e,n||this.injector).init(o,a):(0,u.throwError)(()=>new Error(`Data source type '${s}' not supported.`))),(0,l.catchError)(d=>d instanceof Yc?(0,u.of)(d.dataSource):(0,u.throwError)(()=>d)))}static{this.\u0275fac=function(t){return new(t||ri)(i.\u0275\u0275inject(i.Injector),i.\u0275\u0275inject(xa))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:ri,factory:ri.\u0275fac})}}class uy{}function np(r,e,t){return!r||!e||!t}function ip(r,e){return`/img/entity/hash/${r}/${e}/`}function uu(r,e="SysImage",t="Data"){if(np(r,e,t))return"";const n=ip(e,t);return`${L()}${n}${r}`}function JS(r,e="SysImage",t="Data"){return np(r,e,t)?"":`${ip(e,t)}${r}`}function dy(r){let e="";if(typeof r=="string"){const n=new TextEncoder().encode(r);e=String.fromCharCode(...n)}else if(r instanceof ArrayBuffer){const t=new Uint8Array(r);for(let n=0;n<t?.byteLength;n++)e+=String.fromCharCode(t[n])}return window.btoa(e)}function QS(r){const e=new DOMParser().parseFromString(r,"text/html"),t=e?.querySelectorAll("svg");return t.length>0&&t.forEach(n=>{const s=e.createElement("img"),a=dy(n.outerHTML);s.src=`data:image/svg+xml;base64,${a}`,n?.parentNode.replaceChild(s,n)}),e?.body.innerHTML||r}class Ve{static _setImageLookupTypeUrl(e,t){const n=e[t],s=n?.value;s&&(n.url=uu(s))}static _setBlobTypeUrl(e,t,n){const s=t[n];if(s){const a=t.Id;t[n]={value:s,url:uu(a,e,n)}}}static _addImageUrl(e,t,n){t.forEach(s=>{switch(s.dataValueType){case E.r.IMAGELOOKUP:{this._setImageLookupTypeUrl(n,s.name);break}case E.r.Image:{this._setBlobTypeUrl(e,n,s.name);break}default:break}})}static serializeRecordPrimaryAttributesValues(e){return e.map(t=>`${t.name}:${t.value}`).join(";")}static getModelPrimaryAttributeValues(e,t){const n=e.getPrimaryAttributesNames();return t.map(s=>n.map(a=>({name:a,value:s[a]})))}static getOwnColumnsValues(e,t){const n=t??{};if(e.attributes.length){const s=e.attributes.filter(a=>a.attributeType===ye.OwnAttribute).map(a=>a.name).filter(a=>!(0,M.isUndefined)(n[a])).map(a=>[a,n[a]]);return Object.fromEntries(s)}else return n}static getPrimaryAttributeValuesFromParameters(e,t){const n=t.filter(s=>s.type===ce.PrimaryColumnValue);return n.length?n.map(s=>({[e.primaryAttributeName]:s.value})):[]}static getPrimaryAttributeValuesFromData(e,t){const n=e.getPrimaryAttributesNames();return n.length?n.filter(s=>t[s]).map(s=>({[s]:t[s]})):[]}static getPrimaryAttributeValues(e,t,n){const s=this.getPrimaryAttributeValuesFromData(e,t);return s.length?s:this.getPrimaryAttributeValuesFromParameters(e,n)}static getDataSourceLoadOptions(e){const t={loadType:e?.loadType||Oe.Load};return e?.pagingConfig&&(t.pagingConfig=e.pagingConfig),e?.sortingConfig&&(t.sortingConfig=e.sortingConfig),e?.isDistinct&&(t.isDistinct=e.isDistinct),t}static getImageAttributes(e,t){const n=[];return(t||[]).forEach(s=>{const a=e.findAttributeByName(s);a?.isImage&&n.push(a)}),n}static processImageData(e,t,n){const s=Ve.getImageAttributes(e,n);return s.length>0&&t.forEach(a=>this._addImageUrl(e.name,s,a)),t}static removeNotRequestedData(e,t){return Object.keys(t).forEach(n=>{e.includes(n)||delete t[n]}),t}static getLoadRequestSignature(e,t,n,s){return JSON.stringify(e)+JSON.stringify(t)+JSON.stringify(n)+JSON.stringify(s)}}class sp extends Error{}const hy={[U.Init]:[U.Create,U.Copy,U.Update,U.Delete],[U.Copy]:[U.Delete,U.Update],[U.Create]:[U.Copy,U.Delete,U.Update],[U.Delete]:[U.Copy,U.Create,U.Update,U.Init],[U.Update]:[U.Delete],[U.Unknown]:[]};function du(r){const e={success:!1,rowsAffected:0,errorInfo:""};return typeof r=="string"?Object.assign(e,{errorInfo:r}):r instanceof Error?Object.assign(e,{errorInfo:r.message}):Object.assign(e,typeof r=="object"?r:{errorInfo:r})}class ds{get _children(){return this._children$.value}static get instance(){return this._instance||(this._instance=new ds(null,null)),this._instance}constructor(e,t){this.injector=e,this.dataSource=t,this._lookupDataSourceName="lookupDataSource",this._id=(0,le.qv)(),this._modeChanges=new u.Subject,this._destroyed$=new u.Subject,this._children$=new u.BehaviorSubject([]),this._childrenDirty$=new u.BehaviorSubject(!1),this._childrenModes$=new u.BehaviorSubject([]),this._isCollectionModel=!1,this._isCollectionItemModel=!1,this._mode=U.Init,this._isInitialized=!1,this._isLoaded=!1,this._dirtyAttributes=new Set,this._newLoadingRequestArrived=new u.Subject,this._attributesMap=[],this._selfDirty$=new u.BehaviorSubject(!1),this._isLoading=!1,this._destroyed=!1,this._doNotAllowCancelRequest=!1,this._dirty$=(0,u.combineLatest)([this._selfDirty$,this._childrenDirty$,this._childrenModes$]).pipe((0,l.map)(([n,s,a])=>n||s||a.includes(U.Copy)||a.includes(U.Create)),(0,l.distinctUntilChanged)()),this._loadedData=new Set,this.injector&&(this._dataSourceFactory=this.injector.get(ri),this._lifecycleHookNotificationService=this.injector.get(uy,null,{optional:!0}),this._measurePerformanceService=this.injector.get(et,null,{optional:!0}),this._doNotAllowCancelRequest=this.injector.get(fe,null,{optional:!0})?.DoNotAllowCancelRequest)}static create(e){return(0,u.from)(this.instance._create({type:"crt.EntityDataSource",config:{entitySchemaName:e}},""))}get name(){return this.dataSource?this.dataSource.dataSourceName:""}get mode(){return this._isCollectionModel?U.Unknown:this._mode}get _modeChanges$(){return this._modeChanges.asObservable()}get _isChanged(){return!!this._dirtyAttributes?.size}set _isCollection(e){this._isCollectionModel=e,this._isCollectionModel&&(this._mode=U.Unknown)}get isLoaded(){return this._isLoaded}get event$(){return Ia.instance.event$.pipe((0,l.filter)(()=>this._isInitialized),(0,l.filter)(()=>!this._isCollectionItemModel),(0,l.filter)(({dataSchemaName:e})=>e===this._dataSchemaName),(0,l.tap)(({type:e,modelId:t,payload:n})=>this._updateLoadedData(e,t,n)),(0,l.filter)(({modelId:e})=>e!==this._id&&!this._isChild(e)),(0,l.map)(e=>({event:e,ownPrimaryAttributesValues:e.payload?.primaryAttributesValues?.filter(t=>{const n=Ve.serializeRecordPrimaryAttributesValues(t);return this._loadedData.has(n)})})),(0,l.filter)(({event:e,ownPrimaryAttributesValues:t})=>e.type===It.Update||e.type===It.Delete?!t||t.length!==0:!0),(0,l.map)(({event:e,ownPrimaryAttributesValues:t})=>({event:e,primaryAttributesValues:e.type===It.Create?e.payload.primaryAttributesValues:t})),(0,l.map)(({event:e,primaryAttributesValues:t})=>({modelId:e.modelId,dataSchemaName:e.dataSchemaName,type:e.type,payload:{...e.payload,primaryAttributesValues:t}})),(0,l.takeUntil)(this._destroyed$))}get dataSchemaName(){return this._dataSchemaName}get allowSync(){return!this._disableSync}get disableSync(){return this._disableSync}set disableSync(e){this._disableSync=e}get isLoading(){return this._isLoading}get hasErrors(){return this.dataSource?this.dataSource.hasErrors:!0}get hasCriticalErrors(){return this.dataSource?this.dataSource.hasCriticalErrors:!0}get affectedAttributes(){return this.dataSource?this.dataSource.affectedAttributes:[]}get isAggregate(){return this.dataSource?this.dataSource.isAggregate:!1}get supportsTransactions(){return!1}get isCollectionItemModel(){return this._isCollectionItemModel}get isInitialized(){return this._isInitialized}_isChild(e){return this._children.some(t=>t?._id===e)}_subscribeChildrenModeChanges(){this._children$.pipe((0,l.map)(e=>e.map(t=>(0,u.merge)((0,u.of)(t.mode),t._modeChanges$))),(0,l.switchMap)(e=>e?.length?(0,u.combineLatest)(e):(0,u.of)([])),(0,l.tap)(e=>this._childrenModes$.next(e)),(0,l.takeUntil)(this._destroyed$)).subscribe()}_subscribeChildrenDirtyChanges(){this._children$.pipe((0,l.map)(e=>e.map(t=>t._dirty$)),(0,l.switchMap)(e=>e?.length?(0,u.combineLatest)(e):(0,u.of)([])),(0,l.map)(e=>e.some(t=>t)),(0,l.tap)(e=>this._childrenDirty$.next(e)),(0,l.takeUntil)(this._destroyed$)).subscribe()}_updateLoadedData(e,t,n){this._isCollectionModel&&e===It.Create&&this._isChild(t)&&n.primaryAttributesValues.forEach(s=>{const a=Ve.serializeRecordPrimaryAttributesValues(s);this._loadedData.add(a)})}_setMode(e){if(this._mode===e)return;if(!hy[this._mode]?.includes(e))throw Error(`Unable to mark model with '${this._mode}' mode for '${e}'.`);const n=this._mode;this._mode=e,e===U.Delete&&this._selfDirty$.next(n!==U.Create)}_markForNotCollection(e){this._isCollectionModel||this.markFor(e)}_registerPrimaryAttributeValues(e){e.forEach(t=>{this._loadedData.add(Ve.serializeRecordPrimaryAttributesValues(t))})}_getDependentAttributesNames(e){return this._attributesMap.filter(t=>e.includes(t.name)).filter(t=>t.dependentAttributes.length!==0).map(t=>t.dependentAttributes).flat()}_getDefaultLoadAttributes(){return this.getSchema().pipe((0,l.map)(e=>e.getPrimaryLoadAttributes()))}_checkAttributesInDataSchema(e){return this.getSchema().pipe((0,l.tap)(t=>{const n=e.filter(s=>t.findAttributeByName(s)==null);if(n.length>0)throw new Error(`data has unknown attributes names: ${n.join(", ")}`)}))}_createDataSource(e,t,n=null){const s=n??t.dataSourceConfig;return this._dataSourceFactory.create(e,s)}_notifyEventByParameters(e,t){return this.getSchema().pipe((0,l.map)(n=>Ve.getPrimaryAttributeValuesFromParameters(n,e)),(0,l.mergeMap)(n=>this._notifyDataChange(n,t)))}_notifyDataChange(e,t){return this.getSchema().pipe((0,l.map)(n=>Ve.getModelPrimaryAttributeValues(n,e)),(0,l.tap)(n=>{Ia.instance.notify({modelId:this._id,dataSchemaName:this._dataSchemaName,type:t,payload:{primaryAttributesValues:n}})}),(0,l.map)(()=>null))}_mapSaveResult(e,t,n){return this.getSchema().pipe((0,l.map)(s=>({result:e,actionType:It.Update,data:Ve.getPrimaryAttributeValues(s,t,n)})))}_mapInsertResult(e){return{data:e.primaryAttributes??[],result:e,actionType:It.Create}}_getLoadAttributes(e){if(e&&e.length!==0){let t=null;if(e.every(s=>(0,M.isString)(s)))return t=this._getDependentAttributesNames(e),(0,u.of)([...e,...t]);{const s=e.map(a=>a.name);return t=this._getDependentAttributesNames(s),this.getSchema().pipe((0,l.map)(a=>(t=t.map(o=>a.findAttributeByName(o)).map(o=>({name:o.name,path:o.path,caption:o.caption,dataValueType:o.dataValueType,aggregationConfig:o.aggregationConfig})),[...e,...t])))}}return this._getDefaultLoadAttributes()}_getChangedAttributesValues(e){return this._persistedState?Object.entries({...this._persistedState,...e}).filter(([t])=>this._dirtyAttributes.has(t)).reduce((t,[n,s])=>Object.assign(t,{[n]:s}),{}):e}_load(e,t,n,s,a=U.Update){const o={attributes:t,parameters:n,options:s,mode:a},c=(0,M.cloneDeep)(this._lastRequestPayload),d=(0,M.isEqual)((0,M.omit)(o,"options.loadType"),(0,M.omit)(c,"options.loadType"));return this._loadingRequest&&d?this._loadingRequest:(this._lastRequestPayload&&!d&&(this._newLoadingRequestArrived.next(null),this._newLoadingRequestArrived=new u.Subject),this._lastRequestPayload=o,this._loadingRequest=this._getLoadAttributes(t).pipe((0,T.pR)(()=>this._onBeforeLoad(o,c)),(0,l.switchMap)(p=>e(p,n,s)),(0,l.raceWith)(this._newLoadingRequestArrived.pipe((0,l.switchMap)(()=>(0,u.throwError)(()=>new sp)))),(0,l.tap)(()=>this._markForNotCollection(a)),(0,T.BB)(()=>this.getSchema()),(0,l.tap)(([p,C])=>{this._registerPrimaryAttributeValues(Ve.getModelPrimaryAttributeValues(C,p))}),(0,l.tap)(()=>this._persistedState={}),(0,l.map)(([p,C])=>Ve.processImageData(C,p,t)),(0,l.tap)(()=>this._isLoaded=!0),(0,T.pR)(()=>this._onAfterLoad(o,c)),(0,l.catchError)(p=>(this._isLoaded=!1,(0,u.throwError)(()=>p))),(0,l.tap)(()=>{this._dirtyAttributes.size===0&&this._markAsPristine(),this._loadingRequest=null}),(0,l.share)()),(0,u.iif)(()=>!this._doNotAllowCancelRequest,this._loadingRequest.pipe((0,l.takeUntil)(this._destroyed$)),this._loadingRequest))}_updateAttributesDependencies(){this._attributesMap.forEach(t=>t.dependentAttributes=[]),this._attributesMap.filter(t=>t.attributeType!==ye.OwnAttribute).forEach(t=>{const n=t.path.split(".");if(n.length===1)return;const s=n.shift(),a=this._attributesMap.find(o=>o.path===s);a?.dependentAttributes.push(t.name)})}_buildAttributesMap(e){const t=e.attributes??[];this._attributesMap=t.map(n=>({name:n.name,path:n.path,attributeType:n.attributeType,dependentAttributes:[],isSchemaAttribute:!0})),this._updateAttributesDependencies()}_loadDependentDataForCreate(e){return this.getSchema().pipe((0,l.map)(t=>t.attributes.filter(n=>n.dataValueType===E.r.Lookup).filter(n=>n.name in e).map(n=>n.name)),(0,l.switchMap)(t=>{if(t.length===0)return(0,u.of)([]);const n=t.map(s=>this.reloadDependentData(s,e[s]));return(0,u.forkJoin)(n)}),(0,l.map)(t=>{let n={};return t.forEach(s=>{n={...n,...s[0]||{}}}),{...n,...e}}))}_getDependentAttributesInfo(e){return this.getSchema().pipe((0,l.map)(t=>e.map(n=>{const s=t.findAttributeByName(n),a=s?.path??n,o=s?.name??n,c=s?.aggregationConfig??null,d=s?.dataValueType??null,p=s?.attributeType??null,C=a.split(".");C.shift();const I=C.length===1?C[0]:o;let O;return p===ye.AggregationAttribute?O=ye.AggregationAttribute:O=C.length===1?ye.OwnAttribute:ye.ForwardReferenceAttribute,{alias:I,attributeName:o,config:{path:C.join("."),aggregationConfig:c,dataValueType:d,type:O},type:O}})))}_markAsPristine(){this._selfDirty$.next(!1)}_onBeforeLoad(e,t){return this._lifecycleHookNotificationService?.onBeforeLoad?(0,u.from)(this._lifecycleHookNotificationService.onBeforeLoad({model:this,payload:{attributes:e?.attributes,options:e?.options,parameters:e?.parameters},previousPayload:{attributes:t?.attributes,options:t?.options,parameters:t?.parameters}})).pipe((0,l.map)(n=>{if(n===!1)throw Error('Loading is disallowed by a "OnBeforeLoad" model lifecycle event')})):(0,u.of)(void 0)}_onAfterLoad(e,t){return this._lifecycleHookNotificationService?.onAfterLoad?(0,u.from)(this._lifecycleHookNotificationService.onAfterLoad({model:this,payload:{attributes:e?.attributes,options:e?.options,parameters:e?.parameters},previousPayload:{attributes:t?.attributes,options:t?.options,parameters:t?.parameters}})):(0,u.of)(void 0)}_onBeforeInsert(e){return this._lifecycleHookNotificationService?.onBeforeInsert?this.getSchema().pipe((0,l.map)(t=>Ve.getModelPrimaryAttributeValues(t,[e])),(0,l.map)(t=>t.pop()),(0,l.switchMap)(t=>this._lifecycleHookNotificationService.onBeforeInsert({model:this,payload:{data:e,primaryAttributesValues:t}})),(0,l.map)(t=>{if(t===!1)throw Error('Inserting is disallowed by a "OnBeforeInsert" model lifecycle event')})):(0,u.of)(void 0)}_insert(e,t){return t(e).pipe((0,l.map)(n=>this._mapInsertResult(n)),(0,l.tap)(()=>this._persistedState={}),(0,l.tap)(()=>this._markAsPristine()),(0,l.tap)(()=>this._markForNotCollection(U.Update)),(0,T.BB)(()=>this.getSchema()),(0,l.tap)(([,n])=>{this._registerPrimaryAttributeValues(Ve.getModelPrimaryAttributeValues(n,[e]))}),(0,l.map)(([n])=>n),(0,T.hk)(({data:n,actionType:s})=>this._notifyDataChange(n,s)),(0,l.map)(({result:n})=>n))}_onAfterInsert(e){return this._lifecycleHookNotificationService?.onAfterInsert?(0,u.from)(this._lifecycleHookNotificationService.onAfterInsert({model:this,payload:{data:e}})):(0,u.of)(void 0)}_onBeforeUpdate(e,t){return this._lifecycleHookNotificationService?.onBeforeUpdate?(0,u.from)(this._lifecycleHookNotificationService.onBeforeUpdate({model:this,payload:{data:e,parameters:t}})).pipe((0,l.map)(n=>{if(n===!1)throw Error('Updating is disallowed by a "OnBeforeUpdate" model lifecycle event')})):(0,u.of)(void 0)}_update(e,t,n){return n(t,e).pipe((0,l.mergeMap)(s=>this._mapSaveResult(s,e,t)),(0,T.hk)(()=>this._notifyEventByParameters(t,It.Update)),(0,l.map)(({result:s})=>s),(0,l.tap)(()=>this.setLoadedState()))}_onAfterUpdate(e,t){return this._lifecycleHookNotificationService?.onAfterUpdate?(0,u.from)(this._lifecycleHookNotificationService.onAfterUpdate({model:this,payload:{data:e,parameters:t}})):(0,u.of)(void 0)}_onBeforeDelete(e){return this._lifecycleHookNotificationService?.onBeforeDelete?(0,u.from)(this._lifecycleHookNotificationService.onBeforeDelete({model:this,payload:{parameters:e}})).pipe((0,l.map)(t=>{if(t===!1)throw Error('Deleting is disallowed by a "OnBeforeDelete" model lifecycle event')})):(0,u.of)(void 0)}_delete(e,t){return t(e).pipe((0,l.tap)(()=>this._markAsPristine()),(0,l.tap)(()=>this._markForNotCollection(U.Init)),(0,T.hk)(()=>this._notifyEventByParameters(e,It.Delete)))}_onAfterDelete(e){return this._lifecycleHookNotificationService?.onAfterDelete?(0,u.from)(this._lifecycleHookNotificationService.onAfterDelete({model:this,payload:{parameters:e}})):(0,u.of)(void 0)}innerInsert(e,t){const s=this.getSchema().pipe((0,l.map)(a=>({dataSchema:a,data:{...this._persistedState??{},...t}})),(0,l.map)(({data:a,dataSchema:o})=>Ve.getOwnColumnsValues(o,a))).pipe((0,T.pR)(a=>this._onBeforeInsert(a)),(0,T.DH)(a=>this._insert(a,e)),(0,T.pR)(([a])=>this._onAfterInsert(a)),(0,l.map)(([,a])=>a),(0,l.tap)(()=>{this._isLoaded=!0}),(0,l.catchError)(a=>(0,u.of)(du(a))));return(0,u.iif)(()=>!this._doNotAllowCancelRequest,s.pipe((0,l.takeUntil)(this._destroyed$)),s)}innerUpdate(e,t,n){const a=this.getSchema().pipe((0,l.map)(o=>Ve.getOwnColumnsValues(o,t)),(0,l.map)(o=>this._getChangedAttributesValues(o))).pipe((0,T.pR)(o=>this._onBeforeUpdate(o,n)),(0,T.DH)(o=>this._update(o,n,e)),(0,T.pR)(([o])=>this._onAfterUpdate(o,n)),(0,l.map)(([,o])=>o),(0,l.catchError)(o=>(0,u.of)(du(o))));return(0,u.iif)(()=>!this._doNotAllowCancelRequest,a.pipe((0,l.takeUntil)(this._destroyed$)),a)}innerDelete(e,t){return this._onBeforeDelete(t).pipe((0,l.switchMap)(()=>this._delete(t,e)),(0,T.pR)(()=>this._onAfterDelete(t)),(0,l.catchError)(n=>(0,u.of)(du(n))))}innerLoad(e,t){if(this._destroyed)return(0,u.of)([]);this._isLoading=!0;const n=t?.attributes,s=t?.parameters||[],a=Ve.getDataSourceLoadOptions(t?.options),o=this._load(e,n,s,a).pipe((0,l.tap)(()=>this._isLoading=!1),(0,l.catchError)(c=>(this._isLoading=!1,(0,u.throwError)(()=>c))));return(0,u.iif)(()=>!this._doNotAllowCancelRequest,o.pipe((0,l.takeUntil)(this._destroyed$)),o)}createChildModel(){return new ds(this.injector,this.dataSource)}init(){return this.getSchema().pipe((0,l.tap)(e=>this._dataSchemaName=e.name),(0,l.tap)(e=>this._buildAttributesMap(e)),(0,l.map)(()=>this),(0,l.tap)(()=>this._isInitialized=!this.hasCriticalErrors),(0,l.tap)(()=>{this._subscribeChildrenModeChanges(),this._subscribeChildrenDirtyChanges()}),(0,l.take)(1))}getSchema(){if(!this.dataSource)return(0,u.of)(null);if(this.hasCriticalErrors)return(0,u.of)(this.dataSource.getEmptySchema());const e=this.dataSource.getSchema();return this._measurePerformanceService?e.pipe(this._measurePerformanceService.measure$(`model.getSchema.${this.name}`)):e}getDataSource(){return this.dataSource}load(e){return this.innerLoad((t,n,s)=>this.dataSource.load(t,n,s),e)}updateDependentAttributes(e){this._attributesMap=this._attributesMap.filter(s=>s.isSchemaAttribute);const t=this._attributesMap.map(s=>s.name),n=e.filter(s=>!t.includes(s.path)).map(s=>({name:s.path,path:s.path,attributeType:s.type??ye.ForwardReferenceAttribute,dependentAttributes:[],isSchemaAttribute:!1}));this._attributesMap.push(...n),this._updateAttributesDependencies()}canReloadDependentData(e){return this._getDependentAttributesNames([e]).length!==0}getDependentAttributesNames(e){return this._getDependentAttributesNames([e])}reloadDependentData(e,t){const n=this._getDependentAttributesNames([e]);if(n.length===0)return(0,u.of)([]);if(t==null)return(0,u.of)([Object.fromEntries(n.map(o=>[o,null]))]);const s=[{type:ce.PrimaryColumnValue,value:t}],a=[];return(0,u.forkJoin)([this._getDependentAttributesInfo(n),this.dataSource.getLookupDataSchema(e)]).pipe((0,l.switchMap)(([o,c])=>{const d=o.filter(C=>C.type!==ye.OwnAttribute).map(C=>[C.alias,C.config]),p={type:c.dataSourceConfig.type,config:{...c.dataSourceConfig.config,attributes:Object.fromEntries(d)}};return o.forEach(C=>{a.push({ownAttributeName:C.attributeName,alias:C.alias})}),this._createDataSource(`${this.name}_reloadData`,c,p)}),(0,l.switchMap)(o=>o.load([...new Set(a.map(c=>c.alias))],s,{throttled:!0})),(0,l.map)(o=>o.map(c=>{const d={};return a.forEach(p=>{d[p.ownAttributeName]=c[p.alias]}),d})))}create(e={}){return this._isLoading=!0,this.getSchema().pipe((0,l.map)(t=>Ve.getOwnColumnsValues(t,e)),(0,l.switchMap)(t=>(0,u.forkJoin)([(0,u.of)(t),this.dataSource.getDefaultValues()])),(0,l.tap)(()=>this._markForNotCollection(U.Create)),(0,l.map)(([t,n])=>(this._persistedState={...n,...t},this._persistedState)),(0,l.switchMap)(t=>this._loadDependentDataForCreate(t)),(0,l.tap)(()=>this._isLoading=!1))}copy(e,t={}){return this._isLoading=!0,this.getSchema().pipe((0,l.map)(n=>({schema:n,attributes:n.attributes.filter(s=>s.attributeType===ye.OwnAttribute&&s.isValueCloneable).map(s=>s.name),parameters:typeof e=="string"?[{type:ce.PrimaryColumnValue,value:e}]:n.getPrimaryAttributesNames().filter(s=>e[s]).map(s=>({type:ce.PrimaryColumnValue,value:{[s]:e[s]}}))})),(0,l.mergeMap)(({schema:n,attributes:s,parameters:a})=>this._load((o,c,d)=>this.dataSource.load(o,c,d),s,a,{},U.Copy).pipe((0,l.tap)(()=>{this._isLoaded=!1}),(0,l.tap)(o=>{if(o.length>1)throw new Error("More than one record loaded for copy");if(o.length===0)throw new Error("No records loaded for copy")}),(0,l.map)(o=>Ve.removeNotRequestedData(s,{...o[0]})),(0,l.map)(o=>{n.getPrimaryAttributesNames().forEach(d=>delete o[d]);const c=Ve.getOwnColumnsValues(n,t);return{...o,...c}}),(0,l.switchMap)(o=>this.dataSource.getDefaultValues().pipe((0,l.map)(c=>({...c,...o})))),(0,l.tap)(o=>{this._persistedState={...o}}),(0,l.switchMap)(o=>this._loadDependentDataForCreate(o)),(0,l.tap)(()=>{this._isLoaded=!0,this._isLoading=!1}),(0,l.catchError)(o=>(this._isLoading=!1,this._markForNotCollection(U.Update),(0,u.throwError)(()=>new Error(o)))))))}insert(e){return this.innerInsert(t=>this.dataSource.insert(t),e)}update(e,t){return this.innerUpdate((n,s)=>this.dataSource.save(n,s),e,t)}insertOrUpdate(e,t){return this._mode===U.Update?this.update(e,t):this.insert(e)}delete(e){return this.innerDelete(t=>this.dataSource.delete(t),e)}setValue(e){const t=Object.keys(e);return this._checkAttributesInDataSchema(t).pipe((0,l.tap)(()=>{t.length>0&&(this._dirtyAttributes=new Set([...this._dirtyAttributes,...t]),this._persistedState={...this._persistedState??{},...e})}),(0,l.map)(()=>null))}_getPersistedState(){return{...this._persistedState??{}}}markFor(e){this.mode!==e&&(this._setMode(e),this._modeChanges.next(e))}resetMode(){this._mode!==U.Init&&(this._mode=U.Init,this._modeChanges.next(this._mode))}loadLookupList(e,t,n={}){if(!this.dataSource)throw Error("DataSource is null");const s=this.dataSource.getLookupDataSchema(e).pipe((0,l.switchMap)(a=>{const o=a.getPrimaryLoadAttributes();return this._createDataSource(this._lookupDataSourceName,a).pipe((0,l.switchMap)(c=>c.load(o,t,n)),(0,l.map)(c=>({primaryAttributeName:a.primaryAttributeName,primaryDisplayAttributeName:a.primaryDisplayAttributeName,data:c})))}));return(0,u.iif)(()=>!this._doNotAllowCancelRequest,s.pipe((0,l.takeUntil)(this._destroyed$)),s)}canDelete(e){return(0,u.lastValueFrom)(this.dataSource.canDelete(e),{defaultValue:null})}canSave(e){switch(this._mode){case U.Init:return Promise.resolve({result:!1});case U.Create:case U.Copy:return(0,u.lastValueFrom)(this.dataSource.canCreate(e),{defaultValue:null});case U.Update:return(0,u.lastValueFrom)(this.dataSource.canEdit(e),{defaultValue:null});case U.Delete:return this.canDelete(e);default:throw Error(`Unable to verify the possibility of operation executing: the '${this._mode}' is not supported.`)}}attributeChanged(e,t){t||this._selfDirty$.next(!0),this._dirtyAttributes.add(e)}setLoadedState(e=null){if(this._isCollectionModel||!e){this._dirtyAttributes.clear(),this._markAsPristine();return}e.forEach(t=>this._dirtyAttributes.delete(t)),this._dirtyAttributes.size||this._markAsPristine()}createCollectionItemModel(e){const t=this.createChildModel();return t._isCollectionItemModel=!0,t._isLoaded=!0,t._isInitialized=!0,t._persistedState={},t._dataSchemaName=this._dataSchemaName,t._attributesMap=this._attributesMap,e!=null&&(t._setMode(e),t._selfDirty$.next(!1)),this._children.push(t),t}childrenChange(){this._children$.next(this._children)}removeChild(e){const t=e?._id,n=this._children.findIndex(s=>s?._id===t);n!==-1&&this._children.splice(n,1)}_getAsyncResult(e){return(0,u.firstValueFrom)(e)}getLastError(){return this.dataSource?this.dataSource.getLastError():new Error("DataSource is null")}destroy(){this._isInitialized=!1,this._destroyed$.next(),this._destroyed$.complete(),this._selfDirty$.complete(),this._children$.complete(),this._childrenDirty$.complete(),this._childrenModes$.complete(),this._destroyed=!0}getOwnLoadParameters(){return this.dataSource.getOwnLoadParameters()}getAllowCopyingRecords(){return this.dataSource.getAllowCopyingRecords()}}(0,y.__decorate)([Lt({requestType:"crt.ModelGenerator",methodName:"generateOne"}),(0,y.__metadata)("design:type",Function)],ds.prototype,"_create",void 0);class py{}class hu extends ds{get supportsTransactions(){return this.dataSource?this.dataSource.supportTransactions:!1}createChildModel(){return new hu(this.injector,this.dataSource)}loadInTransaction(e,t){return e.createOperation(n=>(0,u.firstValueFrom)(this.innerLoad((s,a,o)=>this.dataSource.loadInTransaction(n,s,a,o),t)))}insertInTransaction(e,t){return e.createOperation(n=>(0,u.firstValueFrom)(this.innerInsert(s=>this.dataSource.insertInTransaction(n,s),t)))}updateInTransaction(e,t,n){return e.createOperation(s=>(0,u.firstValueFrom)(this.innerUpdate((a,o)=>this.dataSource.saveInTransaction(s,a,o),t,n)))}insertOrUpdateInTransaction(e,t,n){return this.mode===U.Update?this.updateInTransaction(e,t,n):this.insertInTransaction(e,t)}deleteInTransaction(e,t){return e.createOperation(n=>(0,u.firstValueFrom)(this.innerDelete(s=>this.dataSource.deleteInTransaction(n,s),t)))}}let pu=class Wl{constructor(e,t,n,s){this.dataSourceFactory=e,this.entitySchemaRepository=t,this._featureValues=n,this._injector=s}get _transactionsEnabled(){return this._featureValues["DataSource-DisableTransactions"]!==!0}_createModel(e=null,t=!1,n){const s=e.supportTransactions&&this._transactionsEnabled?new hu(n||this._injector,e):new ds(n||this._injector,e);return s.disableSync=t,s.init()}_validateModelConfig(e){if(e.primaryDataSourceName&&!e.dataSources[e.primaryDataSourceName])throw new Error(`Data source "${e.primaryDataSourceName}" cannot be primary data source. Data source "${e.primaryDataSourceName}" not found in model config.`);if(e.primaryDataSourceName&&e.dataSources[e.primaryDataSourceName]?.scope===Vt.ViewElement)throw new Error(`Data source "${e.primaryDataSourceName}" with scope "viewElement" cannot be primary. Only data sources with scope "page" can be primary`)}_getEntitySchemesRequest(e){return e.map(([,t])=>t).filter(t=>t.type==="crt.EntityDataSource").map(t=>t.config).filter(t=>!!t.entitySchemaName).map(t=>{let n=[];return t.attributes&&(n=Object.entries(t.attributes).filter(([,s])=>s.type===ye.ForwardReferenceAttribute).map(([,s])=>s.path)),{name:t.entitySchemaName,loadLookupColumns:!0,forwardReferencePaths:n}})}_generateFromConfig(e,t){let n,s;const a=t?.get(et,null,{optional:!0});return a?(n=Object.entries(e?.dataSources||{}).filter(([o,c])=>c.type?!0:(console.warn(`Data source ${o} without type not supported.`),!1)),n.length===0?(0,u.of)([]):(this._validateModelConfig(e),s=n.map(([o,c])=>this.generateOne(c,o,t)),this.preInitializeDataSources(n).pipe(a.measure$("modelGenerator.generateFromConfig"),(0,u.switchMap)(()=>(0,u.forkJoin)(s))))):(n=Object.entries(e?.dataSources||{}).filter(([o,c])=>c.type?!0:(console.warn(`Data source ${o} without type not supported.`),!1)),n.length===0?(0,u.of)([]):(this._validateModelConfig(e),s=n.map(([o,c])=>this.generateOne(c,o,t)),this.preInitializeDataSources(n).pipe((0,u.switchMap)(()=>(0,u.forkJoin)(s)))))}preInitializeDataSources(e){if(this._featureValues["DataSource-DontUseOneRequestForEntitySchemes"])return(0,u.of)(null);const t=this._getEntitySchemesRequest(e);return this.entitySchemaRepository.getSchemes(t).pipe((0,l.catchError)(n=>(0,u.of)([])),(0,l.map)(n=>null))}generate(e,t){return this._generateFromConfig(e,t)}generateOne(e,t,n){const s=n?.get(et,null,{optional:!0});return s?this.dataSourceFactory.create(t,e,n).pipe(s.measure$(`modelGenerator.generateOne.${t}`),(0,l.mergeMap)(a=>this._createModel(a,e.disableSync,n))):this.dataSourceFactory.create(t,e,n).pipe((0,l.mergeMap)(a=>this._createModel(a,e.disableSync,n)))}static{this.\u0275fac=function(t){return new(t||Wl)(i.\u0275\u0275inject(ri),i.\u0275\u0275inject(nn),i.\u0275\u0275inject(fe),i.\u0275\u0275inject(i.Injector))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Wl,factory:Wl.\u0275fac})}};pu=(0,y.__decorate)([(0,T.op)({requestType:"crt.ModelGenerator"}),(0,y.__metadata)("design:paramtypes",[ri,nn,py,i.Injector])],pu);class Ta{constructor(e,t,n){this._sysSettingsService=e,this._dataSchemaRepository=t,this._featureValues=n,this._searchComparisonTypeSysSettingCode="StringColumnSearchComparisonType"}_getParameterValue(e,t,n){if(typeof t=="string"){if(t.startsWith("@requestPayload")){const s=t.replace("@requestPayload.","");return(0,M.get)(n,s)}if(t.startsWith("$"))return e.attributes[t.substring(1)];if(e.attributes[t])return e.attributes[t]}return t}_applyFilterMacros(e,t){let n=null;switch(typeof t){case"object":n=JSON.stringify((0,Ee.classToPlain)(t));break;case"string":n=t;break;default:return t}const s=/##ViewModelMacro\.\$([^#]+)##/g;let a=!1;return[...n.matchAll(s)].forEach(o=>{const c=o[1],d=(0,M.get)(e.attributes,c);let p=d?.toString();typeof d=="object"&&(a=!0,p=JSON.stringify(d)),n=n.replace(o[0],p)}),typeof t=="object"||a?JSON.parse(n):n}_createPrimaryDisplayColumnValueFilter(e){var t=this;return(0,f.A)(function*(){const n=t._searchComparisonTypeSysSettingCode,a=(yield t._sysSettingsService.getByCode(n))?.value===1?ge.Contain:ge.Start_with;return{type:ce.PrimaryDisplayValueFilter,value:e,comparisonType:a}})()}_createColumnValueFilter(e,t,n){const s=t;return Promise.resolve({type:ce.ColumnValue,value:{attributePath:s.attributePath,attributeValue:this._getParameterValue(e,s.attributeValue,n)}})}_getOwnLoadParameters(e,t){return e.getModelByName(t)?.getOwnLoadParameters()}_getDataSourceFilteringParameters(e,t){const s=e._dataSourcesInfos.get(t).getFilteringConfig();return e._checkFilteringAttributes(t,s),s.length===0?Promise.resolve([]):Promise.all(s.map(a=>e[a.name])).then(a=>a.map(o=>({type:ce.Filter,value:o})))}_getDataSourceOwnFilteringParameters(e,t){return this._getOwnLoadParameters(e,t)?.parameters??[]}_getPrimaryAttributeName(e,t){var n=this;return(0,f.A)(function*(){if(!t)return null;let s=Object.values(e.dataSchemas).find(a=>a.name===t);return s||(s=yield(0,u.lastValueFrom)(n._dataSchemaRepository.get(t))),s?.primaryAttributeName})()}_getParameterRelationsConfigs(e){return e.relationsConfigs||[]}_createRelationParameter(e,t){const n={...e},s=this._getParameterRelationsConfigs(n);return n.relationsConfigs=[{dataSchemaName:t.dataSchemaName,attributePath:t.attributePath,relationPath:t.relationPath},...s],n}_validateAllowedRelations(e,t,n){const a=n?.relationPath?.split(".")?.shift(),o=e.dataSchemas[t],c=o?.findAttributeByName(a);if(o&&c&&o.primaryAttributeName!==a&&c.dataValueType!==E.r.Lookup&&!this._featureValues.DataSourceAllowRelationsByNonLookupColumn){const d="Filtration of data sources by page data is currently supported by lookup and primaryAttribute fields only",p=new Error(`${d}, please see the console for more details`);throw p.stack=`${d} , data source name: ${t}, relation config: ${JSON.stringify(n)}`,p}}_createRelationParameterWithAttributeValue(e,t,n,s){var a=this;return(0,f.A)(function*(){const o={...n},c=a._getParameterRelationsConfigs(o),d=e.dataSchemas[t],p=s.relationPath.split("."),C=p.shift(),I=d.findAttributeByName(C);if(I.dataValueType!==E.r.Lookup&&(a._featureValues.DataSourceAllowRelationsByNonLookupColumn||d.primaryAttributeName===C))return o.type=ce.ColumnValue,o.value={attributePath:s.attributePath,attributeValue:s.value},o.relationsConfigs=c,o;const O={dataSchemaName:s.dataSchemaName,attributePath:s.attributePath,relationPath:s.relationPath};o.value=s.value,o.type=ce.PrimaryColumnValue,d.primaryAttributeName!==C&&(O.dataSchemaName=I.referenceSchemaName);const Y=d.type!==cs.Entity?O.dataSchemaName:s.dataSchemaName;return O.relationPath=p.length===0?yield a._getPrimaryAttributeName(e,Y):p.join("."),o.relationsConfigs=[O,...c],o})()}_convertToRelationParameters(e,t,n,s){var a=this;return(0,f.A)(function*(){const o=[];a._validateAllowedRelations(e,t,s);for(const c of n){const d=s.useAttributeValue?yield a._createRelationParameterWithAttributeValue(e,t,c,s):a._createRelationParameter(c,s);o.push(d)}return o})()}_getRelationParameters(e,t,n){var s=this;return(0,f.A)(function*(){const a=e._modelDependencies[t]||[];if(a.length===0)return Promise.resolve([]);const o=a.map(p=>s.getLoadParametersByRelation(e,p,t,n)),c=(yield Promise.all(o)).flat();if(s._featureValues.DisableDsDepsJoinOptimization)return c;const d=c.filter(p=>p.type!==ce.Empty);return d.length===0?c:d.filter(p=>p.type===ce.Filter?!!p.value:!0)})()}_getPagingConfigRowCount(e,t,n,s){return typeof t=="string"&&(t=(0,M.isNil)(e.attributes[t])?0:e.attributes[t]),s&&(!t||t+n>s)&&(t=s-n),t}_getPagingConfigRowsOffset(e,t,n,s){const a=e._dataSourcesInfos.get(s).collectionViewModelAttributeName,o=e.attributes[a]?.length??0;if(typeof t=="number")throw new Error("Rows offset parameter cannot be set to number");return!t&&n===Oe.LoadNext?o:!t&&n===Oe.Reload?0:(e.attributes[t]=(0,M.isNil)(e.attributes[t])?0:e.attributes[t],n===Oe.Reload?e.attributes[t]:e.attributes[t]+o)}_getModelPagingConfig(e,t,n,s){if(!t){const c=this._getOwnLoadParameters(e,s);return Promise.resolve(c?.options?.pagingConfig??null)}const a=this._getPagingConfigRowsOffset(e,t.rowsOffset,n,s),o=this._getPagingConfigRowCount(e,t.rowCount,a,t.rowsLimit);return Promise.resolve({rowCount:o,rowsOffset:a})}_mergeSorting(e,t){return(0,M.unionBy)(e??[],t??[],"columnName")??null}_getModelSortingConfig(e,t,n){const a=this._getOwnLoadParameters(e,n)?.options?.sortingConfig,o=t?.attributeName;return!o||!e.attributes[o]?a?Promise.resolve(a):Promise.resolve(null):Promise.all(e.attributes[o].map(function(){var c=(0,f.A)(function*(d){return{columnName:yield d.columnName,direction:yield d.direction}});return function(d){return c.apply(this,arguments)}}())).then(c=>({columns:this._mergeSorting(c,a?.columns)}))}_updateLastEventLoadParameters(e,t,n,s){n&&n.length!==0?e._lastEventLoadParameters.set(t,n):s!==!0&&e._lastEventLoadParameters.set(t,[{type:ce.Empty,value:""}])}_getModelLoadParameters(e,t,n,s,a,o,c){const d=this.getModelParameters(e,n,s).then(p=>(o!==!0&&this._updateLastEventLoadParameters(e,t,p,a),a!==!0?p:e._lastEventLoadParameters.get(t)||[{type:ce.Never,value:""}]));return Promise.all([d,this._getDataSourceFilteringParameters(e,t),this._getDataSourceOwnFilteringParameters(e,t),this._getRelationParameters(e,t,c)]).then(([p,C,I,O])=>[...p,...I,...C,...O])}getLoadParametersByRelation(e,t,n,s){const a=t.relationPath.split("."),o=a.shift(),c=e.dataSchemas[o],d={dataSchemaName:c.name,attributePath:t.attributePath,relationPath:a.join(".")},p=a.shift(),I=e._dataSourcesInfos.get(o).getMappedAttributeNames(p)?.[0]??null,O=e.getModelMode(o),Y=s?.[o]?.[d.relationPath];if(e.getModelByName(n)?.getAllowCopyingRecords()&&Y)d.value=Y,d.useAttributeValue=!0;else{const se=e.getIsDirty(I)||O===U.Create||O===U.Copy||c.type!==cs.Entity;if(I&&se){d.useAttributeValue=!0;const Mi=e.attributes[I];d.value=Mi?.value?Mi.value:Mi}}return this._getModelLoadParameters(e,o,null,null,!0,!1).then(se=>this._convertToRelationParameters(e,o,se,d))}getModelParameters(e,t,n){if(n?.parameters&&(t=[...t,...n.parameters]),!t||t.length===0)return Promise.resolve([]);const s=t.map(a=>{switch(a.type){case ce.PrimaryColumnValue:return Promise.resolve({type:a.type,value:this._getParameterValue(e,a.value,n)});case ce.Filter:return Promise.resolve({type:a.type,value:this._applyFilterMacros(e,a.value)});case ce.PrimaryDisplayValueFilter:return this._createPrimaryDisplayColumnValueFilter(this._getParameterValue(e,a.value,n));case ce.ColumnValue:return this._createColumnValueFilter(e,a.value,n)}});return Promise.all(s)}getModelLoadParameters(e,t,n,s=Oe.Load,{payload:a,useLastLoadParameters:o,doNotUpdateLastLoadParameters:c,modelLoadConfiguration:d}={}){const p=t.name,C=s??Oe.Load,I=C===Oe.Load?null:t.getPagingConfig(),O=t.getSortingConfig();return Promise.all([this._getModelLoadParameters(e,p,n,a,o,c,d),this._getModelPagingConfig(e,I,C,p),this._getModelSortingConfig(e,O,p)])}static{this.\u0275fac=function(t){return new(t||Ta)(i.\u0275\u0275inject(Zn),i.\u0275\u0275inject(xn),i.\u0275\u0275inject(fe))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Ta,factory:Ta.\u0275fac,providedIn:"root"})}}class an{get attributesMap(){return this._attributesMap}get mappedViewModelAttributes(){return this._mappedViewModelAttributes}get isCollection(){return this._isCollection}get collectionViewModelAttributeName(){return this._collectionViewModelAttributeName}constructor(e){this._attributesMap=new Map,this._mappedViewModelAttributes=new Set,this.attributes=[],this.includePrimaryAttributes=!0,this.name=e}static _getDataSourceInfo(e,t){if(!e.has(t)){const n=new an(t);return e.set(t,n),n}return e.get(t)}static _extractViewModelAttributeMapInfo(e){const t=e.split(".");return{dataSourceName:t.shift(),dataSourceAttributePath:t.join(".")}}static _getByDefaultAttribute(e,t,n,s=""){const a=t.modelConfig;if(!a||!a.path)return;const o=this._extractViewModelAttributeMapInfo(a.path);if(!o.dataSourceAttributePath){this._getByViewModelCollectionAttribute(e,t,n);return}if(s&&s!==o.dataSourceName)throw new Error(`Attribute '${e}' mapped on a few DataSources`);const c=this._getDataSourceInfo(n,o.dataSourceName),d=a.aggregationConfig?.aggregationFunction?kh(o.dataSourceAttributePath):o.dataSourceAttributePath;c.attributes.push({path:d,type:a.type,functionConfig:a.functionConfig,aggregationConfig:a.aggregationConfig}),c._mappedViewModelAttributes.add(e),c._attributesMap.set(e,o.dataSourceAttributePath)}static _getByInlineViewModelAttribute(e,t,n,s=""){const a=t.viewModelConfig||{};Object.entries(a.attributes||{}).forEach(([o,c])=>{const d=`${e}.${o}`;this._processViewModelAttribute(d,c,n,s)})}static _getByViewModelCollectionAttribute(e,t,n){const s=t.modelConfig;if(!s||!s.path)return;const o=this._extractViewModelAttributeMapInfo(s.path).dataSourceName,c=this._getDataSourceInfo(n,o);c._isCollection=!0,c._collectionViewModelAttributeName=e,c._pagingConfig=s.pagingConfig,c._sortingConfig=s.sortingConfig,c._filteringConfig=s.filterAttributes,c.includePrimaryAttributes=s.includePrimaryAttributes===void 0?!0:s.includePrimaryAttributes;const d=t?.viewModelConfig;Object.entries(d?.attributes||{}).forEach(([p,C])=>{this._processViewModelAttribute(`${e}.${p}`,C,n,o)})}static _processViewModelAttribute(e,t,n,s=""){"viewModelConfig"in t||"viewModelName"in t?t.isCollection?this._getByViewModelCollectionAttribute(e,t,n):this._getByInlineViewModelAttribute(e,t,n,s):"from"in t||this._getByDefaultAttribute(e,t,n,s)}static getFromViewModelConfig(e,t=[]){const n=new Map;return Object.entries(e?.attributes||{}).forEach(([s,a])=>{this._processViewModelAttribute(s,a,n)}),t.filter(s=>!n.has(s.name)).forEach(({name:s})=>{const a=new an(s);n.set(s,a)}),n}static getLookupListDataSourceInfo(e,t){const n=new an("");return n._isCollection=!0,n._collectionViewModelAttributeName=e,Object.entries(t).forEach(([s,a])=>{n.attributes.push({path:a}),n._mappedViewModelAttributes.add(s),n._attributesMap.set(s,a)}),n}_getRowModelDto(e){const t=e.length>0?e[0]:{},n={};return Object.entries(t).forEach(([s,a])=>{this.getMappedAttributeNames(s).forEach(c=>{const d=c.split(".");this.isCollection&&d.length>1&&d.shift(),(0,M.set)(n,d.join("."),a)})}),n}_getCollectionModelDto(e){const t=this._collectionViewModelAttributeName,n=e.map(s=>this._getRowModelDto([s]));return{[t]:n}}getMappedAttributes(){return Array.from(this._mappedViewModelAttributes.values())}getMappedAttributeNames(e){return Array.from(this._attributesMap.entries()).filter(([,t])=>t===e).map(([t])=>t)}getDataSourceAttributePath(e){return this._attributesMap.has(e)?this._attributesMap.get(e):""}getIsMapOnCollection(e){return this._isCollection&&this._collectionViewModelAttributeName===e}getPagingConfig(){return this._pagingConfig}getSortingConfig(){return this._sortingConfig}getFilteringConfig(){return this._filteringConfig||[]}getModelDto(e){return this._isCollection?this._getCollectionModelDto(e):this._getRowModelDto(e)}addNewAttribute(e,t,n){const s=new Map;s.set(this.name,this),an._getByDefaultAttribute(e,t,s,n)}getIsDataSourceAttributePathExists(e){return this.attributes.find(t=>t.path===e)!==void 0}}class my{}var ai;(function(r){r.None="None",r.OneToMany="OneToMany",r.ManyToOne="ManyToOne",r.ManyToMany="ManyToMany",r.CircularDependency="CircularDependency"})(ai||(ai={}));function XS(r,e){return!!r?.some(t=>t.relationPath.split(".").shift()===e)}function rp(r){return r.dataValueType===E.r.Guid}function ap(r,e){return rp(e)&&r.primaryAttributeName===e.name}function gy(r,e,t,n){const s=t.findAttributeByName(n),a=r.findAttributeByName(e);return(a.isLookup||rp(a))&&ap(t,s)?ai.OneToMany:ap(r,a)&&s.isLookup?ai.ManyToOne:ai.ManyToMany}function mu(r){const e=r.split("."),t=e.shift(),n=e.shift();return{dependOnModelName:t,dependOnAttributeName:n}}function op(r){Object.values(r.controls||{}).forEach(e=>{e instanceof Z.FormGroup||e instanceof Z.FormArray?op(e):e.updateValueAndValidity({onlySelf:!0})})}function eM(r){r?.markAsPristine(),r?.markAsUntouched(),r?.updateValueAndValidity()}function tM(r){return Object.values(r?.errors||{}).map(e=>e?.message).filter(Boolean)}function lp(r){return r.statusChanges.pipe((0,l.startWith)(r.status),(0,l.first)(()=>r.status.toLowerCase()!=="pending"),(0,l.map)(()=>{}))}const fy=500;class on{static{this._skippedProperties=["schedule","then"]}constructor(e,t,n,s,a,o,c,d){this.viewModelGenerator=e,this.injector=t,this.viewModelConfig=n,this.resources=s,this._eventScopes=o,this._modelsInitConfig=c,this._defaultPrimaryAttributeName="Id",this._models$=new u.BehaviorSubject([]),this._businessRulesActive=!0,this._dropdownPageSizeSettingsCode="DropdownPageSize",this._dataSourcesInfos=new Map,this._attributesToDataSourceNameMap=new Map,this._dropdownPageSize=null,this._replayEvents$=new u.ReplaySubject,this._loadedDataSources=new Set,this._conflictedModels=[],this.__destroyed=!1,this._disableViewModelWaitingForAsyncTasks=!1,this._disableViewModelLoadUnblockingThread=!1,this._blockFieldsAffectedByBusinessRules=!1,this._asyncTasksExecutingSubject=new u.BehaviorSubject(new Set),this._modelsRequestedToLoad=new Set,this._attributesAffectedByBusinessRules=[],this._businessRulesAreActivated=!1,this._destroySubject=new u.Subject,this._modelSourceRecordId={},this._modelLoadParametersSetted$=new u.Subject,this._modelsNamesWithParameters=new Set,this.saveModelTaskName="MODEL_SAVING",this._modelLoaded$=new u.Subject,this._viewModelAttributeChangeEventOptions=new Kf({preventAttributeChangeRequest:!1,preventStateChange:!0,preventRunBusinessRules:!0}),this._dynamicModelNames=new Set,this._attributeConfigs={},this._eventsSubject$=new u.Subject,this._collectionSubscription=new Map,this._crtControls=new Map,this._subscriptions=new u.Subscription,this._destroy$=this._destroySubject.asObservable(),this._businessRulesActivated$=new u.BehaviorSubject(!1),this.attributes={},this.dataSchemas={},this.events$=(0,u.merge)(this._eventsSubject$,this._replayEvents$),this._systemAttributes=[],this.initDependencies(),this._subscribeModelsChanges(),this.handlerChain=Qt.instance,a?this.formApiModel=a:this.formApiModel=this.formBuilder.group({}),this.parent=d;const p=this._appInfo?.isDebugEnabled?this._createProxy(this):this;return this._viewModelDataDelayerService&&!this.parent&&this._viewModelDataDelayerService.setViewModel(p),p}get models(){return this._models$.value}get IsChanged(){return Promise.resolve(this.attributes[ea])}set IsChanged(e){}get HasUnsavedData(){return Promise.resolve(this.attributes[ml])}set HasUnsavedData(e){}set BusinessRulesActivated(e){}get BusinessRulesActivated(){return Promise.resolve(this._businessRulesAreActivated)}get _isChanged(){return console.warn("Warning: The `_isChanged` property of the view-model is deprecated. It will be removed in future versions. Use `IsChanged` or `HasUnsavedData` attribute instead."),Object.keys(this._attributeConfigs).filter(e=>!(0,M.isEmpty)(this._attributeConfigs[e].modelConfig)).some(e=>this.formApiModel.controls[e]?.dirty)}get _scopes(){return[...this._eventScopes??[]]}get _injectionContext(){return this._context}get[$n](){return this.injector}get primaryAttributeName(){if(!this._primaryModelName)return this._defaultPrimaryAttributeName in this._attributeConfigs?this._defaultPrimaryAttributeName:null;const t=this.dataSchemas[this._primaryModelName].primaryAttributeName,n=this._dataSourcesInfos.get(this._primaryModelName);return this._getMappedAttributeName(n,t)}get PrimaryModelMode(){return this.getPrimaryModelMode()}get State(){return Yr(this).attributes[gl]}get _destroyed(){return this.__destroyed}get modelInitConfigs(){return this._modelsInitConfig}_createProxy(e){return new Proxy(e,{get(t,n){return!(typeof n=="string")||n in t||on._skippedProperties.includes(n)||console.debug(`Attribute ${n} not found.`),t[n]}})}_executeWithOptions(e,t){let n;try{return n=this._viewModelAttributeChangeEventOptions.getOptions(),this._viewModelAttributeChangeEventOptions.setOptions(t),e()}finally{this._viewModelAttributeChangeEventOptions.setOptions(n)}}_setSystemAttributeValue(e,t){const n=this.attributes[e];this.attributes[e]=t,this._executeWithOptions(()=>{this._fireChangeAttributeEvent({type:Re.ChangeAttributeValue,payload:{attributeName:e,oldValue:n,value:t}})},{preventStateChange:!0,preventRunBusinessRules:!0})}_fireChangeAttributeEvent(e){e.payload.silent??=this._viewModelAttributeChangeEventOptions.getAsSilent(),Object.assign(e.payload,this._viewModelAttributeChangeEventOptions.getOptions()),this._eventsSubject$.next(e)}_getViewModelValidators(e){const t=this.viewModelConfig.attributes[e]??{};return("validators"in t&&t.validators)??{}}_initDataSourceValidators(){return this._measurePerformanceService?.measure(`ViewModel.initDataSourceValidators.${this._injectionContext?.id}.parent.${!!this.parent}`,()=>(this._validators={},this._dataSourcesInfos.forEach(e=>{e.attributesMap.forEach((t,n)=>{const s=this.viewModelConfig.attributes[n]??{};if("modelConfig"in s&&s.modelConfig?.ignoreValidators)return;this._validators[n]=this._validators[n]||[];const a=this._getDataSourceAttributeSchema(e,t);if(a?.validators){for(const[o,c]of Object.entries(a.validators))if(c?.type){const d=this._injectionContext??Yr(this)?._injectionContext,p=this.validatorTypeResolver.getValidator(c.type,{validationParameters:c?.params,injectionContext:d}),C=this._getViewModelValidators(n),I=Object.values(C).find(O=>O.type===c.type);this._validators[n].push({name:o,instance:p,disabled:!!I?.disabled,params:c?.params})}}})}),(0,u.of)(null)))}_initSchemaValidators(e){this._measurePerformanceService.measure(`ViewModel.initSchemaValidators.${this._injectionContext?.id}.parent.${!!this.parent}`,()=>{Object.entries(e||{}).forEach(([t])=>{const n=this._getViewModelValidators(t);this._validators[t]=this._validators[t]||[];for(const[s,a]of Object.entries(n))if(a?.type){const o=this._injectionContext??Yr(this)?._injectionContext,c=this.validatorTypeResolver.getValidator(a.type,{validationParameters:a.params,injectionContext:o});this._validators[t].push({name:s,instance:c,disabled:a.disabled,params:a?.params})}})})}_waitAsyncValidation(){return(0,u.from)(this.waitAsyncTasksFinish()).pipe((0,l.switchMap)(()=>this.formApiModel.statusChanges.pipe((0,l.startWith)(this.formApiModel.status),(0,l.filter)(e=>e.toLowerCase()!=="pending"),(0,l.first)(),(0,l.map)(()=>null))))}_getResourcesStrings(){const e=this.resources?.strings??{};return{...e,...this._getResourceStringsByAttributes(e)}}_getChangedResourcesStrings(e){const t=Object.entries(e).reduce((s,[a,o])=>{const c=this.resources?.strings[a]||{},d=o&&{...c,...o};return{...s,[a]:d}},{}),n={...this.resources?.strings,...t};return JSON.parse(JSON.stringify(n))}_generateResourceAttribute(){this[xr]={},this[xr][Hi.string]={};const e=this._getResourcesStrings();return this._attributeResourceGenerator.generate(this,e)}_getBoundAttributeNames(){const e=new Set;return this._dataSourcesInfos.forEach(t=>{for(const n of t.mappedViewModelAttributes)e.add(n)}),Array.from(e.values())}_getDataSourceInfoByViewModelAttributePath(e){const t=this.getBoundDataSourceNameByAttributePath(e);return this._dataSourcesInfos.has(t)?this._dataSourcesInfos.get(t):null}_getResourceStringsByAttributes(e){const t=Object.keys(e);return this._getBoundAttributeNames().filter(s=>!t.includes(s)).reduce((s,a)=>(s[a]={},s),{})}_getDataSourceAttributeSchema(e,t){return this.dataSchemas[e.name]?.attributes?.find(n=>n.name===t)}_generatePrimaryAttributes(){return this._measurePerformanceService.measure(`ViewModel.generatePrimaryAttributes.${this._injectionContext?.id}.parent.${!!this.parent}`,()=>{const e=Array.from(this._dataSourcesInfos.values()).map(t=>{const n=t.name,s=this.dataSchemas[n],o=(t.includePrimaryAttributes?[s?.primaryAttributeName,s?.primaryDisplayAttributeName]:[]).filter(c=>c&&!t.getIsDataSourceAttributePathExists(c)).map(c=>{const d=(0,le.qv)(),p=`${n}_${c}_${d}`,C=s.findAttributeByName(c),I={modelConfig:{path:`${n}.${c}`},dataValueTypeName:E.r[C.dataValueType]};return this._attributeConfigs[p]=I,t.addNewAttribute(p,I),this._attributeGenerate({[p]:I})});return o.length===0?(0,u.of)(null):(0,u.forkJoin)(o)});return e.length===0?(0,u.of)(null):(0,u.forkJoin)(e).pipe(this._measurePerformanceService.measure$(`ViewModel.generatePrimaryAttributes.forkJoin.${this._injectionContext?.id}.parent.${!!this.parent}`))})}_getDataSourceDto(e){const t={},n=this._dataSourcesInfos.get(e);return n.attributesMap.forEach((s,a)=>{if(!n.getIsMapOnCollection(a)){const o=this.attributes[a],c=this._getDataSourceAttributeSchema(n,s);!o&&c?.dataValueType===E.r.Lookup?t[s]=null:t[s]=o}}),(0,u.of)(t)}_checkFilteringAttributes(e,t){if(t.some(s=>(0,M.isNil)(s.name)))throw new Error(`Filtering attributes for ${e} are not valid!`)}_attributeGenerate(e,t){return this._attributeGenerator.generate(this,e,{...t,onChangeAttributeValue:(n,s,a)=>{this._fireChangeAttributeEvent({type:Re.ChangeAttributeValue,payload:{attributeName:n,value:s,oldValue:a,silent:this._viewModelAttributeChangeEventOptions.getAsSilent()}})}})}_getDataSourceNamesAffectedByFilteringAttribute(e,t){return[...this._dataSourcesInfos.entries()].filter(([,n])=>n.isCollection).filter(([n])=>{const s=this.getModelByName(n);return t.has(s?.name)||s?.isLoaded||s?.isLoading}).filter(([n,s])=>{const a=s.getFilteringConfig(),o=a.some(c=>c?.name===e&&c?.loadOnChange);return o&&this._checkFilteringAttributes(n,a),o}).map(([n])=>n)}_createRequestsForReloadingDataSources(e){return e.map(t=>({type:"crt.LoadDataRequest",$context:this,dataSourceName:t,config:{loadType:Oe.Reload}}))}_dispatchStartLoadModelAttributes(e){const t=`${vn.AttributeLoading}_${this._context?.id}_${Object.keys(e)}`;this._measurePerformancePageLoadService?.addTask(t,{targetTask:!0}),this._replayEvents$.next({type:Re.StartLoadModelAttributes,payload:e})}_dispatchFinishLoadModelAttributes(e){const t=`${vn.AttributeLoading}_${this._context?.id}_${Object.keys(e)}`;this._measurePerformancePageLoadService?.removeTask(t,{targetTask:!0}),this._replayEvents$.next({type:Re.FinishLoadModelAttributes,payload:e})}_processEmptyLoadDataForCollection(e,t){var n=this;return(0,f.A)(function*(){if(!e.isCollection||!e.collectionViewModelAttributeName)return;const s=t.find(d=>d.type===ce.PrimaryColumnValue);if(!s)return;const a=s.value?.value,o=n.attributes[e.collectionViewModelAttributeName];if(!a||!o)return;const c=yield o.findByPrimaryAttribute(a);c&&o.remove(c)})()}_loadDynamicModel(e){const t=e.attributeName,n=e.dataSourceConfig,s=e.dataSourceName||Kr.createDynamicDataSourceNameFromAttributeName(this,t),a=Kr.createAttributeConfig(this,s,e),o=this._createAndSetDataSourceInfo(s,t,a);return this._defineOrUpdateAttribute(t,a),this._setupSortingAttribute(e.sortingConfig),this._setupFiltersAttributes(e.filtersConfig),this._modelGenerator.generateOne(n,s).pipe((0,l.tap)(c=>this._markModelAsCollection(c,o)),(0,l.tap)(c=>this._dynamicModelNames.add(c.name)),(0,l.tap)(c=>this._upsertModel(s,c)),(0,l.tap)(c=>this._addModelDependencies(c,e.dependencies)),(0,l.switchMap)(c=>(0,u.forkJoin)([(0,u.of)(c),this._addDataSchemaToDataSchemas(c)])),(0,l.switchMap)(([c])=>(0,u.forkJoin)([(0,u.of)(c),(0,u.of)(this._replaceAttributesToDataSourceNameMap(o))])),(0,l.switchMap)(([c])=>(0,u.forkJoin)([(0,u.of)(c),this._reGenerateResourcesAttributes()])),(0,l.switchMap)(([c])=>this._loadModelData({model:c,dataSourceInfo:o,parametersConfig:[],loadType:Oe.Reload,useLastLoadParameters:e.useLastLoadParameters}).pipe(this._measurePerformanceService.measure$(`ViewModel.loadDynamicModel.${this._injectionContext?.id}.parent.${!!this.parent}.datasourceName.${e.dataSourceName}`))))}_defineOrUpdateAttribute(e,t){this.attributes[e]?this._attributeConfigs[e]=t:this._attributeGenerate({[e]:t})}_createAndSetDataSourceInfo(e,t,n){const a=an.getFromViewModelConfig({attributes:{[t]:n}}).get(e);return this._dataSourcesInfos.set(e,a),a}_setupSortingAttribute(e){if(!e?.default)return;const t=e.attributeName;this.attributes[t]=e.default}_setupFiltersAttributes(e){e?.forEach(t=>{if(!t.value)return;const n=t.name,s=t.value;this[n]=s.value||s})}_addModelDependencies(e,t){this._modelDependencies[e.name]=t||[]}_addDataSchemaToDataSchemas(e){return e.getSchema().pipe((0,l.tap)(t=>this.dataSchemas[e.name]=t))}_reGenerateResourcesAttributes(){return(0,u.forkJoin)([...this._generateResourceAttribute(),(0,u.of)(null)])}_replaceAttributesToDataSourceNameMap(e){const t=this._getDataSourceAttributesMap(e),n=[...Array.from(this._attributesToDataSourceNameMap.entries()),...t];this._initializeAttributesToDataSourceNameMap(n)}_getMappedAttributeName(e,t){if(!e)return"";const n=e.getMappedAttributeNames(t);return!n||n.length===0?"":n[0]}_getMappedAttributeNames(e,t){return e?e.getMappedAttributeNames(t):[]}_getModelAttributesToLoad(e,t){const n=this._dataSourcesInfos.get(e.name);if(t?.attributes){const s=t.attributes.filter(a=>{const o=this._getMappedAttributeName(n,a);return!this.getIsDirty(o)});return this._getModelDependentAttributes(e,s)}return n.attributes.map(s=>s.path)}_loadStaticModel(e,t,n,s,a,o){const c=this.getModelByName(e),d=this._dataSourcesInfos.get(c.name);return this._loadModelData({model:c,dataSourceInfo:d,parametersConfig:t,loadType:n,payload:s,useLastLoadParameters:a,doNotUpdateLastLoadParameters:o})}_waitDataDelay(e){return this._viewModelDataDelayerService?.shouldBeDelayed()?(0,u.of)(e).pipe((0,l.delayWhen)(()=>this._viewModelDataDelayerService.loadTrigger$)):(0,u.of)(e)}_updateTrackedAttributes(e){const t=this._modelDependencies[e.name];if(!t||!e.isAggregate)return;const n=/^.{0,2}\[\w+:\w+(:\w+)?]/;t.forEach(s=>{const a=s.relationPath.split(".")[0],o=this.getModelByName(a),c=e.affectedAttributes.filter(p=>p.schemaName===o.dataSchemaName).map(p=>p.path.split(".")[0]).filter(p=>!n.test(p)),d=new Set([...s.trackByAttributes??[],...c]);s.trackByAttributes=[...d.values()]})}_waitForModelLoad(e){var t=this;return(0,f.A)(function*(){const n=t.getModelByName(e);!n||n?.isLoaded||n.mode===U.Create||n.mode===U.Copy||(yield(0,u.firstValueFrom)(t._modelLoaded$.pipe((0,l.filter)(s=>s===e),(0,l.take)(1))))})()}_waitForModelsLoad(e){var t=this;return(0,f.A)(function*(){if(e.length===0||t._isDesignTime)return;const n=e.map(s=>t._waitForModelLoad(s));yield Promise.all(n)})()}_waitForModelsLoadParameters(e,t){var n=this;return(0,f.A)(function*(){if(e.length===0||n._isDesignTime||!t||t.mode===U.Create||t.mode===U.Copy)return;const s=e.map(a=>n._waitForModelLoadParameters(a));yield Promise.all(s)})()}_waitForModelLoadParameters(e){var t=this;return(0,f.A)(function*(){t._lastEventLoadParameters.has(e)||t._modelsNamesWithParameters.has(e)||(yield(0,u.firstValueFrom)(t._modelLoadParametersSetted$.pipe((0,l.filter)(()=>t._modelsNamesWithParameters.has(e)),(0,l.take)(1))))})()}_getAffectedAttributes(e,t,n){const a=this.dataSchemas[e].primaryAttributeName,o=[...t];return a&&!t.includes(a)&&n?.length>0&&n?.[0][a]&&o.push(a),o}_getModelLoadParameters(e,t,n,s,a,o){return this._modelParametersBuilder.getModelLoadParameters(this,e,t,n,{payload:s,useLastLoadParameters:a,doNotUpdateLastLoadParameters:o}).catch(c=>(console.error(c),this._showNotification({message:c.message}),[[{type:ce.Never}],{},{}]))}_getRelationTypeForRootModel(e){if(this._featureValues.DisableMultipleDataSources||this._isDesignTime)return null;const t=this._modelDependencies[e],n=Jn(this.getModelByName(e));if(t?.length!==1||!this._primaryModelName||!n)return null;const s=this.dataSchemas[this._primaryModelName],a=t[0],{dependOnModelName:o,dependOnAttributeName:c}=mu(a.relationPath);return o!==this._primaryModelName?null:gy(this.dataSchemas[e],a.attributePath,s,c)}_isManyToOneRootModelRelation(e){return this._getRelationTypeForRootModel(e)===ai.ManyToOne}_isOneToManyRootModelRelation(e){return this._getRelationTypeForRootModel(e)===ai.OneToMany}_getOneToManyRelationDefaultValues(e){const t=this._modelDependencies[e]?.[0];if(!t)return{};const n=this.dataSchemas[this._primaryModelName],s=this.getViewModelAttributePaths(this._primaryModelName,n.primaryAttributeName)?.[0],a=this.getViewModelAttributePaths(this._primaryModelName,n.primaryDisplayAttributeName)?.[0];return{[t.attributePath]:{value:this.attributes[s],displayValue:this.attributes[a]}}}_getDependOnModelLoadConfiguration(e){const t=this._getDependOnModelsNames(e),n={};return t.forEach(s=>{this._modelSourceRecordId[s]&&(n[s]={[this.dataSchemas[s].primaryAttributeName??"Id"]:this._modelSourceRecordId[s]})}),n}_isPrimaryModel(e){return this._primaryModelName===e}_isIndependentRootModel(e){return Jn(e)?this._getDependOnModelsNames(e.name).length===0:!1}_checkAndProcessPageDataSourceData(e,t){if(this._featureValues.DisableMultipleDataSources||this._isDesignTime)return(0,u.of)(t);if(this._isManyToOneRootModelRelation(e.name)&&t.length===0)return this._clearModelValues(e.name),e.setLoadedState(),(0,u.of)(t);const s=this._isOneToManyRootModelRelation(e.name),a=this._isIndependentRootModel(e);if(!(s&&t.length===0||a&&t.length===0&&!this._isPrimaryModel(e.name)))return(0,u.of)(t);e.resetMode();const c=this._getOneToManyRelationDefaultValues(e.name);if(this.PrimaryModelMode===U.Copy){const d=this.dataSchemas[e.name].primaryAttributeName??"Id",p=this._getDependOnModelLoadConfiguration(e.name);return(0,u.from)(this.getDataSourceLoadParameters(e.name,p)).pipe((0,l.switchMap)(({parameters:C,options:I})=>e.load({attributes:[d],parameters:C,options:{loadType:Oe.Reload,pagingConfig:I.pagingConfig,sortingConfig:I.sortingConfig}})),(0,l.switchMap)(C=>{e.resetMode();const I=C?.length?C[0][d]:null;return I?this.copy(e.name,I,c):this.create(e.name,c)}),(0,l.map)(()=>t))}return this.create(e.name,c).pipe((0,l.map)(()=>t))}_isRowsLimitReached(e){var t=this;return(0,f.A)(function*(){const n=e.collectionViewModelAttributeName,s=e.getPagingConfig()?.rowsLimit;return!s||!n?!1:(yield t[n])?.length>=s})()}_setDataSourceLoaded(e,t,n,s){var a=this;return(0,f.A)(function*(){n.length<s?.rowCount||(yield a._isRowsLimitReached(t))?a._loadedDataSources.add(e):a._loadedDataSources.delete(e)})()}_getModelDependedOnEntityDataSource(e){return e.filter(t=>this.models.find(a=>a.name===t).getDataSource().type===ol.EntityDataSource)}_loadModelData({model:e,dataSourceInfo:t,parametersConfig:n,loadType:s,payload:a,useLastLoadParameters:o,doNotUpdateLastLoadParameters:c}){const d=e.name;this._modelsRequestedToLoad.add(d);const p=this._getModelAttributesToLoad(e,a),C=a?.attributes;if(C&&p.length===0)return(0,u.of)([]);if(this._conflictedModels.includes(d))return(0,u.of)([]);const I=this._getDataSourceMappingAttributes(t,p),O=this._getLoadTypeForDataSource(t,s);if(O===Oe.LoadNext&&this._loadedDataSources.has(d))return(0,u.of)([]);this._dispatchStartLoadModelAttributes(I);const Y=!this._isSyncForModelAllowed(e)||C===null||e.mode===U.Init,te=this._getDependOnModelsNames(d);this._checkAndLoadUnloadedDependOnModels(te);const se=this._getModelDependedOnEntityDataSource(te),Mi=te.filter(st=>!se.includes(st)),_S=Promise.all([this._waitForModelsLoad(Mi),this._waitForModelsLoadParameters(se,e)]);return(0,u.from)(this._featureValues.DisableSequentialLoadDependentDS?this._waitForModelsLoad(te):_S).pipe((0,l.switchMap)(st=>(0,u.from)(this._getModelLoadParameters(t,n,O,a,o,c)).pipe((0,l.tap)(()=>{!this._featureValues.DisableSequentialLoadDependentDS&&!t.isCollection&&(this._modelDependencies[d]?.map(Ne=>Ne.relationPath)||[]).forEach(Ne=>{const{dependOnModelName:nr,dependOnAttributeName:md}=mu(Ne),[Xp]=this.getViewModelAttributePaths(nr,md);this.getAttributeControl(Xp).markAsPristine()})}),(0,l.tap)(()=>{if(!this._featureValues.DisableSequentialLoadDependentDS){this._setModalLoadParameters(d);const Gt=this._getAffectedAttributes(d,p,[]);this._reloadDependentModels(e,Gt,Vt.Page)}}))),(0,l.mergeMap)(st=>this._waitDataDelay(st)),(0,l.switchMap)(([st,Gt,Qp])=>e.load({attributes:p,parameters:st,options:{loadType:s,pagingConfig:Gt,sortingConfig:Qp}}).pipe(this._measurePerformanceService.measure$(`ViewModel.loadStaticModel.model.load.${this._injectionContext?.id}.parent.${!!this.parent}.modelName.${d}`),(0,l.catchError)(Ne=>this._handleLoadErrorResponse(Ne,[])),(0,l.tap)(()=>this._updateTrackedAttributes(e)),(0,l.tap)(Ne=>{Ne.length===0&&this._dispatchFinishLoadModelAttributes(I)}),(0,l.mergeMap)(Ne=>Ne.length===0?(0,u.from)(this._processEmptyLoadDataForCollection(t,st)).pipe((0,l.map)(()=>Ne)):(0,u.of)(Ne)),(0,l.switchMap)(Ne=>this._checkAndProcessPageDataSourceData(e,Ne)),(0,l.map)(Ne=>({data:Ne,viewModelAttributes:t.getModelDto(Ne)})),(0,l.switchMap)(({data:Ne,viewModelAttributes:nr})=>this.setValue(nr,{collectionLoadType:O===Oe.Reload?es.Reload:es.Merge,silent:!0,isMaskedValue:!0}).pipe((0,T.pR)(()=>!t.isCollection||!nr?(0,u.of)(void 0):(Object.keys(nr).forEach(md=>{this.attributes[md]?.forEach(em=>{em.formApiModel.updateValueAndValidity()})}),(0,u.from)(this._setDataSourceLoaded(d,t,Ne,Gt)))),(0,l.tap)(()=>this._markAsPristine(nr)),(0,l.map)(()=>Ne))))),(0,l.tap)(()=>this._modelLoaded$.next(d)),(0,l.switchMap)(st=>this._runBusinessRulesForModel(e,st)),(0,l.tap)(st=>{const Gt=this._getAffectedAttributes(d,p,st);this._featureValues.DisableSequentialLoadDependentDS&&this._reloadDependentModels(e,Gt,Vt.Page),Y||this._reloadDependentModels(e,Gt,Vt.ViewElement)}),(0,l.tap)(st=>{const Gt=st[0]??{};e.setLoadedState(Object.keys(Gt)),this._dispatchFinishLoadModelAttributes(I)}))}_checkAndLoadUnloadedDependOnModels(e){const t=e.filter(n=>{const s=!this._modelsRequestedToLoad.has(n),a=!Jn(this.getModelByName(n));return s&&a});this._requestReloadModels(t)}_createChangeAttributeTriggers(e){return e.map(t=>({type:ve.ChangeAttributeValue,name:t,scopeId:""}))}_runBusinessRulesForModel(e,t,n=!1,s=[]){const a=this._dataSourcesInfos.get(e.name);if(a.isCollection||!this._businessRulesProcessingEnabled||!this._businessRulesActive)return(0,u.of)(t);const o=t[0]??{},c=n?[...a.mappedViewModelAttributes]:Object.keys(o).flatMap(I=>this._getMappedAttributeNames(a,I)).filter(I=>I!=null),d=this._createChangeAttributeTriggers(c),p={type:ve.DataLoaded,name:e.name,scopeId:""},C=this.models.filter(I=>I!==e).filter(I=>I.mode!==U.Init).filter(I=>I.getDataSource().scope===Vt.Page).map(I=>this._getModelBusinessRuleContext(I.name,[]));return(0,u.forkJoin)([this._getModelBusinessRuleContext(a.name,[p,...s]),...C,(0,u.of)(this._getViewModelBusinessRuleContext([...d,...s,p]))]).pipe(this._measurePerformanceService.measure$(`ViewModel.runBusinessRulesForModel.${this._injectionContext?.id}.parent.${!!this.parent}`),(0,l.switchMap)(I=>this._runBusinessRulesForContexts(I)),(0,l.map)(()=>t))}_runInitialBusinessRules(){if(!this._businessRulesProcessingEnabled||!this._businessRulesActive)return(0,u.of)(null);const e={type:ve.ContextReady,name:null,scopeId:""};return this._prepareBusinessRulesContexts([e]).pipe(this._measurePerformanceService.measure$(`ViewModel.runInitialBusinessRules.${this._injectionContext?.id}.parent.${!!this.parent}`),(0,l.mergeMap)(t=>t.length===0?(0,u.of)(null):this._runBusinessRulesForContexts(t)))}_createViewModelAttributesValues(e,t){const n=Object.entries(this.dataSchemas),[,s]=n.find(([o])=>o===e),a={};for(const o of s.attributes){const c=t[o.name],d=this.getViewModelAttributePath(e,o.name);d&&(a[d]=c??null)}return a}_createModelData(e,t){const n=this._dataSourcesInfos.get(e),s=this._getDataSourceMappingAttributes(n);this._dispatchStartLoadModelAttributes(s);const a=this.getModelByName(e),o=a.disableSync,c=this._getModelAttributesToLoad(a,null);return a.disableSync=!0,a.create(t).pipe((0,l.switchMap)(d=>{const p=this._createViewModelAttributesValues(e,d),C=this._isOneToManyRootModelRelation(e)?{silent:!0}:null;return this.setValue(p,C).pipe((0,l.tap)(()=>this._forEachControl(p,I=>{I.markAsPristine(),I.markAsUntouched()})))}),(0,l.tap)(()=>{a.disableSync=o,this._modelLoaded$.next(e),this._featureValues.DisableSequentialLoadDependentDS||this._setModalLoadParameters(e)}),(0,l.switchMap)(()=>this._runBusinessRulesForModel(a,[],!0)),(0,l.tap)(()=>{this._isSyncForModelAllowed(a)&&this._reloadDependentModels(a,c)}),(0,l.tap)(()=>{this._dispatchFinishLoadModelAttributes(s),a.setLoadedState()}),(0,l.map)(()=>null))}_copyModelData(e,t,n){const s=this._dataSourcesInfos.get(e),a=this._getDataSourceMappingAttributes(s);this._dispatchStartLoadModelAttributes(a);let o;const c=this.getModelByName(e),d=this._getModelAttributesToLoad(c,null),p=c.disableSync;return c.disableSync=!0,this._modelSourceRecordId[e]=t,c.copy(t,n).pipe((0,l.catchError)(C=>this._handleLoadErrorResponse(C,{})),(0,l.map)(C=>({data:[C],viewModelAttributes:s.getModelDto([C])})),(0,l.switchMap)(({data:C,viewModelAttributes:I})=>this.setValue(I).pipe((0,l.tap)(()=>this._markAsPristine(I)),(0,l.map)(()=>C))),(0,l.tap)(()=>{c.disableSync=p,this._modelLoaded$.next(e)}),(0,l.switchMap)(C=>this._runBusinessRulesForModel(c,C,!0)),(0,l.tap)(()=>{this._isSyncForModelAllowed(c)&&(this._reloadDependentModels(c,d),this._featureValues.DisableSequentialLoadDependentDS||this._setModalLoadParameters(e))}),(0,l.tap)(()=>{this._dispatchFinishLoadModelAttributes(a),c.setLoadedState()}),(0,l.mergeMap)(()=>(0,u.of)(o)))}_getDataSourceMappingAttributes(e,t=null){const n=t??e.attributes.map(a=>a.path),s=Object.fromEntries(n.map(a=>[this._getMappedAttributeName(e,a),!0]));return e.collectionViewModelAttributeName&&(s[e.collectionViewModelAttributeName]=!0),s}_handleLoadErrorResponse(e,t){if(e instanceof sp)return(0,u.of)(t);const n=1e4;return console.error(e),this._showNotification({message:e.message,duration:n}),(0,u.of)(t)}_canExecuteBusinessRulesByModelAttributeValue(e,t,n){return t&&e?this._isModelAttributeValueValid(e,t,n):!0}_canExecuteBusinessRulesByViewModelAttributeValue(e,t){const n=this._getDataSourceInfoByViewModelAttributePath(e);if(n){const s=n.getDataSourceAttributePath(e);return this._canExecuteBusinessRulesByModelAttributeValue(n,s,t)}return!0}_getContextAttributeValue(e){return e instanceof Date?ih(e):e}_getNormalizedContextAttributeValue(e,t,n){const s=e;return E.r[t]===E.r.Lookup||s?.displayValue?s?.value??e:n===!0||!t?e:[E.r.RICH_TEXT,E.r.Image].includes(E.r[t])?null:E.r[t]===E.r.MAXSIZE_TEXT&&e?e.slice(0,500):e}_getHasValueContextAttributeValue(e,t){return!!(t&&E.r[t]===E.r.Boolean||e!=null&&e!=="")}_getViewModelAttributeInfos(e,t,n){return Object.keys(t).filter(s=>!(t[s]instanceof tt)).map(s=>{if(t[s]instanceof on)return this._getViewModelAttributeInfos(e?`${e}.${s}`:s,t[s]?.attributes??{},n);const a=this._attributeConfigs[s]?.dataValueTypeName,o=this._getContextAttributeValue(t[s]),c=this._getNormalizedContextAttributeValue(o,a,n);return{name:e?`${e}.${s}`:s,value:c??null,displayValue:t[s]?.displayValue,dataValueTypeName:a,hasValue:this._getHasValueContextAttributeValue(o,a)}}).flat()}_runBusinessRulesForContexts(e){const t=`${vn.RunningBusinessRules}-${(0,le.qv)()}`;return this._onAsyncTaskStarted(t),(0,u.of)(e).pipe(this._measurePerformanceService.measure$(`ViewModel.runBusinessRules.${this._injectionContext?.id}.parent.${!!this.parent}`),(0,l.map)(n=>n?.filter(s=>!(0,M.isNil)(s))??[]),(0,l.mergeMap)(n=>{if(n.length===0)return(0,u.of)(null);const s=n.map(a=>({scopeName:a.scopeName,scopeId:a.scopeId,scopeType:a.scopeType,triggers:a.triggers}));return this._toggleControlsAffectedByBusinessRules(!1,s),this._businessRulesEngine.execute(n).pipe(this._measurePerformanceService.measure$(`ViewModel.runBusinessRules.execute.${this._injectionContext?.id}.parent.${!!this.parent}`),(0,l.tap)(a=>{a.forEach(o=>{const c=s.find(d=>d.scopeId===o.scopeId&&d.scopeName===o.scopeName&&d.scopeType===o.scopeType);o.triggers=c?.triggers??[]})}),(0,l.switchMap)(a=>a?this._businessRulesApplier.applyRules(this,a):(0,u.of)(null)),(0,l.tap)(()=>{this._toggleControlsAffectedByBusinessRules(!0,s)}))}),(0,l.tap)(()=>this._onAsyncTaskFinished(t)))}_createViewModelContext(e,t){return{scopeType:Xt.ViewModel,scopeName:this._scopeName,scopeId:this._scopeName,scopeState:Sn.Unknown,parentScopeId:null,attributes:t,triggers:e}}_getViewModelBusinessRuleContext(e){const t=this._featureValues["BRules-EnableCompareLargeAttributeValues"],n=this._getViewModelAttributeInfos(null,this.attributes,t);return this._createViewModelContext(e,[...n].map(s=>({attributeName:s.name,value:s.value,displayValue:s.displayValue,dataValueTypeName:s.dataValueTypeName,hasValue:s.hasValue})))}_prepareModelBusinessRuleTrigger(e,t){return t.map(n=>{if(n.type===ve.DataLoaded||n.type===ve.ContextReady)return n;const s=this._getDataSourceInfoByViewModelAttributePath(n.name);return!s||s.name!==e?null:{type:ve.ChangeAttributeValue,name:s.getDataSourceAttributePath(n.name),scopeId:""}}).filter(n=>n!=null)}_getModelContextScopeStateType(e){switch(e.mode){case U.Init:return Sn.Init;case U.Create:return Sn.Create;case U.Copy:return Sn.Copy;case U.Update:return Sn.Update;default:return Sn.Unknown}}_getModelBusinessRuleContext(e,t){const n=this._dataSourcesInfos.get(e),s=this.getModelByName(e),a=this.dataSchemas[e],o=this._prepareModelBusinessRuleTrigger(e,t),c=this._getModelContextScopeStateType(s);return this._getDataSourceDto(e).pipe((0,l.map)(d=>({...s._getPersistedState(),...d})),(0,l.map)(d=>({enableCompareLargeAttributeValues:this._featureValues["BRules-EnableCompareLargeAttributeValues"],modelDto:d})),(0,l.map)(({enableCompareLargeAttributeValues:d,modelDto:p})=>Object.entries(p).map(([C,I])=>{let O;const Y=this._getMappedAttributeName(n,C);if(Y)O=this._attributeConfigs[Y]?.dataValueTypeName;else{const Mi=a.findAttributeByName(C);O=E.r[Mi.dataValueType]}const te=this._getContextAttributeValue(I),se=this._getNormalizedContextAttributeValue(te,O,d);return{attributeName:C,value:se,displayValue:I?.displayValue,dataValueTypeName:O,hasValue:this._getHasValueContextAttributeValue(te,O),isSignificant:C===a.primaryAttributeName}})),(0,l.map)(d=>({scopeType:Xt.Model,scopeName:s.dataSchemaName,scopeId:e,scopeState:c,parentScopeId:this._scopeName,attributes:d,triggers:o,modelType:s.getDataSource()?.type})))}_prepareDataSourceNamesForBusinessRules(){return this._modelsMap.size===0?[]:[...this._modelsMap.values()].filter(e=>!this._dataSourcesInfos.get(e.name).isCollection).map(e=>e.name)}_getModelsBusinessRuleContexts(e){return this._prepareDataSourceNamesForBusinessRules().map(n=>n?this._getModelBusinessRuleContext(n,e):(0,u.of)(null))}_prepareBusinessRulesContexts(e){const t=this._getModelsBusinessRuleContexts(e);if(!this._scopeName)return t.length===0?(0,u.of)([]):(0,u.forkJoin)([...t]);const s=[(0,u.of)(this._getViewModelBusinessRuleContext(e)),...t];return s.length===0?(0,u.of)([]):(0,u.forkJoin)(s)}_isAttributeChange(e){return!e.attributeName?.includes(":")}_businessRulesSubscribeOnChangeAttributes(){if(!this._businessRulesProcessingEnabled||this._isDesignTime)return;const e=this.events$.pipe((0,l.filter)(()=>this._businessRulesActive),(0,l.filter)(n=>n.type===Re.ChangeAttributeValue),(0,l.filter)(n=>this._isAttributeChange(n.payload)),(0,l.filter)(n=>!n.payload.silent),(0,l.filter)(n=>!n.payload?.preventRunBusinessRules),(0,l.filter)(n=>{const s=n.payload;return this._canExecuteBusinessRulesByViewModelAttributeValue(s.attributeName,s.value)}),(0,l.filter)(n=>{const s=n.payload,a=this._getAttributeDataValueTypeName(s.attributeName);return a&&jc(a)===E.r.Lookup?s.value?.value!==s.oldValue?.value:!0}),(0,l.map)(n=>n.payload.attributeName)),t=e.pipe((0,l.tap)(()=>this._onAsyncTaskStarted(vn.DebouncingBusinessRules)),(0,l.buffer)(e.pipe((0,l.debounceTime)(fy))),(0,l.map)(n=>Array.from(new Set(n))),(0,l.map)(n=>this._createChangeAttributeTriggers(n)),(0,l.mergeMap)(n=>this._prepareBusinessRulesContexts(n)),(0,l.tap)(()=>this._onAsyncTaskFinished(vn.DebouncingBusinessRules)),(0,l.filter)(n=>n.length>0),(0,l.mergeMap)(n=>this._runBusinessRulesForContexts(n)));this._subscriptions.add(t.subscribe())}_subscribeOnChangeAttributes(){const e=this.events$.pipe((0,l.filter)(t=>t.type===Re.ChangeAttributeValue),(0,l.map)(t=>t),(0,l.map)(t=>{const n=this.getBoundDataSourceNameByAttributePath(t.payload.attributeName),s=this._dataSourcesInfos.get(n)?.attributesMap.get(t.payload.attributeName),a=this.getBoundDataSchemaAttributeByAttributePath(t.payload.attributeName);return{changeEvent:t,model:this.getModelByName(n),modelAttributeInfo:{name:a?.name??s,isLookup:!!a?.isLookup}}}),(0,l.filter)(({model:t,modelAttributeInfo:n})=>!!(t&&n.name)),(0,l.tap)(({changeEvent:t,model:n,modelAttributeInfo:s})=>{const a=t.payload,o=s.isLookup,c=o?a.oldValue?.value:a.oldValue,d=o?a.value?.value:a.value;c!==d&&n?.attributeChanged(s.name,a?.preventStateChange??a?.silent)}));this._subscriptions.add(e.subscribe())}_getHasRelation(e=[],t,n){return e.map(a=>{const o=a.trackByAttributes??[],{dependOnModelName:c,dependOnAttributeName:d}=mu(a.relationPath);return o.push(d),{rootModelName:c,trackedAttributes:d}}).filter(({rootModelName:a})=>a===t).filter(({trackedAttributes:a})=>this._dataSourcesInfos.get(t).isCollection?!0:n.some(o=>a.includes(o))).length!==0}_getDependentModelsNames(e,t=[]){return e?Object.entries(this._modelDependencies).filter(([n])=>n!==e).filter(([,n])=>this._getHasRelation(n,e,t)).map(([n])=>n).map(n=>[n,...this._getDependentModelsNames(n)]).flat():[]}_getIsModelDataChanged(e){if(!this.getModelByName(e)?.isLoaded)return!1;const n=this._dataSourcesInfos.get(e);if(n.isCollection){const a=n.collectionViewModelAttributeName,o=this.attributes[a];return o?o.isChanged:!1}return n.getMappedAttributes().some(a=>this.getIsDirty(a))}_requestReloadModels(e){this._createRequestsForReloadingDataSources(e).forEach(n=>{this._ngZone.runOutsideAngular(()=>this.processRequest(n))})}_isModelAttributeValueValid(e,t,n){return this._getDataSourceAttributeSchema(e,t)?.dataValueType===E.r.Lookup?wh(n):!0}_canReloadModelDependentData(e,t){return e.canReloadDependentData(t)?!0:this._conflictedModels.includes(e.name)?!1:this._getDependentModelsNames(e.name,[t]).length>0}_getModelDependentAttributes(e,t){return[...t,...t.map(n=>e.getDependentAttributesNames(n)).flat()]}_getChangedModelsNames(e){return e.filter(t=>this._getIsModelDataChanged(t))}_showNotification(e){this._ngZone.runOutsideAngular(()=>this.processRequest({type:"crt.NotificationRequest",$context:this,...e}))}_isSyncForModelAllowed(e){return e.allowSync}_subscribeOnReloadDataEvents(){if(this._isDesignTime)return;const e=this.events$.pipe((0,l.filter)(()=>this._modelSynchronizationEnabled),(0,l.filter)(t=>t.type===Re.ChangeAttributeValue),(0,l.filter)(t=>t.payload.silent!==!0),(0,l.map)(t=>({modelName:this.getBoundDataSourceNameByAttributePath(t.payload.attributeName),attributeName:t.payload.attributeName,attributeValue:t.payload.value})),(0,l.filter)(({modelName:t})=>t!=null),(0,l.map)(({modelName:t,attributeName:n,attributeValue:s})=>{const a=this._dataSourcesInfos.get(t),o=a?.attributesMap.get(n);return{model:this.getModelByName(t),dataSourceInfo:a,modelAttribute:o,attributeValue:s}})).pipe((0,l.filter)(({model:t})=>t!=null),(0,l.filter)(({dataSourceInfo:t})=>!t.isCollection),(0,l.filter)(({model:t})=>this._isSyncForModelAllowed(t)),(0,l.filter)(({dataSourceInfo:t,modelAttribute:n,attributeValue:s})=>this._isModelAttributeValueValid(t,n,s)),(0,l.filter)(({model:t,modelAttribute:n})=>this._canReloadModelDependentData(t,n))).pipe((0,l.tap)(({model:t,dataSourceInfo:n,modelAttribute:s,attributeValue:a})=>{const o=this._getModelDependentAttributes(t,[s]),c=Object.fromEntries(o.map(d=>[this._getMappedAttributeName(n,d),!0]));this._dispatchStartLoadModelAttributes(c),t.reloadDependentData(s,a).pipe((0,l.switchMap)(d=>{if(d.length===0)return(0,u.of)(d);const p=n.getModelDto(d);return this.setValue(p,{silent:!0,isMaskedValue:!0}).pipe((0,l.switchMap)(()=>this._runBusinessRulesForModel(t,d)))}),(0,l.tap)(()=>this._reloadDependentModels(t,[s])),(0,l.tap)(()=>this._dispatchFinishLoadModelAttributes(c))).subscribe()}));this._subscriptions.add(e.subscribe())}_subscribeOnChangeRequests(){const e=this.events$.pipe((0,l.filter)(t=>t.type===Re.ChangeAttributeValue),(0,l.mergeMap)(t=>{const n=t.payload.attributeName,s=this._attributeConfigs[n];return Array.isArray(s?.change)?s.change:[s?.change]}),(0,l.filter)(t=>t!=null),(0,l.map)(t=>({type:t.request,$context:this,scopes:this._scopeName?[this._scopeName]:[],...t.params})),(0,l.tap)(t=>this._ngZone.runOutsideAngular(()=>this.handlerChain.process(t))));this._subscriptions.add(e.subscribe())}_subscribeOnFilteringEvents(){const e=new Set;this._subscriptions.add(this._modelLoaded$.pipe((0,l.tap)(n=>{e.add(n)})).subscribe());const t=this.events$.pipe((0,l.filter)(n=>n.type===Re.ChangeAttributeValue),(0,l.map)(n=>{const s=n.payload.attributeName;return this._getDataSourceNamesAffectedByFilteringAttribute(s,e)}),(0,l.map)(n=>this._createRequestsForReloadingDataSources(n)),(0,l.tap)(n=>{n.forEach(s=>{this._ngZone.runOutsideAngular(()=>this.processRequest(s))})}));this._subscriptions.add(t.subscribe())}_saveModel(e,t,n){const s=this.getModelByName(e),a=s.mode,o=this.getSaveModelStream$({dataSourceName:e,parametersConfig:t,saveAction:(c,d)=>s.insertOrUpdate(c,d),onSavedAction:(c,d)=>this._updateLastLoadParameters(e,a,c,d),getInvalidAction:c=>(0,u.of)(c)});return this.handleSaveModelStream(o,n)}_initSubscriptions(){return this._measurePerformanceService.measure(`ViewModel.initSubscriptions.${this._injectionContext?.id}.parent.${!!this.parent}`,()=>(this._subscribeOnFilteringEvents(),this._subscribeModelsEvents(),this._subscribeOnChangeAttributes(),this._subscribeOnChangeRequests(),this._subscribeOnReloadDataEvents(),this._businessRulesSubscribeOnChangeAttributes(),this._subscribeOnChangeAttributesToHandleModelDependenciesConstrains(),this._subscribeOnPrimaryDisplayAttributeChangeForOneToManyRelation(),(0,u.of)(null)))}_subscribeOnPrimaryDisplayAttributeChangeForOneToManyRelation(){if(this._featureValues.DisableMultipleDataSources)return;const e=this.events$.pipe((0,l.filter)(t=>this._primaryModelName!=null),(0,l.filter)(t=>t.type===Re.ChangeAttributeValue),(0,l.map)(t=>t),(0,l.map)(({payload:t})=>{const n=t.attributeName,s=t.value;return{modelName:this.getBoundDataSourceNameByAttributePath(n),attributeName:n,attributeValue:s}}),(0,l.filter)(({modelName:t})=>this._isPrimaryModel(t)),(0,l.filter)(({attributeName:t})=>{const n=this.getBoundDataSchemaByAttributePath(t),s=this.getBoundDataSchemaAttributeByAttributePath(t);return!n||!s?!1:n.primaryDisplayAttributeName===s.name}),(0,l.map)(({modelName:t,attributeValue:n})=>{const s=this.dataSchemas[this._primaryModelName],o=this._getDependentModelsNames(t,[s.primaryAttributeName]).filter(c=>this._isOneToManyRootModelRelation(c));return{primaryDisplayValue:n,dependentModelsNames:o}}),(0,l.filter)(({dependentModelsNames:t})=>t.length>0),(0,l.tap)(({dependentModelsNames:t,primaryDisplayValue:n})=>{const s=this.dataSchemas[this._primaryModelName],a=this.getViewModelAttributePaths(this._primaryModelName,s.primaryAttributeName)[0],o=this.attributes[a],c={};t.map(d=>{const C=this._modelDependencies[d][0].attributePath;return this.getViewModelAttributePaths(d,C)}).flat().forEach(d=>{c[d]={value:o,displayValue:n}}),this.setValue(c,{silent:!0,preventAttributeChangeRequest:!0,preventRunBusinessRules:!1,preventStateChange:!0})}));this._subscriptions.add(e.subscribe())}_getDataSchemas(){if(this.models&&this.models.length!==0){const e=this.models.map(t=>t.getSchema().pipe((0,l.map)(n=>[t.name,n])));return(0,u.combineLatest)(e).pipe((0,l.take)(1),(0,l.map)(t=>Object.fromEntries(t)))}return(0,u.of)({})}_setAttributesDefaultValues(e){var t=this;return(0,u.from)((0,f.A)(function*(){let n=Object.entries(t.dataSchemas);e&&(n=n.filter(([s])=>s===e));for(const[s,a]of n){const o={};for(const c of a.attributes){const d=yield(0,u.lastValueFrom)(c.defaultValue,{defaultValue:null});if(!(0,M.isNil)(d)){const p=t.getViewModelAttributePath(s,c.name);p&&(o[p]=d)}}t.setValue(o).subscribe()}})())}_generateDataSourcesInfo(){return this._dataSourcesInfos=an.getFromViewModelConfig(this.viewModelConfig,this.models),(0,u.of)(this._dataSourcesInfos)}_generateAttributesToDataSourceNameMap(e){const t=Array.from(e.values()).map(n=>this._getDataSourceAttributesMap(n)).flat();return this._initializeAttributesToDataSourceNameMap(t),(0,u.of)(this._attributesToDataSourceNameMap)}_initializeAttributesToDataSourceNameMap(e){this._attributesToDataSourceNameMap=new Map(e)}_getDataSourceAttributesMap(e){const n=e.getMappedAttributes().map(s=>[s,e.name]);return e.isCollection&&n.push([e.collectionViewModelAttributeName,e.name]),n}_getDataSourceLoadType(e){return e?e||Oe.Reload:null}_getLoadTypeForDataSource(e,t){if(t===Oe.Load)return t;const n=e.getPagingConfig();return!t&&n?Oe.LoadNext:t}_loadDefaultSorting(e){this._measurePerformanceService.measure(`ViewModel._loadDefaultSorting.${this._injectionContext?.id}.parent.${!!this.parent}.dsNames.${e?.toString()}`,()=>{const t=Array.from(this._dataSourcesInfos.entries()).filter(([n])=>!e?.length||e.includes(n)).map(([,n])=>n.getSortingConfig()).filter(n=>!!n?.default).reduce((n,s)=>(n[s.attributeName]=s.default,n),{});this.setValue(t,{silent:!0}).subscribe()})}_getDropdownPageSize(){var e=this;return(0,f.A)(function*(){if(!(0,M.isEmpty)(e._dropdownPageSize))return e._dropdownPageSize;const t=yield e.sysSettingsService.getByCode(e._dropdownPageSizeSettingsCode);return e._dropdownPageSize={pagingConfig:{rowCount:t?.value,rowsOffset:0}},e._dropdownPageSize})()}_mergeCollectionModels(e,t){this._measurePerformanceService.measure(`ViewModel.mergeCollectionModels.${this._injectionContext?.id}.parent.${!!this.parent}.collection.${e}`,()=>{const n=this.attributes[e];this._featureValues.DisableBaseViewModelCollectionOptimization||n.length?n.merge(t):n.push(...t)})}_getEmbeddedModels(){const e=Object.entries(this.viewModelConfig?.attributes??{}).filter(([,s])=>s&&"embeddedModel"in s&&s.embeddedModel).map(([s,a])=>({attributeName:s,embeddedModel:a.embeddedModel}));if(e.length===0)return(0,u.of)([]);const t={},n=[];if(e.forEach(({attributeName:s,embeddedModel:{name:a,config:o}})=>{a?t[a]&&n.push(`Duplicated embedded model : ${a}.`):n.push(`Embedded model name is not provided for ${s}.`),t[a]=o}),n.length>0)throw new Error(n.join(" "));return this._modelGenerator.generate({dataSources:t},this.injector)}_concatModelsWithEmbedded(e=null){return this._getEmbeddedModels().pipe((0,l.map)(t=>{const n=[...e??[],...t??[]],s=n.map(a=>a.name).filter((a,o,c)=>c.indexOf(a)!==o);if(s.length>0)throw new Error(`Duplicated model names found : ${s.join(",")}.`);return n}))}_updateModelsMap(){const e=this.models.map(t=>[t.name,t]);this._modelsMap=new Map(e)}_subscribeModelsChanges(){this._subscriptions.add(this._models$.subscribe(()=>this._updateModelsMap()))}_subscribeModelsEvents(){this._isDesignTime||this.models.forEach(e=>this._subscribeModelEvents(e))}_subscribeModelEvents(e){this._subscriptions.add(e.event$.pipe((0,l.mergeMap)(t=>this._waitDataDelay(t)),(0,l.mergeMap)(t=>this._ngZone.runOutsideAngular(()=>this.processRequest({type:"crt.HandleModelEventRequest",$context:this,scopes:this._eventScopes,modelName:e.name,modelEvent:t})),1)).subscribe())}_upsertModel(e,t){const n=[...this.models],s=n.findIndex(({name:a})=>a===e);s===-1?n.push(t):n.splice(s,1,t).forEach(a=>a.destroy()),this._subscribeModelEvents(t),this._models$.next(n)}_replaceDataSourceInfo(e,t){!e||!t||(this._loadedDataSources.has(e)&&this._loadedDataSources.delete(e),this._dataSourcesInfos.set(e,t),this._replaceAttributesToDataSourceNameMap(t))}_updateModels(e){e.forEach((t,n)=>{const s=this.getModelByName(n);s&&(this._markModelAsCollection(s,t),this._updateModelDependentAttributes(s,t))})}_markModelAsCollection(e,t){t.isCollection&&(e._isCollection=!0)}_setModalLoadParameters(e){this._modelsNamesWithParameters.add(e),this._modelLoadParametersSetted$.next()}_updateModelDependentAttributes(e,t){const n=t.attributes.map(s=>({path:s.path,type:s.type}));e.updateDependentAttributes(n)}_initIsChangedAttribute(){this._systemAttributes.push(ea),this.attributes[ea]=!1;const e=this._models$.pipe((0,l.switchMap)(t=>t?.length?(0,u.combineLatest)(t.map(n=>n._dirty$)):(0,u.of)([])),(0,l.map)(t=>t.some(n=>n)),(0,l.filter)(()=>!this._viewModelAttributeChangeEventOptions.getOptions().preventStateChange),(0,l.distinctUntilChanged)()).subscribe(t=>{this._setSystemAttributeValue(ea,t)});this._subscriptions.add(e)}_initHasUnsavedDataAttribute(){this._systemAttributes.push(ml),this.attributes[ml]=!1;const e=this.events$.pipe((0,l.filter)(o=>o?.type===Re.ChangeAttributeValue&&o.payload?.attributeName===ea),(0,l.map)(o=>o.payload.value)),t=(0,u.merge)(this.IsChanged,e),s=this._models$.pipe((0,l.map)(o=>o.map(c=>c._modeChanges$.pipe((0,l.map)(d=>({mode:d,name:c.name})),(0,l.startWith)({mode:c.mode,name:c.name})))),(0,l.switchMap)(o=>o?.length?(0,u.combineLatest)(o):(0,u.of)([]))).pipe((0,l.map)(o=>o.some(({mode:c,name:d})=>{const p=!this._isDesignTime&&!this._featureValues.DisableMultipleDataSources&&!this._isPrimaryModel(d)&&this._isIndependentRootModel(this.getModelByName(d)),C=this._isOneToManyRootModelRelation(d);return(c===U.Create||c===U.Copy)&&!C&&!p}))),a=(0,u.combineLatest)([t,s]).pipe((0,l.map)(([o,c])=>!!(o||c)),(0,l.distinctUntilChanged)()).subscribe(o=>{this._setSystemAttributeValue(ml,o)});this._subscriptions.add(a)}_initPrimaryModelModeAttribute(){const e=this._getPrimaryModelModeChanges();if(!e)return;this._systemAttributes.push($c),this.attributes[$c]=this.getPrimaryModelMode();const t=e.pipe((0,l.startWith)(this.getPrimaryModelMode())).subscribe(n=>this._setSystemAttributeValue($c,n));this._subscriptions.add(t)}_initStateAttribute(){this._systemAttributes.push(gl),this.attributes[gl]=Zc.Active}_initBusinessRulesActivatedAttribute(){if(this._systemAttributes.push(Gc),this.attributes[Gc]=this._businessRulesAreActivated,this._businessRulesAreActivated)return;const e=this._businessRulesActivated$.pipe((0,l.filter)(t=>t===!0)).subscribe(t=>{this._setSystemAttributeValue(Gc,t)});this._subscriptions.add(e)}_initSystemAttributes(){var e=this;return(0,f.A)(function*(){yield e._measurePerformanceService.measureCallback(`ViewModel.initSystemAttributes.${e._injectionContext?.id}.parent.${!!e.parent}`,()=>(e._initIsChangedAttribute(),e._initPrimaryModelModeAttribute(),e._initHasUnsavedDataAttribute(),e._featureValues.DisableDelayingModelEvents||e._initStateAttribute(),e._initBusinessRulesActivatedAttribute(),Promise.resolve()))})()}_handleCircularDependencies(){const e=qf(this._modelDependencies);if(e.hasCycles){const t=this._translateService.instant("BaseViewModel.WarningModelsWithCircularDependencies");this._showNotification({message:t,duration:1e4}),console.warn(t,e.cycledModelsNames)}this._conflictedModels=e?.cycledModelsNames}_forEachControl(e,t){Object.keys(e).forEach(s=>{if(this.attributes[s]instanceof tt){const a=this.attributes[s],o=e[s];a.forEach(c=>{const d=c.primaryAttributeName,p=c.attributes[d],C=o.find(I=>I[d]===p);C&&c._forEachControl(C,t)})}else if(this.attributes[s]instanceof on)this.attributes[s]._forEachControl(e[s],t);else{const a=this.getControl(s);t(a.formControl)}})}_getModelsErrors(e){return(e??[]).filter(t=>!t.isCollectionItemModel&&t.hasErrors).map(t=>t.getLastError())}_notifyAboutModelsErrors(e){const t=this._getModelsErrors(e);if(t.length>0){const n=t.map(s=>s.message).join(" ");this._showNotification({message:n})}}_initFeaturesStates(){this._disableViewModelWaitingForAsyncTasks=this._featureValues.DisableViewModelWaitingForAsyncTasks,this._disableViewModelLoadUnblockingThread=this._featureValues.DisableViewModelLoadUnblockingThread,this._blockFieldsAffectedByBusinessRules=this._featureValues.BlockFieldsWhileRunBusinessRules,this._modelSynchronizationEnabled=!this._featureValues.ModelSynchronizationDisabled}_handleAsyncTasksCycle(e){let t=null;const n=100,s=Array.from(e).filter(a=>a.startsWith(vn.ProcessingAttributeChangeRequest));if(!(!e.size||!s.length))return s.length&&(t=setTimeout(()=>{console.warn("[ViewModel]: Clearing executing tasks by exceeded timeout",s),s.forEach(a=>e.delete(a)),this._asyncTasksExecutingSubject.next(e)},n)),t}_getAffectedViewModelAttributes(e,t){return this.models.filter(s=>s.dataSchemaName===e).map(s=>s.name).flatMap(s=>this.getViewModelAttributePaths(s,t))}_toggleControlsAffectedByBusinessRules(e,t){if(!this._blockFieldsAffectedByBusinessRules)return;this._attributesAffectedByBusinessRules?.filter(s=>If(this._scopeName,s,t))?.forEach(s=>{s.scopeName===this._scopeName?this.getControl(s.name).toggle(e):this._getAffectedViewModelAttributes(s.scopeName,s.name).forEach(o=>{this.getControl(o).toggle(e)})})}_initAttributesAffectedByBusinessRules(){var e=this;return(0,f.A)(function*(){const n=e._prepareDataSourceNamesForBusinessRules().filter(a=>!!a).map(a=>e.getModelByName(a)).map(a=>({scopeId:a.name,scopeName:a.dataSchemaName,scopeType:Xt.Model,modelType:a.getDataSource()?.type})),s={scopeName:e._scopeName,scopeType:Xt.ViewModel,scopeId:e._scopeName};e._attributesAffectedByBusinessRules=yield e._businessRulesEngine.getAffectedAttributes([s,...n])})()}_initBusinessRules(){var e=this;return this._measurePerformanceService.measureCallback(`ViewModel.initBusinessRules.${this._injectionContext?.id}.parent.${!!this.parent}`,(0,f.A)(function*(){e._businessRulesProcessingEnabled=!e._featureValues.BusinessRulesProcessingDisabled&&e.viewModelConfig.supportBusinessRules!==!1,e._businessRulesProcessingEnabled&&(yield e._initAttributesAffectedByBusinessRules()),e._businessRulesAreActivated=e._businessRulesProcessingEnabled&&e._businessRulesActive!==!1,e._businessRulesActivated$.next(e._businessRulesAreActivated)}))}_attributeGenerate$(e,t){return(0,u.of)(this._featureValues.UseDesignerHotSwapViewModel).pipe((0,l.switchMap)(n=>n&&this._isDesignTime?this._initDataSourceValidators().pipe((0,l.tap)(()=>{this._initSchemaValidators(e)}),(0,l.switchMap)(()=>this._attributeGenerate(e,t))):this._attributeGenerate(e,t)))}_validateByDataSourceName(e){var t=this;return(0,f.A)(function*(){const n={},s=t._getBoundDataSourceAttributeControls(e);return yield Promise.all(Object.entries(s).map(([a,o])=>(o.markAsTouched(),o.updateValueAndValidity(),(0,u.lastValueFrom)(lp(o).pipe((0,l.tap)(()=>{o.errors&&(n[a]=o.errors)})))))),n})()}_validateAll(){var e=this;return(0,f.A)(function*(){const t={};return e.formApiModel.markAllAsTouched(),e.formApiModel.updateValueAndValidity(),op(e.formApiModel),yield(0,u.lastValueFrom)(lp(e.formApiModel).pipe((0,l.tap)(()=>{Object.entries(e.formApiModel.controls).forEach(([s,a])=>{a.errors&&(t[s]=a.errors)})}))),t})()}_getDependentModelsNamesOnRelationAttributeName(e){const t=this.getBoundDataSourceNameByAttributePath(e),s=this._dataSourcesInfos.get(t)?.attributesMap.get(e);return this._getDependentModelsNames(t,[s])}_setAttributeValue(e,t,n){this._executeWithOptions(()=>this[e]=t,n)}_subscribeOnChangeAttributesToHandleModelDependenciesConstrains(){if(this._isDesignTime)return;const e=this.events$.pipe((0,l.filter)(t=>t.type===Re.ChangeAttributeValue),(0,l.filter)(t=>this._isAttributeChange(t.payload)),(0,l.tap)(t=>{const n=t;!n?.payload?.value&&n.payload?.attributeName&&this._clearValuesForManyToOne(n.payload.attributeName)}));this._subscriptions.add(e.subscribe())}_clearValuesForManyToOne(e){this._getDependentModelsNamesOnRelationAttributeName(e).forEach(n=>{this._isManyToOneRootModelRelation(n)&&this._clearModelValues(n)})}_clearModelValues(e){const t=this._dataSourcesInfos.get(e),n=t?.isCollection?[]:t.getMappedAttributes();if(n.length){const s=n.reduce((a,o)=>({...a,[o]:null}),{});this.setValue(s).subscribe(()=>{this._markAsPristine(s),this._markAsUntouched(s)})}}_markAsUntouched(e){this._forEachControl(e,t=>{t.markAsUntouched()})}_setSingleSubmodelValue(e,t,n){return this.attributes[e].setValue(t[e],{silent:n?.silent,isMaskedValue:n?.isMaskedValue,preventAttributeChangeRequest:n?.preventAttributeChangeRequest,preventStateChange:n?.preventStateChange,preventRunBusinessRules:n?.preventRunBusinessRules})}_setCollectionSubmodelValue(e,t,n){const s=this._attributeConfigs[e],a=s.viewModelConfig||s.viewModelName,o=!this._featureValues.DisableDataGridEditingMode,c=(t[e]||[]).map(d=>{const p=this.getBoundDataSourceName(e),I=this._getDataSourceInfoByViewModelAttributePath(e)?.isCollection&&this.getModelByName(p)?.createCollectionItemModel(U.Update);return this.viewModelGenerator.generate({viewModelConfig:a,modelConfig:o&&I?{primaryDataSourceName:I.name}:void 0,models:o&&I?[I]:void 0,parentViewModel:this,businessRulesActive:!1},i.Injector.create({providers:[{provide:jo,useValue:null}],parent:this.injector})).pipe(this._measurePerformanceService.measure$(`ViewModel.setValue.generateViewModel.${this._injectionContext?.id}.parent.${!!this.parent}.modelName.${I?.name}`),(0,l.tap)(O=>{p&&(O.dataSchemas[p]=this.dataSchemas[p])}),(0,l.tap)(O=>{O.deactivateBusinessRules()}),(0,l.switchMap)(O=>O.setValue(d,{silent:n?.silent,isMaskedValue:n?.isMaskedValue,preventAttributeChangeRequest:n?.preventAttributeChangeRequest,preventStateChange:n?.preventStateChange,preventRunBusinessRules:n?.preventRunBusinessRules}).pipe((0,l.tap)(()=>I&&I.setLoadedState()),(0,l.map)(()=>O))))});return!c.length&&n?.collectionLoadType===es.Reload&&this.attributes[e].clear(),c.length===0?(0,u.of)(null):(0,u.forkJoin)([...c]).pipe((0,l.tap)(d=>{const p=this.getBoundDataSourceName(e);this.getModelByName(p)?.childrenChange(),this._executeWithOptions(()=>{n?.collectionLoadType===es.Reload||!n?.collectionLoadType?this.attributes[e].reload(d):this.getBoundDataSchema(e)?this._mergeCollectionModels(e,d):this.attributes[e].push(...d)},n)}))}_setSubmodelValues(e,t,n){return(0,u.forkJoin)([...e.filter(s=>t?.[s]).map(s=>this.attributes[s]instanceof on?this._setSingleSubmodelValue(s,t,n):this._setCollectionSubmodelValue(s,t,n)),(0,u.of)(this)])}_findAttributePathInDataSourceNameMap(e){for(const t of this._attributesToDataSourceNameMap.keys()){const n=t.indexOf(".");if(n<0)continue;const s=n+1,a=e.length;if(t.startsWith(e,s)&&(t.length===s+a||t.charAt(s+a)==="."))return t}}_getBoundDataSourceAttributeControls(e){return Object.fromEntries(Array.from(this._attributesToDataSourceNameMap.entries()).filter(([t,n])=>n===e).map(([t])=>[t,this.getAttributeControl(t)]))}_resetMaskDataForAttribute(e){this[Vh](e)&&(this.setAttributePropertyValue(e,hl,null),this.setAttributePropertyValue(e,zc,null),this.setAttributePropertyValue(e,Hc,null))}showLoadMaskAndValidateFields(e){this.maskService.showMask(this.saveModelTaskName,this);const t=this._getBoundDataSourceAttributeControls(e);Object.keys(t).forEach(n=>this.formApiModel.controls[n].updateValueAndValidity())}deleteModel(e,t,n,s){return(0,u.from)(this._modelParametersBuilder.getModelParameters(this,t,s?.payload)).pipe((0,l.switchMap)(a=>n(e,a)))}handleSaveModelStream(e,t){return e.pipe((0,l.finalize)(()=>this.maskService.hideMask(this.saveModelTaskName,this)),(0,l.catchError)(n=>{const s=typeof n=="string"?n:n?.message||n?.errorInfo;return t?.silent===!0?(0,u.of)({success:!1,rowsAffected:0,errorInfo:s}):(0,u.throwError)(()=>new Error(s))}))}_updateLastLoadParameters(e,t,n,s){const a=t===U.Create||t===U.Copy,o=this.dataSchemas[e],c=o.dataSourceConfig?.type===ol.EntityDataSource;if(s.success&&a&&c){const d=o.primaryAttributeName,p=n[d];this._loadedDataSources.add(e),this._lastEventLoadParameters.set(e,[{type:ce.PrimaryColumnValue,value:p}])}}getSaveParameters(e,t){return(0,u.forkJoin)({parameters:this._modelParametersBuilder.getModelParameters(this,t),dto:this._getDataSourceDto(e)})}getSaveModelStream$(e){return this.showLoadMaskAndValidateFields(e.dataSourceName),(0,u.from)(this.isValid(e.dataSourceName)).pipe((0,l.switchMap)(t=>{if(!t){const n=this.injector.get(m.TranslateService);return e.getInvalidAction({success:!1,rowsAffected:0,errorInfo:n.instant("HomePage.DialogMessages.RequiredFieldsAreNotFilled")})}return this.getSaveParameters(e.dataSourceName,e.parametersConfig).pipe((0,l.mergeMap)(({parameters:n,dto:s})=>(0,u.forkJoin)({result:e.saveAction(s,n),dto:(0,u.of)(s)})),(0,l.tap)(({result:n,dto:s})=>e.onSavedAction(s,n)),(0,l.map)(({result:n})=>n))}))}_checkDataSourceName(e){if(!e)throw new Error("Data source name is not provided")}innerSave(e,t,n){return(0,u.from)(this.waitAsyncTasksFinish()).pipe((0,l.switchMap)(()=>(this._checkDataSourceName(n),this.getModelMode(n)===U.Delete?t():e())))}initDependencies(){this.formBuilder=this.injector.get(Z.FormBuilder),this.resourceFinderService=this.injector.get(Hn),this.validatorTypeResolver=this.injector.get(jh),this.maskService=this.injector.get(Jf),this.sysSettingsService=this.injector.get(Zn),this.crtControlStateAdapter=this.injector.get(ss),this._businessRulesEngine=this.injector.get(Wr),this._businessRulesApplier=this.injector.get($r),this._featureValues=this.injector.get(fe),this._modelGenerator=this.injector.get(pu),this._ngZone=this.injector.get(i.NgZone),this._translateService=this.injector.get(m.TranslateService),this._scopeName=this.injector.get(jo,null),this._attributeGenerator=this.injector.get(Qr),this._attributeResourceGenerator=this.injector.get(Xr),this._crtZoneService=this.injector.get(Uc),this._viewEventZoneName=this.injector.get(ef,qn.Root),this._modelParametersBuilder=this.injector.get(Ta),this._context=this.injector.get(tf,null),this._crtInjectionContextService=this.injector.get(ns),this._viewModelDataDelayerService=this.injector.get(my,null),this._isDesignTime=this.injector.get(Wn,null),this._measurePerformanceService=this.injector.get(et,null),this._measurePerformancePageLoadService=this.injector.get(Zr),this._appInfo=this.injector.get(Xe,null)}processRequest(e){return this.handlerChain.process(e)}runInitFlow(e=null){return this._concatModelsWithEmbedded(e).pipe(this._measurePerformanceService.measure$(`ViewModel.runInitFlow.${this._injectionContext?.id}.parent.${!!this.parent}`),(0,l.tap)(t=>this._notifyAboutModelsErrors(t)),(0,l.tap)(t=>this._models$.next(t)),(0,l.tap)(()=>this._initFeaturesStates()),(0,l.mergeMap)(()=>this._generateDataSourcesInfo()),(0,l.tap)(t=>this._updateModels(t)),(0,l.mergeMap)(t=>this._generateAttributesToDataSourceNameMap(t)),(0,l.mergeMap)(t=>this._getDataSchemas()),(0,l.tap)(t=>this.dataSchemas=t),(0,l.mergeMap)(()=>this._initDataSourceValidators()),(0,l.switchMap)(()=>this._initBusinessRules()),(0,l.tap)(()=>{this._initSchemaValidators(this.viewModelConfig.attributes)}),(0,l.mergeMap)(()=>(0,u.forkJoin)([...this._generateResourceAttribute(),this._initSystemAttributes(),this._attributeGenerate(this.viewModelConfig.attributes),(0,u.of)(this),this._initSubscriptions()])),(0,l.mergeMap)(()=>this._generatePrimaryAttributes()),(0,l.tap)(()=>this._loadDefaultSorting()),(0,l.mergeMap)(()=>this._runInitialBusinessRules()),(0,l.tap)(()=>this._viewModelAttributeChangeEventOptions.reset())).pipe((0,l.switchMap)(()=>(0,u.of)(this)))}[Vh](e){return this._attributeConfigs[e]?.isValueMasked??!1}[r_](e){return this.getAttributePropertyValue(e,zc)}[a_](e){return this.getAttributePropertyValue(e,Hc)}[o_](e,t){this.setAttributePropertyValue(e,hl,t)}[l_](e){return this.getAttributePropertyValue(e,hl)||Wc.Unmasked}init(e,t){return this._primaryModelName=t?.primaryModelName,this._modelDependencies=t?.modelDependencies||{},this._modelsLoadingConfig=t?.modelsLoadingConfig||{},this._lastEventLoadParameters=new Map,t?.businessRulesActive||this.deactivateBusinessRules(),this._modelDependencies&&this._handleCircularDependencies(),this._ngZone.runOutsideAngular(()=>this.runInitFlow(e))}setValue(e,t){const n=[],s=[];for(const a of Object.keys(this._attributeConfigs))"viewModelConfig"in this._attributeConfigs[a]||"viewModelName"in this._attributeConfigs[a]?s.push(a):n.push(a);return this._executeWithOptions(()=>{this._measurePerformanceService.measure(`ViewModel.setValue.updateViewModelModelAttributes.${this._injectionContext?.id}.parent.${!!this.parent}.data.${Object.keys(e).toString()}`,()=>{for(const a in e)n.includes(a)&&(this._resetMaskDataForAttribute(a),this.set(a,e[a],{isMaskedValue:t?.isMaskedValue}))})},t),Kr.deferUpdatingValueAndValidity(this,()=>this._setSubmodelValues(s,e,t),this._featureValues)}deactivateBusinessRules(){this._businessRulesActive=!1}activateBusinessRules(){const e=this._businessRulesActive;if(this._businessRulesActive=!0,e)return(0,u.of)(null);const t=this.models.filter(n=>n.isLoaded);if(t.length>0){const n={type:ve.ContextReady,name:null,scopeId:""};return(0,u.forkJoin)(t.map(s=>this._runBusinessRulesForModel(s,[],!0,[n]))).pipe((0,l.tap)(()=>this._businessRulesAreActivated=this._businessRulesProcessingEnabled),(0,l.tap)(()=>this._businessRulesActivated$.next(this._businessRulesAreActivated)))}}_getDependOnModelsNames(e){const t=this._modelDependencies[e];if(!t)return[];const n=t.map(s=>s.relationPath.split(".")[0]);return[...new Set(n)]}_getModelDependencies(e){return this._modelDependencies[e]??[]}_getIsAffectedByBusinessRules(e){if(!this._businessRulesProcessingEnabled)return Promise.resolve(!1);const t=e.name,n=this._attributesAffectedByBusinessRules;if(n.length===0||!t)return Promise.resolve(!1);const s=n.some(d=>d.name===t),a=this.getBoundDataSchemaByAttributePath(t),o=this.getBoundDataSchemaAttributeByAttributePath(t);if(!o)return Promise.resolve(s);const c=n.filter(d=>d.scopeName===a.name).some(d=>d.name===o.name);return Promise.resolve(c||s)}executeRequest(e){return e.scopes=e.scopes||this._eventScopes,this._crtZoneService.runInZone(this._viewEventZoneName,()=>this.processRequest(e))}getAttributeControl(e){let t=this.formApiModel;Ar(this,e).then(M.noop);for(const n of e.split("."))t=t.get(n);return t??new Z.FormControl}loadLookupList(e,t=[],n){const s=e.control,a=e.items,o=this._getDataSourceInfoByViewModelAttributePath(a);if(o){const c=this._ngZone.runOutsideAngular(()=>this.processRequest({type:"crt.LoadDataRequest",$context:this,dataSourceName:o.name,parameters:t,config:{payload:n}}));Promise.resolve(c)}else{const c=this._getDataSourceInfoByViewModelAttributePath(s);if(c){const d=c.getDataSourceAttributePath(s);(0,u.forkJoin)([this._getDropdownPageSize(),this._modelParametersBuilder.getModelParameters(this,t,n)]).pipe((0,l.mergeMap)(([p,C])=>this.getModelByName(c.name).loadLookupList(d,C,p)),(0,l.map)(p=>an.getLookupListDataSourceInfo(a,{value:p.primaryAttributeName,displayValue:p.primaryDisplayAttributeName}).getModelDto(p.data)),(0,l.mergeMap)(p=>this.setValue(p,{silent:!0}))).subscribe()}}}load(...e){const t=this._disableViewModelLoadUnblockingThread?(0,u.of)(null):(0,u.timer)(0,u.asyncScheduler);if(typeof e[0]=="string"){const s=e[0],a=e[1],o=e[2];this._checkDataSourceName(s);const c=this._getDataSourceLoadType(o?.loadType);return t.pipe((0,l.switchMap)(()=>this._loadStaticModel(s,a,c,o?.payload,o?.useLastLoadParameters,o?.doNotUpdateLastLoadParameters).pipe(this._measurePerformanceService.measure$(`ViewModel.loadStaticModel.${this._injectionContext?.id}.parent.${!!this.parent}.datasourceName.${s}`))))}const n=e[0];return t.pipe((0,l.switchMap)(()=>this._loadDynamicModel(n).pipe(this._measurePerformanceService.measure$(`ViewModel.loadDynamicModel.${this._injectionContext?.id}.parent.${!!this.parent}.model.${n.dataSourceName}`))))}setSorting(e,t){const s=this._dataSourcesInfos.get(e).getSortingConfig(),a=s&&s.attributeName;return a&&(this[a]=t),(0,u.of)(null)}create(e,t){return this._checkDataSourceName(e),this._createModelData(e,t)}copy(e,t,n){return this._checkDataSourceName(e),this._copyModelData(e,t,n)}loadDefaultValues(e){return this._setAttributesDefaultValues(e)}save(e,t,n){return this.innerSave(()=>this._saveModel(e,t,n),()=>this.delete(e,t,n),e)}delete(e,t,n){return this._checkDataSourceName(e),this.deleteModel(e,t,(s,a)=>this.getModelByName(s).delete(a),n)}resume(){return(0,u.of)(void 0)}pause(){return(0,u.of)(void 0)}destroy(){this._subscriptions.unsubscribe(),Array.from(this._collectionSubscription.values()).forEach(t=>t.unsubscribe()),this._collectionSubscription.clear(),this._crtControls.forEach(t=>{t.destroy()}),this.models?.forEach(t=>t.destroy()),this._crtControls.clear(),this._eventsSubject$.complete(),this._replayEvents$.complete(),this._modelLoaded$.complete();const e=[];for(const t of Object.values(this.attributes))t instanceof on&&e.push(t.destroy()),t instanceof tt&&e.push((0,u.from)(t.destroy()));return(0,u.forkJoin)(e).pipe((0,l.defaultIfEmpty)(void 0),(0,l.map)(()=>{}),(0,l.finalize)(()=>{this.parent||(this._crtInjectionContextService.removeContext(this._injectionContext?.id),ff(this._injectionContext),this._context=null,this._viewModelDataDelayerService?.destroy(),this._viewModelDataDelayerService=null),this._asyncTasksExecutingSubject.complete(),this._dataSourcesInfos.clear(),this.__destroyed=!0,this._destroySubject.next(),this._destroySubject.complete()}))}getBoundDataSourceName(e){const t=this.getBoundDataSourceNameByAttributePath(e);if(t!==null)return t;if(!e)return null;const n=this._findAttributePathInDataSourceNameMap(e);return this.getBoundDataSourceNameByAttributePath(n)}getBoundDataSourceAttributeControls(e){return Object.values(this._getBoundDataSourceAttributeControls(e))}getBoundDataSourceNameByAttributePath(e){return this._attributesToDataSourceNameMap.get(e)??null}getBoundDataSchema(e){return this.dataSchemas[this.getBoundDataSourceName(e)]}getBoundDataSchemaByAttributePath(e){return this.dataSchemas[this.getBoundDataSourceNameByAttributePath(e)]??null}getBoundDataSchemaAttributeByAttributePath(e){const t=this.getBoundDataSourceNameByAttributePath(e),n=this.getBoundDataSchemaByAttributePath(e);if(!t||!n)return null;const a=this._getDataSourceInfoByViewModelAttributePath(e).getDataSourceAttributePath(e);return n.findAttributeByName(a)}getPrimaryModelName(){return Promise.resolve(this._primaryModelName)}getPrimaryDataSchema(){return this.getPrimaryModelName().then(e=>this.dataSchemas[e])}isValid(e){const t=this._waitAsyncValidation().pipe((0,l.map)(()=>e?this.getBoundDataSourceAttributeControls(e).every(n=>!n.invalid):this.formApiModel.valid));return(0,u.lastValueFrom)(t)}validate(e){return this._ngZone.run(()=>e?this._validateByDataSourceName(e):this._validateAll())}getViewModelAttributePath(e,t){const n=this._dataSourcesInfos.get(e);return this._getMappedAttributeName(n,t)}getViewModelAttributePaths(e,t){return this._dataSourcesInfos.get(e)?.getMappedAttributeNames(t)}getCollectionViewModelAttributePath(e){return this._dataSourcesInfos.get(e)?.collectionViewModelAttributeName}canDelete(e,t){var n=this;return(0,f.A)(function*(){return n.getModelByName(e).canDelete(t)})()}canSave(e,t){var n=this;return(0,f.A)(function*(){return n.getModelByName(e).canSave(t)})()}enableAttributeValidator(e,t){this.getControl(e).enableValidator(t)}disableAttributeValidator(e,t){this.getControl(e).disableValidator(t)}_hotSwap(e){return this._measurePerformanceService.measure(`ViewModel.generatePrimaryAttributes.${this._injectionContext?.id}.parent.${!!this.parent}.hotSwap`,()=>{const t=e?.attributes?.changed||[],n=(0,M.isEmpty)(e.resources?.strings);if((0,M.isEmpty)(t)&&n)return(0,u.of)(!1);n||(this.resources={strings:this._getChangedResourcesStrings(e.resources.strings)}),this.viewModelConfig=e.actualViewModelConfig;const s=an.getFromViewModelConfig(this.viewModelConfig),a=Object.fromEntries(t.map(I=>[I,this.viewModelConfig.attributes[I]])),o=e?.models?.changed??[],c=o.map(I=>I.name),d=this.models.filter(I=>I.isLoaded||I.isLoading).filter(I=>c.includes(I.name)).map(I=>I.name),p=o.map(I=>{const O=s.get(I.name);return this._upsertModel(I.name,I),this._replaceDataSourceInfo(I.name,O),this._addDataSchemaToDataSchemas(I)}),C=this._attributeGenerate$(a,{disableDefaultConfig:!0});return(0,u.forkJoin)([...p,C]).pipe(this._measurePerformanceService.measure$(`ViewModel.generatePrimaryAttributes.${this._injectionContext?.id}.parent.${!!this.parent}.hotSwap.forkJoin`),(0,l.switchMap)(()=>this._reGenerateResourcesAttributes()),(0,l.tap)(()=>this._loadDefaultSorting(c)),(0,l.tap)(()=>this._requestReloadModels(d)),(0,l.map)(()=>!0))})}set(e,t,n){return this._setAttributeValue(e,t,n),Promise.resolve()}_markAsPristine(e){this._forEachControl(e,t=>{t.markAsPristine()})}getAttributeNameByViewItemName(e){return Object.keys(this._attributeConfigs).find(t=>this._attributeConfigs[t].viewItemName===e)}getControl(e){return this._crtControls.has(e)?this._crtControls.get(e):dl.create({name:e,value:null,propertiesConfig:[],featureValues:this._featureValues})}getAttributePropertyValue(...e){let t,n;if(e.length===2)t=e[0],n=e[1];else if(e.length===1){const a=e[0].split(":");t=a[0],n=a[1]}else throw new Error("ArgumentException");return this.getControl(t).getPropertyValue(n)}setAttributePropertyValue(...e){let t,n,s;if(e.length===3)t=e[0],n=e[1],s=e[2];else if(e.length===2){const o=e[0].split(":");t=o[0],n=o[1],s=e[1]}else throw new Error("ArgumentException");return this.getControl(t).setPropertyValue(n,s)}resetAttributePropertyValue(...e){let t,n;if(e.length===1)[t,n]=e[0].split(":");else if(e.length===2)t=e[0],n=e[1];else throw new Error("ArgumentException");this.getControl(t).getPropertyByName(n)?.resetValue()}getInvariabilityPropertyName(e){return this.getControl(e).getInvariabilityPropertyName()}setModelValues(e,t){return this.getModelByName(e).setValue(t)}_getBoundAttributesNames(e){const t=this.getBoundDataSourceNameByAttributePath(e);if(!t)return null;const n=this._dataSourcesInfos.get(t),s=n.attributesMap.get(e);return Array.from(n.attributesMap.entries()).filter(([a,o])=>o===s&&a!==e).map(([a])=>a)}_getAttributeDataValueTypeName(e){return this._attributeConfigs[e].dataValueTypeName}getDataSourceLoadParameters(e,t){const n=this._dataSourcesInfos.get(e);return n?this._modelParametersBuilder.getModelLoadParameters(this,n,[],Oe.Load,{modelLoadConfiguration:t}).then(([s,a,o])=>({parameters:s,options:{pagingConfig:a,sortingConfig:o}})):null}getAttributeViewModelConfig(e){return this._attributeConfigs[e]?.viewModelConfig?.attributes}isDataSourceForCollection(e){return!!this._dataSourcesInfos.get(e)?.isCollection}_getDataSourceAttributeDataValueType(e){const t=this._getDataSourceInfoByViewModelAttributePath(e);let n=null;if(t){const s=t.getDataSourceAttributePath(e);s&&(n=this._getDataSourceAttributeSchema(t,s)?.dataValueType)}return n}_getModelNamesByLoadType(e){return Object.entries(this._modelsLoadingConfig).filter(([t,n])=>n.type===e).map(([t,n])=>t)}_reloadDependentModels(e,t=[],n=null){const s=this._getDependentModelsForLoad(e,t);this._requestReloadModels(s.filter(a=>{const o=Jn(this.getModelByName(a));return!n||o&&n===Vt.Page||!o&&n===Vt.ViewElement}))}_getDependentModelsForLoad(e,t=[]){const n=this._getDependentModelsNames(e.name,t),s=this._getChangedModelsNames(n).filter(a=>!Jn(this.getModelByName(a)));return s.length!==0&&this._showNotification({message:"BaseViewModel.RefreshModelDataConflict"}),n.filter(a=>!s.includes(a)).filter(a=>this._modelsRequestedToLoad.has(a)||Jn(this.getModelByName(a)))}_getDataSourceAttributeCaption(e,t){let n=this.resourceFinderService.findLocalizableValue(t);const s=this._getDataSourceInfoByViewModelAttributePath(e);if(n==null&&s){const a=s.getDataSourceAttributePath(e),o=a?this._getDataSourceAttributeSchema(s,a):"";n=o?o.caption:this._translateService.instant("BaseViewModel.DataSourceAttributeRemoved")}return n}getIsDirty(e){return this.getControl(e).isDirty}getModelByName(e){return this._modelsMap.get(e)}getModelMode(e){return this.getModelByName(e)?.mode}getPrimaryModelMode(){return this.getModelMode(this._primaryModelName)}_getModelModeChanges(e){return this.getModelByName(e)?._modeChanges$}_getPrimaryModelModeChanges(){return this._getModelModeChanges(this._primaryModelName)}markModelFor(e,t){this.getModelByName(e)?.markFor(t)}markPrimaryModelFor(e){this.markModelFor(this._primaryModelName,e)}_setStateAttribute(e){this._setSystemAttributeValue(gl,e)}_onAsyncTaskStarted(e){if(this._disableViewModelWaitingForAsyncTasks)return;const t=this._asyncTasksExecutingSubject.value;t.add(e),this._asyncTasksExecutingSubject.next(t)}_onAsyncTaskFinished(e){if(this._disableViewModelWaitingForAsyncTasks)return;const t=this._asyncTasksExecutingSubject.value;t.delete(e),this._asyncTasksExecutingSubject.next(t)}waitAsyncTasksFinish(){let e;return(0,u.firstValueFrom)(this._asyncTasksExecutingSubject.pipe((0,l.tap)(t=>{clearTimeout(e),e=this._handleAsyncTasksCycle(t)}),(0,l.filter)(t=>t.size===0),(0,l.take)(1),(0,l.map)(()=>{})))}destroyModel(e){const t=this.getModelByName(e);t&&t.destroy();const n=this.models.filter(s=>s.name!==e);this._models$.next(n),this._dataSourcesInfos.delete(e),[...this._attributesToDataSourceNameMap.entries()].filter(([s,a])=>e===a).forEach(([s])=>this._attributesToDataSourceNameMap.delete(s))}}class Tn extends Ot{_getViewModelCollectionValue(e,t){if(!t.length)return Promise.resolve(e);const n=Array.from(e).map(s=>this._getObjectProp(s,t));return Promise.all(n)}_getObjectProp(e,t){var n=this;return(0,f.A)(function*(){const s=t.shift();return s?(e=yield e[s],e instanceof on?n._getObjectProp(e,t):e instanceof tt?n._getViewModelCollectionValue(e,t):n._getObjectProp(e,t)):e})()}evaluate(e,t){const n=e.slice(1);return lc(n,t).pipe((0,l.map)(s=>s??{context:Nr(t),contextPath:""}),(0,l.switchMap)(s=>(0,u.combineLatest)([s.context.viewModel$,(0,u.of)(dc(s.contextPath,n))])),(0,l.switchMap)(([s,a])=>s?this._getObjectProp(s,a.split(".")):(0,u.of)(null)),(0,l.take)(1))}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=i.\u0275\u0275getInheritedFactory(Tn)))(n||Tn)}})()}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Tn,factory:Tn.\u0275fac})}}class hs{_getStringValue(e){return e.match(/^'(.*)'$/)[1]}_getBooleanValue(e){if(e==="true")return!0;if(e==="false")return!1;throw new Error(`${e} is not Boolean value`)}evaluate(e){if(Ud(e))return(0,u.of)(this._getStringValue(e));if(zd(e))return(0,u.of)(parseFloat(e));if(Hd(e))return(0,u.of)(this._getBooleanValue(e));throw new Error(`Failed to parse primitive value binding expression: ${e}`)}static{this.\u0275fac=function(t){return new(t||hs)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:hs,factory:hs.\u0275fac})}}class An extends Pr{constructor(e,t,n,s=!1){super(),this._convertersRegistry=e,this._objectPropBindingExpressionInterpreter=t,this._fixedValueBindingExpressionInterpreter=n,this._isDesignTime=s}_evaluateParam(e,t){if(lf(e))return this._fixedValueBindingExpressionInterpreter.evaluate(e);if(vt(e))return this._objectPropBindingExpressionInterpreter.evaluate(e,t);throw new Error(`Cannot parse parameter expression: ${e}`)}_evaluateParams(e,t){const n=e.map(s=>this._evaluateParam(s,t).pipe((0,l.first)()));return(0,u.forkJoin)(n).pipe((0,l.defaultIfEmpty)([]))}_getConverters(e,t){return e.split("|").map(s=>s.trim()).map(s=>{const[a,...o]=s.split(":").map(p=>p.trim()),c=this._evaluateParams(o,t),d=t.viewModel$.pipe((0,l.first)());return(0,u.forkJoin)([d,c]).pipe((0,l.map)(([p,C])=>I=>{if(!p)return null;const O=p._injectionContext;return this._convertersRegistry.get(a,O).convert(I,p,...C)}))})}_applyConverters(e,t){for(const[n,s]of Object.entries(t))if(e=s(e),e instanceof Promise){const a=parseInt(n,10)+1;return this._applyAsyncConverters(e,[...t].slice(a))}return e}_applyAsyncConverters(e,t){return(0,f.A)(function*(){let n=yield e;for(const s of t)n=s(n),n instanceof Promise&&(n=yield n);return n})()}evaluate(e,t){if(this._isDesignTime||(0,M.isEmpty)(e))return(0,u.of)(s=>s);const n=this._getConverters(e,t);return(0,u.forkJoin)(n).pipe((0,l.map)(s=>a=>this._applyConverters(a,s)))}static{this.\u0275fac=function(t){return new(t||An)(i.\u0275\u0275inject(Or),i.\u0275\u0275inject(Tn),i.\u0275\u0275inject(hs),i.\u0275\u0275inject(Wn,8))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:An,factory:An.\u0275fac})}}class oi{constructor(e,t,n,s){this._attributeBindingExpressionInterpreter=e,this._attributePropertyBindingExpressionInterpreter=t,this._resourceBindingExpressionInterpreter=n,this._converterExpressionInterpreter=s}_applyConverter(e,t){return(0,f.A)(function*(){return e=t(e),e instanceof Promise&&(e=yield e),e})()}evaluateInputValueExpression(e,t){return Fd(e)?this._resourceBindingExpressionInterpreter.evaluate(e,t):Bd(e)?this._attributePropertyBindingExpressionInterpreter.evaluate(e,t):this._attributeBindingExpressionInterpreter.evaluate(e,t)}evaluate(e,t){const n=/\|(.*)/,[s,a]=e.split(n).map(d=>d.trim()),o=this.evaluateInputValueExpression(s,t),c=this._converterExpressionInterpreter.evaluate(a,t);return o.pipe((0,l.switchMap)(d=>c.pipe((0,l.switchMap)(p=>this._applyConverter(d,p)))))}static{this.\u0275fac=function(t){return new(t||oi)(i.\u0275\u0275inject(Ot),i.\u0275\u0275inject(Zi),i.\u0275\u0275inject(Yi),i.\u0275\u0275inject(An))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:oi,factory:oi.\u0275fac})}}class ps extends oi{constructor(e,t){super(null,null,null,t),this._objectPropBindingExpressionInterpreter=e}_evaluateEventBindingExpression(e,t){const n=t.initialEvent,s=e.replace(/@event\.?/,"");return(0,u.of)(s?(0,M.get)(n,s):n)}evaluateInputValueExpression(e,t){return cc(e)?this._evaluateEventBindingExpression(e,t):this._objectPropBindingExpressionInterpreter.evaluate(e,t)}static{this.\u0275fac=function(t){return new(t||ps)(i.\u0275\u0275inject(Tn),i.\u0275\u0275inject(An))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:ps,factory:ps.\u0275fac})}}class ms{constructor(e){this._requestParamBindingExpressionInterceptor=e}_evaluate(e,t){var n=this;return(0,f.A)(function*(){const s={};for(const[a,o]of Object.entries(e))s[a]=yield n._evaluateConfigValue(o,t);return s})()}_evaluateConfigValue(e,t){return Array.isArray(e)?Promise.all(e.map(n=>this._evaluateConfigValue(n,t))):vt(e)||cc(e)?(0,u.lastValueFrom)(this._requestParamBindingExpressionInterceptor.evaluate(e,t),{defaultValue:null}):e&&typeof e=="object"?this._evaluate(e,t):Promise.resolve(e)}evaluate(e,t){return(0,u.from)(this._evaluate(e,t))}static{this.\u0275fac=function(t){return new(t||ms)(i.\u0275\u0275inject(ps))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:ms,factory:ms.\u0275fac})}}class gs{constructor(e){this._requestParamsBindingConfigInterpreter=e}_evaluateParams(e,t){return e?this._requestParamsBindingConfigInterpreter.evaluate(e,t):(0,u.of)({})}_getRequestBindingContext(e,t){return e.useRelativeContext?t:Nr(t)}evaluate(e,t){return this._evaluateParams(e.params,t).pipe((0,l.withLatestFrom)(this._getRequestBindingContext(e,t).viewModel$),(0,l.map)(([n,s])=>({type:e.request,$context:s,...n})),(0,l.first)())}static{this.\u0275fac=function(t){return new(t||gs)(i.\u0275\u0275inject(ms))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:gs,factory:gs.\u0275fac})}}class li extends Ot{_getValidationStateChanges(e,t){const n=t.attributeHost.getAttributeControl(t.attributeName);return(0,u.merge)(e,n.statusChanges).pipe((0,l.map)(()=>({value:n.value,validationInfo:(0,M.pick)(n,"valid","errors","dirty","touched")})),(0,l.distinctUntilChanged)(M.isEqual))}evaluate(e,t){const n=e.slice(1);return this.getAttributeLocationChanges(n,t).pipe((0,l.switchMap)(s=>s.attributeHost?this._getValidationStateChanges(super.evaluate(e,t),s):(0,u.of)({value:null,validationInfo:{valid:!0,errors:null,dirty:!1,touched:!1}})))}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=i.\u0275\u0275getInheritedFactory(li)))(n||li)}})()}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:li,factory:li.\u0275fac})}}const cp=[Ot,Zi,Gn,oi,An,Tn,hs,gs,ps,ms,Yi,li,T.gX.create({token:Xg,mappings:[{predicate:"converter",injectable:An}]})],vl=new i.InjectionToken("CRT_BINDING_CONTEXT"),up=new i.InjectionToken("CRT_BINDING_CONTEXT_DESIGN_TIME"),_y=r=>({viewModel$:r.viewModel$,parent:r.parent}),yy=(r,e)=>{const t=new u.ReplaySubject(1);return t.next(null),(r.viewModel$??e?.viewModel$)?.subscribe(t),{viewModel$:t.asObservable(),parent:r.viewModel$?e:e?.parent,viewModelSubject:t}};class ci{set viewModel(e){(e instanceof on||e===void 0||e===null)&&(this.viewModel$?this.viewModel$.next(e):(this.viewModel$=new u.ReplaySubject(1),this.viewModel$.next(e)))}ngOnDestroy(){this.viewModel=null,this.viewModel$?.complete()}static{this.\u0275fac=function(t){return new(t||ci)}}static{this.\u0275dir=i.\u0275\u0275defineDirective({type:ci,selectors:[["","crtViewModel",""]],inputs:{viewModel:[i.\u0275\u0275InputFlags.None,"crtViewModel","viewModel"]},features:[i.\u0275\u0275ProvidersFeature([{provide:vl,useFactory:_y,deps:[[new i.Inject(up),new i.Self]],multi:!1},{provide:up,useFactory:yy,deps:[(0,i.forwardRef)(()=>ci),[new i.Inject(vl),new i.SkipSelf,new i.Optional]],multi:!1}])]})}}class Cy{static{this._addItemListeners=[]}static{this._removeItemListeners=[]}static{this._requestHandlersMap=new Map}static{this._handlersByRequestMap=new Map}static get requestHandlersMap(){return this._requestHandlersMap}static get handlersByRequestMap(){return this._handlersByRequestMap}static onAddRequestHandler(e){return this._addItemListeners.push(e),()=>{this._addItemListeners.splice(this._addItemListeners.indexOf(e),1)}}static onRemoveRequestHandler(e){return this._removeItemListeners.push(e),()=>{this._removeItemListeners.splice(this._removeItemListeners.indexOf(e),1)}}static addRequestHandler(e,t){const n=this._requestHandlersMap.get(e);if(n&&(!n.instanceConfig?.lazy||n.instanceType))return;const s={instanceType:t.instanceType,instanceConfig:{...n?.instanceConfig??{},...t.instanceConfig}};this._requestHandlersMap.set(e,s);for(const c of this._addItemListeners)c(e,s);const a=t.instanceConfig.requestType;let o=this._handlersByRequestMap.get(a);o||(o=new Map,this._handlersByRequestMap.set(a,o)),o.set(e,s)}static removeRequestHandler(e){const t=this._requestHandlersMap.get(e);if(!t)return;this._requestHandlersMap.delete(e);for(const a of this._removeItemListeners)a(e,t);const n=t.instanceConfig.requestType,s=this._handlersByRequestMap.get(n);s&&s.delete(e)}static clear(){for(const e of this._requestHandlersMap.keys())this.removeRequestHandler(e)}}const Aa=window;Aa.creatio??={},Aa.creatio.requestHandlerRegistry||Object.defineProperty(Aa.creatio,"requestHandlerRegistry",{get:()=>Cy,configurable:!1});const by=Aa.creatio.requestHandlerRegistry;class gu{static{this._internalRegistry=Aa.creatio.requestHandlerRegistry}static find(e){return gu._internalRegistry.requestHandlersMap.get(e)}static register(e,t){const n=e.requestType,s=e.type;if(!n)throw new Error(`Error when register ${s}. Request type not specified.`);const a={instanceType:t,instanceConfig:e};gu._internalRegistry.addRequestHandler(s,a)}}class nM{}const Sy="ValidatorRegistry";class Il extends Rr{static{this.registryKey=Sy}static _hasWithAnotherTypeRef(e,t){const n=Il.items.get(e);return!n||n.lazy&&!n.typeRef?!1:n.typeRef!==t}static validate(e){if(bn(e.type,"ValidatorTypeName"),e.typeRef&&Il._hasWithAnotherTypeRef(e.type,e.typeRef))throw new Error(`Error when register ${e.type}. Element with this type has already exist`)}static get items(){return this.store.typeInfos}static register(e){const t=this.items.get(e.type);this.items.set(e.type,{...t??{},...e})}}const My="InterfaceDesignerItemRegistry";class vy extends Rr{static get _interfaceDesignerItemRegistrationInfos(){return this.store.typeInfos}static validate(e){bn(e.type,"InterfaceDesignerItemTypeName"),Bo(e.type),Yd(e.type,e,this._interfaceDesignerItemRegistrationInfos)}static register(e,t){if(typeof e=="string"&&t)this._interfaceDesignerItemRegistrationInfos.set(e,t);else if(typeof e!="string")this._interfaceDesignerItemRegistrationInfos.set(e.type,e);else throw new Error("Invalid arguments provided to register method.")}static get(e){return this._interfaceDesignerItemRegistrationInfos.get(e)}static has(e){return this._interfaceDesignerItemRegistrationInfos.has(e)}static getAll(){return this._interfaceDesignerItemRegistrationInfos}static values(){return[...this._interfaceDesignerItemRegistrationInfos.values()]}static clear(){this._interfaceDesignerItemRegistrationInfos.clear()}}class Iy extends vy{static{this.registryKey=My}}class Da{constructor(){this.registry=Iy}get(e){return this.registry.get(e)}register(e,t){this.registry.register(e,t)}getAll(){return this.registry.getAll()}has(e){return this.registry.has(e)}values(){return this.registry.values()}clear(){this.registry.clear()}static{this.\u0275fac=function(t){return new(t||Da)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Da,factory:Da.\u0275fac})}}class wy extends Rr{static validate(e){bn(e.type,"ViewElementTypeName");const t=this.viewElements.get(e.type);t?.lazy&&!("selector"in t)&&!t.typeRef||Yd(e.type,e,this.viewElements)}static get viewElements(){return this.store.typeInfos}static register(e){const t=this.viewElements.get(e.type);this.viewElements.set(e.type,{...t??{},...e})}static getFormControlRelatesAttribute(e){const t=this.store.typeInfos.get(e);return t&&"formControlConfig"in t&&t.formControlConfig?.relatesTo||null}static getViewElementInputs(e){return this.store.typeInfos.get(e)?.inputs??{}}static getViewElementOutputs(e){return this.store.typeInfos.get(e)?.outputs??{}}static getViewElementPropertiesDefaultValues(e){const t=this.store.typeInfos.get(e);return[...Object.entries(t?.inputs??{}).filter(([s,a])=>Object.prototype.hasOwnProperty.call(a,"defaultValue")).map(([s,a])=>({name:s,defaultValue:a.defaultValue})),{name:"visible",defaultValue:!0}]}static getViewElementCompatiblePlatformAPIsOptions(e,t){return this.store.typeInfos.get(e)?.compatibleAPIs?.[t]??{}}static isViewElementAvailableByCompatibleAPIs(e,...t){const n=this.store.typeInfos.get(e);return Object.entries(n?.compatibleAPIs??{}).filter(([s,a])=>t.includes(s)).some(([s,a])=>typeof a=="boolean"?a:(a||{}).enable)}}const Ey="ViewElementRegistry";class wl extends wy{static{this.registryKey=Ey}}class xy{canResolve(e){return this.registry.viewElements.has(e)}getViewElementRegistryItem(e){return this.registry.viewElements.get(e)}isViewElementAvailableByCompatibleAPIs(e,...t){return this.registry.isViewElementAvailableByCompatibleAPIs(e,...t)}getViewElementCompatiblePlatformAPIsOptions(e,t){return this.registry.getViewElementCompatiblePlatformAPIsOptions(e,t)}getFormControlRelatesAttribute(e){return this.registry.getFormControlRelatesAttribute(e)}getViewElementInputs(e){return this.registry.getViewElementInputs(e)}getViewElementOutputs(e){return this.registry.getViewElementOutputs(e)}getViewElementPropertiesDefaultValues(e){return this.registry.getViewElementPropertiesDefaultValues(e)}getViewElementType(e){const t=this.getViewElementRegistryItem(e.type);return this.getViewElementTypeByRegistryItem(t)}getCrtInputs(e){return this.getViewElementRegistryItem(e)?.inputs}getSelector(e){const t=this.getViewElementRegistryItem(e);return this.getSelectorByRegistryItem(t)}getSelectorByRegistryItem(e){return e&&"selector"in e?e.selector:null}getViewElementTypeByRegistryItem(e){return e&&"typeRef"in e?e.typeRef:null}}class je extends xy{constructor(){super(...arguments),this.registry=wl}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=i.\u0275\u0275getInheritedFactory(je)))(n||je)}})()}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:je,factory:je.\u0275fac})}}function Ty(r,e){if(typeof r=="string"){const t=r.startsWith("$"),n=r.slice(1).split(".").pop()||"",s=e?.[n]!=null;return t&&s}return!1}class Na{constructor(){this._designerResolver=(0,i.inject)(Da),this._viewResolver=(0,i.inject)(je),this._viewElementContentSlotsCache=new Map}_getViewConfigInfo(e,t,n,s,a){const o=[];if(Array.isArray(n))for(let c=0;c<n.length;c++){const d=n[c];t.includes(d[e])&&o.push({viewConfig:d,parentName:s,index:c,parentPropertyName:a}),this.getViewElementContentSlots(d.type)?.forEach(C=>{const I=d[C];if(I){const O=this._getViewConfigInfo(e,t,I,d.name,C);o.push(...O)}})}return o}_getViewConfigInfoByFilter(e,t,n,s){const a=[];if(Array.isArray(t))for(let o=0;o<t.length;o++){const c=t[o];e(c)&&a.push({viewConfig:c,parentName:n,index:o,parentPropertyName:s}),this.getViewElementContentSlots(c.type)?.forEach(p=>{const C=c[p];if(C){const I=this._getViewConfigInfoByFilter(e,C,c.name,p);a.push(...I)}})}return a}_getViewConfigsBindingMap(e,t,n){const s=new Map;if(Array.isArray(e))for(let a=0;a<e.length;a++){const o=e[a],c=this._viewResolver.getFormControlRelatesAttribute(o.type),d=o[c]??"";if(d.startsWith("$")){const C=d.substring(1),I={viewConfig:o,parentName:t,index:a,parentPropertyName:n};s.has(C)?s.get(C).push(I):s.set(C,[I])}this.getViewElementContentSlots(o.type)?.forEach(C=>{const I=o[C];I&&this._getViewConfigsBindingMap(I,o.name,C).forEach((Y,te)=>{s.has(te)?s.get(te).push(...Y):s.set(te,Y)})})}return s}_isViewModelAttributeBound(e,t){if(!t)return!1;const n=e.viewConfig,s=`\\W\\$${t}\\W`;return this._isAttributeUseInConfig(n,s)}_isViewModelAttributeBoundInViewModel(e,t){if(!t)return!1;const n=(0,M.cloneDeep)(this.getViewModelConfig(e));n.attributes=n.attributes||{},delete n?.attributes[t];const s=`\\W${t}\\W`;return this._isAttributeUseInConfig(n,s)}_isAttributeUseInConfig(e,t){const n=JSON.stringify(e);return new RegExp(t).test(n)}_findViewConfigItem(e,t,n){if(n(t))return e.push(t),!0;const s=this.getViewElementContentSlots(t.type);for(const a of s){const o=t[a];if(o){for(const c of o)if(this._findViewConfigItem(e,c,n))return e.push(t),!0}}}_getViewConfigArray(e){return e?Array.isArray(e)?e:[e]:[]}_getCollectionPropertyNames(e){return this._designerResolver.get(e)?.collectionPropertyNames||["items"]}_getContentSlots(e){const t=[];return this._viewResolver.getViewElementRegistryItem(e)?.contentSlots?.forEach(s=>{if(typeof s=="string")t.push(s);else{const a=s?.name;t.push(a)}}),t}_getPossibleResourceValues(e){return[`#ResourceString(${e})#`]}getViewElementContentSlots(e){if(this._viewElementContentSlotsCache.has(e))return this._viewElementContentSlotsCache.get(e);const t=this._getContentSlots(e),n=this._getCollectionPropertyNames(e),s=[...new Set([...t,...n])];return this._viewElementContentSlotsCache.set(e,s),s}getViewConfigPathByPropertyValue(e,t,n){const s=[],a=this._getViewConfigArray(n);for(const o of a)if(this._findViewConfigItem(s,o,c=>c[e]===t))break;return s}getViewConfigInfoByPropertyForValues(e,t,n){const s=[],a=this._getViewConfigArray(n);for(let o=0;o<a.length;o++){const c=a[o];t.includes(c[e])&&s.push({viewConfig:c,index:o}),this.getViewElementContentSlots(c.type)?.forEach(p=>{const C=c[p];if(C){const I=this._getViewConfigInfo(e,t,C,c.name,p);s.push(...I)}})}return s}getViewConfigInfoByProperty(e,t,n){return this.getViewConfigInfoByPropertyForValues(e,[t],n)}getViewConfigInfoByType(e,t){return this.getViewConfigInfoByProperty("type",t,e).map(n=>n?.viewConfig).filter(Boolean)}getViewConfigInfoByFilter(e,t){const n=[],s=t??[];for(let a=0;a<s.length;a++){const o=s[a];e(o)&&n.push({viewConfig:o,index:a}),this.getViewElementContentSlots(o.type)?.forEach(d=>{const p=o[d];if(p){const C=this._getViewConfigInfoByFilter(e,p,o.name,d);n.push(...C)}})}return n}getViewConfigsBindingMap(e){return this._getViewConfigsBindingMap(e??[],"","")}getViewModelAttribute(e,t){return this.getViewModelConfig(e)?.attributes?.[t]}getViewConfigInfoByName(e,t){return this.getViewConfigInfoByProperty("name",t,e?.viewConfig)[0]||{}}getViewModelConfig(e,t=!1){return!e.viewModelConfig&&t&&(e.viewModelConfig={}),e.viewModelConfig||{}}isViewModelAttributeBound(e,t){return t?this._isViewModelAttributeBound(e,t)||this._isViewModelAttributeBoundInViewModel(e,t):!1}addViewModelAttributeChangeRequest(e,t){const{attributeName:n,requests:s,options:a}=t??{};if(!n||!s?.length)return;const o=!!a?.createAttributeIfEmpty,c=this.getViewModelConfig(e,o);if(!c?.attributes&&!o)return;const d=c.attributes??={};if(!d[n]&&!o)return;const p=d[n]??={};p.change??=[],Array.isArray(p.change)||(p.change=[p.change]),p.change.push(...s)}findResourceDependencies(e,t){const n=this._getPossibleResourceValues(e),s={viewElements:[],attributes:[]},a=(o,c)=>{o&&(typeof o=="string"?n.forEach(d=>{o.includes(d)&&s.viewElements.push(c)}):Array.isArray(o)?o.forEach(d=>a(d,c)):typeof o=="object"&&Object.values(o).forEach(d=>a(d,c)))};return Object.entries(t).forEach(([o,c])=>a(c,o)),s}getDependentModelsNames(e,t,n){return Object.entries(e||{}).filter(([,a])=>{let o=t;return n&&(o=`${t}.${n}`),a.some(c=>c.relationPath.startsWith(o))}).map(([a])=>a)}getDataSourceModelName(e,t){return e?.dataSources?.[t]?.config?.entitySchemaName}findAllAttributesByDataSourceAttributePath(e,t){const n=this.getViewModelConfig(e,!0).attributes??{},s=Object.keys(n).filter(o=>{const c=n[o]??{};return d_(c)&&c.modelConfig?.path===t});if(s.length>0)return s;const a=t.split(".");if(a.length>2){const o=a[0],d=e?.modelConfig?.dataSources?.[o]?.config?.attributes;if(d){const p=a.slice(1).join("."),C=Object.keys(d).find(I=>d[I].path===p);if(C)return this.findAllAttributesByDataSourceAttributePath(e,`${o}.${C}`)}}return[]}getLoadParametersByDataSourceName(e,t){return t.modelConfig?.dataSources?.[e]?.config?.loadParameters}getSortingConfigByDataSourceName(e,t){return this.getLoadParametersByDataSourceName(e,t)?.options?.sortingConfig}getCollectionViewConfigs(e,t){return t?.length?this.getViewConfigInfoByPropertyForValues("type",t,e.viewConfig).filter(n=>!!n).map(({viewConfig:n})=>n).filter(({name:n})=>n)||[]:[]}getCollectionViewConfigsWithItemsBinding(e,t){return this.getCollectionViewConfigs(e,t).filter(({items:n})=>Ty(n,e.viewModelConfig?.attributes))}getRequestBindingConfigs(e,t,n){const s=[];return t===void 0||this.getViewConfigInfoByFilter(a=>{const o=Object.values(a).filter(c=>{const d=c;return d?.request===t&&(n?n(d):!0)});return s.push(...o),!1},e),s}static{this.\u0275fac=function(t){return new(t||Na)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Na,factory:Na.\u0275fac})}}class dp{constructor(){this.viewElements=new Set,this.requests=new Set,this.converters=new Set,this.validators=new Set}}class Pa{constructor(){this._metadataSchemaUtils=(0,i.inject)(Na),this._viewElementTypeResolver=(0,i.inject)(je)}_forEachStringInObject(e,t,n=[]){for(const s in e){const a=e[s];typeof a=="string"?t(n.concat(s),a):typeof a=="object"&&a!==null&&(n.push(s),this._forEachStringInObject(a,t,n),n.pop())}}_searchInContentSlots(e,t,n){const s=this._metadataSchemaUtils.getViewElementContentSlots(e.type)??[];for(const a of s){const o=e[a];Array.isArray(o)&&this._searchInViewConfig(e[a]??[],n)}}_searchInBindingExpression(e,t){uc(e).converters?.forEach(n=>t.converters.add(n.type))}_searchInRequestConfig(e,t){const n=Array.isArray(e)?e:[e];for(const s of n)t.requests.add(s.request),s.params&&this._forEachStringInObject(s.params,(a,o)=>{vt(o)&&this._searchInBindingExpression(o,t)})}_searchInViewConfig(e,t){for(const n of e){t.viewElements.add(n.type);const s=this._viewElementTypeResolver.getViewElementRegistryItem(n.type);if(s)for(const[a,o]of Object.entries(n))s.inputs&&a in s.inputs&&vt(o)&&this._searchInBindingExpression(o,t),o&&s.outputs&&a in s.outputs&&this._searchInRequestConfig(o,t);this._searchInContentSlots(n,s,t)}}_searchInValidatorsConfig(e,t){for(const n of Object.values(e))t.validators.add(n.type)}_searchInViewModelConfig(e,t){if("attributes"in e)for(const n of Object.values(e.attributes))"change"in n&&this._searchInRequestConfig(n.change,t),"validators"in n&&this._searchInValidatorsConfig(n.validators,t),"viewModelConfig"in n&&this._searchInViewModelConfig(n.viewModelConfig,t),"converter"in n&&this._searchInBindingExpression("$value | "+n.converter,t)}*_getRequestHandlersMetadata(e){for(const t of e){const n=by.handlersByRequestMap.get(t);if(n)for(const s of n.values())yield s}}_addModuleRefIfLazy(e,t,n){t?.lazy&&(!n||n(t))&&e.add(t.lazyModuleRef)}getUsedItemsInSchema(e){const t=new dp;return this._searchInViewConfig(e.viewConfig??[],t),this._searchInViewModelConfig(e.viewModelConfig??{},t),t}getUsedItemsInViewConfig(...e){const t=new dp;return this._searchInViewConfig(e,t),t}getUsedViewElements(e){return this.getUsedItemsInViewConfig(...e).viewElements}getLazyModuleRefs(e,t){const n=new Set,{viewElements:s,requests:a,converters:o,validators:c}=e;for(const C of s)this._addModuleRefIfLazy(n,this._viewElementTypeResolver.getViewElementRegistryItem(C));for(const C of o)this._addModuleRefIfLazy(n,Kd.find(C));for(const C of c)this._addModuleRefIfLazy(n,Il.items.get(C));const d=this._getRequestHandlersMetadata(a),p=t?.requestScopes?C=>Xd(C.scopes,t.requestScopes):void 0;for(const C of d)this._addModuleRefIfLazy(n,C.instanceConfig,p);return n}static{this.\u0275fac=function(t){return new(t||Pa)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Pa,factory:Pa.\u0275fac})}}function Ay(r){const e=new u.Subscription;for(const t of r)e.add(t);return e}class Le{constructor(e=new u.Subscription,t=Promise.resolve()){this._subscription=e,this.ready=t}static all(e){const t=Ay(e.map(s=>s._subscription)),n=Promise.all(e.map(s=>s.ready)).then(()=>{});return new Le(t,n)}static subscribe(e,t,n=!1){e=e.pipe((0,l.share)());const s=e.subscribe({next:t}),a=n?(0,u.lastValueFrom)(e.pipe((0,l.first)(),(0,l.map)(()=>{})),{defaultValue:null}):Promise.resolve();return new Le(s,a)}unsubscribe(){this._subscription.unsubscribe()}}const fu="Change",El="ValidationInfo";function _u(r,e){return!!wl.viewElements.get(r)?.inputs?.[e]}function yu(r,e){return!!wl.viewElements.get(r)?.outputs?.[e]}function iM(r,e){return!!ViewElementRegistry.viewElements.get(r)?.validationInputs?.[e]}function Cu(r){return r+fu}function sM(r,e){const t=Cu(e);return yu(r,t)}function Dy(r){return r+El}function hp(r,e){const t=e+El;return!!wl.viewElements.get(r)?.validationInputs?.[t]}function Ny(r){let e=null;if(r.endsWith(fu))e=r.replace(new RegExp(fu+"$"),"");else if(r.endsWith(El))e=r.replace(new RegExp(El+"$"),"");else return null;return e}function rM(r,e){const t=Ny(e);return!!t&&_u(r,t)}function pp(r,e){return bu.apply(this,arguments)}function bu(){return bu=(0,f.A)(function*(r,e){const t=lc(r,e),n=yield(0,u.firstValueFrom)(t,{defaultValue:null});if(!n)return null;const s=yield(0,u.firstValueFrom)(n.context.viewModel$);if(!s)return null;const a=dc(n.contextPath,r);return yield Wd(s,a)}),bu.apply(this,arguments)}function Py(r,e,t){return Su.apply(this,arguments)}function Su(){return Su=(0,f.A)(function*(r,e,t){const n=yield pp(r,t);if(!n)return;const{attributeHost:s,attributeName:a}=n;s.getAttributeControl(a).markAsDirty(),s[a]=e}),Su.apply(this,arguments)}function Ry(r,e){return Mu.apply(this,arguments)}function Mu(){return Mu=(0,f.A)(function*(r,e){const t=yield pp(r,e);if(!t)return;const{attributeHost:n,attributeName:s}=t,a=n.getAttributeControl(s);a.touched||(a.markAsTouched(),a.updateValueAndValidity())}),Mu.apply(this,arguments)}const mp="bindTo";class gp{constructor(e){this.injector=e,this._loadingAttributeName="loading",this.bindingExpressionInterpreter=e.get(oi),this.attrCtrlExpInterpreter=e.get(Gn),this.requestBindingConfigInterpreter=e.get(gs),this.validationBindingInterpreter=e.get(li),this._bindingContext=e.get(vl,null),this._macrosHandlerService=e.get(zi),this._isDesignTime=e.get(Wn,!1);const t=e.get(fe);this._isSafeBinding=!t.DisableSafePropertiesBinding,this._viewElementTypeResolver=e.get(je)}_useMacros(e,t){if(!this._bindingContext)return t(e);let n;const s=new u.Subject,a=this._bindingContext.viewModel$.pipe((0,l.switchMap)(o=>this._macrosHandlerService.handleResourceMacros(e,o)),(0,l.map)((o,c)=>{n?.unsubscribe(),n=t(o),c===0&&n.ready.then(()=>{s.next(),s.complete()})}),(0,l.finalize)(()=>n?.unsubscribe())).subscribe();return new Le(a,(0,u.lastValueFrom)(s,{defaultValue:null}))}_bindLoadingProperty(e,t){if(Object.keys(e).some(c=>c===this._loadingAttributeName))return new Le;const s=(0,M.chain)(e).entries().filter(([c,d])=>this.isInputBinding(c,d,t,e)&&vt(d)).value();if(!s.length)return new Le;const a=s.map(([c,d])=>cf(d)),o=Nr(this._bindingContext).viewModel$.pipe((0,l.switchMap)(c=>{if(!c)return(0,u.of)();let d=[];const p=c.events$.pipe((0,l.filter)(I=>I.type===Re.StartLoadModelAttributes),(0,l.filter)(I=>{const O=Object.keys(I.payload);return a.some(Y=>O.includes(Y))}),(0,l.tap)(I=>{d=Object.keys(I.payload)}),(0,l.tap)(()=>t.setPropertyValue("loading",!0))),C=c.events$.pipe((0,l.filter)(I=>I.type===Re.FinishLoadModelAttributes),(0,l.filter)(I=>{const O=Object.keys(I.payload);return d.every(Y=>O.includes(Y))}),(0,l.tap)(()=>t.setPropertyValue("loading",!1)),(0,l.tap)(()=>d=[]));return(0,u.merge)(p,C)})).subscribe();return new Le(o)}_isControlProperty(e,t){const n=this._viewElementTypeResolver.getFormControlRelatesAttribute(t.type);return e===n}_getViewElementInputProperties(e){const t=this._viewElementTypeResolver.getViewElementRegistryItem(e.type);return t?[...Object.keys(t.inputs??{}).filter(n=>t.inputs[n].propertyBindable)]:["visible"]}_getViewElementEntries(e,t){const n=this._viewElementTypeResolver.getFormControlRelatesAttribute(t.type),s=e.find(([o])=>o===mp);let a=e.filter(([o])=>o!==mp);if(s){const[,o]=s;if(!o)return a;this._getViewElementInputProperties(t).forEach(d=>{if(d!==n){let p=o;p=`${p}:${d}`;const C=t[d];C!=null&&(p+=`=${C}`),a=a.filter(([I])=>I!==d),a.push([d,p])}})}return a}_bindInputWithValidation(e,t,n){const s=this.validationBindingInterpreter.evaluate(t,this._bindingContext).pipe((0,l.startWith)(null),(0,u.pairwise)()),a=Dy(e),o=([c,d])=>{c?.value!==d?.value&&n.setPropertyValue(e,d.value),n.setPropertyValue(a,d?.validationInfo)};return Le.subscribe(s,o)}_bindFocusout(e,t){const n=t.getEvent("focusout"),s=e.slice(1),a=()=>Ry(s,this._bindingContext);return Le.subscribe(n,a)}_bindInputs(e,t){const[n,s]=(0,M.chain)(e).entries().filter(([d,p])=>this.isInputBinding(d,p,t,e)&&!this.isTwoWayBinding(d,p,t,e)).partition(([,d])=>vt(d)).value();s.forEach(([d,p])=>{p=this._isControlProperty(d,e)?new Z.FormControl(p):p,t.setPropertyValue(d,p)});const o=this._getViewElementEntries(n,e).map(([d,p])=>{const O=(this._isControlProperty(d,e)?this.attrCtrlExpInterpreter:this.bindingExpressionInterpreter).evaluate(p,this._bindingContext);if(hp(e.type,d)&&Fo(p))return this._bindInputWithValidation(d,p,t);{const Y=te=>t.setPropertyValue(d,te);return Le.subscribe(O,Y,!1)}}),c=this._bindLoadingProperty(e,t);return Le.all([...o,c])}_createRequest(e,t){const n={...this._bindingContext,initialEvent:t};return this.requestBindingConfigInterpreter.evaluate(e,n).pipe((0,l.map)(s=>({...s,$initialEvent:t})))}_bindOutputSafely(e,t,n){const s=e.getEvent(t),a=Nr(this._bindingContext).viewModel$.pipe((0,l.switchMap)(c=>c._destroy$)),o=c=>(0,u.lastValueFrom)(this._createRequest(n,c).pipe((0,l.switchMap)(d=>d.$context.executeRequest(d)),(0,l.takeUntil)(a))).catch(()=>null);return Le.subscribe(s,o)}_bindOutputUnsafely(e,t,n){const s=e.getEvent(t).pipe((0,l.switchMap)(o=>this._createRequest(n,o))),a=o=>o.$context.executeRequest(o);return Le.subscribe(s,a)}_bindOutput(e,t,n){return this._isSafeBinding?this._bindOutputSafely(e,t,n):this._bindOutputUnsafely(e,t,n)}_bindOutputs(e,t){const s=Object.entries(e).filter(([a,o])=>this.isOutputBinding(a,o,t,e)).map(([a,o])=>this._bindOutput(t,a,o));return Le.all(s)}_bindTwoWays(e,t){const n=Object.entries(e).filter(([a,o])=>this.isTwoWayBinding(a,o,t,e)),s=[];return n.forEach(([a,o])=>{const c=this.bindingExpressionInterpreter.evaluate(o,this._bindingContext),d=se=>t.setPropertyValue(a,se);hp(e.type,a)&&Fo(o)?s.push(this._bindInputWithValidation(a,o,t)):s.push(Le.subscribe(c,d));const p=o.slice(1),C=Cu(a),I=this.getViewEventsStream(t,C),O=se=>Py(p,se,this._bindingContext),Y=Le.subscribe(I,O);s.push(Y);const te=this._bindFocusout(o,t);s.push(te)}),Le.all(s)}isInputBinding(e,t,n,s){return _u(s.type,e)}isOutputBinding(e,t,n,s){return yu(s.type,e)}isTwoWayBinding(e,t,n,s){const a=Cu(e);return Fo(t)&&_u(s.type,e)&&yu(s.type,a)&&!(a in s)}bind(e,t){const n=s=>Le.all([this._bindInputs(s,e),this._bindOutputs(s,e),this._bindTwoWays(s,e)]);return this._isDesignTime?this._useMacros(t,n):n(t)}}class fp extends gp{isInputBinding(e,t,n,s){return super.isInputBinding(e,t,n,s)||!this.isOutputBinding(e,t,n,s)}isOutputBinding(e,t,n,s){return super.isOutputBinding(e,t,n,s)||n.getPropertyValue(e)instanceof i.EventEmitter}getViewEventsStream(e,t){return e.getEvent(t)}}class _p{constructor(e,t,n,s,a,o,c){this._componentRef=e,this._inputs=t,this._ngZone=s,this._changeDetectorRef=a,this.nativeElement=o,this.hostView=c,this._propertyValues=new Map,this.instance=n;const d=this._componentRef.injector.get(fe,null);this._enableInstanceValueSetFeature=d?.["ComponentViewElementRef.EnableInstanceValueSet"]}setValue(e,t){if(this._inputs?.[e])this._componentRef.setInput(e,t);else if(this._enableInstanceValueSetFeature)(0,M.set)(this.instance,e,t);else{const n=["selected","layoutConfig","dragging","currentLayoutConfig"];if(e in this.instance&&!n.includes(e)){const s=this._componentRef.componentType.name;let a=`Can't set value of the '${e}' input on the '${s}' component. `;a+=`Make sure that the '${e}' property is annotated with @Input() or a mapped @Input('${e}') exists.`,console.error(a)}}this._changeDetectorRef.detectChanges()}getPropertyValue(e){return(0,M.get)(this.instance,e)}getEvent(e){const t=this.getPropertyValue(e);return!t&&this.nativeElement?(0,u.fromEvent)(this.nativeElement,e):t}on(e,t){const s=this.getEvent(e).subscribe(t);return()=>{s.unsubscribe()}}setPropertyValue(e,t){(!this._propertyValues.has(e)||t!==this._propertyValues.get(e))&&(this._propertyValues.set(e,t),this._ngZone.run(()=>this.setValue(e,t)))}destroy(){this.hostView?.destroy(),this._componentRef?.destroy(),this.nativeElement=null}}class Oy{constructor(e,t){this._ngZone=t,this._propertyValues=new Map,this.instance=e}setValue(e,t){(0,M.set)(this.instance,e,t)}getPropertyValue(e){return(0,M.get)(this.instance,e)}getEvent(e){return this.getPropertyValue(e)}on(e,t){const s=this.getPropertyValue(e).subscribe(t);return()=>{s.unsubscribe()}}setPropertyValue(e,t){(!this._propertyValues.has(e)||t!==this._propertyValues.get(e))&&(this._propertyValues.set(e,t),this._ngZone.run(()=>this.setValue(e,t)))}destroy(){this.instance=null}}var ln;(function(r){r.Default="default",r.OnViewport="on-viewport"})(ln||(ln={}));class Vy extends gp{getViewEventsStream(e,t){return e.getEvent(t).pipe((0,u.map)(n=>n.detail))}}class yp{constructor(e){this.injector=e}}const fs=new i.InjectionToken("CRT_VIEW_ELEMENT_CONFIG");class Ly{constructor(e){this._propertyValues=new Map,this.instance=e}getPropertyValue(e){return this.instance[e]}getEvent(e){return(0,u.fromEvent)(this.instance,e)}on(e,t){return this.instance.addEventListener(e,t),()=>this.instance.removeEventListener(e,t)}setPropertyValue(e,t){(!this._propertyValues.has(e)||t!==this._propertyValues.get(e))&&(this._propertyValues.set(e,t),this.instance[e]=t)}destroy(){}}class ky extends yp{createComponent(e){const t=this.injector.get(je),n=this.injector.get(i.Renderer2),s=this.injector.get(i.ViewContainerRef),a=this.injector.get(fs),o=t.getSelector(a.type),c=document.createElement(o);return e?.forEach(({name:d,value:p})=>{n.setAttribute(c,d,p)}),n.appendChild(s.element.nativeElement.parentElement,c),this._initDirectionality(c),new Ly(c)}_initDirectionality(e){this.injector.get(At.Directionality)?.value==="rtl"&&e.setAttribute("dir","rtl")}}class Cp extends yp{createComponent(e){const t=this.injector.get(je),n=this.injector.get(fs),s=t.getViewElementType(n);if(!s)throw new Error(`Component for type ${n.type} not found`);const a=this.injector.get(i.ViewContainerRef),o=this.injector.get(i.Renderer2),c=t.getCrtInputs(n.type),d=a.createComponent(s,{index:0,injector:this.injector});e?.forEach(({name:O,value:Y})=>{o.setAttribute(d.location.nativeElement,O,Y)});const p=d.injector.get(i.ChangeDetectorRef),C=d.injector.get(i.ElementRef).nativeElement;d.changeDetectorRef.detectChanges();const I=this.injector.get(i.NgZone);return new _p(d,c,d.instance,I,p,C,d.hostView)}}class jy{}const bp=new i.InjectionToken("VIEW_ELEMENT_COMPONENT_CREATOR");class Sp extends jy{constructor(e){super(),this.injector=e,this.viewElementConfig=this.injector.get(fs),this.featureValues=this.injector.get(fe,{optional:!0}),this.measurePerformanceService=this.injector.get(et),this._componentCreator=this.injector.get(bp)}_getElementName(){return`${this.viewElementConfig.type.split(".")?.[1]} ${this.viewElementConfig.name}`}_getDOMAttributes(){const e=[];return this.featureValues?.UseViewElementDataItemMarker&&e.push({name:"data-item-marker",value:this.viewElementConfig.dataItemMarker||this.viewElementConfig.name}),e}createComponent(e){return this._componentCreator.createComponent(e)}getComponentRef(){const e=this._getElementName(),t=this._getDOMAttributes();return this.measurePerformanceService.measure(e,()=>this.createComponent(t))}show(){const e=this.getComponentRef();return(0,u.of)(e)}hide(){}}class Fy extends Sp{constructor(e,t,n){super(e),this.injector=e,this._creator=t,this._destroyed=n,this._renderer=this.injector.get(i.Renderer2),this._container=this.injector.get(i.ViewContainerRef),this._resolver=this.injector.get(je),this._initMinHeight(),this._subscribeDestroyed()}get _parentElement(){return this._container.element.nativeElement.parentElement}_handleIntersection(e,t){if(this._parentElement){if(e&&!this._componentRef?.hostView){this._initResizeObservable(),t.next(this.getComponentRef()),t.complete();return}this._componentRef?.hostView&&(e?this._showElement():this._hideElement())}}_initIntersectionObserver(e){let t=this.viewElementConfig.selected;this._intersectionObserver=new IntersectionObserver(n=>{n.forEach(s=>{t?t=!1:this._handleIntersection(s.isIntersecting,e)})}),this._intersectionObserver.observe(this._parentElement),t&&this._handleIntersection(!0,e)}_initResizeObservable(){this._resizeObserver||(this._resizeObserver=new ResizeObserver(e=>{const{height:t,width:n}=e[0].contentRect;this._minHeight=`${t}px`,this._minWidth=`${n}px`}),this._resizeObserver.observe(this._parentElement))}_showElement(){this._display?this._renderer.setStyle(this._componentRef.nativeElement,"display",this._display):this._renderer.removeStyle(this._componentRef.nativeElement,"display"),this._removeMinSize()}_hideElement(){this._applyMinSize(),this._display=this._componentRef.nativeElement?.style.display,this._renderer.setStyle(this._componentRef.nativeElement,"display","none")}_removeMinSize(){this._renderer.removeStyle(this._parentElement,"min-height"),this._minWidth&&this._renderer.removeStyle(this._parentElement,"min-width")}_applyMinSize(){this._renderer.setStyle(this._parentElement,"min-height",this._minHeight),this._minWidth&&this._renderer.setStyle(this._parentElement,"min-width",this._minWidth)}_initMinHeight(){const e=this._resolver.getViewElementRegistryItem(this.viewElementConfig.type);e?e.renderStrategy===ln.OnViewport&&(this._minHeight=e.placeholderSize.height):console.warn(`View element with type "${this.viewElementConfig.type}" not found`)}_subscribeDestroyed(){this._destroyed?.subscribe(()=>{const e=this._componentRef?.hostView;e&&!e.destroyed&&(e.detach(),e.destroy()),this._componentRef&&(this._componentRef.instance=null),this._componentRef=null,this._container.detach(),this._container.clear(),this._container=null,this._resizeObserver?.disconnect(),this._intersectionObserver?.disconnect()})}createComponent(e){return this._componentRef=this._creator.createComponent(e),this._removeMinSize(),this._componentRef}show(){return this._applyMinSize(),new u.Observable(e=>{this._initIntersectionObserver(e)})}hide(){this._resizeObserver?.disconnect(),this._intersectionObserver?.disconnect()}}const Mp=new i.InjectionToken("COMPONENT_PROPERTIES_BINDER"),vp=new i.InjectionToken("DIRECTIVE_PROPERTIES_BINDER"),Ip=new i.InjectionToken("VIEW_ELEMENT_RENDER_STRATEGY"),vu=new i.InjectionToken("VIEW_ELEMENT_RENDER_STRATEGY_VALUE"),By=function(r){const e=r.get(fs);return r.get(je).getSelector(e.type)},Iu=function(r){return!!By(r)},Uy=function(r){return r.get(fe,{optional:!0})},zy=function(r){return r.get(Wn,!1)},Hy=function(r){return Iu(r)?new Vy(r):new fp(r)},Wy=function(r){return Iu(r)?new ky(r):new Cp(r)},$y=function(r,e){const t=r.get(vu)||ln.Default,s={[ln.Default]:wp,[ln.OnViewport]:Ky}[t];if(!s)throw new Error(`Unsupported render strategy type: ${t}`);return s(r,e)},Gy=function(r,e){return r||e},wp=function(r){return new Sp(r)},Zy=function(r){return Uy(r).UseLazyComponentCreationInDesignTime},Yy=function(r){const e=r.get(fs);return r.get(je).getViewElementRegistryItem(e.type)?.renderStrategy===ln.Default},Ky=function(r,e){const t=Yy(r),n=Zy(r),s=Iu(r),a=!zy(r);return t||s||a||!n?wp(r):new Fy(r,new Cp(r),e)},qy=new i.InjectionToken("Ignore view elements not found warning");class mt{constructor(e,t,n,s,a,o){this._resolver=e,this.parentDirective=t,this.injector=n,this._container=s,this._isDesignTime=a,this._ngZone=o,this._ownProperties=[{property:"visible",defaultValue:!0,omitForViewModelBinding:!0},{property:"bindTo",defaultValue:null,omitForViewModelBinding:!1}],this._destroyed$=new u.Subject,this._showElementSubscription=new u.Subscription,this._bindingContext=null,this._isCreating=!1,this._visible=!1,this._schemaAnalysisUtils=(0,i.inject)(Pa),this.nested=[],this.total=0,this.viewElementShow=new i.EventEmitter,this._featureValues=(0,i.inject)(fe,{optional:!0}),this._shouldLoadLazyModules=!this._featureValues.DisableLoadingLazyModulesFromViewElementDirective,this._measurePerformanceService=(0,i.inject)(et),this._directiveRef=new Oy(this,this._ngZone)}get visible(){return this._visible}set visible(e){this._visible=e,this._setViewElementVisibility(e||this._isDesignTime)}_bindSelfToViewModel(){const e=this._ownProperties.reduce((t,{property:n,defaultValue:s})=>({...t,[n]:this.viewElementConfig[n]??s}),{});this._ngZone.runOutsideAngular(()=>this.bindDirectiveProperties(e))}_bindComponentToViewModel(){const e=(0,M.omit)(this.viewElementConfig,...this._ownProperties.filter(({omitForViewModelBinding:t})=>t===!0).map(({property:t})=>t));this._ngZone.runOutsideAngular(()=>this.bindComponentProperties(e))}_setViewElementVisibility(e){e&&!this.componentRef?this._showViewElement():!e&&this.componentRef&&this._hideViewElement()}_showViewElement(){const e=this.viewElementConfig.type;if(this._typeName=e,!!this._typeName)if(this._resolver.canResolve(e))this._showComponent();else{if(this.injector.get(qy,!1))return;const n=this._container.createComponent(Gi);n.instance.caption=e;const s=n.injector.get(i.ElementRef).nativeElement,a=this._resolver.getCrtInputs(e);console.warn(`View element with type "${e}" not found`),this.componentRef=new _p(n,a,n.instance,this._ngZone,n.changeDetectorRef,s,n.hostView)}}_getLazyModuleRefs(e){return this._measurePerformanceService.measure("ViewElementDirective.SEARCHING_SCHEMA_LAZY_ITEMS",()=>{const t=this._schemaAnalysisUtils.getUsedItemsInViewConfig(this.viewElementConfig);return this._schemaAnalysisUtils.getLazyModuleRefs(t,{requestScopes:e?._scopes})})}_getInjectionContext(e){const t=e;return t._injectionContext||Yr(t)._injectionContext}_addLazyModulesToContext(e,t){const n=this._getInjectionContext(e);for(const s of t)n.addLazyModule(s);th(n)}_loadLazyModules(){return this._shouldLoadLazyModules?this._featureValues.DisableFreedomUiLazyLoading?(0,u.from)(Jd.instance.loadAll()):(this._bindingContext?.viewModel$??(0,u.of)(null)).pipe((0,l.switchMap)(t=>{const n=this._getLazyModuleRefs(t);if(n.size===0)return(0,u.of)(void 0);const s=(0,u.from)(Promise.all(Array.from(n,a=>a.loadAndBootstrap())));return t?s.pipe((0,l.map)(a=>Qd(a)),(0,l.tap)(a=>this._addLazyModulesToContext(t,a))):s}),(0,l.take)(1),this._measurePerformanceService.measure$("ViewElementDirective.LOADING_SCHEMA_LAZY_ITEMS")):(0,u.of)(void 0)}_showComponent(){this._isCreating||(this._isCreating=!0,this._renderStrategyInstance&&this._renderStrategyInstance.hide(),this._renderStrategyInstance=this.injector.get(Ip),this._showElementSubscription.add(this._loadLazyModules().pipe((0,l.switchMap)(()=>this._renderStrategyInstance.show()),(0,l.filter)(e=>!!e)).subscribe(e=>{this.componentRef=e,this._measurePerformanceService.measure(`binding ${this.viewElementConfig.name}`,()=>this._bindComponentToViewModel()),this.viewElementShow.emit(this),this._isCreating=!1,this._featureValues?.UseMeasurePerformanceTools&&this._measurePerformanceService.rendering$.next()})))}_hideViewElement(){this._componentBinding?.unsubscribe(),this._showElementSubscription.unsubscribe(),this._renderStrategyInstance.hide(),this._container.clear(),this.componentRef?.destroy(),this.componentRef=null}bindDirectiveProperties(e){this._directiveBinding?.unsubscribe(),this._directiveBinding=this._directivePropertiesBinder.bind(this._directiveRef,e)}bindComponentProperties(e){this._componentBinding?.unsubscribe(),this.componentRef&&(this._componentBinding=this._componentPropertiesBinder.bind(this.componentRef,e))}updateViewElementConfig(e){this.viewElementConfig=e,this._bindSelfToViewModel(),this._bindComponentToViewModel()}ngOnInit(){this._shouldLoadLazyModules&&(this._bindingContext=this.injector.get(vl,null)),this._directivePropertiesBinder=this.injector.get(vp),this._componentPropertiesBinder=this.injector.get(Mp),this.parentDirective&&this.parentDirective.attachNested(this),this._bindSelfToViewModel()}attachNested(e){this.nested.push(e)}detachNested(e){this.nested.splice(this.nested.indexOf(e),1)}ngOnDestroy(){this.parentDirective&&this.parentDirective.detachNested(this),this.nested.forEach(e=>e.ngOnDestroy()),this.componentRef?.destroy(),this.componentRef=null,this.viewElementConfig=null,this._componentBinding?.unsubscribe(),this._directiveBinding?.unsubscribe(),this._showElementSubscription.unsubscribe(),this._container.clear(),this._directiveRef.destroy(),this._renderStrategyInstance=null,this._destroyed$.next(),this._destroyed$.complete()}static{this.\u0275fac=function(t){return new(t||mt)(i.\u0275\u0275directiveInject(je),i.\u0275\u0275directiveInject(mt,12),i.\u0275\u0275directiveInject(i.Injector),i.\u0275\u0275directiveInject(i.ViewContainerRef),i.\u0275\u0275directiveInject(Wn,8),i.\u0275\u0275directiveInject(i.NgZone))}}static{this.\u0275dir=i.\u0275\u0275defineDirective({type:mt,selectors:[["","crtViewElement",""]],inputs:{viewElementConfig:[i.\u0275\u0275InputFlags.None,"crtViewElement","viewElementConfig"],renderStrategy:"renderStrategy",visible:"visible"},outputs:{viewElementShow:"viewElementShow"},features:[i.\u0275\u0275ProvidersFeature([{provide:fs,useFactory:e=>e.viewElementConfig,deps:[(0,i.forwardRef)(()=>mt)],multi:!1},{provide:Mp,useFactory:Hy,deps:[i.Injector],multi:!1},{provide:vp,useFactory:e=>new fp(e),deps:[i.Injector],multi:!1},{provide:bp,useFactory:Wy,deps:[i.Injector],multi:!1},{provide:vu,useFactory:(e,t)=>Gy(e.renderStrategy,t),deps:[(0,i.forwardRef)(()=>mt),[new i.Inject(vu),new i.SkipSelf,new i.Optional]],multi:!1},{provide:Ip,useFactory:(e,t)=>$y(e,t._destroyed$),deps:[i.Injector,(0,i.forwardRef)(()=>mt)],multi:!1},...cp])]})}}class Ra{constructor(){this._viewElementTypeResolver=(0,i.inject)(je)}_updateAttributeProperties(e,t,n,s){const a=e[t]||{},o={};s.forEach(p=>{let C=p.defaultValue;Object.prototype.hasOwnProperty.call(n,p.name)&&(C=n[p.name]??p.defaultValue),o[p.name]={defaultValue:C}});const c=this._viewElementTypeResolver.getViewElementInputs(n.type);Object.entries(c).filter(([,p])=>p.propertyName!=null).forEach(([p,C])=>{o[C.propertyName]={defaultValue:p,locked:!0}}),a.properties={...a.properties??{},...o}}updateAttributeProperties(e,t,n){const s=e.bindTo.replace("$",""),a=t?.viewModelConfig?.attributes||{};this._updateAttributeProperties(a,s,e,n)}updateCollectionAttributeProperties(e,t,n,s){const a=e.bindTo.replace(`${n}.`,""),o=n.replace("$",""),d=(t?.viewModelConfig?.attributes||{})[o];if(!d)return;const p=d?.viewModelConfig?.attributes;p&&this._updateAttributeProperties(p,a,e,s)}static{this.\u0275fac=function(t){return new(t||Ra)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Ra,factory:Ra.\u0275fac})}}const Ep="bindTo",Jy="visible";class Oa{constructor(){this._viewElementTypeResolver=(0,i.inject)(je)}_getViewElementInputProperties(e){const t=this._viewElementTypeResolver.getViewElementRegistryItem(e.type);return[...Object.keys(t.inputs??{}).filter(n=>t.inputs[n].propertyBindable),Jy]}createLayoutConfigComponentParts(e,t,n){for(const[s,a]of Object.entries(t))n.attributes["layout-config-"+(0,M.kebabCase)(s)]={value:a}}createVisibleComponentPartsWrapper(e,t,n,s){const a=vt(t);let o=t;const c=[];a&&(o=t,c.push({name:"crtBinding",arguments:[{value:e,propertyKey:this.getContextPropertyName(e+"|propertyName",n)},{value:s,propertyKey:this.getContextPropertyName(e+"|viewElementConfig",n)}]}));const d=n.directives.find(p=>p.selector==="crtIf");if(d)d.values.unshift({propertyKey:this.getContextPropertyName(e,n),value:o,pipes:c});else{const p={values:[{propertyKey:this.getContextPropertyName(e,n),value:o,pipes:c}],selector:"crtIf",useAsterisk:!0};this.addCrtIfDirectiveAdditionalInputs(p,s),n.directives.push(p)}return n}getContextPropertyName(e,t){return t.name+":"+e}getViewElementEntries(e){const t=this._viewElementTypeResolver.getFormControlRelatesAttribute(e.type),n=Object.entries(e),s=n.find(([o])=>o===Ep);let a=n.filter(([o])=>o!==Ep);if(s){const o=this._getViewElementInputProperties(e),[,c]=s;o.forEach(d=>{if(d!==t){const p=e[d];if(p==null||typeof p!="string"||typeof p=="string"&&!p.includes("|")){let C=c;C=`${C}:${d}`,p!=null&&(C+=`=${JSON.stringify(p)}`),a=a.filter(([I])=>I!==d),a.push([d,C])}}})}return a}addCrtIfDirectiveAdditionalInputs(e,{visibilityStrategyMode:t}){if(!t)return;const n=e.additionalInputs||[];n.push({propertyKey:"visibilityStrategyMode",value:t}),e.additionalInputs=[...n]}static{this.\u0275fac=function(t){return new(t||Oa)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Oa,factory:Oa.\u0275fac})}}class _s{static{this.\u0275fac=function(t){return new(t||_s)}}static{this.\u0275mod=i.\u0275\u0275defineNgModule({type:_s})}static{this.\u0275inj=i.\u0275\u0275defineInjector({providers:[je,Ra,Oa,...cp],imports:[v.CommonModule,$i,Cn,Cn]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&i.\u0275\u0275setNgModuleScope(_s,{declarations:[ci,mt],imports:[v.CommonModule,$i,Cn],exports:[ci,mt,Cn]})})();class ys{constructor(e){this._document=e}_getDownloadFileUrl(e){const t=new Blob([e],{type:"octet/stream"});return window.URL.createObjectURL(t)}_getDownloadFileName(e){const t=e.headers.get("Content-Disposition");return t?t.match(/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/)[1]:null}download(e,t){const n=this._getDownloadFileUrl(e);this.downloadFromUrl(n,t)}downloadFromResponse(e,t){t=t||this._getDownloadFileName(e),this.download(e.body,t)}downloadFromUrl(e,t){const n=this._document,s=n.createElement("a");s.href=e,s.download=t,n.body.appendChild(s),s.click(),n.body.removeChild(s)}static{this.\u0275fac=function(t){return new(t||ys)(i.\u0275\u0275inject(v.DOCUMENT))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:ys,factory:ys.\u0275fac})}}class xl{encodeKey(e){return encodeURIComponent(e)}encodeValue(e){return encodeURIComponent(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}class Va{constructor(e,t,n){this.http=e,this._fileDownloadService=t,this._userInfo=n,this._baseEndpoint="rest/FileApiService/",this._uploadFileMethodName="UploadFile",this._uploadAndAttachMethodName="UploadAndAttachFile",this._getFileSchemasMethodName="GetAllFileSchemas",this._chunkSize=5e5}_getEndpoint(e){return(this._userInfo.isSSP?"ssp/":"")+`${this._baseEndpoint}${e}`}_prepareError(e,t){const n={...e,file:t.file};return(0,u.throwError)(()=>n)}_sendWithChunks(e,t,n,s=this._chunkSize){const a=new Uint8Array(e.content),o=new Array;for(let d=0;d<a.length;d+=s){const p=Math.min(d+s,a.length),C=new Blob([a.subarray(d,p)]),I={start:d,end:p,content:C};o.push(I)}let c=0;return(0,u.from)(o).pipe((0,l.concatMap)(d=>(c++,e.progress=Math.floor(c/o.length*100),this.http.post(n,d.content,{headers:new P.HttpHeaders({"Content-Range":`bytes ${d.start}-${d.end-1}/${e.file.size}`,"Content-Type":e.file.type,"Content-Disposition":`attachment; filename=${encodeURIComponent(e.file.name)}`}),params:t}).pipe((0,l.retry)(2),(0,l.switchMap)(p=>!p||!p.success?(0,u.throwError)(()=>p.errorInfo):(0,u.of)(p)),(0,l.catchError)(p=>this._prepareError(p,e))))),(0,l.toArray)())}upload(e){let t=new P.HttpParams({encoder:new xl}).set("fileId",e.id).set("totalFileLength",e.file.size).set("mimeType",e.file.type).set("fileName",e.file.name).set("columnName","Data").set("entitySchemaName",e.fileEntitySchemaName).set("parentColumnName",e.recordColumnName).set("parentColumnValue",e.recordId);const n={...e.fileGroup&&{FileGroupId:e.fileGroup},...e.tag&&{Tag:e.tag},...e.recordEntitySchemaName&&{RecordSchemaName:e.recordEntitySchemaName}};Object.keys(n).length&&(t=t.append("AdditionalParams",JSON.stringify(n)));const s=this._getEndpoint(this._uploadFileMethodName);return this._sendWithChunks(e,t,s)}uploadAsColumn(e){const t=new P.HttpParams({encoder:new xl}).set("fileId",e.id).set("totalFileLength",e.file.size).set("mimeType",e.file.type).set("columnName","Data").set("fileName",e.file.name).set("entitySchemaName",e.fileEntitySchemaName),n=this._getEndpoint(this._uploadFileMethodName);return this._sendWithChunks(e,t,n)}uploadAndAttach(e){const t=new P.HttpParams({encoder:new xl}).set("fileId",e.id).set("totalFileLength",e.file.size).set("mimeType",e.file.type).set("columnName","Data").set("fileName",e.file.name).set("parentEntitySchemaName",e.recordEntitySchemaName).set("entitySchemaName",e.fileEntitySchemaName).set("parentColumnValue",e.recordId),n=this._getEndpoint(this._uploadAndAttachMethodName);return this._sendWithChunks(e,t,n)}uploadToCustomEndpoint(e,t,n){const s=new P.HttpParams({encoder:new xl}).set("totalFileLength",e.file.size).set("mimeType",e.file.type).set("fileName",e.file.name);return this._sendWithChunks(e,s,t,n)}download(e,t){this._fileDownloadService.downloadFromUrl(e,t)}getAllFileSchemas(){const e=this._getEndpoint(this._getFileSchemasMethodName);return this.http.get(e)}static{this.\u0275fac=function(t){return new(t||Va)(i.\u0275\u0275inject(P.HttpClient),i.\u0275\u0275inject(ys),i.\u0275\u0275inject(We.oq))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Va,factory:Va.\u0275fac})}}class La{constructor(e){this.translateService=e}_getTranslations(e){const t=this.translateService.translations[e];return t?(0,u.of)({translation:t,cultureName:e}):this.translateService.currentLoader.getTranslation(e).pipe((0,l.map)(n=>({translation:n,cultureName:e})))}getAllCultureValues(e,t){return(0,u.forkJoin)(e.map(n=>this._getTranslations(n))).pipe((0,l.map)(n=>{const s=new Wi;for(const{translation:a,cultureName:o}of n){const c=(0,M.get)(a,t);s.setValueLocalizableString(o,c)}return s}))}isTranslateKey(e){return/^\S+\.\S+$/.test(e)}static{this.\u0275fac=function(t){return new(t||La)(i.\u0275\u0275inject(m.TranslateService))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:La,factory:La.\u0275fac})}}const wu=new i.InjectionToken("CRT_REQUIRE_JS");class Eu{}class ka extends Eu{constructor(e,t){super(),this._requireJs=e,this._httpClient=t,this._serviceEndpoint="ServiceModel/ClientUnitSchemaPathService.svc/",this.paths=new Map}_loadPartOfSchema(e){const t=this._serviceEndpoint+"GetPathsBySchemaName/"+e;return this._httpClient.post(t,null).pipe((0,l.map)(n=>n?.paths??[]))}register(e){return this.paths.has(e)?(0,u.of)(void 0):this._loadPartOfSchema(e).pipe((0,l.map)(t=>{const n=Object.fromEntries(t.map(s=>[s.name,v.Location.joinWithSlash(pe(),s.path)]));this._requireJs.config({paths:n});for(const{name:s,path:a}of t)this.paths.set(s,a)}))}registerDescriptors(e){const t=Object.fromEntries(e.map(n=>[n.schemaName,v.Location.joinWithSlash(v.Location.joinWithSlash(pe(),n.path),n.schemaName)]));this._requireJs.config({paths:t})}static{this.\u0275fac=function(t){return new(t||ka)(i.\u0275\u0275inject(wu),i.\u0275\u0275inject(P.HttpClient))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:ka,factory:ka.\u0275fac})}}class Cs extends Eu{register(){return(0,u.of)(void 0)}registerDescriptors(e){}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=i.\u0275\u0275getInheritedFactory(Cs)))(n||Cs)}})()}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Cs,factory:Cs.\u0275fac})}}class ja extends Eu{constructor(e,t){super(),this._requireJs=e,this._appInfo=t,this._hashParamName="hash",this._workspaceBaseUrl=pe(),this._emptyResourcesModulePath="Terrasoft/configuration/resources/empty-resources.js"}_getSchemaRuntimePath(e){return v.Location.joinWithSlash(this._workspaceBaseUrl,e.staticFileContent.schemasRuntimePath)}_getResourceRuntimePath(e){return v.Location.joinWithSlash(this._workspaceBaseUrl,e.staticFileContent.resourcesRuntimePath)}_getEmptyResourcesPath(e){const t=v.Location.joinWithSlash(this._workspaceBaseUrl,e.coreModulesPath),n=new URL(v.Location.joinWithSlash(t,this._emptyResourcesModulePath));return n.searchParams.set(this._hashParamName,e.configurationContentHash),n.toString()}_getSchemaPath(e,t){const n=new URL(v.Location.joinWithSlash(this._getSchemaRuntimePath(t),`${e}.js`));return n.searchParams.set(this._hashParamName,t.configurationContentHash),n.toString()}_getResourcePath(e,t){const n=new URL(v.Location.joinWithSlash(this._getResourceRuntimePath(t),`${e}Resources.js`));return n.searchParams.set(this._hashParamName,t.configurationContentHash),n.toString()}register(e){return this._requireJs.config({paths:{[e]:this._getSchemaPath(e,this._appInfo),[`${e}Resources`]:[this._getResourcePath(e,this._appInfo),this._getEmptyResourcesPath(this._appInfo)]}}),(0,u.of)(void 0)}registerDescriptors(e,t){e.forEach(n=>{const s=n.schemaName;this._requireJs.config({paths:{[s]:this._getSchemaPath(s,t),[`${s}Resources`]:[this._getResourcePath(s,t),this._getEmptyResourcesPath(t)]}})})}static{this.\u0275fac=function(t){return new(t||ja)(i.\u0275\u0275inject(wu),i.\u0275\u0275inject(Xe))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:ja,factory:ja.\u0275fac})}}class Fa{constructor(e){this._window=e}get(){return this._window.requirejs}static{this.\u0275fac=function(t){return new(t||Fa)(i.\u0275\u0275inject(T.ZP))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Fa,factory:Fa.\u0275fac})}}var bs=h(71260),xp=h(72051),Tp=h(30293);class Ss{constructor(){this.handlerChain=Qt.instance}static{this._instanceOfKey="devkit_BaseRequestHandler"}get next(){return this._next}static[Symbol.hasInstance](e){return e?.constructor?._instanceOfKey===Ss._instanceOfKey}setNext(e){if(this._next)throw new qd;this._next=e}}function Tl(r){return r?function(e){bn(r.type,"RequestHandlerTypeName"),Bo(r.type),Vg(r,e)}:e=>{}}class Qy{constructor(){}copyTextToBuffer(e){var t=this;return(0,f.A)(function*(){const s=(Array.isArray(e)?e:[e]).map(a=>({data:a,mimeType:"text/plain"}));try{return yield t.copyToBuffer(s)}catch{return console.log("Copy to clipboard is not allowed")}})()}}let xu=class extends Ss{constructor(e,t){super(),this._copyClipboardService=e,this._notifyService=t}handle(e){var t=this;return(0,f.A)(function*(){yield t._copyClipboardService.copyTextToBuffer(e.value),yield t._notifyService.show({message:"CopyClipboard.Copied"}),yield t.next?.handle(e)})()}};xu=(0,y.__decorate)([Tl({type:"crt.CopyClipboardRequestHandler",requestType:"crt.CopyClipboardRequest"}),(0,y.__metadata)("design:paramtypes",[Qy,Fi])],xu);function Xy(r){return function(e,t,n){Reflect.defineMetadata(rm+n,r,e)}}let Tu=class extends Ss{constructor(e){super(),this.notificationSender=e}handle(e){var t=this;return(0,f.A)(function*(){yield t.notificationSender.notify(e.config),yield t.next?.handle(e)})()}};Tu=(0,y.__decorate)([Tl({type:"crt.ShowDesktopNotificationHandler",requestType:"crt.ShowDesktopNotificationRequest"}),(0,y.__param)(0,Xy(T.X4)),(0,y.__metadata)("design:paramtypes",[Object])],Tu);let Au=class extends Ss{constructor(e){super(),this._soundPlayerService=e}handle(e){var t=this;return(0,f.A)(function*(){yield t._soundPlayerService.playFromSource(e.source,e.throwErrors),yield t.next?.handle(e)})()}};Au=(0,y.__decorate)([Tl({type:"crt.SoundNotificationHandler",requestType:"crt.SoundNotificationRequest"}),(0,y.__metadata)("design:paramtypes",[T.wZ])],Au);let Ba=class gd{static{this.\u0275fac=function(t){return new(t||gd)}}static{this.\u0275mod=i.\u0275\u0275defineNgModule({type:gd})}static{this.\u0275inj=i.\u0275\u0275defineInjector({providers:[nt,Va,ys,bs.B4,La,Hn,{provide:wu,useFactory:e=>e.requirejs,deps:[T.ZP]},ka,Cs,ja,Fa,{provide:Zh,useValue:e=>e?.header?.sender==="SchemaManagerItemEventNotifier"&&e?.header?.bodyTypeName==="ChangedSchema",multi:!0},{provide:Yh,useValue:e=>e?.header?.sender==="SchemaManagerItemEventNotifier"&&e?.header?.bodyTypeName==="RemovedSchema",multi:!0},{provide:nu,useValue:e=>e?.header?.sender==="SchemaManagerItemEventNotifier"&&e?.header?.bodyTypeName==="SchemaRightsChanged",multi:!0},{provide:nu,useValue:e=>e?.header?.sender==="SchemaManagerItemRightsChangedNotifier",multi:!0},{provide:xp.P,useValue:{name:rl.HO,type:eu.P.PersistentAndMemory,options:{tableName:Tp.w.ApplicationInfo}},multi:!0}],imports:[m.TranslateModule]})}};Ba=(0,y.__decorate)([Od({requestHandlers:[xu,Tu,Au]})],Ba),function(){(typeof ngJitMode>"u"||ngJitMode)&&i.\u0275\u0275setNgModuleScope(Ba,{imports:[m.TranslateModule]})}();function Ce(r){return r?function(e){const t=typeof r=="string"?r:r.type;bn(t,"converterTypeName"),Pg({type:t,typeRef:e},e)}:e=>{}}const Ap=[E.r.Float,E.r.FLOAT1,E.r.FLOAT2,E.r.FLOAT3,E.r.FLOAT4,E.r.FLOAT8,E.r.Integer,E.r.Money],eC=[E.r.DateTime,E.r.Date,E.r.Time];var tC=h(23493);class Ms{transform(e){return(0,tC.decode)(e)}static{this.\u0275fac=function(t){return new(t||Ms)}}static{this.\u0275pipe=i.\u0275\u0275definePipe({name:"decodeHtml",type:Ms,pure:!0,standalone:!0})}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Ms,factory:Ms.\u0275fac,providedIn:"root"})}}class vs extends T.NS{handle(e){return e.dateTimeFormat?.date?.format==="week"?"W":super.handle(e)}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=i.\u0275\u0275getInheritedFactory(vs)))(n||vs)}})()}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:vs,factory:vs.\u0275fac,providedIn:"root"})}}class Is extends T.NS{handle(e){return e?.dateTimeFormat?.time?.format==="hour"?"H":super.handle(e)}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=i.\u0275\u0275getInheritedFactory(Is)))(n||Is)}})()}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Is,factory:Is.\u0275fac,providedIn:"root"})}}class Ua{constructor(){this._defaultShortDatePattern="M/D/YYYY"}convert(e){if(e)return{...e,shortDatePattern:e?.shortDatePattern?.toUpperCase()??this._defaultShortDatePattern,shortTimePattern:e?.shortTimePattern?.replace("tt","A")}}static{this.\u0275fac=function(t){return new(t||Ua)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Ua,factory:Ua.\u0275fac,providedIn:"root"})}}const nC=new i.InjectionToken("DateTimeFormatInfo",{providedIn:"root",factory:()=>{const r=(0,i.inject)(Ua),e=(0,i.inject)(We.oq);return r.convert(e?.cultureInfo?.dateTimeFormat)}}),iC="M/D/YYYY";class ui extends T.NS{constructor(e){super(),this._dateTimeFormat=e}_castToDateTimeFormat(e){const t=e.format;if(!t)return e;const n=t.split(" ").length>=2;return{type:e.type,date:{display:!0},time:{display:n}}}_getDateTimeFormatMoment(e){let t="";const{shortDatePattern:n,shortTimePattern:s}=this._dateTimeFormat??{};if(!n&&!s)return iC;const{date:a,time:o}=e??{},{display:c=!1}=a??{},{display:d=!1}=o??{};return c&&(t+=n),d&&(t+=` ${s}`),t.trim()}handle(e){const{dateTimeFormat:t,handledMomentFormat:n}=e,s=this._castToDateTimeFormat(t),a=this._getDateTimeFormatMoment(s);this.format=s?.date?.format;let o=this.internalHandler(n??a);if(o!==a){const c=new RegExp(`^\\${this._dateTimeFormat.dateSeparator}+`),d=new RegExp(`\\${this._dateTimeFormat.dateSeparator}+$`),p=new RegExp(`\\${this._dateTimeFormat.dateSeparator}{2,}`,"g");o=o.replace(c,"").replace(d,"").replace(p,this._dateTimeFormat.dateSeparator)}return e.handledMomentFormat=o,super.handle(e)??o}static{this.\u0275fac=function(t){return new(t||ui)(i.\u0275\u0275inject(nC))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:ui,factory:ui.\u0275fac,providedIn:"root"})}}class ws extends ui{internalHandler(e){return this.format&&!this.format.has("days")?e.replace(/D/g,""):e}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=i.\u0275\u0275getInheritedFactory(ws)))(n||ws)}})()}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:ws,factory:ws.\u0275fac,providedIn:"root"})}}class Es extends ui{internalHandler(e){return this.format&&!this.format?.has("months")?e.replace(/M/g,""):e}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=i.\u0275\u0275getInheritedFactory(Es)))(n||Es)}})()}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Es,factory:Es.\u0275fac,providedIn:"root"})}}class xs extends ui{internalHandler(e){return this.format&&!this.format?.has("years")?e.replace(/Y/g,""):e}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=i.\u0275\u0275getInheritedFactory(xs)))(n||xs)}})()}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:xs,factory:xs.\u0275fac,providedIn:"root"})}}const Dp=new i.InjectionToken("Represents the moment date time format",{factory:()=>{const r=(0,i.inject)(vs),e=(0,i.inject)(Is),t=(0,i.inject)(ws),n=(0,i.inject)(Es),s=(0,i.inject)(xs);return{getFormat:a=>(r.setNext(e).setNext(t).setNext(n).setNext(s),r.handle({dateTimeFormat:a}))}},providedIn:"root"});class Du{}class za extends Du{constructor(e){super(),this._momentDateTimeFormatter=e}format(e,t){if(!e)return"";const n=new Date(e);if(isNaN(n))return"";const s=this._momentDateTimeFormatter.getFormat(t);return No()(n).format(s)}static{this.\u0275fac=function(t){return new(t||za)(i.\u0275\u0275inject(Dp))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:za,factory:za.\u0275fac,providedIn:"root"})}}const sC=new i.InjectionToken("Represents a datetime data formatter",{factory:()=>new za((0,i.inject)(Dp)),providedIn:"root"});class Nu{constructor(e){this._formatter=e}getValue(e){return e.toString()}getFormat(e){if(!e)return this.defaultFormat;const t=this.getFormatByDataType(e.dataType);return t?(0,M.merge)({},t,e):{type:this.defaultFormat?.type,...(0,M.omit)(e,"dataType")}}getFormatByDataType(e){return e&&this.formatsByDataTypeMap.get(e)}isSupportedValue(e){return typeof e=="string"}transform(e,t){if(!this.isSupportedValue(e))return"";const n=this.getValue(e),s=this.getFormat(t);return this._formatter.format(n,s)}}const rC=new Map([[E.r.Date,{type:"datetime",date:{display:!0}}],[E.r.DateTime,{type:"datetime",date:{display:!0},time:{display:!0}}],[E.r.Time,{type:"datetime",date:{display:!1},time:{display:!0}}]]);class Ts extends Nu{constructor(e){super(e),this.defaultFormat={type:"datetime",date:{display:!0}},this.formatsByDataTypeMap=rC}getValue(e){return typeof e=="number"&&(e=new Date(e)),e.toString()}isSupportedValue(e){return super.isSupportedValue(e)||typeof e=="number"||e instanceof Date}transform(e,t){return e===""?"":super.transform(e,t)}static{this.\u0275fac=function(t){return new(t||Ts)(i.\u0275\u0275directiveInject(sC,16))}}static{this.\u0275pipe=i.\u0275\u0275definePipe({name:"dateTimeFormat",type:Ts,pure:!0})}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Ts,factory:Ts.\u0275fac,providedIn:"root"})}}class di{constructor(e){this._translate=e}transform(e){if(!e?.value)return null;const t=e?.displayValue||null;return e&&Kt.String.isNullOrWhiteSpace(t)?this._translate.instant("LookupFormat.EmptyDisplayValue"):t}static{this.\u0275fac=function(t){return new(t||di)(i.\u0275\u0275directiveInject(m.TranslateService,16))}}static{this.\u0275pipe=i.\u0275\u0275definePipe({name:"lookupFormat",type:di,pure:!0})}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:di,factory:di.\u0275fac,providedIn:"root"})}}const aC=new Map([[E.r.Integer,0],[E.r.Float,2],[E.r.Money,2],[E.r.FLOAT1,1],[E.r.FLOAT2,2],[E.r.FLOAT3,3],[E.r.FLOAT4,4],[E.r.FLOAT8,8]]);var oC=h(67462),Pu=h.n(oC);const lC=0,cC=20,Ha=".",Np="",aM=1024;class Wa{constructor(e){this._userInfo=e}_adjustDecimalPrecision(e){return e==null||(e=parseInt(`${e}`,10),isNaN(e))?null:(e=Math.min(e,cC),e=Math.max(e,lC),e)}_adjustDecimalSeparator(e){const t=this._userInfo?.cultureInfo?.decimalSeparator;return typeof t=="string"?t:e||Ha}_adjustThousandSeparator(e){const t=this._userInfo?.cultureInfo?.thousandSeparator;return typeof t=="string"?t:e||Np}adjust(e){const{decimalPrecision:t,decimalSeparator:n,thousandSeparator:s,thousandAbbreviation:a,trimTrailingZeros:o}=e||{};return{type:"number",decimalPrecision:this._adjustDecimalPrecision(t),decimalSeparator:this._adjustDecimalSeparator(n),trimTrailingZeros:o??!1,thousandSeparator:this._adjustThousandSeparator(s),thousandAbbreviation:{enabled:a?.enabled===!0}}}static{this.\u0275fac=function(t){return new(t||Wa)(i.\u0275\u0275inject(We.oq,8))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Wa,factory:Wa.\u0275fac,providedIn:"root"})}}const uC=",",Pp="#DECIMAL_SEPARATOR#",Rp="#THOUSAND_SEPARATOR#";class $a extends Du{constructor(e){super(),this._formatAdjuster=e}_isNaN(e){const t=parseFloat(e);return isNaN(t)}_isExponentialValue(e){return/^[-+]?\d*\.?\d+[eE][-+]?\d+$/.test(e)}_getPrecisionFromExponential(e){const[,t,n]=e.match(/^[-+]?(\d*\.?\d+)[eE]([-+]?\d+)$/),[s,a=""]=t.split(Ha),o=parseInt(n,10),c=s+a,d=s.length+o,p=c.length-d;return p>0?p:0}_convertExponentialToDecimal(e,t){const n=t?.decimalPrecision??this._getPrecisionFromExponential(e);try{return Pu()(e).format({mantissa:n})}catch{return e.toString()}}_createNumbroFormat(e,t){const{decimalPrecision:n,trimTrailingZeros:s,thousandSeparator:a,thousandAbbreviation:o}=t;this._isExponentialValue(e)&&(e=this._convertExponentialToDecimal(e,t));const[c,d]=e.split(Ha),p=Math.abs(parseInt(c,10))>=1e3;return!!o?.enabled&&p?{average:!0,thousandSeparated:!!a,mantissa:1,optionalMantissa:!0}:{mantissa:n??d?.length??0,thousandSeparated:!!a,trimMantissa:!!s}}_replaceSeparators(e,t){const{decimalSeparator:n,thousandSeparator:s}=t,a=[{searchValue:Ha,replaceMacros:Pp,replaceValue:n},{searchValue:uC,replaceMacros:Rp,replaceValue:s}];return(0,T.mh)(e,a)}_undoReplaceSeparators(e,t){const{decimalSeparator:n,thousandSeparator:s}=t,a=[{searchValue:n,replaceMacros:Pp,replaceValue:Ha},{searchValue:s,replaceMacros:Rp,replaceValue:Np}];return(0,T.mh)(e,a)}format(e,t){if(this._isNaN(e))return"";t||(t={type:"number"});const n=this._formatAdjuster.adjust(t),s=this._createNumbroFormat(e,n);let a;try{a=Pu()(e).format(s)}catch{a=Pu()(0).format(s)}return this._replaceSeparators(a,n)}undoFormat(e,t){if(this._isNaN(e))return"";t||(t={type:"number"});const n=this._formatAdjuster.adjust(t);return this._undoReplaceSeparators(e,n)}static{this.\u0275fac=function(t){return new(t||$a)(i.\u0275\u0275inject(Wa))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:$a,factory:$a.\u0275fac,providedIn:"root"})}}const dC=new i.InjectionToken("Represents a number data formatter",{factory:()=>(0,i.inject)($a),providedIn:"root"}),hC=new Map(Ap.map(r=>[r,pC(r)]));function pC(r){return{type:"number",decimalPrecision:aC.get(r)}}class As extends Nu{constructor(e){super(e),this.defaultFormat={type:"number"},this.formatsByDataTypeMap=hC}isSupportedValue(e){return super.isSupportedValue(e)||typeof e=="number"}static{this.\u0275fac=function(t){return new(t||As)(i.\u0275\u0275directiveInject(dC,16))}}static{this.\u0275pipe=i.\u0275\u0275definePipe({name:"numberFormat",type:As,pure:!0})}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:As,factory:As.\u0275fac,providedIn:"root"})}}const mC=new Map([["default",{ADD_TAGS:["#comment","signature"],FORCE_BODY:!0}],["textOnly",{ALLOWED_TAGS:["#text"],FORBID_CONTENTS:T.G8}]]);class Ga extends Du{constructor(e){super(),this._domPurifier=e,this._defaultFormat={type:"sanitizeHtml",mode:"default"},this._sanitizationConfigsByMode=mC}_sanitizeHtml(e,t){const n=t.mode??"default",s=this._sanitizationConfigsByMode.get(n);return this._domPurifier.sanitize(e,s).toString()}format(e,t){return e?this._sanitizeHtml(e,t??this._defaultFormat):""}static{this.\u0275fac=function(t){return new(t||Ga)(i.\u0275\u0275inject(T.MV))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Ga,factory:Ga.\u0275fac,providedIn:"root"})}}const gC=new i.InjectionToken("Represents a sanitize html formatter",{factory:()=>new Ga((0,i.inject)(T.MV)),providedIn:"root"});class Ds extends Nu{constructor(e){super(e),this.defaultFormat={type:"sanitizeHtml"},this.formatsByDataTypeMap=new Map([])}isSupportedValue(e){return super.isSupportedValue(e)||typeof e=="number"||typeof e=="boolean"||typeof e=="bigint"||typeof e=="symbol"||e instanceof Date}static{this.\u0275fac=function(t){return new(t||Ds)(i.\u0275\u0275directiveInject(gC,16))}}static{this.\u0275pipe=i.\u0275\u0275definePipe({name:"sanitizeHtml",type:Ds,pure:!0})}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Ds,factory:Ds.\u0275fac,providedIn:"root"})}}class Ns{constructor(e){this._injector=e}_sanitizeText(e,t){const n=this._injector.get(Ms),s=this._injector.get(Ds);return e=n.transform(e),e=s.transform(e,{mode:"textOnly",dataType:t}),e=n.transform(e),e}transform(e,t){const{dataType:n}=t??{};return Ap.includes(n)?this._injector.get(As).transform(e,t):n===E.r.Lookup?this._injector.get(di).transform(e):eC.includes(n)?this._injector.get(Ts).transform(e,t):n===E.r.IMAGELOOKUP?"":typeof e=="string"?this._sanitizeText(e,n):e?.toString()}static{this.\u0275fac=function(t){return new(t||Ns)(i.\u0275\u0275directiveInject(i.Injector,16))}}static{this.\u0275pipe=i.\u0275\u0275definePipe({name:"valueFormat",type:Ns,pure:!0})}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Ns,factory:Ns.\u0275fac,providedIn:"root"})}}let Ru=class{constructor(e){this._formatValuePipe=e}convert(e,t,n){return this._formatValuePipe.transform(e,n)}};Ru=(0,y.__decorate)([Ce({type:"crt.FormatValue"}),(0,y.__metadata)("design:paramtypes",[Ns])],Ru);let Ou=class{convert(e){return!e}};Ou=(0,y.__decorate)([Ce({type:"crt.InvertBooleanValue"})],Ou);let Al=class{convert(e,t,n){return(0,M.isEqual)(e,n)}};Al=(0,y.__decorate)([Ce({type:"crt.IsEqual"})],Al);let Vu=class{convert(e){return!!e}};Vu=(0,y.__decorate)([Ce({type:"crt.ToBoolean"})],Vu);let Lu=class{convert(e){return e?`mailTo: ${e}`:""}};Lu=(0,y.__decorate)([Ce({type:"crt.ToEmailLink"})],Lu);const fC=new i.InjectionToken("A factory of empty placeholder creators");class Ps{constructor(e){this._emptyPlaceholderCreatorFactory=e}transform(e,t){return e==null||e===""?this._emptyPlaceholderCreatorFactory?.create(t)?.create(t)??"":e}static{this.\u0275fac=function(t){return new(t||Ps)(i.\u0275\u0275directiveInject(fC,16))}}static{this.\u0275pipe=i.\u0275\u0275definePipe({name:"toEmptyPlaceholder",type:Ps,pure:!0})}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Ps,factory:Ps.\u0275fac})}}let ku=class{constructor(e){this._toEmptyPlaceholder=e}convert(e,t,n){return this._toEmptyPlaceholder.transform(e,n)}};ku=(0,y.__decorate)([Ce({type:"crt.ToEmptyPlaceholder"}),(0,y.__metadata)("design:paramtypes",[Ps])],ku);let ju=class{convert(e){return e?.displayValue||e?.value||e}};ju=(0,y.__decorate)([Ce({type:"crt.ToDisplayValue"})],ju);let Fu=class{constructor(e){this._userInfo=e}convert(e){const t=this._userInfo?.cultureInfo,n=(0,M.isEmpty)(t?.dateTimeFormat?.code)?(0,M.isEmpty)(t?.sysCultureName)?"en-US":t.sysCultureName:t.dateTimeFormat.code,s=!(0,M.isEmpty)(t?.dateTimeFormat?.amDesignator);return new Intl.DateTimeFormat(n,{hour:"2-digit",minute:"2-digit",hour12:s}).format(e)}};Fu=(0,y.__decorate)([Ce({type:"crt.ToLocalTimeValue"}),(0,y.__metadata)("design:paramtypes",[We.oq])],Fu);let Bu=class{convert(e,t){return e?typeof e=="string"?e:uu(e.value):""}};Bu=(0,y.__decorate)([Ce({type:"crt.ToImageLink"})],Bu);let Uu=class{convert(e,t,n,s=null){const a=e&&e[n];return a==null||a===""?s:a}};Uu=(0,y.__decorate)([Ce({type:"crt.ToObjectProp"})],Uu);let zu=class{convert(e){return e?`tel: ${e}`:""}};zu=(0,y.__decorate)([Ce({type:"crt.ToPhoneLink"})],zu);let Hu=class{constructor(){this._fileServicePath="rest/FileService/"}_getFilePath(e){const t=this._fileServicePath+v.Location.joinWithSlash("Download",e);return pe()+t}convert(e,t,n){return n?v.Location.joinWithSlash(this._getFilePath(n),e):""}};Hu=(0,y.__decorate)([Ce({type:"crt.ToFileLink"})],Hu);let Wu=class{_tryGetLookupValueFromCollection(e,t,{primaryAttributeName:n,primaryDisplayAttributeName:s,primaryColorAttributeName:a}){const o=t.find(p=>p.attributes[n]===e);if(!o)return null;const c=o.attributes[s];if(s&&!c)return null;const d=o.attributes[a];return a&&!d?null:{value:e,displayValue:c,primaryColorValue:d}}_getAttributeValue(e,t){let n=e;for(const s of t)if(n?.attributes&&s in n.attributes)n=n.attributes[s];else return;return n}_getCollectionForSearch(e,t){const n=e.dataSchemas[t],s=e.getViewModelAttributePath(t,n.primaryAttributeName).split(".").slice(0,-1);let a;const o=this._getAttributeValue(e,s);if(o instanceof on)a=[o];else if(o instanceof tt&&o.length)a=o;else return null;const c=a[0].getViewModelAttributePath(t,n.primaryAttributeName),d=a[0].getViewModelAttributePath(t,n.primaryDisplayAttributeName);if(n.primaryDisplayAttributeName&&!d)return null;const p=a[0].getViewModelAttributePath(t,n.primaryColorAttributeName);return n.primaryColorAttributeName&&!p?null:{collection:a,keys:{primaryAttributeName:c,primaryDisplayAttributeName:d,primaryColorAttributeName:p}}}_getModelsBoundToEntity(e,t){const n=e.dataSchemas;return Object.entries(n).filter(([,s])=>s.name===t).map(([s])=>s)}_getFilterByPrimaryValues(e,t){const n=new _a("tempTable"),s=new be({columnPath:e}),a=t.map(d=>new we({value:d})),o=new en(ge.Equal,s,a);return n.filters.add(o),n.getMetadata().filters}_getLookupValuesFromDataSource(e,t){var n=this;return(0,f.A)(function*(){if(!e.length)return[];const s=yield kt.create(t),a=yield s.getSchema(),{primaryAttributeName:o,primaryDisplayAttributeName:c,primaryColorAttributeName:d}=a,p=n._getFilterByPrimaryValues(o,e),C=[o,c,d].filter(Boolean),I=yield s.load({attributes:C,parameters:[{type:ce.Filter,value:p}]});return e.map(O=>{const Y=I.find(te=>te[o]===O);return Y?{value:Y[o],displayValue:Y[c],primaryColorValue:Y[d]}:{value:O}})})()}getLookupValuesFromContext(e,t,n){const s=()=>({lookupValues:[],notFound:e.slice()});if(!e.length)return s();const a=this._getModelsBoundToEntity(t,n);if(!a.length)return s();const o=a.map(d=>this._getCollectionForSearch(t,d)).filter(Boolean);if(!o.length)return s();const c={lookupValues:[],notFound:[]};return e.forEach(d=>{let p;for(let C=0;!p&&C<o.length;C++){const{collection:I,keys:O}=o[C];p=this._tryGetLookupValueFromCollection(d,I,O)}p?c.lookupValues.push(p):c.notFound.push(d)}),c}convert(e,t,n){var s=this;return(0,f.A)(function*(){const a=Array.isArray(e),o=a?e:[e],c=o.filter(le.n7),d=s.getLookupValuesFromContext(c,t,n),{lookupValues:p,notFound:C}=d,I=yield s._getLookupValuesFromDataSource(C,n),O=o.map(Y=>p.find(te=>te.value===Y)??I.find(te=>te.value===Y)??Y);return a?O:O[0]})()}};Wu=(0,y.__decorate)([Ce({type:"crt.ToLookup"})],Wu);let $u=class{_isEncodedUri(e){return/%[0-9A-Fa-f]{2}/g.test(e)}_getEncodedUri(e){return this._isEncodedUri(e)?e:encodeURI(e)}convert(e){return(0,M.isEmpty)(e)?"":(e=e.trim(),this._getEncodedUri(e.startsWith("http://")||e.startsWith("https://")?e:`//${e}`))}};$u=(0,y.__decorate)([Ce({type:"crt.LinkPrefix"})],$u);let Gu=class{_normalizePrimaryAttributeValues(e){return e?Array.isArray(e)?e:[e]:[]}_getFilteredPrimaryAttributeValues(e,t,n){return(0,f.A)(function*(){const{filterByPrimaryAttributeValues:s}=n??{},a=yield e.getPrimaryAttributeValues();return s===!1?a:t.filter(o=>a.includes(o))})()}_getViewModelAttributeName(e,t,n){const a=e.getBoundDataSchemaByAttributePath(t)?.attributes?.find(({path:p})=>p===n);if(!a)return null;const c=e.getBoundDataSourceNameByAttributePath(t);return e.getViewModelAttributePath(c,a.name).split(".").pop()}_getValuesFromCollection(e,t){var n=this;return(0,f.A)(function*(){const{context:s,collectionAttributeName:a,primaryAttributeValues:o,dataSourceAttributePath:c}=t,d=n._getViewModelAttributeName(s,a,c);if(!d)return null;const p=yield e.filterByPrimaryAttributes(o),C=`${a}.${d}`;return(yield Promise.all(p.map(O=>O[d]))).filter(O=>n._isAttributeValueValid(s,C,O))})()}_isAttributeValueValid(e,t,n){return e._getDataSourceAttributeDataValueType(t)===E.r.Lookup?wh(n):!0}_loadValuesByCollection(e){return(0,f.A)(function*(){const{context:t,collectionAttributeName:n,primaryAttributeValues:s,dataSourceAttributePath:a}=e,o=t.getBoundDataSchemaByAttributePath(n),c=yield kt.create(o.name),d=new en(ge.Equal,new be({columnPath:o.primaryAttributeName}),s.map(C=>new we({value:C}))),p=yield c.load({attributes:[a],parameters:[{type:ce.Filter,value:(0,Ee.classToPlain)(d)}]});return p?p.map(C=>C[a]):[]})()}convert(e,t,n,s,a){var o=this;return(0,f.A)(function*(){const[c,d]=e??[];if(!c||!n||!s||!t)return[];const p=o._normalizePrimaryAttributeValues(d),C=a?.filterByPrimaryAttributeValues!==!1;if(!p?.length&&C)return[];const I=yield o._getFilteredPrimaryAttributeValues(c,p,a);if(!I?.length)return[];const O={context:t,primaryAttributeValues:I,collectionAttributeName:n,dataSourceAttributePath:s};return(yield o._getValuesFromCollection(c,O))||o._loadValuesByCollection(O)})()}};Gu=(0,y.__decorate)([Ce({type:"crt.ToValuesFromCollection"})],Gu);var Zu;(function(r){r.Sum="sum"})(Zu||(Zu={}));let Yu=class{_summarize(e){let t=0;return!Array.isArray(e)&&!Number.isNaN(e)?e:(e.map(n=>t+=Number(n)),t)}convert(e,t,n){return e&&n===Zu.Sum?this._summarize(e):0}};Yu=(0,y.__decorate)([Ce({type:"crt.ToAggregatedValue"})],Yu);let Ku=class{constructor(e){this._injector=e,this._httpClient=this._injector.get(P.HttpClient)}_getDcmStagesList(e){return this._httpClient.post("/rest/PlaybookStageService/"+"GetDcmStages",{dcmId:e}).pipe((0,u.map)(n=>n.stageValues))}convert(e){return e?(0,u.lastValueFrom)(this._getDcmStagesList(e.value)):Promise.resolve([])}};Ku=(0,y.__decorate)([Ce({type:"crt.ToDcmStageValue"}),(0,y.__metadata)("design:paramtypes",[i.Injector])],Ku);let qu=class{convert(e,t,n,...s){return Kt.String.format(n,e,...s)}};qu=(0,y.__decorate)([Ce({type:"crt.InterpolateString"})],qu);let Ju=class extends Al{convert(e,t,n){const s=Array.isArray(e)?e:[e];return s.length?s.every(a=>super.convert(a,t,n)):!0}};Ju=(0,y.__decorate)([Ce({type:"crt.IsEveryEqualTo"})],Ju);let Qu=class{constructor(e){this._lookupFormatPipe=e}convert(e){return this._lookupFormatPipe.transform(e)}};Qu=(0,y.__decorate)([Ce({type:"crt.ToLookupDisplayValue"}),(0,y.__metadata)("design:paramtypes",[di])],Qu);let Xu=class{constructor(e){this._translateService=e}_getEmptyDisplayValue(){return this._translateService.instant("LookupFormat.EmptyDisplayValue")}convert(e){if(!e)return this._getEmptyDisplayValue();const t=Object.values(Ki.Q).find(n=>n.id===e)?.translateKey;return t?this._translateService.instant(t):this._getEmptyDisplayValue()}};Xu=(0,y.__decorate)([Ce({type:"crt.ToDataValueTypeDisplayValue"}),(0,y.__metadata)("design:paramtypes",[m.TranslateService])],Xu);let ed=class{constructor(e){this._translateService=e}convert(e){if(!e)return null;const t=Object.values(Ki.Q).find(n=>n.id===e);return t?{value:t.id,displayValue:this._translateService.instant(t.translateKey)}:null}};ed=(0,y.__decorate)([Ce({type:"crt.ToDataValueTypeLookupValue"}),(0,y.__metadata)("design:paramtypes",[m.TranslateService])],ed);let td=class{convert(e,t,n,s){return e?n:s}};td=(0,y.__decorate)([Ce({type:"crt.IfElse"})],td);let nd=class{convert(e,t,n){Array.isArray(e)||(e=[e,n]);const s=e[0],a=e[1];return s||a}};nd=(0,y.__decorate)([Ce({type:"crt.OrBooleanValue"})],nd);let id=class{convert(e,t,n){return(0,f.A)(function*(){return(e?.shift()||t.attributes[n])?.length?{}:{display:"none"}})()}};id=(0,y.__decorate)([Ce({type:"crt.HideComponentWithNoItems"})],id);let sd=class $l{convert(e,t,n,s){return(0,f.A)(function*(){const a=yield t[n];if(!a||!Array.isArray(a))return null;for(const o of a)if(typeof o=="object"&&o!==null&&s){if((yield o[s])===e)return o}else if(o===e)return o;return null})()}static{this.\u0275fac=function(t){return new(t||$l)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:$l,factory:$l.\u0275fac})}};sd=(0,y.__decorate)([Ce({type:"crt.FindInCollection"})],sd);let rd=class Gl{convert(e,t,n){return t.getModelByName(n).isLoaded}static{this.\u0275fac=function(t){return new(t||Gl)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Gl,factory:Gl.\u0275fac})}};rd=(0,y.__decorate)([Ce({type:"crt.IsModelLoaded"})],rd);class Za{static{this._requestsMap=new Map}static{this._requestsRegistrationInfos=new Map}static get requestsRegistrationInfos(){return this._requestsRegistrationInfos}static register(e,t){const n=e.type;Za._requestsMap.set(n,t),Za._requestsRegistrationInfos.set(n,e)}static get(e){const t=Za._requestsMap.get(e);return hf(e,t),t&&new t}}function _C(r){return function(e){bn(r.type,"RequestTypeName"),Bo(r.type),Za.register(r,e)}}let Op=class extends Th{constructor(){super(...arguments),this.type="crt.ChangeViewModelAttributeValueRequest"}};Op=(0,y.__decorate)([_C({type:"crt.ChangeViewModelAttributeValueRequest"})],Op);let ad=class extends Ss{handle(e){return(0,f.A)(function*(){const{$context:t,attributeName:n,attributeValue:s}=e||{};if(!t||!n)return;const a=t;return yield(0,u.lastValueFrom)(a.setValue({[n]:s}),{defaultValue:null}),s})()}};ad=(0,y.__decorate)([Tl({type:"crt.ChangeViewModelAttributeValueHandler",requestType:"crt.ChangeViewModelAttributeValueRequest"})],ad);class Rs{constructor(){this._maxGridLayoutRow=1,this._maxColumnsCount=12,this._defaultItemLayout={colSpan:1,row:1,column:1,rowSpan:1},this._defaultRowSpan=1,this._defaultColSpan=6}_applyExplicitPositions(e,t){if(e.every(n=>!n?.layoutConfig)){let n=1,s=1;e.forEach(a=>{const o=a.layoutConfig||{};o.column===void 0&&(o.column=s,s++),o.colSpan===void 0&&(o.colSpan=1),o.row===void 0&&(o.row=n),o.rowSpan===void 0&&(o.rowSpan=1),o.column===1&&o.colSpan===-1&&n++,s>t&&(s=1,n++),a.layoutConfig=o})}return e}_checkBitmapIntersection(e,t){let n,s;for(n=0,s=e.length;n<s;n++)if((e[n]&t[n])>0)return!0;return!1}_calculateBitMask(e,t,n){const s=n-e;return Math.pow(2,s)-Math.pow(2,s-t)}_isEmpty(e){return e==null||e===""||(0,M.isArray)(e)&&e.length===0}_getItemBitmap(e,t){const n=[];if(this._isEmpty(e))return n;const s=e.column,a=e.row,o=e.colSpan||this._defaultColSpan,c=e.rowSpan||this._defaultRowSpan;let d,p;for(d=a,p=a+c;d<p;d++)n[d]=this._calculateBitMask(s,o,t);return n}_setDefaultValue(e,t,n,s){e[n]||(e[n]=s),t[n]||(t[n]=s)}_fixItemIntersect(e,t){const n=e.layoutConfig,s=t.layoutConfig,a=this._tryFixColumns(n,s);let o=!0;return a||(o=this._tryFixRows(n,s)),!a&&!o&&n.row>this._maxGridLayoutRow&&(this._maxGridLayoutRow+=1),!a&&!o&&this._moveDownItem(e),e}_moveDownItem(e){this._maxGridLayoutRow++;const t=e.layoutConfig;t.row=this._maxGridLayoutRow,t.column=1;const n=this._originalItems.find(s=>s.name===e.name);n&&(t.colSpan=n.layoutConfig.colSpan||1)}_tryFixColumns(e,t){return this._setDefaultValue(e,t,"colSpan",this._defaultColSpan),this._calculateNewParameters(e,t,"column","colSpan")}_tryFixRows(e,t){return this._setDefaultValue(e,t,"rowSpan",this._defaultRowSpan),this._calculateNewParameters(e,t,"row","rowSpan")}_calculateNewParameters(e,t,n,s){const a=e[s],o=t[s],c=t[n],d=c+o,p=e[n],C=p+a,I=c<=p,O=I?d-p:C-c;return a<=O?!1:(I&&(e[n]=d),e[s]=a-O,!0)}_compareItemsPositions(e,t){const n=e.layoutConfig||(0,M.cloneDeep)(this._defaultItemLayout),s=t.layoutConfig||(0,M.cloneDeep)(this._defaultItemLayout),a=Math.max(n.colSpan||this._defaultColSpan,n.rowSpan||this._defaultRowSpan),o=Math.max(s.colSpan||this._defaultColSpan,s.rowSpan||this._defaultRowSpan);return n.row!==s.row?n.row<s.row?-1:1:a<o||n.column<s.column&&a<=o?-1:1}_getMaxGridLayoutRow(e){const t=e.map(n=>{const s=n.layoutConfig||{},a=s.row||1,o=s.rowSpan||1;return a+o-1});return Math.max(...t)||1}_getMaxColumnsCount(e,t){const n=e.map(s=>{const a=s.layoutConfig||{},o=a.column||1,c=a.colSpan||1;return o+c-1});return Math.max(...n,t,this._maxColumnsCount)}fixItemsOverlap(e,t){this._originalItems=(0,M.cloneDeep)(e);const n=[],s=[];return this._maxGridLayoutRow=this._getMaxGridLayoutRow(e),this._maxColumnsCount=this._getMaxColumnsCount(e,t),[...e].sort((o,c)=>this._compareItemsPositions(o,c)).forEach(o=>{let c=this._getItemBitmap(o.layoutConfig,this._maxColumnsCount);s.forEach(d=>{const p=this._getItemBitmap(d.layoutConfig,this._maxColumnsCount);this._checkBitmapIntersection(p,c)&&(o=this._fixItemIntersect(o,d),c=this._getItemBitmap(o.layoutConfig,this._maxColumnsCount),n.push(o.name))}),s.push(o)}),this._applyExplicitPositions(e,t),{items:e,affectedItems:n}}static{this.\u0275fac=function(t){return new(t||Rs)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Rs,factory:Rs.\u0275fac})}}class yC{processResponse(e,t){return e.skipUnsuccessfulResponse||(t=t.pipe((0,l.tap)(n=>this.processUnsuccessfulResponse(n)))),t}processUnsuccessfulResponse(e){const{success:t,errorInfo:n}=e||{};!t&&n&&this.processErrorMessage(n.message)}handleRequest(e,t={}){let n=e;return n=this.processResponse(t,n),n.pipe((0,l.catchError)(s=>{let a;return s instanceof Error?a=s.message:(typeof s.error?.errorInfo=="object"&&(a=s.error.errorInfo.message),typeof s.error=="string"&&(a=s.error)),a||(a=JSON.stringify(s.message)),this.processErrorMessage(a),(0,u.throwError)(()=>new Error(a))}))}}var od;(function(r){r[r.None=0]="None",r[r.Count=1]="Count",r[r.Sum=2]="Sum",r[r.Avg=3]="Avg",r[r.Min=4]="Min",r[r.Max=5]="Max",r[r.TopOne=6]="TopOne"})(od||(od={}));var Ue=h(56911);class Vp{}class hi{createObserver(e,t,n){return new CC(e,t,n)}static{this.\u0275fac=function(t){return new(t||hi)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:hi,factory:hi.\u0275fac,providedIn:"root"})}}class CC{constructor(e,t,n){if(this._bottomBuffer=100,this._lastScrollMaxPosition=0,this._emitter=new i.EventEmitter,ue.checkArgumentEmpty("element",e),this._element=e,this._subscribeOnScroll(),n){if(n<=0)throw new Error(`Value of 'bottomBuffer' paramter must be positive, but actual value is ${n}.`);this._bottomBuffer=n}t&&this.subscribe(t)}_isWindowObserved(e){return!(this._element instanceof HTMLElement)}_scrolledToBottom(){const e=this._element,t=this._isWindowObserved(e)?e.document.documentElement.scrollTop:e.scrollTop,n=this._isWindowObserved(e)?e.document.body.scrollHeight:e.scrollHeight,s=this._isWindowObserved(e)?e.innerHeight:e.offsetHeight;if(!n||!s)return!1;const a=n-s-this._bottomBuffer;return this._lastScrollMaxPosition=t>this._lastScrollMaxPosition?t:this._lastScrollMaxPosition,this._lastScrollMaxPosition===t&&t>=a}_processScroll(){this._scrolledToBottom()&&this._emitter.emit()}_subscribeOnScroll(){this._eventListener=this._processScroll.bind(this),this._element.addEventListener("scroll",this._eventListener)}subscribe(e){this._emitter.subscribe(e)}resetScrollMaxPosition(){this._lastScrollMaxPosition=0}destroy(){this._element.removeEventListener("scroll",this._eventListener),this._element=null,this._emitter.unsubscribe()}}class Ya{constructor(e){this._queryExecutor=e}_getColumnPath(e){return typeof e=="string"?e:e.columnPath}_addSchemaColumn(e,t){e.addSchemaColumn(this._getColumnPath(t))}_addPrimaryColumnIfNeeded(e,t,n){const s=e.getPrimaryColumn().name;t.some(a=>this._getColumnPath(a)===s)||n.addSchemaColumn(s)}_getEsqOrderDirection(e){return e?e==="asc"?sn.Asc:sn.Desc:sn.None}_applySort(e,t){if(!t?.sort)return;const n=this._getEsqOrderDirection(t.sort.direction);e.getColumn(t.sort.columnName).withOrdering(n,0)}_buildEsq(e,t){const n=new _a(e.name);return t.columns.forEach(s=>this._addSchemaColumn(n,s)),this._addPrimaryColumnIfNeeded(e,t.columns,n),this._applySort(n,t),t.filter&&n.filters.add(t.filter),n.rowCount=t.rowCount,n.rowsOffset=t.rowsOffset,n}loadEntityData(e,t){ue.checkArgumentEmpty("entitySchema",e),ue.checkArgumentEmpty("config",t);const n=this._buildEsq(e,t);return this._queryExecutor.executeSelectQuery(n)}static{this.\u0275fac=function(t){return new(t||Ya)(i.\u0275\u0275inject(wn))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Ya,factory:Ya.\u0275fac,providedIn:"root"})}}class Ka{_mapEntityColumnDataSchema(e){return{name:e.name,caption:e.caption,valueType:e.dataValueType}}_getColumnPath(e){return typeof e=="string"?e:e.columnPath}buildTableDataSchema(e,t){ue.checkArgumentEmpty("entitySchema",e),ue.checkArgumentEmpty("columns",t);const n=t.map(a=>e.columns.find(o=>this._getColumnPath(a)===o.name)),s=e.getPrimaryColumn().name;return{columns:n.map(this._mapEntityColumnDataSchema.bind(this)),trackBy:a=>a[s]}}static{this.\u0275fac=function(t){return new(t||Ka)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Ka,factory:Ka.\u0275fac,providedIn:"root"})}}const bC=["tableNgContainer"],SC=["dataViewWrapper"];class Os{set config(e){this._validateConfig(e);const t=this._config;this._config=e,(0,M.isEqual)(e,t)||this._applyConfig(e,t)}get sort(){return this._sort}get selectedRecords(){if(!this._entitySchema)return[];const e=this._entitySchema.getPrimaryColumn().name;return this.selectedIds?this._data.filter(t=>this.selectedIds.includes(t[e])):[]}set selectedRecords(e){const t=this._entitySchema.getPrimaryColumn().name,n=this.selectedIds.filter(o=>!this.data.some(c=>c[t]===o)),s=new Set(this.selectedIds),a=new Set(e.map(o=>o[t]).concat(n));this.selectedIds=[...a],(0,M.isEqual)(s,a)||this.selectedIdsChange.emit(this.selectedIds)}get tableDataSchema(){return this._tableDataSchema}get data(){return this._data}get tableConfig(){return this._config?.tableConfig}constructor(e,t,n,s,a){this._restHandler=e,this._entitySchemaService=t,this._loaderService=n,this._tableDataSchemaBuilder=s,this._scrollToBottomObserverFactory=a,this._destroyed$=new u.Subject,this._defaultPageSize=20,this._data=[],this._tableDataSchema={columns:[]},this._allPagesWasLoaded=!1,this._isDataLoading=!1,this.selectedIds=[],this.selectedIdsChange=new i.EventEmitter,this.dataChange=new i.EventEmitter,this.rowDoubleClick=new i.EventEmitter}_setTableDataChange(){this._table.dataSchema=this.tableDataSchema,this._table.config=this.tableConfig,this._table.data=this.data}_renderTableComponent(e){var t=this;return(0,f.A)(function*(){yield h.e(1029).then(h.bind(h,61029)).then(n=>{const s=n.TableComponent;t._tableRef=e.createComponent(s),t._table=t._tableRef.instance,t.dataChange.subscribe(()=>t._setTableDataChange()),t._table.selectedChange.subscribe(a=>t.selectedRecords=a),t._table.sortChange.subscribe(a=>t.onSortChange(a)),t._table.rowDoubleClick.subscribe(a=>t.rowDoubleClick.emit(a))})})()}_getPageSize(e){return e.pageSize??this._defaultPageSize}_afterLoaded(e,t){const n=t.length<this._getPageSize(e);this._allPagesWasLoaded=n,this.dataChange.emit({data:this._data.slice(),isLastPage:n})}_executeLoading(e,t){const n=this._restHandler.handleRequest(t()).pipe((0,l.share)());return n.subscribe(s=>this._afterLoaded(e,s)),n}_validateConfig(e){if(ue.checkArgumentEmpty("config",e),ue.checkArgumentEmpty("entitySchema",e.entitySchema),typeof e.entitySchema=="string"&&ue.checkStringIsNotEmpty("entitySchema",e.entitySchema),ue.checkArgumentEmpty("columns",e.columns),e.columns.length===0)throw new Error("Entity data view config should contain at least one column.")}_initScrollToBottomObserver(){this._scrollToBottomObserver=this._scrollToBottomObserverFactory.createObserver(this.dataViewWrapper.nativeElement,this._onScrollToBottom.bind(this))}_initDefaultSort(e,t){const n=e.getPrimaryDisplayColumn()?.name,a=n&&t.columns.some(o=>this._getColumnPath(o)===n)?n:this._getColumnPath(t.columns[0]);this._sort={columnName:a,direction:"asc"}}_getEntitySchema(e){if(typeof e=="object")return this._entitySchema=e,(0,u.of)(e);const t=this._restHandler.handleRequest(this._entitySchemaService.getEntitySchemaByUId(e),{skipBodyMask:!0}).pipe((0,l.takeUntil)(this._destroyed$),(0,l.map)(n=>n.entitySchema),(0,l.share)());return t.subscribe(n=>this._entitySchema=n),t}_prepareLoaderFilters(e){let t=null;if(e.excludedIds?.length>0){let n;n=new pt,n.addSchemaColumnInFilterWithParameters(ge.Not_equal,this._entitySchema.getPrimaryColumn().name,e.excludedIds),e.filter&&n.add(e.filter),t=n}else t=e.filter;return t}_createDefaultLoaderConfig(e){return{rowCount:this._getPageSize(e),rowsOffset:-1,sort:this._sort,columns:e.columns,filter:this._prepareLoaderFilters(e)}}_loadRows(e,t){return this._isDataLoading=!0,this._loaderService.loadEntityData(e,t).pipe((0,l.take)(1),(0,l.tap)(()=>this._isDataLoading=!1),(0,l.takeUntil)(this._destroyed$),(0,l.share)())}_loadNextData(e,t){const n=this._createDefaultLoaderConfig(t);n.rowsOffset=this._data.length;const s=this._loadRows(e,n);return s.subscribe(a=>this._data=this._data.concat(a)),s}_getColumnPath(e){return typeof e=="string"?e:e.columnPath}_resetScroll(){this.dataViewWrapper?.nativeElement&&(this.dataViewWrapper.nativeElement.scrollTop=0),this._scrollToBottomObserver?.resetScrollMaxPosition()}_loadFirstData(e,t){this._resetScroll();const n=this._createDefaultLoaderConfig(t),s=this._loadRows(e,n);return this._data=[],s.subscribe(a=>{this._data=a,this._tableDataSchema=this._tableDataSchemaBuilder.buildTableDataSchema(e,t.columns)}),s}_applyConfig(e,t){const n=e.columns;let s;if(!t||!(0,M.isEqual)(e.entitySchema,t.entitySchema))s=this._getEntitySchema(e.entitySchema).pipe((0,l.tap)(a=>this._initDefaultSort(a,e)),(0,l.mergeMap)(a=>this._loadFirstData(a,e)));else{const a=!(0,M.isEqual)(n,t.columns);a&&this._initDefaultSort(this._entitySchema,e),this._entitySchema&&(a||!(0,M.isEqual)(e.filter,t.filter)||!(0,M.isEqual)(e.excludedIds,t.excludedIds))&&(s=this._loadFirstData(this._entitySchema,e))}s&&this._executeLoading(e,()=>s)}_onScrollToBottom(){if(this._isDataLoading||this._allPagesWasLoaded)return;const e=this._config;this._executeLoading(e,()=>this._loadNextData(this._entitySchema,e))}onSortChange(e){if((0,M.isEqual)(e,this._sort))return;const t=this._config;this._sort=e,this._executeLoading(t,()=>this._loadFirstData(this._entitySchema,t))}ngOnInit(){var e=this;return(0,f.A)(function*(){yield e._renderTableComponent(e.tableNgContainer)})()}ngOnChanges(e){this._tableRef?.setInput("selected",this.selectedRecords)}ngAfterViewInit(){this._initScrollToBottomObserver()}ngOnDestroy(){this._destroyed$.next(),this._destroyed$.complete(),this._scrollToBottomObserver.destroy()}static{this.\u0275fac=function(t){return new(t||Os)(i.\u0275\u0275directiveInject(Vp),i.\u0275\u0275directiveInject(nt),i.\u0275\u0275directiveInject(Ya),i.\u0275\u0275directiveInject(Ka),i.\u0275\u0275directiveInject(hi))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:Os,selectors:[["ts-entity-data-view"]],viewQuery:function(t,n){if(t&1&&(i.\u0275\u0275viewQuery(bC,7,i.ViewContainerRef),i.\u0275\u0275viewQuery(SC,7)),t&2){let s;i.\u0275\u0275queryRefresh(s=i.\u0275\u0275loadQuery())&&(n.tableNgContainer=s.first),i.\u0275\u0275queryRefresh(s=i.\u0275\u0275loadQuery())&&(n.dataViewWrapper=s.first)}},inputs:{config:"config",selectedIds:"selectedIds"},outputs:{selectedIdsChange:"selectedIdsChange",dataChange:"dataChange",rowDoubleClick:"rowDoubleClick"},features:[i.\u0275\u0275NgOnChangesFeature],decls:4,vars:2,consts:[["dataViewWrapper",""],["tableNgContainer",""],[1,"entity-data-view-wrapper"]],template:function(t,n){t&1&&(i.\u0275\u0275elementStart(0,"div",2,0),i.\u0275\u0275elementContainer(2,null,1),i.\u0275\u0275elementEnd()),t&2&&i.\u0275\u0275styleProp("display",n.data.length>0?null:"none")},styles:[".entity-data-view-wrapper[_ngcontent-%COMP%]{height:100%;overflow:auto}"]})}}const MC=new i.InjectionToken("Flag indicating that mask has startup loading animation");var ld;let Dl=class Zl extends Rt{static{ld=this}constructor(e,t,n,s,a,o,c){super(n,s),this._appRef=e,this._injector=t,this._window=a,this.loadingAnimationVisible=o,this._maskComponentType=c,this.createMaskComponent(),this.maskComponent.isVisible=!1}static _getHtmlElement(e){const t=e;if(!t||t.rootNodes.length===0)throw new Error("Not found HTMLElement Mask");return t.rootNodes[0]}_createMaskComponentRef(){this.maskComponentRef=(0,i.createComponent)(this._maskComponentType||Ke,{environmentInjector:this._appRef.injector})}_appendMaskComponentToBody(){const e=this.maskComponentRef.hostView;this._appRef.attachView(e);const t=ld._getHtmlElement(e);this.document.body.appendChild(t)}_hideLoadingAnimation(){this._window?.dispatchEvent(new CustomEvent("hide_loading_animation"))}createMaskComponent(){this._createMaskComponentRef(),this._appendMaskComponentToBody(),this.maskComponent.isVisible=!1}showBodyMask(e){this.loadingAnimationVisible||this.show(e)}hideBodyMask(){if(this.loadingAnimationVisible){this.loadingAnimationVisible=!1,this._hideLoadingAnimation();return}this.hide()}static{this.\u0275fac=function(t){return new(t||Zl)(i.\u0275\u0275inject(i.ApplicationRef),i.\u0275\u0275inject(i.Injector),i.\u0275\u0275inject(v.DOCUMENT),i.\u0275\u0275inject(i.NgZone),i.\u0275\u0275inject(T.ZP,8),i.\u0275\u0275inject(MC,8),i.\u0275\u0275inject(wd,8))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Zl,factory:Zl.\u0275fac,providedIn:"root"})}};Dl=ld=(0,y.__decorate)([(0,T.op)({requestType:"crt.MaskService"}),(0,y.__metadata)("design:paramtypes",[i.ApplicationRef,i.Injector,Document,i.NgZone,Window,Boolean,i.Type])],Dl);var wt;(function(r){r.Contains="contains",r.StartsWith="starts-with",r.Equals="equals"})(wt||(wt={}));class cd{constructor(e){this._overlayRef=e,this.afterClosed$=new u.Subject}_close(e){this._overlayRef.dispose(),this.afterClosed$.next(e),this.afterClosed$.complete()}close(e){this._close(e)}}var Nl=h(6149);function vC(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"mat-checkbox",8),i.\u0275\u0275listener("change",function(s){const a=i.\u0275\u0275restoreView(t).$implicit,o=i.\u0275\u0275nextContext(2);return i.\u0275\u0275resetView(o.onColumnSelectedChange(a.name,s))}),i.\u0275\u0275text(1),i.\u0275\u0275elementEnd()}if(r&2){const t=e.$implicit,n=i.\u0275\u0275nextContext(2);i.\u0275\u0275property("checked",n.isColumnSelected(t.name)),i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(n.getColumnCheckboxCaption(t))}}function IC(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"div"),i.\u0275\u0275template(1,vC,2,2,"mat-checkbox",7),i.\u0275\u0275element(2,"mat-divider"),i.\u0275\u0275elementEnd()),r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275advance(),i.\u0275\u0275property("ngForOf",t.columnConfigs)}}function wC(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"mat-radio-button",9),i.\u0275\u0275text(1),i.\u0275\u0275elementEnd()),r&2){const t=e.$implicit;i.\u0275\u0275property("value",t.value),i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate1(" ",t.caption," ")}}const Lp=new i.InjectionToken("SEARCH_INPUT_SETTINGS_DATA");class qa{constructor(e,t,n){this._settingsOverlayRef=e,this._translateService=t,this.searchStrategyOptions=[{value:wt.StartsWith,caption:this._translateService.instant("SearchInput.Settings.StartsWith")},{value:wt.Contains,caption:this._translateService.instant("SearchInput.Settings.Contains")},{value:wt.Equals,caption:this._translateService.instant("SearchInput.Settings.Equals")}];const s=n?.settings||{};this.settings={searchStrategy:s.searchStrategy??wt.Contains,columns:s.columns?.slice()??[]},this.columnConfigs=n?.columnConfigs??[]}_setColumnSelected(e,t){const n=this.settings.columns;if(t)n.includes(e)||n.push(e);else{const s=n.indexOf(e);s!==-1&&n.splice(s,1)}}close(){this._settingsOverlayRef.close(null)}apply(){this._settingsOverlayRef.close(this.settings)}isColumnSelected(e){return this.settings.columns.includes(e)}onColumnSelectedChange(e,t){this._setColumnSelected(e,t.checked)}getColumnCheckboxCaption(e){const t=e.caption,n=this._translateService.instant("SearchInput.Settings.SearchColumnTemplate");return Kt.String.Format(n,t)}static{this.\u0275fac=function(t){return new(t||qa)(i.\u0275\u0275directiveInject(cd),i.\u0275\u0275directiveInject(m.TranslateService),i.\u0275\u0275directiveInject(Lp))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:qa,selectors:[["ts-search-input-settings"]],decls:11,vars:9,consts:[[1,"search-input-settings-container"],[4,"ngIf"],[3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"bottom-actions"],["mat-button","",1,"",3,"click"],["mat-flat-button","","color","primary",1,"action-button",3,"click"],[3,"checked","change",4,"ngFor","ngForOf"],[3,"change","checked"],[3,"value"]],template:function(t,n){t&1&&(i.\u0275\u0275elementStart(0,"div",0),i.\u0275\u0275template(1,IC,3,1,"div",1),i.\u0275\u0275elementStart(2,"mat-radio-group",2),i.\u0275\u0275twoWayListener("ngModelChange",function(a){return i.\u0275\u0275twoWayBindingSet(n.settings.searchStrategy,a)||(n.settings.searchStrategy=a),a}),i.\u0275\u0275template(3,wC,2,2,"mat-radio-button",3),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(4,"div",4)(5,"button",5),i.\u0275\u0275listener("click",function(){return n.close()}),i.\u0275\u0275text(6),i.\u0275\u0275pipe(7,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(8,"button",6),i.\u0275\u0275listener("click",function(){return n.apply()}),i.\u0275\u0275text(9),i.\u0275\u0275pipe(10,"translate"),i.\u0275\u0275elementEnd()()()),t&2&&(i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",n.columnConfigs.length>0),i.\u0275\u0275advance(),i.\u0275\u0275twoWayProperty("ngModel",n.settings.searchStrategy),i.\u0275\u0275advance(),i.\u0275\u0275property("ngForOf",n.searchStrategyOptions),i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(7,5,"SearchInput.Settings.Cancel")),i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(10,7,"SearchInput.Settings.Apply")))},dependencies:[v.NgForOf,v.NgIf,Nl.MatLegacyRadioGroup,Nl.MatLegacyRadioButton,Z.NgControlStatus,Z.NgModel,$.MatLegacyButton,Ge.MatLegacyCheckbox,Mt.MatDivider,m.TranslatePipe],styles:[`.search-input-settings-container{background:#fff 0% 0% no-repeat padding-box;box-shadow:0 0 3px #0000001a;border:1px solid #e2e2e2;opacity:1;padding:11px;min-width:220px}.search-input-settings-container mat-checkbox{display:block}.search-input-settings-container mat-checkbox,.search-input-settings-container mat-radio-button{margin-left:4px;margin-right:4px}.search-input-settings-container mat-checkbox:not(:first-child),.search-input-settings-container mat-radio-button:not(:first-child){margin-top:8px}.search-input-settings-container mat-divider{margin:14px 0}.search-input-settings-container .bottom-actions{display:flex;justify-content:flex-end;margin:8px 0 4px}.search-input-settings-container .bottom-actions button:not(:first-child){margin-left:12px}
`],encapsulation:2})}}const EC={hasBackdrop:!0,backdropClass:"search-settings-backdrop",alignToElementRef:null,data:null};class Vs{constructor(e,t){this._injector=e,this._overlay=t}_getOverlayConfig(e){const n=this._overlay.position().flexibleConnectedTo(e.alignToElementRef).withPositions([{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top",offsetY:6}]);return new Ro.OverlayConfig({hasBackdrop:e.hasBackdrop,backdropClass:e.backdropClass,panelClass:e.panelClass,scrollStrategy:this._overlay.scrollStrategies.block(),positionStrategy:n})}_createOverlay(e){const t=this._getOverlayConfig(e);return this._overlay.create(t)}_createInjector(e,t){return i.Injector.create({providers:[{provide:cd,useValue:t},{provide:Lp,useValue:e.data}]})}_attachContainerPortal(e,t,n){const s=this._createInjector(t,n),a=new Id.ComponentPortal(qa,null,s);return e.attach(a).instance}openSettingsMenu(e){const t={...EC,...e},n=this._createOverlay(t),s=new cd(n),a=this._attachContainerPortal(n,t,s);return n.backdropClick().subscribe(o=>{a.close()}),s.afterClosed$}static{this.\u0275fac=function(t){return new(t||Vs)(i.\u0275\u0275inject(i.Injector),i.\u0275\u0275inject(Ro.Overlay))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Vs,factory:Vs.\u0275fac})}}const xC=["searchSettingsButton"],TC=["*"];function AC(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"button",8),i.\u0275\u0275listener("click",function(){i.\u0275\u0275restoreView(t);const s=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(s.openSettingsMenu())}),i.\u0275\u0275element(1,"div",9,0),i.\u0275\u0275elementEnd()}}class pi{set value(e){this._value=e,this._emittedValue=e}get value(){return this._value}constructor(e,t){this._translateService=e,this._searchInputSettingsService=t,this._value="",this._valueChangeDebounceTime=500,this._emitValueChangeWithDebounce=(0,M.debounce)(n=>this._emitValueChange(n),this._valueChangeDebounceTime),this.showSettings=!1,this.settings={searchStrategy:wt.Contains,columns:[]},this.settingsChange=new i.EventEmitter,this.valueChange=new i.EventEmitter,this.columnConfigs=[]}_emitValueChange(e){this._emittedValue!==e&&(this._emittedValue=e,this.valueChange.emit(e))}_changeSettings(e){e&&!(0,M.isEqual)(e,this.settings)&&(this.settings=e,this.settingsChange.emit(e))}ngOnInit(){this.placeholder||(this.placeholder=this._translateService.instant("SearchInput.Placeholder"))}onValueChanged(e){const t=e.target.value;t!==this._value&&(this._value=t,this._emitValueChangeWithDebounce(t))}onClear(){const e="";this._value=e,this._emitValueChangeWithDebounce.cancel(),this._emitValueChange(e)}openSettingsMenu(){this._searchInputSettingsService.openSettingsMenu({alignToElementRef:this.settingsButton,data:{settings:this.settings,columnConfigs:this.columnConfigs}}).subscribe(e=>this._changeSettings(e))}static{this.\u0275fac=function(t){return new(t||pi)(i.\u0275\u0275directiveInject(m.TranslateService),i.\u0275\u0275directiveInject(Vs))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:pi,selectors:[["ts-search-input"]],viewQuery:function(t,n){if(t&1&&i.\u0275\u0275viewQuery(xC,5),t&2){let s;i.\u0275\u0275queryRefresh(s=i.\u0275\u0275loadQuery())&&(n.settingsButton=s.first)}},inputs:{showSettings:"showSettings",value:"value",placeholder:"placeholder",settings:"settings",columnConfigs:"columnConfigs"},outputs:{settingsChange:"settingsChange",valueChange:"valueChange"},ngContentSelectors:TC,decls:8,vars:5,consts:[["searchSettingsButton",""],["matPrefix","","svgIcon","search",1,"search-icon"],["floatLabel","never",1,"search-container-form-field"],["matInput","","type","text","spellcheck","false","autocomplete","off",1,"search-input-field",3,"input","placeholder","value"],["matSuffix","","mat-icon-button","","aria-label","Clear",1,"close",3,"click"],["svgIcon","close"],["matSuffix","",1,"search-settings-tools"],["mat-icon-button","","matSuffix","","class","search-settings-button",3,"click",4,"ngIf"],["mat-icon-button","","matSuffix","",1,"search-settings-button",3,"click"],[1,"search-settings-button-icon"]],template:function(t,n){t&1&&(i.\u0275\u0275projectionDef(),i.\u0275\u0275element(0,"mat-icon",1),i.\u0275\u0275elementStart(1,"mat-form-field",2)(2,"input",3),i.\u0275\u0275listener("input",function(a){return n.onValueChanged(a)}),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(3,"button",4),i.\u0275\u0275listener("click",function(){return n.onClear()}),i.\u0275\u0275element(4,"mat-icon",5),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(5,"div",6),i.\u0275\u0275projection(6),i.\u0275\u0275elementEnd(),i.\u0275\u0275template(7,AC,3,0,"button",7),i.\u0275\u0275elementEnd()),t&2&&(i.\u0275\u0275advance(2),i.\u0275\u0275property("placeholder",n.placeholder)("value",n.value),i.\u0275\u0275advance(),i.\u0275\u0275styleProp("visibility",n.value?"inherit":"hidden"),i.\u0275\u0275advance(4),i.\u0275\u0275property("ngIf",n.showSettings))},dependencies:[v.NgIf,$.MatLegacyButton,ee.MatLegacyFormField,ee.MatLegacyPrefix,ee.MatLegacySuffix,G.MatIcon,me.MatLegacyInput],styles:[`ts-search-input{display:flex}ts-search-input mat-icon[svgicon=search]{width:16px;height:16px;margin-inline-end:6px!important;padding-top:8px!important}ts-search-input .search-container-form-field .mat-form-field-infix,ts-search-input .search-container-form-field .mat-form-field-suffix{display:flex;gap:4px}ts-search-input mat-form-field{flex-grow:1}ts-search-input mat-form-field .mat-form-field-wrapper{margin-bottom:-1em}ts-search-input mat-form-field .mat-form-field-wrapper button.close,ts-search-input mat-form-field .mat-form-field-wrapper .search-settings-button{height:22px!important;width:22px!important;vertical-align:middle!important}ts-search-input mat-form-field .mat-form-field-wrapper button.close mat-icon{display:block;margin:auto}ts-search-input mat-form-field .mat-form-field-wrapper button.close:focus{border:1px solid #c8c8c8}ts-search-input mat-form-field .mat-form-field-wrapper .search-settings-button .search-settings-button-icon{background:url(settings.svg) no-repeat;width:16px;height:16px;margin:auto;display:block}ts-search-input mat-form-field.mat-focused .mat-form-field-label{opacity:0!important}
`],encapsulation:2})}}function DC(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"mat-option",9),i.\u0275\u0275text(1),i.\u0275\u0275elementEnd()),r&2){const t=e.$implicit;i.\u0275\u0275property("value",t),i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(t.caption)}}class Ja{get searchKey(){return this._searchKey}set searchKey(e){if(this._searchKey=e,this._selectedColumn){const t=!e;this._changeFilter(t)}}get filteredColumns(){return this._filteredColumns}set entitySchema(e){this._entitySchema=e,this._columns=e.columns.filter(t=>Ki.P.Text.includes(t.dataValueType)||t.dataValueType===E.r.Lookup||t.dataValueType===E.r.Guid),this._filteredColumns=this._columns}get selectedColumn(){return this._selectedColumn}constructor(e,t,n,s){this._entitySchemaService=e,this._maskService=t,this._dialogService=n,this._translateService=s,this._destroyed$=new u.Subject,this._searchKey="",this.valueChange=new i.EventEmitter}_buildFilterGroup(e){const t=new pt;t.logicalOperation=ra.And;const n=this._selectedColumn.dataValueType===E.r.Guid?ge.Equal:ge.Contain,s=this._selectedColumn.dataValueType===E.r.Guid?this._searchKey?.trim():this._searchKey;return t.addSchemaColumnFilterWithParameter(n,e,s),t}_getFilterColumnPath(){return this._selectedColumn.dataValueType!==E.r.Lookup?(0,u.of)(this._selectedColumn.name):(this._maskService.showBodyMask(),this._entitySchemaService.getEntitySchemaByUId(this._selectedColumn.referenceSchemaUId).pipe((0,l.map)(e=>{this._maskService.hideBodyMask();const t=e.entitySchema.getPrimaryDisplayColumn()?.name;if(t)return this._selectedColumn.name+"."+t;const n=e.entitySchema.getPrimaryColumn()?.name;return this._selectedColumn.name+"."+n})))}_changeFilter(e=!1){if(e){this.valueChange.emit(null);return}if(this._selectedColumn.dataValueType===E.r.Guid&&!(0,le.n7)(this._searchKey?.trim())){this._dialogService.openInfoDialog(this._translateService.instant("QuickEntityFilter.NonGuidMessage"));return}this._getFilterColumnPath().pipe((0,l.takeUntil)(this._destroyed$)).subscribe(t=>{const n=this._buildFilterGroup(t);this.valueChange.emit(n)})}searchColumn(e){e||this.selectColumn(null),e=e.toLocaleLowerCase().trim(),this._filteredColumns=this._columns.filter(t=>t.caption.toLocaleLowerCase().includes(e))}getColumnCaption(e){return e.caption}selectColumn(e){if(this._selectedColumn=e,!e){this._changeFilter(!0);return}this._searchKey&&this._changeFilter()}ngOnInit(){this._selectedColumn=this._entitySchema?.getPrimaryDisplayColumn()}ngOnDestroy(){this._destroyed$.next(),this._destroyed$.complete()}static{this.\u0275fac=function(t){return new(t||Ja)(i.\u0275\u0275directiveInject(nt),i.\u0275\u0275directiveInject(Dl),i.\u0275\u0275directiveInject(lt),i.\u0275\u0275directiveInject(m.TranslateService))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:Ja,selectors:[["ts-quick-entity-filter"]],inputs:{entitySchema:"entitySchema"},outputs:{valueChange:"valueChange"},decls:10,vars:5,consts:[["auto","matAutocomplete"],[1,"select-column-container"],["type","text","matInput","","spellcheck","false",3,"input","matAutocomplete","value"],["matSuffix","",1,"mat-select-arrow-wrapper"],[1,"mat-select-arrow"],[3,"optionSelected","displayWith"],[3,"value",4,"ngFor","ngForOf"],[1,"search-container"],[3,"valueChange","value"],[3,"value"]],template:function(t,n){if(t&1){const s=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"div",1)(1,"mat-form-field")(2,"input",2),i.\u0275\u0275listener("input",function(o){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.searchColumn(o.target.value))}),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(3,"div",3),i.\u0275\u0275element(4,"div",4),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(5,"mat-autocomplete",5,0),i.\u0275\u0275listener("optionSelected",function(o){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.selectColumn(o.option.value))}),i.\u0275\u0275template(7,DC,2,2,"mat-option",6),i.\u0275\u0275elementEnd()()(),i.\u0275\u0275elementStart(8,"div",7)(9,"ts-search-input",8),i.\u0275\u0275twoWayListener("valueChange",function(o){return i.\u0275\u0275restoreView(s),i.\u0275\u0275twoWayBindingSet(n.searchKey,o)||(n.searchKey=o),i.\u0275\u0275resetView(o)}),i.\u0275\u0275elementEnd()()}if(t&2){const s=i.\u0275\u0275reference(6);i.\u0275\u0275advance(2),i.\u0275\u0275property("matAutocomplete",s)("value",n.selectedColumn==null?null:n.selectedColumn.caption),i.\u0275\u0275advance(3),i.\u0275\u0275property("displayWith",n.getColumnCaption),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngForOf",n.filteredColumns),i.\u0275\u0275advance(2),i.\u0275\u0275twoWayProperty("value",n.searchKey)}},dependencies:[v.NgForOf,qe.MatLegacyAutocomplete,qe.MatLegacyAutocompleteTrigger,Yt.MatLegacyOption,ee.MatLegacyFormField,ee.MatLegacySuffix,me.MatLegacyInput,pi],styles:[`ts-quick-entity-filter{display:flex}ts-quick-entity-filter .select-column-container{flex-basis:50%;padding-right:20px}ts-quick-entity-filter .select-column-container .mat-form-field{width:100%!important}ts-quick-entity-filter .search-container{flex-basis:50%}
`],encapsulation:2})}}const NC=r=>({"lookup-dialog-counter-value-hidden":r});function PC(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"ts-quick-entity-filter",14),i.\u0275\u0275listener("valueChange",function(s){i.\u0275\u0275restoreView(t);const a=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(a.onFilterChanged(s))}),i.\u0275\u0275elementEnd()}if(r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275property("entitySchema",t.entitySchema)}}function RC(r,e){r&1&&i.\u0275\u0275element(0,"mat-spinner",20)}function OC(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"div",15)(1,"span",16),i.\u0275\u0275text(2),i.\u0275\u0275pipe(3,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(4,"div",17)(5,"div",18),i.\u0275\u0275text(6),i.\u0275\u0275elementEnd(),i.\u0275\u0275template(7,RC,1,0,"mat-spinner",19),i.\u0275\u0275elementEnd()()),r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(3,4,"LookupDialog.Selected")),i.\u0275\u0275advance(3),i.\u0275\u0275property("ngClass",i.\u0275\u0275pureFunction1(6,NC,t.displayedSelectedRecordsCount===null)),i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(t.displayedSelectedRecordsCount||0),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",t.displayedSelectedRecordsCount===null)}}function VC(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"ts-entity-data-view",21),i.\u0275\u0275listener("dataChange",function(s){i.\u0275\u0275restoreView(t);const a=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(a.onEntityRecordsLoaded(s))}),i.\u0275\u0275twoWayListener("selectedIdsChange",function(s){i.\u0275\u0275restoreView(t);const a=i.\u0275\u0275nextContext();return i.\u0275\u0275twoWayBindingSet(a.selectedIds,s)||(a.selectedIds=s),i.\u0275\u0275resetView(s)}),i.\u0275\u0275listener("selectedIdsChange",function(){i.\u0275\u0275restoreView(t);const s=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(s.onSelectedIdsChange())})("rowDoubleClick",function(s){i.\u0275\u0275restoreView(t);const a=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(a.onRowDoubleClick(s))}),i.\u0275\u0275elementEnd()}if(r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275property("config",t.entityDataViewConfig),i.\u0275\u0275twoWayProperty("selectedIds",t.selectedIds)}}function LC(r,e){r&1&&(i.\u0275\u0275elementContainerStart(0),i.\u0275\u0275elementStart(1,"span"),i.\u0275\u0275text(2),i.\u0275\u0275pipe(3,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementContainerEnd()),r&2&&(i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(3,1,"LookupDialog.Blankslate")))}function kC(r,e){r&1&&(i.\u0275\u0275elementStart(0,"span"),i.\u0275\u0275text(1),i.\u0275\u0275pipe(2,"translate"),i.\u0275\u0275elementEnd()),r&2&&(i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(2,1,"BaseTableDetail.BlankslateWithFilters")))}function jC(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"div",22),i.\u0275\u0275template(1,LC,4,3,"ng-container",23)(2,kC,3,3,"ng-template",null,0,i.\u0275\u0275templateRefExtractor),i.\u0275\u0275elementEnd()),r&2){const t=i.\u0275\u0275reference(3),n=i.\u0275\u0275nextContext();i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",!n.entityFilter)("ngIfElse",t)}}class Ls{get entityFilter(){return this._quickEntityFilter}get entityDataViewConfig(){return{entitySchema:this._entitySchema,columns:this._getDisplayedColumns(),tableConfig:this._getTableConfig(),excludedIds:this._getLookupDialogConfig().excludedIds,filter:this._quickEntityFilter,pageSize:this._pageSize}}get selectMode(){return this._dialogData.tableConfig.selectMode}get entitySchema(){return this._entitySchema}get defaultBlankslateVisible(){return this._defaultBlankslateVisible}get displayedSelectedRecordsCount(){return this._allPagesSelectionEnabled?this._allPagesSelectedCount:this._loadedSelectedCount}constructor(e,t,n,s,a,o,c){this._dialogData=e,this._dialogRef=t,this._entitySchemaService=n,this._restHandler=s,this._translateService=a,this._queryExecutor=o,this._dialogService=c,this._pageSize=20,this._allPagesSelectionWarningRecordsNumber=1e3,this._destroyed$=new u.Subject,this._allPagesRecordsCountRequestCancel$=new u.Subject,this._defaultBlankslateVisible=!1,this._loadedRecords=[],this._allPagesWasLoaded=!1,this._allPagesSelectionEnabled=!1,this._allPagesUnselectedIds=null,this._allPagesRecordsCount=null,this._allPagesSelectedCount=null,this._allRowsSelectState=null,this._loadedSelectedCount=0,this.selectedIds=[],ue.checkArgumentEmpty("data",e),ue.checkArgumentEmpty("lookupDialogConfig",e.lookupDialogConfig),this.selectedIds=e.lookupDialogConfig.selectedIds?.slice()??[],this._getEntitySchema(e.lookupDialogConfig.entitySchema).pipe((0,l.takeUntil)(this._destroyed$)).subscribe(d=>this._entitySchema=d),this._applyIncomingFilter()}_getPrimaryColumnName(){return this._entitySchema.getPrimaryColumn().name}_getLoadedRecordIds(){const e=this._getPrimaryColumnName();return this._loadedRecords.map(t=>t[e])}_unselectAllExceptLoaded(){const e=this.selectedIds;this.selectedIds=this._getLoadedRecordIds().filter(t=>e.includes(t))}_getLookupDialogConfig(){return this._dialogData.lookupDialogConfig}_actualizeLoadedSelectedCount(){this._loadedSelectedCount=this.selectedIds.length}_canExistNotLoadedSelectedRecords(e){return e===Ue.K.None&&!this._allPagesSelectionEnabled&&!this._allPagesWasLoaded}_actualizeAllPagesUnselectedIds(){const e=this.selectedIds,t=this._getLoadedRecordIds(),n=t.filter(a=>!e.includes(a)),s=t.filter(a=>e.includes(a));for(const a of n)this._allPagesUnselectedIds.add(a);for(const a of s)this._allPagesUnselectedIds.delete(a)}_calculateAllPagesSelectedCount(){this._allPagesSelectedCount=this._allPagesRecordsCount===null?null:this._allPagesRecordsCount-this._allPagesUnselectedIds.size}_setAllPagesRecordsCount(e){this._allPagesRecordsCount=e,this._calculateAllPagesSelectedCount()}_handleRequest(e){return t=>this._restHandler.handleRequest(t,e)}_getDisplayedColumns(){let e=this._getLookupDialogConfig().displayedColumns;if(!e){const t=this._entitySchema.getPrimaryDisplayColumn();e=t?[t.name]:[this._getPrimaryColumnName()]}return e}_getTableConfig(){return{...this._dialogData.tableConfig,allRowsSelectState:()=>this._allRowsSelectState,allRowsSelectToggleHandler:()=>this._allRowsSelectToggle()}}_applyIncomingFilter(){const e=this._getLookupDialogConfig().filter;e&&(this._quickEntityFilter||(this._quickEntityFilter=new pt),this._quickEntityFilter.add(e))}_getEntitySchema(e){return typeof e=="object"?(0,u.of)(e):this._entitySchemaService.getEntitySchemaByUId(e).pipe(this._handleRequest(),(0,l.map)(t=>t.entitySchema))}_actualizeDefaultBlankslateVisibility(e){this._defaultBlankslateVisible=e.length===0}_confirmAllPagesSelection(){if(this.displayedSelectedRecordsCount<this._allPagesSelectionWarningRecordsNumber)return(0,u.of)(!0);const e=this._translateService.instant("LookupDialog.AllPagesSelectionWarning");return this._dialogService.openConfirmationDialog(e).pipe((0,l.map)(t=>t===ic.result))}_enableAllPagesSelection(){this._unselectAllExceptLoaded(),this._allPagesSelectionEnabled=!0,this._allPagesRecordsCount||this._loadAllPagesRecordsCount(),this._allRowsSelectState=Ue.K.All,this._allPagesUnselectedIds=new Set}_disableAllPagesSelection({unselectAllRecords:e}){this._allPagesRecordsCountRequestCancel$.next(),this._allPagesSelectionEnabled=!1,e&&(this.selectedIds=[],this._allRowsSelectState=Ue.K.None),this._actualizeLoadedSelectedCount(),this._allPagesUnselectedIds=null}_createAllFilteredRecordsEsq(){const e=this._getPrimaryColumnName(),t=new _a(this._entitySchema.name);this._quickEntityFilter&&t.filters.add(this._quickEntityFilter);const n=this._getLookupDialogConfig().excludedIds;return n?.length>0&&t.filters.addSchemaColumnInFilterWithParameters(ge.Not_equal,e,n),t}_createAllFilteredIdsEsq(){const e=this._createAllFilteredRecordsEsq();return e.addSchemaColumn(this._getPrimaryColumnName()),e}_loadAllPagesRecordsCount(){const e=this._getPrimaryColumnName(),t=this._createAllFilteredRecordsEsq();t.addAggregationFunctionColumn(e,od.Count,"Count"),this._queryExecutor.executeSelectQuery(t).pipe(this._handleRequest({skipBodyMask:!0}),(0,l.takeUntil)((0,u.merge)(this._allPagesRecordsCountRequestCancel$,this._destroyed$)),(0,l.catchError)(()=>(this._disableAllPagesSelection({unselectAllRecords:!1}),u.EMPTY)),(0,l.map)(n=>n[0].Count)).subscribe(n=>this._setAllPagesRecordsCount(n))}_loadIsAnyRecordExist(e){const t=this._createAllFilteredIdsEsq();return t.rowCount=1,e(t),this._queryExecutor.executeSelectQuery(t).pipe((0,l.takeUntil)(this._destroyed$),this._handleRequest({maskDelay:0}),(0,l.map)(n=>n.length===1),(0,l.catchError)(()=>(0,u.of)(!0)),(0,l.shareReplay)())}_clearNotLoadedRecordsCachedInfo(){this._isAnyNotLoadedRecordSelected$=null,this._isAnyNotLoadedRecordUnselected$=null}_loadIsAnyNotLoadedRecordSelected(){return this._isAnyNotLoadedRecordSelected$??(this._isAnyNotLoadedRecordSelected$=this._loadIsAnyRecordExist(e=>e.filters.addSchemaColumnInFilterWithParameters(ge.Equal,this._getPrimaryColumnName(),this.selectedIds)))}_loadIsAnyNotLoadedRecordUnselected(){return this._isAnyNotLoadedRecordUnselected$??(this._isAnyNotLoadedRecordUnselected$=this._loadIsAnyRecordExist(e=>e.filters.addSchemaColumnInFilterWithParameters(ge.Not_equal,this._getPrimaryColumnName(),this.selectedIds)))}_loadAllPagesSelectedIds(){const e=this._getPrimaryColumnName(),t=this._getLoadedRecordIds().filter(n=>this._allPagesUnselectedIds.has(n));return this._queryExecutor.executeSelectQuery(this._createAllFilteredIdsEsq()).pipe((0,l.takeUntil)(this._destroyed$),this._handleRequest(),(0,l.map)(n=>n.map(s=>s[e])),(0,l.map)(n=>n.filter(s=>!t.includes(s))))}_actualizeAllRowsSelectState(){let e;const t=this._getLoadedRecordIds(),n=t.length>0&&t.some(a=>this.selectedIds.includes(a)),s=n&&t.every(a=>this.selectedIds.includes(a));return this.selectedIds.length===0||!n&&this._allPagesWasLoaded?e=(0,u.of)(Ue.K.None):s&&(this._allPagesWasLoaded||this._allPagesSelectionEnabled)?e=(0,u.of)(Ue.K.All):n&&!s?e=(0,u.of)(Ue.K.Intermediate):e=n?this._loadIsAnyNotLoadedRecordUnselected().pipe((0,l.map)(a=>a?Ue.K.Intermediate:Ue.K.All)):this._loadIsAnyNotLoadedRecordSelected().pipe((0,l.map)(a=>a?Ue.K.Intermediate:Ue.K.None)),e.subscribe(a=>this._allRowsSelectState=a),e}_unselectNotLoadedRecords(){const e=this._getPrimaryColumnName(),t=this._createAllFilteredIdsEsq();t.filters.addSchemaColumnInFilterWithParameters(ge.Equal,e,this.selectedIds);const n=this._queryExecutor.executeSelectQuery(t).pipe(this._handleRequest(),(0,l.takeUntil)((0,u.merge)(this._destroyed$)),(0,l.map)(s=>s.map(a=>a[e])),(0,l.catchError)(()=>(0,u.of)([])),(0,l.share)());return n.subscribe(s=>{this.selectedIds=this.selectedIds.filter(a=>!s.includes(a))}),n}_toggleLoadedRecordsSelection(e){const t=this._getLoadedRecordIds();e===Ue.K.None?this.selectedIds=this.selectedIds.filter(n=>!t.includes(n)):this.selectedIds=[...new Set(this.selectedIds.concat(t))]}_toggleAllPagesSelectionIfRequired(e){const t=!this._allPagesSelectionEnabled&&this.selectedIds.length>0&&e===Ue.K.All&&!this._allPagesWasLoaded,n=this._allPagesSelectionEnabled&&e===Ue.K.None;return t?(this._enableAllPagesSelection(),!0):n?(this._disableAllPagesSelection({unselectAllRecords:!0}),!1):null}_allRowsSelectToggle(){const e=this._allRowsSelectState===Ue.K.All?Ue.K.None:Ue.K.All;this._allRowsSelectState=e,this._toggleLoadedRecordsSelection(e),this._canExistNotLoadedSelectedRecords(e)?(this._loadedSelectedCount=null,this._unselectNotLoadedRecords().subscribe(()=>this._actualizeLoadedSelectedCount())):this._actualizeLoadedSelectedCount(),this._toggleAllPagesSelectionIfRequired(e)===null&&this._allPagesSelectionEnabled&&(this._allPagesUnselectedIds.clear(),this._calculateAllPagesSelectedCount())}_resetSelectionOnFilterChanged(){this._allPagesSelectionEnabled&&this._disableAllPagesSelection({unselectAllRecords:!0}),this.selectMode!=="multi"&&(this.selectedIds=[]),this._setAllPagesRecordsCount(null),this._allRowsSelectState=null}_closeWithSelection(e){const t=this._getPrimaryColumnName();this._dialogRef.close({selectedIds:e,selectedRecords:this._loadedRecords.filter(n=>e.includes(n[t]))})}getDialogTitle(){if(!this._entitySchema)return"";const e=this._translateService.instant("LookupDialog.TitleTemplate");return Kt.String.Format(e,this._entitySchema.caption)}ngOnDestroy(){this._destroyed$.next()}onFilterChanged(e){this._resetSelectionOnFilterChanged(),this._quickEntityFilter=e,this._applyIncomingFilter()}onEntityRecordsLoaded({data:e,isLastPage:t}){if(this._loadedRecords=e,this._clearNotLoadedRecordsCachedInfo(),this._actualizeDefaultBlankslateVisibility(e),this._allPagesWasLoaded=t,this._allPagesSelectionEnabled){const n=this._getPrimaryColumnName();this.selectedIds=e.map(s=>s[n]).filter(s=>!this._allPagesUnselectedIds.has(s)),this._actualizeLoadedSelectedCount(),t&&this._disableAllPagesSelection({unselectAllRecords:!1})}!this._allRowsSelectState&&this.selectMode==="multi"&&this._actualizeAllRowsSelectState()}isAnyRecordSelected(){return this.displayedSelectedRecordsCount>0}onRowDoubleClick(e){if(this.selectMode!=="single")return;const t=this._getPrimaryColumnName();this._dialogRef.close({selectedIds:[e[t]],selectedRecords:[e]})}closeWithCurrentSelection(){this._allPagesSelectionEnabled?this._confirmAllPagesSelection().pipe((0,l.filter)(e=>e),(0,l.mergeMap)(()=>this._loadAllPagesSelectedIds())).subscribe(e=>this._closeWithSelection(e)):this._closeWithSelection(this.selectedIds)}onSelectedIdsChange(){this._allPagesSelectionEnabled?(this._actualizeAllPagesUnselectedIds(),this._calculateAllPagesSelectedCount()):this._actualizeLoadedSelectedCount(),this._actualizeAllRowsSelectState()}static{this.\u0275fac=function(t){return new(t||Ls)(i.\u0275\u0275directiveInject(N.MAT_LEGACY_DIALOG_DATA),i.\u0275\u0275directiveInject(N.MatLegacyDialogRef),i.\u0275\u0275directiveInject(nt),i.\u0275\u0275directiveInject(Vp),i.\u0275\u0275directiveInject(m.TranslateService),i.\u0275\u0275directiveInject(wn),i.\u0275\u0275directiveInject(lt))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:Ls,selectors:[["ts-lookup-dialog"]],decls:20,vars:12,consts:[["blankslateWithFilters",""],["mat-dialog-title",""],["mat-icon-button","",1,"close-dialog",3,"mat-dialog-close"],["svgIcon","close",1,"close-button-icon"],[1,"lookup-dialog-top-panel"],[1,"dialog-filters"],[3,"entitySchema","valueChange",4,"ngIf"],["class","counter-container",4,"ngIf"],["mat-dialog-content",""],[3,"config","selectedIds","dataChange","selectedIdsChange","rowDoubleClick",4,"ngIf"],["class","lookup-dialog-blank-slate",4,"ngIf"],["mat-dialog-actions",""],["mat-button","","cdkFocusInitial","",3,"mat-dialog-close"],["mat-flat-button","","color","primary",3,"click","disabled"],[3,"valueChange","entitySchema"],[1,"counter-container"],[1,"counter-label"],[1,"lookup-dialog-counter-value-wrapper"],[1,"counter-value",3,"ngClass"],["diameter","18",4,"ngIf"],["diameter","18"],[3,"dataChange","selectedIdsChange","rowDoubleClick","config","selectedIds"],[1,"lookup-dialog-blank-slate"],[4,"ngIf","ngIfElse"]],template:function(t,n){t&1&&(i.\u0275\u0275elementStart(0,"div",1)(1,"div")(2,"span"),i.\u0275\u0275text(3),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(4,"button",2),i.\u0275\u0275element(5,"mat-icon",3),i.\u0275\u0275elementEnd()()(),i.\u0275\u0275elementStart(6,"div",4)(7,"div",5),i.\u0275\u0275template(8,PC,1,1,"ts-quick-entity-filter",6),i.\u0275\u0275elementEnd(),i.\u0275\u0275template(9,OC,8,8,"div",7),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(10,"div",8),i.\u0275\u0275template(11,VC,1,2,"ts-entity-data-view",9)(12,jC,4,2,"div",10),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(13,"div",11)(14,"button",12),i.\u0275\u0275text(15),i.\u0275\u0275pipe(16,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(17,"button",13),i.\u0275\u0275listener("click",function(){return n.closeWithCurrentSelection()}),i.\u0275\u0275text(18),i.\u0275\u0275pipe(19,"translate"),i.\u0275\u0275elementEnd()()),t&2&&(i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate(n.getDialogTitle()),i.\u0275\u0275advance(5),i.\u0275\u0275property("ngIf",n.entitySchema),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",n.selectMode==="multi"),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",n.entitySchema),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",n.defaultBlankslateVisible),i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(16,8,"LookupDialog.CancelButton")),i.\u0275\u0275advance(2),i.\u0275\u0275property("disabled",!n.isAnyRecordSelected()),i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(19,10,"LookupDialog.SelectButton")))},dependencies:[v.NgClass,v.NgIf,Os,$.MatLegacyButton,N.MatLegacyDialogClose,N.MatLegacyDialogTitle,N.MatLegacyDialogContent,N.MatLegacyDialogActions,G.MatIcon,Tt.MatProgressSpinner,Ja,m.TranslatePipe],styles:["[_nghost-%COMP%]{padding:4px 10px;width:834px;max-width:100%;min-width:420px;box-sizing:border-box}.counter-container[_ngcontent-%COMP%]{display:flex;align-items:baseline}.counter-container[_ngcontent-%COMP%]   .counter-label[_ngcontent-%COMP%]{font-size:13px;color:#757575;margin-right:4px}.counter-container[_ngcontent-%COMP%]   .lookup-dialog-counter-value-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center}.counter-container[_ngcontent-%COMP%]   .lookup-dialog-counter-value-wrapper[_ngcontent-%COMP%]   .counter-value[_ngcontent-%COMP%]{font-size:14px;color:#444}.counter-container[_ngcontent-%COMP%]   .lookup-dialog-counter-value-wrapper[_ngcontent-%COMP%]   .counter-value.lookup-dialog-counter-value-hidden[_ngcontent-%COMP%]{visibility:hidden;width:0}[mat-dialog-content][_ngcontent-%COMP%]{max-height:55vh!important;min-height:267px;height:862px}[mat-dialog-content][_ngcontent-%COMP%]   .lookup-dialog-blank-slate[_ngcontent-%COMP%]{display:flex;justify-content:center;font-size:14px;color:#999;text-align:center;padding-top:22px}[mat-dialog-actions][_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end}"]})}}class ks{constructor(e){this._dialogService=e,this._defaultTableConfig={headerSticky:!0}}_createTableConfig(e){return{...this._defaultTableConfig,...e}}openWithMultiselect(e){const t={lookupDialogConfig:e,tableConfig:this._createTableConfig({selectMode:"multi"}),gtmData:null};return this._dialogService.open(Ls,{data:t}).pipe((0,l.map)(n=>({selectedIds:n?.selectedIds})))}open(e){const t={lookupDialogConfig:e,tableConfig:this._createTableConfig({selectMode:"single"}),gtmData:null};return this._dialogService.open(Ls,{data:t}).pipe((0,l.map)(n=>({selectedId:n?.selectedIds[0],selectedRecord:n?.selectedRecords[0]})))}static{this.\u0275fac=function(t){return new(t||ks)(i.\u0275\u0275inject(lt))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:ks,factory:ks.\u0275fac})}}class mi extends Dt{set maxValue(e){this._maxValue=e}set selected(e){this._selected=e}get formattedValue(){return this._formattedValue}constructor(e,t,n,s,a,o){super(e,t,n),this._element=s,this._cdRef=a,this._formatUtility=o,this._formattedValue="",this._selected=!1,this._maxValue=99999999999e-2,this._maxLargeValue=999999999999,this.controlType="ts-number-input",this.isLargeNumberEnabled=!1,this.inputBlur=new i.EventEmitter,this.precision=2}_updateFormattedValue(){this._formattedValue=this._formatUtility.formatNumberValue(this.innerValue,new bs.V_({precision:this.precision}))}_exceededMaxValue(e){const t=Math.abs(e),n=t%1;return this.isLargeNumberEnabled&&n===0?t>this._maxLargeValue:t>this._maxValue}ngAfterViewInit(){this._selected&&(this._element.nativeElement.lastElementChild.focus(),this._cdRef.detectChanges())}ngOnInit(){this._updateFormattedValue()}onInputValueChange(){this.callChangeHandler()}onInputFocus(){this.innerValue&&(this._formattedValue=this._formatUtility.formatNumberValue(this.innerValue,new bs.V_({ignoreThousandSeparator:!0,precision:this.precision})))}writeValue(e){this.setInnerValueSilent(e),this._updateFormattedValue(),this.stateChanges.next(),this._cdRef.detectChanges()}onBlur(e){this._updateFormattedValue(),e&&(e.currentTarget.value=this._formattedValue),this.inputBlur.emit()}onInput(e){let t=e.currentTarget.value;if(t===""){this.setInnerValueSilent(0),this._formattedValue="";return}if(t=this._formatUtility.formatStringValue(t),this.precision===0){const s=this._formatUtility.getNumberFormatInfo().decimalSeparator;t=t.replace(new RegExp(`\\${s}$`),"")}e.currentTarget.value=t;let n=this._formatUtility.parseStringToNumber(t,this.precision);t==="-"&&(n=0),(isNaN(n)||this._exceededMaxValue(n))&&(n=this.innerValue,e.currentTarget.value=this._formatUtility.formatNumberValue(n,new bs.V_({ignoreThousandSeparator:!0,precision:this.precision}))),this.setInnerValueSilent(n)}static{this.\u0275fac=function(t){return new(t||mi)(i.\u0275\u0275directiveInject(Z.NgControl,10),i.\u0275\u0275directiveInject(Do.AutofillMonitor),i.\u0275\u0275directiveInject(Ai.FocusMonitor),i.\u0275\u0275directiveInject(i.ElementRef),i.\u0275\u0275directiveInject(i.ChangeDetectorRef),i.\u0275\u0275directiveInject(bs.B4))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:mi,selectors:[["ts-number-input"]],inputs:{isLargeNumberEnabled:"isLargeNumberEnabled",maxValue:"maxValue",selected:"selected",precision:"precision"},outputs:{inputBlur:"inputBlur"},features:[i.\u0275\u0275ProvidersFeature([{provide:ee.MatLegacyFormFieldControl,useExisting:mi}]),i.\u0275\u0275InheritDefinitionFeature],decls:2,vars:3,consts:[["input",""],["matInput","","dir","ltr",3,"change","blur","input","focus","value","disabled","required"]],template:function(t,n){if(t&1){const s=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"input",1,0),i.\u0275\u0275listener("change",function(){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.onInputValueChange())})("blur",function(o){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.onBlur(o))})("input",function(o){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.onInput(o))})("focus",function(){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.onInputFocus())}),i.\u0275\u0275elementEnd()}t&2&&i.\u0275\u0275property("value",n.formattedValue)("disabled",n.disabled)("required",n.required)},dependencies:[At.Dir,me.MatLegacyInput],styles:["input[_ngcontent-%COMP%]{text-align:left;border:0;height:100%;width:100%}input[_ngcontent-%COMP%]:focus{outline-style:none}"],changeDetection:0})}}function FC(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"mat-checkbox",6),i.\u0275\u0275twoWayListener("ngModelChange",function(s){i.\u0275\u0275restoreView(t);const a=i.\u0275\u0275nextContext(2);return i.\u0275\u0275twoWayBindingSet(a.innerValue,s)||(a.innerValue=s),i.\u0275\u0275resetView(s)}),i.\u0275\u0275text(1),i.\u0275\u0275elementEnd()}if(r&2){const t=i.\u0275\u0275nextContext(2);i.\u0275\u0275twoWayProperty("ngModel",t.innerValue),i.\u0275\u0275property("disabled",t.disabled),i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(t.label)}}function BC(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"button",11),i.\u0275\u0275listener("click",function(){i.\u0275\u0275restoreView(t);const s=i.\u0275\u0275nextContext(3);return i.\u0275\u0275resetView(s.openSelectLookupValueDialog())}),i.\u0275\u0275element(1,"mat-icon",12),i.\u0275\u0275elementEnd()}}function UC(r,e){r&1&&i.\u0275\u0275element(0,"mat-icon",13)}function zC(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"mat-form-field",7)(1,"mat-label"),i.\u0275\u0275text(2),i.\u0275\u0275elementEnd(),i.\u0275\u0275element(3,"input",8),i.\u0275\u0275template(4,BC,2,0,"button",9)(5,UC,1,0,"mat-icon",10),i.\u0275\u0275elementEnd()),r&2){const t=i.\u0275\u0275nextContext(2);i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(t.label),i.\u0275\u0275advance(),i.\u0275\u0275property("value",t.getLookupDisplayValue())("required",t.required),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",!t.disabled),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",t.disabled)}}function HC(r,e){r&1&&i.\u0275\u0275element(0,"mat-icon",13)}function WC(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"mat-form-field",7)(1,"mat-label"),i.\u0275\u0275text(2),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(3,"input",14),i.\u0275\u0275twoWayListener("ngModelChange",function(s){i.\u0275\u0275restoreView(t);const a=i.\u0275\u0275nextContext(2);return i.\u0275\u0275twoWayBindingSet(a.innerValue,s)||(a.innerValue=s),i.\u0275\u0275resetView(s)}),i.\u0275\u0275elementEnd(),i.\u0275\u0275template(4,HC,1,0,"mat-icon",10),i.\u0275\u0275elementEnd()}if(r&2){const t=i.\u0275\u0275nextContext(2);i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(t.label),i.\u0275\u0275advance(),i.\u0275\u0275twoWayProperty("ngModel",t.innerValue),i.\u0275\u0275property("required",t.required)("disabled",t.disabled),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",t.disabled)}}function $C(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"textarea",14),i.\u0275\u0275twoWayListener("ngModelChange",function(s){i.\u0275\u0275restoreView(t);const a=i.\u0275\u0275nextContext(3);return i.\u0275\u0275twoWayBindingSet(a.innerValue,s)||(a.innerValue=s),i.\u0275\u0275resetView(s)}),i.\u0275\u0275elementEnd()}if(r&2){const t=i.\u0275\u0275nextContext(3);i.\u0275\u0275twoWayProperty("ngModel",t.innerValue),i.\u0275\u0275property("required",t.required)("disabled",t.disabled)}}function GC(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"mat-form-field",7)(1,"mat-label"),i.\u0275\u0275text(2),i.\u0275\u0275elementEnd(),i.\u0275\u0275template(3,$C,1,3,"textarea",15),i.\u0275\u0275elementEnd()),r&2){const t=i.\u0275\u0275nextContext(2);i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(t.label),i.\u0275\u0275advance(),i.\u0275\u0275property("ngSwitchCase",t.inputTypes.LongText)}}function ZC(r,e){r&1&&i.\u0275\u0275element(0,"mat-icon",13)}function YC(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"mat-form-field",7)(1,"mat-label"),i.\u0275\u0275text(2),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(3,"ts-datetime-picker",17),i.\u0275\u0275twoWayListener("ngModelChange",function(s){i.\u0275\u0275restoreView(t);const a=i.\u0275\u0275nextContext(3);return i.\u0275\u0275twoWayBindingSet(a.innerValue,s)||(a.innerValue=s),i.\u0275\u0275resetView(s)}),i.\u0275\u0275elementEnd(),i.\u0275\u0275template(4,ZC,1,0,"mat-icon",10),i.\u0275\u0275elementEnd()}if(r&2){const t=i.\u0275\u0275nextContext(3);i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(t.label),i.\u0275\u0275advance(),i.\u0275\u0275twoWayProperty("ngModel",t.innerValue),i.\u0275\u0275property("label",t.label)("required",t.required)("disabled",t.disabled)("type",t.getDatetimePickerType()),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",t.disabled)}}function KC(r,e){r&1&&i.\u0275\u0275element(0,"mat-icon",13)}function qC(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"mat-form-field",7)(1,"mat-label"),i.\u0275\u0275text(2),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(3,"ts-number-input",18),i.\u0275\u0275twoWayListener("ngModelChange",function(s){i.\u0275\u0275restoreView(t);const a=i.\u0275\u0275nextContext(3);return i.\u0275\u0275twoWayBindingSet(a.innerValue,s)||(a.innerValue=s),i.\u0275\u0275resetView(s)}),i.\u0275\u0275elementEnd(),i.\u0275\u0275template(4,KC,1,0,"mat-icon",10),i.\u0275\u0275elementEnd()}if(r&2){const t=i.\u0275\u0275nextContext(3);i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(t.label),i.\u0275\u0275advance(),i.\u0275\u0275twoWayProperty("ngModel",t.innerValue),i.\u0275\u0275property("required",t.required)("disabled",t.disabled)("precision",t.getNumberInputPrecision())("maxValue",t.numberMaxValue),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",t.disabled)}}function JC(r,e){if(r&1&&(i.\u0275\u0275elementContainerStart(0),i.\u0275\u0275template(1,YC,5,7,"mat-form-field",16)(2,qC,5,7,"mat-form-field",16),i.\u0275\u0275elementContainerEnd()),r&2){const t=i.\u0275\u0275nextContext(2);i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",t.useDatepicker()),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",t.useNumberInput())}}function QC(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"div",1),i.\u0275\u0275elementContainerStart(1,2),i.\u0275\u0275template(2,FC,2,3,"mat-checkbox",3)(3,zC,6,5,"mat-form-field",4)(4,WC,5,5,"mat-form-field",4)(5,GC,4,2,"mat-form-field",4)(6,JC,3,2,"ng-container",5),i.\u0275\u0275elementContainerEnd(),i.\u0275\u0275elementEnd()),r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275property("ngClass","input-type-"+t.inputTypes[t.inputType].toLowerCase()),i.\u0275\u0275advance(),i.\u0275\u0275property("ngSwitch",t.inputType),i.\u0275\u0275advance(),i.\u0275\u0275property("ngSwitchCase",t.inputTypes.Boolean),i.\u0275\u0275advance(),i.\u0275\u0275property("ngSwitchCase",t.inputTypes.Lookup),i.\u0275\u0275advance(),i.\u0275\u0275property("ngSwitchCase",t.inputTypes.Text),i.\u0275\u0275advance(),i.\u0275\u0275property("ngSwitchCase",t.inputTypes.LongText)}}var Fe;(function(r){r[r.Boolean=0]="Boolean",r[r.Integer=1]="Integer",r[r.Float=2]="Float",r[r.Date=3]="Date",r[r.Time=4]="Time",r[r.DateTime=5]="DateTime",r[r.Lookup=6]="Lookup",r[r.Text=7]="Text",r[r.LongText=8]="LongText"})(Fe||(Fe={}));const kp={[Fe.Boolean]:[E.r.Boolean],[Fe.Integer]:[E.r.Integer],[Fe.Float]:[E.r.Float,E.r.FLOAT1,E.r.FLOAT2,E.r.FLOAT3,E.r.FLOAT4,E.r.FLOAT8,E.r.Money],[Fe.Date]:[E.r.Date],[Fe.Time]:[E.r.Time],[Fe.DateTime]:[E.r.DateTime],[Fe.Lookup]:[E.r.Lookup],[Fe.Text]:[E.r.Text,E.r.SHORT_TEXT,E.r.PHONE_TEXT,E.r.WEB_TEXT,E.r.EMAIL_TEXT,E.r.MEDIUM_TEXT,E.r.Color,E.r.RICH_TEXT],[Fe.LongText]:[E.r.LONG_TEXT,E.r.MAXSIZE_TEXT]};class Qa extends Dt{get column(){return this._column}set column(e){this._specifyInputType(e),this._column=e}get inputType(){return this._inputType}get numberMaxValue(){return this._column?.dataValueType===E.r.Integer?this._integerMaxValue:this._floatMaxValue}constructor(e,t,n,s,a,o,c,d,p){super(e,t,n),this._entitySchemaService=s,this._lookupDialogService=a,this._restErrorHandler=o,this._maskService=c,this._matIconRegistry=d,this._domSanitizer=p,this._integerMaxValue=2147483647,this._floatMaxValue=1175494351e29,this.inputTypes=Fe,this._registerIcons()}_specifyInputType(e){const t=Object.keys(kp).find(n=>kp[n].includes(e.dataValueType));this._inputType=t?parseInt(t):null}_registerIcons(){this._matIconRegistry.addSvgIconLiteral("read-only",this._domSanitizer.bypassSecurityTrustHtml(h(75670)))}_getLookupDialogConfig(e){const t=this.innerValue;return{entitySchema:e,displayedColumns:null,selectedIds:t?.value?[t.value]:null}}_setLookupValue(e,t){if(!t.selectedRecord)return;const n=e.getPrimaryDisplayColumn();this.innerValue={value:t.selectedId,displayValue:n?t.selectedRecord[n.name]:t.selectedId}}focusElementViaMouse(){}initMonitors(){}useDatepicker(){return[Fe.Date,Fe.Time,Fe.DateTime].includes(this._inputType)}getDatetimePickerType(){return{[E.r.Date]:"date",[E.r.Time]:"time",[E.r.DateTime]:"datetime"}[this._column.dataValueType]}useNumberInput(){return[Fe.Integer,Fe.Float].includes(this._inputType)}getNumberInputPrecision(){return{[E.r.Integer]:0,[E.r.Float]:2,[E.r.FLOAT1]:1,[E.r.FLOAT2]:2,[E.r.FLOAT3]:3,[E.r.FLOAT4]:4,[E.r.FLOAT8]:8,[E.r.Money]:2}[this._column.dataValueType]}openSelectLookupValueDialog(){this._maskService.showBodyMask();let e;this._restErrorHandler.handleRequest(this._entitySchemaService.getEntitySchemaByUId(this._column.referenceSchemaUId)).pipe((0,l.tap)(t=>{this._maskService.hideBodyMask(),e=t.entitySchema}),(0,l.mergeMap)(t=>this._lookupDialogService.open(this._getLookupDialogConfig(t.entitySchema)))).subscribe(t=>this._setLookupValue(e,t))}getLookupDisplayValue(){const e=this.innerValue;return e?.displayValue??e?.value??""}static{this.\u0275fac=function(t){return new(t||Qa)(i.\u0275\u0275directiveInject(Z.NgControl,10),i.\u0275\u0275directiveInject(Do.AutofillMonitor),i.\u0275\u0275directiveInject(Ai.FocusMonitor),i.\u0275\u0275directiveInject(nt),i.\u0275\u0275directiveInject(ks),i.\u0275\u0275directiveInject(yC),i.\u0275\u0275directiveInject(Dl),i.\u0275\u0275directiveInject(G.MatIconRegistry),i.\u0275\u0275directiveInject(g.DomSanitizer))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:Qa,selectors:[["ts-entity-column-value-input"]],inputs:{column:"column",label:"label"},features:[i.\u0275\u0275InheritDefinitionFeature],decls:1,vars:1,consts:[["class","entity-column-value-input-wrapper",3,"ngClass",4,"ngIf"],[1,"entity-column-value-input-wrapper",3,"ngClass"],[3,"ngSwitch"],[3,"ngModel","disabled","ngModelChange",4,"ngSwitchCase"],["floatLabel","always",4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"ngModelChange","ngModel","disabled"],["floatLabel","always"],["matInput","","type","text","disabled","true",3,"value","required"],["matSuffix","","mat-icon-button","",3,"click",4,"ngIf"],["matSuffix","","svgIcon","read-only",4,"ngIf"],["matSuffix","","mat-icon-button","",3,"click"],["svgIcon","search"],["matSuffix","","svgIcon","read-only"],["matInput","","type","text",3,"ngModelChange","ngModel","required","disabled"],["matInput","","type","text",3,"ngModel","required","disabled","ngModelChange",4,"ngSwitchCase"],["floatLabel","always",4,"ngIf"],[3,"ngModelChange","ngModel","label","required","disabled","type"],[3,"ngModelChange","ngModel","required","disabled","precision","maxValue"]],template:function(t,n){t&1&&i.\u0275\u0275template(0,QC,7,6,"div",0),t&2&&i.\u0275\u0275property("ngIf",n.inputType!==null)},dependencies:[v.NgClass,v.NgIf,v.NgSwitch,v.NgSwitchCase,v.NgSwitchDefault,Z.DefaultValueAccessor,Z.NgControlStatus,Z.RequiredValidator,Z.NgModel,mn,$.MatLegacyButton,Ge.MatLegacyCheckbox,ee.MatLegacyFormField,ee.MatLegacyLabel,ee.MatLegacySuffix,G.MatIcon,me.MatLegacyInput,mi],styles:[`ts-entity-column-value-input .entity-column-value-input-wrapper{display:flex;align-items:center}ts-entity-column-value-input .entity-column-value-input-wrapper:not(.input-type-longtext){height:44px}ts-entity-column-value-input .entity-column-value-input-wrapper.input-type-lookup button[matsuffix]{height:25px;width:25px}ts-entity-column-value-input .entity-column-value-input-wrapper.input-type-lookup button[matsuffix] mat-icon{height:16px;width:16px}ts-entity-column-value-input .entity-column-value-input-wrapper mat-form-field{width:100%}ts-entity-column-value-input .entity-column-value-input-wrapper mat-form-field textarea{min-height:calc(1em + 1px)}
`],encapsulation:2})}}class js{static{this.\u0275fac=function(t){return new(t||js)}}static{this.\u0275mod=i.\u0275\u0275defineNgModule({type:js})}static{this.\u0275inj=i.\u0275\u0275defineInjector({providers:[bs.B4],imports:[v.CommonModule,Z.FormsModule,ee.MatLegacyFormFieldModule,me.MatLegacyInputModule]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&i.\u0275\u0275setNgModuleScope(js,{declarations:[mi],imports:[v.CommonModule,Z.FormsModule,ee.MatLegacyFormFieldModule,me.MatLegacyInputModule],exports:[mi]})})();class Dn{static{this.\u0275fac=function(t){return new(t||Dn)}}static{this.\u0275mod=i.\u0275\u0275defineNgModule({type:Dn})}static{this.\u0275inj=i.\u0275\u0275defineInjector({imports:[v.CommonModule,Z.FormsModule,dt,$.MatLegacyButtonModule,Ge.MatLegacyCheckboxModule,ee.MatLegacyFormFieldModule,G.MatIconModule,me.MatLegacyInputModule,js]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&i.\u0275\u0275setNgModuleScope(Dn,{declarations:[Qa],imports:[v.CommonModule,Z.FormsModule,dt,$.MatLegacyButtonModule,Ge.MatLegacyCheckboxModule,ee.MatLegacyFormFieldModule,G.MatIconModule,me.MatLegacyInputModule,js],exports:[Qa]})})();const XC=(r,e)=>({expanded:r,collapsed:e});class Fs{constructor(){this._direction="right",this.animationState="initial",this.isExpanded=!1,this.toggle=new i.EventEmitter}set direction(e){this._direction=e}get direction(){return this._direction}set animationDisabled(e){this._animationDisabled=e}get animationDisabled(){return this._animationDisabled}_setDefaultAnimationState(){this.animationState="initial"}_changeAnimationState(e){this.animationState=e}_onMouseEnter(){this.isExpanded||this._changeAnimationState(`slide-${this.direction}`)}_onMouseLeave(){this._changeAnimationState("initial")}onMouseAction(e){if(this.animationDisabled){this._setDefaultAnimationState();return}switch(e){case"enter":this._onMouseEnter();break;case"leave":this._onMouseLeave();break}}onToggle(){this.toggle.emit()}static{this.\u0275fac=function(t){return new(t||Fs)}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:Fs,selectors:[["crt-expansion-button"]],inputs:{isExpanded:"isExpanded",direction:"direction",animationDisabled:"animationDisabled"},outputs:{toggle:"toggle"},decls:5,vars:17,consts:[[3,"mouseenter","mouseleave","click","ngClass","title"],["svgIcon","collapse",1,"arrow-icon"]],template:function(t,n){t&1&&(i.\u0275\u0275elementStart(0,"div",0),i.\u0275\u0275pipe(1,"translate"),i.\u0275\u0275pipe(2,"translate"),i.\u0275\u0275listener("mouseenter",function(){return n.onMouseAction("enter")})("mouseleave",function(){return n.onMouseAction("leave")})("click",function(){return n.onToggle()}),i.\u0275\u0275elementStart(3,"div"),i.\u0275\u0275element(4,"mat-icon",1),i.\u0275\u0275elementEnd()()),t&2&&(i.\u0275\u0275classMapInterpolate1("expansion-button-wrapper ",n.direction,""),i.\u0275\u0275property("ngClass",i.\u0275\u0275pureFunction2(14,XC,n.isExpanded,!n.isExpanded))("title",n.isExpanded?i.\u0275\u0275pipeBind1(1,10,"ExpansionButton.CollapseTooltip"):i.\u0275\u0275pipeBind1(2,12,"ExpansionButton.ExpandTooltip")),i.\u0275\u0275advance(3),i.\u0275\u0275classMapInterpolate1("expansion-btn ",n.animationState,""),i.\u0275\u0275advance(),i.\u0275\u0275classProp("reversed",n.isExpanded))},dependencies:[v.NgClass,G.MatIcon,m.TranslatePipe],styles:[`.expansion-button-wrapper{height:40px;display:flex;position:absolute}.expansion-button-wrapper.expanded{width:16px}.expansion-button-wrapper.collapsed{width:29px}.expansion-button-wrapper.left{justify-content:flex-end}.expansion-button-wrapper.left.expanded{left:-4px}.expansion-button-wrapper.left.collapsed{left:-17px}.expansion-button-wrapper.left .expansion-btn{border-radius:8px 0 0 8px}.expansion-button-wrapper.left .expansion-btn .arrow-icon{transform:rotate(0)}.expansion-button-wrapper.left .expansion-btn .arrow-icon.reversed{transform:rotate(180deg)}.expansion-button-wrapper.right{justify-content:flex-start}.expansion-button-wrapper.right.expanded{left:4px}.expansion-button-wrapper.right.collapsed{left:17px}.expansion-button-wrapper.right .expansion-btn{border-radius:0 8px 8px 0}.expansion-button-wrapper.right .expansion-btn .arrow-icon{transform:rotate(180deg)}.expansion-button-wrapper.right .expansion-btn .arrow-icon.reversed{transform:rotate(0)}.expansion-button-wrapper .expansion-btn{display:flex;justify-content:center;align-items:center;height:100%;cursor:pointer;transition:.3s cubic-bezier(.18,.89,.32,1.28)}.expansion-button-wrapper .expansion-btn.initial{width:16px}.expansion-button-wrapper .expansion-btn.slide-left,.expansion-button-wrapper .expansion-btn.slide-right{width:25px}.expansion-button-wrapper .expansion-btn .arrow-icon{height:16px;width:16px}
`],encapsulation:2})}}class Bs{constructor(e,t){this._matIconRegistry=e,this._domSanitizer=t,this._registerIcons()}_registerIcons(){this._matIconRegistry.addSvgIconLiteral("collapse",this._domSanitizer.bypassSecurityTrustHtml(h(14186)))}static{this.\u0275fac=function(t){return new(t||Bs)(i.\u0275\u0275inject(G.MatIconRegistry),i.\u0275\u0275inject(g.DomSanitizer))}}static{this.\u0275mod=i.\u0275\u0275defineNgModule({type:Bs})}static{this.\u0275inj=i.\u0275\u0275defineInjector({imports:[v.CommonModule,G.MatIconModule,m.TranslateModule]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&i.\u0275\u0275setNgModuleScope(Bs,{declarations:[Fs],imports:[v.CommonModule,G.MatIconModule,m.TranslateModule],exports:[Fs]})})();const e0="39px";function jp(r){(0,M.isEmpty)(r.renderStrategy)&&"placeholderSize"in r&&(r.renderStrategy=ln.OnViewport),r.renderStrategy===ln.OnViewport&&!r.placeholderSize&&(r.placeholderSize={height:e0})}var Ht;(function(r){r[r.Reuse=0]="Reuse",r[r.Rerender=1]="Rerender"})(Ht||(Ht={}));function t0(r,e){return function(t){df(r.type);const n=Lg(t),s=kg(t),a=jg(t),o={...r,inputs:n,outputs:s,validationInputs:a},c="selector"in r?{...o,selector:r.selector}:{...o,typeRef:t};c.reuseStrategy=r?.reuseStrategy??Ht.Rerender,jp(c),e==="web"?Dg(c,t):Ng(c,t)}}function gi(r){return t0(r,"web")}var Pl;(function(r){r.Charts="Charts",r.Components="Components",r.LayoutElements="LayoutElements",r.Inputs="Inputs",r.CustomElements="CustomElements"})(Pl||(Pl={}));function n0(r,e){function t(){if(!r.typeCaption&&r.toolbarConfig){const n=Array.isArray(r.toolbarConfig)?r.toolbarConfig[0]:r.toolbarConfig;r.typeCaption=n.caption}}return function(n){r.typeRef=n,r.viewElementGroupType??=Pl.CustomElements,t(),jp(r),e==="mobile"?Og(r,n):Rg(r,n)}}function i0(r){return n0(r,"web")}var it;(function(r){r.None="none",r.Default="default",r.ExtraSmall="extra-small",r.Small="small",r.Medium="medium",r.Large="large",r.ExtraLarge="extra-large"})(it||(it={}));const s0=Object.values(it);function Rl(r){return!!r&&typeof r=="string"&&s0.includes(r.toLowerCase())}class r0{constructor(e){this.injector=e}}const a0=new i.InjectionToken("Add delay before enabling skeleton loader");class ze extends r0{set shape(e){this._shape=e;const t=this._classes.indexOf("crt-component-rounded");this.shape==="rounded"?t===-1&&this._classes.push("crt-component-rounded"):t>=0&&this._classes.splice(t,1)}get shape(){return this._shape}get classes(){return this.getClasses()}set classes(e){this.setClasses(e)}get loading(){return this._loading$.value}set loading(e){this._loading$.next(!!e),typeof e=="boolean"&&(e?this.handleStartLoadViewModelAttributes():this.handleFinishLoadViewModelAttributes())}constructor(e){super(e),this.injector=e,this._loading$=new u.BehaviorSubject(!1),this._classes=[],this.destroyed$=new u.Subject,this.loaderVisible=!1,this.documentDirection=null,this.documentDirection=e.get(At.Directionality)?.value==="rtl"?"rtl":null,this.changeDetectorRef=this.injector.get(i.ChangeDetectorRef),this.directionality=this.injector.get(At.Directionality),this.elementRef=this.injector.get(i.ElementRef),this._subscribeLoadingChanges()}_subscribeLoadingChanges(){const e=this.injector.get(a0,0,{optional:!0});this._loading$.pipe((0,l.switchMap)(t=>t?(0,u.of)(t).pipe((0,u.delay)(e)):(0,u.of)(t)),(0,l.tap)(t=>{this.loaderVisible=t,this.changeDetectorRef.markForCheck()}),(0,l.takeUntil)(this.destroyed$)).subscribe()}handleStartLoadViewModelAttributes(){}handleFinishLoadViewModelAttributes(){}setClasses(e){this._classes=e||[]}getClasses(){return this._classes}toggleClass(e,t,n){const s=e.indexOf(n);t&&s===-1&&e.push(n),!t&&s>=0&&e.splice(s,1)}switchClass(e,t,n){n.forEach(([s,a])=>{this.toggleClass(e,s===t,a)})}setValuesFromConfig(e,t=[]){const n=(0,M.omit)(e,["id","name","type",...t]);Object.entries(n).forEach(([s,a])=>{this[s]=a})}detectChanges(){this.changeDetectorRef.detectChanges()}isRtl(){return this.directionality.value==="rtl"}focus(){this.elementRef?.nativeElement.focus()}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}static{this.\u0275fac=function(t){return new(t||ze)(i.\u0275\u0275directiveInject(i.Injector))}}static{this.\u0275dir=i.\u0275\u0275defineDirective({type:ze,hostVars:2,hostBindings:function(t,n){t&2&&i.\u0275\u0275attribute("element-name",n.name)("dir",n.documentDirection)},inputs:{name:"name",id:"id",tabIndex:"tabIndex",styles:"styles",shape:"shape",classes:"classes",loading:"loading"},features:[i.\u0275\u0275InheritDefinitionFeature]})}}(0,y.__decorate)([re(),(0,y.__metadata)("design:type",String)],ze.prototype,"name",void 0),(0,y.__decorate)([re(),(0,y.__metadata)("design:type",String)],ze.prototype,"id",void 0),(0,y.__decorate)([re(),(0,y.__metadata)("design:type",Number)],ze.prototype,"tabIndex",void 0),(0,y.__decorate)([re(),(0,y.__metadata)("design:type",Object)],ze.prototype,"styles",void 0),(0,y.__decorate)([re(),(0,y.__metadata)("design:type",String),(0,y.__metadata)("design:paramtypes",[String])],ze.prototype,"shape",null),(0,y.__decorate)([re(),(0,y.__metadata)("design:type",Array),(0,y.__metadata)("design:paramtypes",[Array])],ze.prototype,"classes",null),(0,y.__decorate)([re(),(0,y.__metadata)("design:type",Boolean),(0,y.__metadata)("design:paramtypes",[Boolean])],ze.prototype,"loading",null);var o0=h(26828),l0=h.n(o0);function ud(r){if(typeof r=="number")return!0;if(typeof r=="string"){const e=Number.parseInt(r);return String(e)===r}return!1}const c0=["container"],Fp={Primary:{key:"primary",value:"#FFFFFF"}},oM="transparent",Bp={alignItems:"stretch"};class De extends ze{static{this._baseColors=Object.values(Fp).map(({key:e,value:t})=>({key:e.toLowerCase(),value:t.toLowerCase()}))}set container(e){this._container=e}get container(){return this.featureValues.DisableRemoveDuplicateIDs?this._container:this.elementRef}get isResponsive(){return this.responsiveWidth<Number.MAX_VALUE}get isResponsiveWidth(){return this.elementResponsiveWidth?this.elementWidth<this.elementResponsiveWidth:this.width<this.responsiveWidth}get responsiveWidth(){return 395*this.window.devicePixelRatio}set responsiveWidth(e){throw new Error("responsiveWidth is not supported yet")}constructor(e){super(e),this.injector=e,this.width=Number.MAX_VALUE,this.elementWidth=Number.MAX_VALUE,this.items=[],this.visiblePadding=!0,this.borderRadius=it.None,this.stretch=!1,this.fitContent=!0,this.elementResponsiveWidth=0,this.window=this.injector.get(T.ZP),this.featureValues=this.injector.get(fe),this.renderer=this.injector.get(i.Renderer2)}static isBaseColorKey(e){if(e&&typeof e=="string"){const t=e.toLowerCase();return De._baseColors.some(n=>n.key===t)}return!1}static isBaseColorValue(e){if(e&&typeof e=="string"){const t=e.toLowerCase();return De._baseColors.some(n=>n.value===t)}return!1}static getBaseColorKey(e){const t=e.toLowerCase();return De._baseColors.find(n=>n.value===t)?.key}static getBaseColorValue(e){const t=e.toLowerCase();return De._baseColors.find(n=>n.key===t)?.value}_preparePadding(){const{top:e,bottom:t}=this.padding;let{left:n,right:s}=this.padding;return this.isRtl()&&([s,n]=[n,s]),{top:e,bottom:t,left:n,right:s}}_paddingClasses(){const e=[],t=this.padding;if(!t)return e;if((0,M.isObject)(t)){const{top:n,bottom:s,left:a,right:o}=this._preparePadding();return this.applySizeClass("container-padding-top-{0}",n,e),this.applySizeClass("container-padding-bottom-{0}",s,e),this.applySizeClass("container-padding-left-{0}",a,e),this.applySizeClass("container-padding-right-{0}",o,e),e}return this.applySizeClass("container-padding-{0}",t,e),e}_paddingStyles(){const e={},t=this.padding;if(!t)return e;if((0,M.isObject)(t)){const{top:n,bottom:s,left:a,right:o}=this._preparePadding();return this.applySizeStyle("paddingTop",n,e),this.applySizeStyle("paddingBottom",s,e),this.applySizeStyle("paddingLeft",a,e),this.applySizeStyle("paddingRight",o,e),e}return this.applySizeStyle("padding",t,e),e}_borderRadiusClasses(){const e=[],t=this.borderRadius;return t&&t!==it.None&&(this.applySizeClass("container-border-radius-{0}",t,e),e.push("container-border-area")),e}_borderRadiusStyles(){const e={},t=this.borderRadius;return t&&(ud(t)?e.borderRadius=`${t}px`:Rl(t)||(e.borderRadius=t)),e}_colorClasses(){const e=this.color?.toLowerCase(),t=[];return De.isBaseColorKey(e)&&t.push(`container-background-color-${e}`),t}_colorStyles(){const e={};return this.color&&!De.isBaseColorKey(this.color)&&(e.backgroundColor=this.color),e}onScroll(){}applySizeClass(e,t,n){if(typeof t=="string"&&Rl(t)&&t!==it.None){const s=Kt.String.Format(e,t.toLowerCase());n.push(s)}}onResize(){this.window.requestAnimationFrame(()=>{this.zone.run(()=>{this.isResponsive&&(this.width=this.window.innerWidth,this.elementWidth=this.elementRef.nativeElement.clientWidth,this.updateResponsiveStyles(),this.detectChanges())})})}getClasses(){const e=super.getClasses(),t=this._paddingClasses(),n=this._colorClasses(),s=this._borderRadiusClasses();return[...e,...t,...n,...s]}applySizeStyle(e,t,n){t&&(ud(t)?n[e]=`${t}px`:typeof t=="string"&&!Rl(t)&&(n[e]=t))}setValuesFromConfig(e,t=[]){super.setValuesFromConfig(e,["items"])}get containerStyles(){return{...(0,M.isObject)(this.styles)?this.styles:{},...this._paddingStyles(),...this._borderRadiusStyles(),...this._colorStyles()}}detectChangesAsync(e=null){this.window.requestAnimationFrame(()=>{setTimeout(()=>{this.detectChanges(),e?.()})})}subscribeResize(){this.resizeObserver=new(l0())(()=>this.onResize()),this.container&&this.resizeObserver.observe(this.container.nativeElement)}updateResponsiveStyles(){}ngOnInit(){this.visiblePadding=!this.featureValues.HideDesignPadding}ngAfterViewInit(){this.zone=this.injector.get(i.NgZone),this.subscribeResize()}ngOnDestroy(){super.ngOnDestroy(),this.resizeObserver?.disconnect()}static{this.\u0275fac=function(t){return new(t||De)(i.\u0275\u0275directiveInject(i.Injector))}}static{this.\u0275dir=i.\u0275\u0275defineDirective({type:De,viewQuery:function(t,n){if(t&1&&i.\u0275\u0275viewQuery(c0,5),t&2){let s;i.\u0275\u0275queryRefresh(s=i.\u0275\u0275loadQuery())&&(n.container=s.first)}},hostVars:4,hostBindings:function(t,n){t&1&&i.\u0275\u0275listener("scroll",function(){return n.onScroll()}),t&2&&i.\u0275\u0275classProp("stretch",n.stretch)("fit-content",n.fitContent)},inputs:{items:"items",visiblePadding:"visiblePadding",padding:"padding",borderRadius:"borderRadius",color:"color",responsiveWidth:"responsiveWidth",stretch:"stretch",fitContent:"fitContent",elementResponsiveWidth:"elementResponsiveWidth"},features:[i.\u0275\u0275InheritDefinitionFeature]})}}(0,y.__decorate)([re(),(0,y.__metadata)("design:type",Array)],De.prototype,"items",void 0),(0,y.__decorate)([re(),(0,y.__metadata)("design:type",Object)],De.prototype,"visiblePadding",void 0),(0,y.__decorate)([re(),(0,y.__metadata)("design:type",Object)],De.prototype,"padding",void 0),(0,y.__decorate)([re(),(0,y.__metadata)("design:type",Object)],De.prototype,"borderRadius",void 0),(0,y.__decorate)([re(),(0,y.__metadata)("design:type",Kt.String)],De.prototype,"color",void 0),(0,y.__decorate)([re(),(0,y.__metadata)("design:type",Number),(0,y.__metadata)("design:paramtypes",[Object])],De.prototype,"responsiveWidth",null),(0,y.__decorate)([re(),(0,y.__metadata)("design:type",Object)],De.prototype,"stretch",void 0),(0,y.__decorate)([re(),(0,y.__metadata)("design:type",Object)],De.prototype,"fitContent",void 0),(0,y.__decorate)([re(),(0,y.__metadata)("design:type",Object)],De.prototype,"elementResponsiveWidth",void 0);class Us extends De{constructor(){super(...arguments),this.slotHTMLElements=[]}setSlotElementStyles(e){e=this.castSlotElements(e.filter(t=>!(t instanceof Comment))),this.applySlotElementStyles(e)}castSlotElements(e){}getItemLayout(e){}castElementStylesToLayoutConfig(e){}applySlotElementStyles(e){e.forEach(t=>{const n=this.getItemLayout(t.layoutConfig);Object.entries(n).forEach(([s,a])=>{const o=(0,M.kebabCase)(s);this.renderer.setStyle(t,o,a)})})}get shouldUseSlots(){return!this.items||!this.items.length}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=i.\u0275\u0275getInheritedFactory(Us)))(n||Us)}})()}static{this.\u0275dir=i.\u0275\u0275defineDirective({type:Us,features:[i.\u0275\u0275InheritDefinitionFeature]})}}const u0=["items"],d0=["*"],h0=r=>({containerDiv:r});function p0(r,e){r&1&&i.\u0275\u0275elementContainer(0)}function m0(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"slot",7),i.\u0275\u0275listener("slotchange",function(s){i.\u0275\u0275restoreView(t);const a=i.\u0275\u0275nextContext(2);return i.\u0275\u0275resetView(a.slotChange(s))}),i.\u0275\u0275elementEnd(),i.\u0275\u0275projection(1)}}function g0(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"div",9),i.\u0275\u0275elementContainer(1,10),i.\u0275\u0275elementEnd()),r&2){const t=e.$implicit,n=i.\u0275\u0275nextContext(4);i.\u0275\u0275property("ngStyle",n.getItemLayout(t.layoutConfig)),i.\u0275\u0275advance(),i.\u0275\u0275property("crtViewElement",t)}}function f0(r,e){if(r&1&&(i.\u0275\u0275elementContainerStart(0),i.\u0275\u0275template(1,g0,2,2,"div",8),i.\u0275\u0275elementContainerEnd()),r&2){const t=i.\u0275\u0275nextContext(3);i.\u0275\u0275advance(),i.\u0275\u0275property("ngForOf",t.items)}}function _0(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"div",9),i.\u0275\u0275elementContainer(1,10),i.\u0275\u0275elementEnd()),r&2){const t=e.$implicit,n=i.\u0275\u0275nextContext(4);i.\u0275\u0275property("ngStyle",n.getItemLayout(t.layoutConfig)),i.\u0275\u0275advance(),i.\u0275\u0275property("crtViewElement",t)}}function y0(r,e){if(r&1&&i.\u0275\u0275template(0,_0,2,2,"div",8),r&2){const t=i.\u0275\u0275nextContext(2).containerDiv,n=i.\u0275\u0275nextContext();i.\u0275\u0275property("ngForOf",n.fixItemsOverlap(n.items,n.useOldTemplate?t:n.elementRef.nativeElement).items)}}function C0(r,e){if(r&1&&i.\u0275\u0275template(0,f0,2,1,"ng-container",5)(1,y0,1,1,"ng-template",null,3,i.\u0275\u0275templateRefExtractor),r&2){const t=i.\u0275\u0275reference(2),n=i.\u0275\u0275nextContext(2);i.\u0275\u0275property("ngIf",n.gridContainerAllowOverlapFeature)("ngIfElse",t)}}function b0(r,e){if(r&1&&i.\u0275\u0275template(0,p0,1,0,"ng-container",6)(1,m0,2,0,"ng-template",null,1,i.\u0275\u0275templateRefExtractor)(3,C0,3,2,"ng-template",null,2,i.\u0275\u0275templateRefExtractor),r&2){const t=i.\u0275\u0275reference(2),n=i.\u0275\u0275reference(4),s=i.\u0275\u0275nextContext();i.\u0275\u0275property("ngIf",s.shouldUseSlots)("ngIfThen",t)("ngIfElse",n)}}function S0(r,e){if(r&1&&(i.\u0275\u0275elementContainerStart(0),i.\u0275\u0275elementStart(1,"div",11,4),i.\u0275\u0275elementContainer(3,12),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementContainerEnd()),r&2){const t=i.\u0275\u0275reference(2),n=i.\u0275\u0275nextContext(),s=i.\u0275\u0275reference(1);i.\u0275\u0275advance(),i.\u0275\u0275styleProp("grid-template-columns",n.gridTemplateColumns),i.\u0275\u0275property("ngStyle",n.gridStyles)("ngClass",n.classes),i.\u0275\u0275attribute("id",n.id),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngTemplateOutlet",s)("ngTemplateOutletContext",i.\u0275\u0275pureFunction1(7,h0,t))}}const Up={...Bp,columnsTemplate:"minmax(32px, 1fr)"},Xa=(r,e,t={},n="column")=>{const s=Up.columnsTemplate,a="minmax(max-content, 32px)",o=new Array(r).fill(s);return{caption:`LayoutElements.Grid${n.charAt(0).toUpperCase()+n.slice(1)}${r}.Caption`,icon:h(33996)(`./grid-${n}-${r}-icon.svg`),defaultPropertyValues:{columns:o,rows:a,gap:{columnGap:it.Large},items:[],fitContent:!0,...t},position:e}},M0=(r,e)=>{const t={padding:{top:it.Medium,right:it.Large,bottom:it.Medium,left:it.Large},color:Fp.Primary.key,borderRadius:it.Medium};return Xa(r,e,t,"area")};let Et=class fd extends Us{get hostClasses(){if(!this.useOldTemplate)return this.classes}get hostGridStyles(){if(!this.useOldTemplate)return this.gridStyles}get hostGridTemplateColumns(){if(!this.useOldTemplate)return this.gridTemplateColumns}get gridStyles(){const e={};return this.justifyItems&&(e.justifyItems=this.justifyItems),this.alignItems&&(e.alignItems=this.alignItems),this.isResponsiveWidth&&(e.gridTemplateAreas="initial"),{...this.containerStyles,...e,...this._gapStyles(),...this._rowsStyles(),...this._columnsStyles()}}get gridTemplateColumns(){return this.isResponsiveWidth?Up.columnsTemplate:this.gridStyles.gridTemplateColumns}constructor(e){super(e),this.injector=e,this._containerClasses=[],this.useOldTemplate=!1,this._gridContainerItemsLayoutService=this.injector.get(Rs),this.gridContainerAllowOverlapFeature=!!this.featureValues.GridContainerAllowOverlap}_gapStyles(){const e={},t=this.gap;if((0,M.isObject)(t)){const{columnGap:n,rowGap:s}=t;this.applySizeStyle("columnGap",n,e),this.applySizeStyle("rowGap",s,e)}else this.applySizeStyle("gap",this.gap,e);return e}_rowsStyles(){const e={};return this.isResponsiveWidth?e.gridAutoRows="max-content":typeof this.rows=="string"?e.gridAutoRows=this.rows:this.rows instanceof Array&&(e.gridTemplateRows=this.rows.join(" ")),e}_columnsStyles(){const e={};return typeof this.columns=="string"?e.gridAutoColumns=this.columns:this.columns instanceof Array&&(e.gridTemplateColumns=this.columns.join(" ")),e}_gridTemplateColumnsClasses(){const e=[];return this.isResponsiveWidth&&e.push("crt-grid-responsive"),e}_gapClasses(){const e=[],t=this.gap;if(t)if((0,M.isObject)(t)){const{columnGap:n,rowGap:s}=t;this.applySizeClass("container-column-gap-{0}",n,e),this.applySizeClass("container-row-gap-{0}",s,e)}else this.applySizeClass("container-gap-{0}",t,e);return e}_fullLayoutConfig(e){const t={};let n="";e?.column!==void 0&&(n+=e.column),e?.colSpan!==void 0&&(n&&(n+="/"),e.colSpan!==-1&&(n+="span "),n+=e.colSpan);let s="";return e?.row!==void 0&&(s+=e.row),e?.rowSpan!==void 0&&(s&&(s+="/"),e.rowSpan!==-1&&(s+="span "),s+=e.rowSpan),n&&(t.gridColumn=n),s&&(t.gridRow=s),t}_responsiveLayoutConfig(e){const t={},n=e?.rowSpan;return n!==void 0&&n!==-1&&(t.gridRow=`span ${n}`),t}_computedGridColumns(e){return getComputedStyle(e).getPropertyValue("container-template-columns").split(" ")}_applySlotElementsResponsiveStyles(e){for(const t of e){const n=t?.layoutConfig?.rowSpan;n!==void 0&&n!==-1&&(this.renderer.setStyle(t,"grid-row-start",`span ${n}`),this.renderer.setStyle(t,"grid-row-end","auto")),this.renderer.setStyle(t,"grid-column-start","auto"),this.renderer.setStyle(t,"grid-column-end","auto")}}getClasses(){const e=super.getClasses()||[],t=this._gridTemplateColumnsClasses(),n=this._gapClasses(),s=[...e,"crt-grid",...t,...n].sort();return(0,M.isEqual)(this._containerClasses,s)||(this._containerClasses=s),this._containerClasses}applySlotElementStyles(e){if(this.isResponsiveWidth){this._applySlotElementsResponsiveStyles(e);return}super.applySlotElementStyles(e)}castElementStylesToLayoutConfig(e){const[t,n,s,a]=["row","column","row-span","col-span"].map(o=>{const c=`layout-config-${o}`,d=e.getAttribute(c);if(d)return Number(d)});return{row:t,column:n,rowSpan:s,colSpan:a}}castSlotElements(e){for(const t of e)t.layoutConfig=this.castElementStylesToLayoutConfig(t);if(!this.gridContainerAllowOverlapFeature&&this.container?.nativeElement){const t=e.map(n=>({layoutConfig:n.layoutConfig}));this.fixItemsOverlap(t,this.container.nativeElement)}return e}onResize(){super.onResize(),this.shouldUseSlots&&this.window.requestAnimationFrame(()=>{this.zone.run(()=>{this.setSlotElementStyles(this.slotHTMLElements)})})}getItemLayout(e){return e?this.isResponsiveWidth?this._responsiveLayoutConfig(e):this._fullLayoutConfig(e):null}fixItemsOverlap(e,t){let n=[];if(this.allowOverlap!==!0&&e){const s=this._computedGridColumns(t);n=this._gridContainerItemsLayoutService.fixItemsOverlap(e,s.length).affectedItems}return{items:e,affectedItems:n}}slotChange(e){const t=e.target.assignedNodes();!t||!t.length||(this.slotHTMLElements=t,this.setSlotElementStyles(this.slotHTMLElements))}updateResponsiveStyles(){if(this.useOldTemplate)return;const e=this.elementRef.nativeElement;this.isResponsiveWidth?this.renderer.addClass(e,"crt-grid-responsive"):this.renderer.removeClass(e,"crt-grid-responsive"),this.renderer.setStyle(e,"grid-template-areas",this.isResponsiveWidth?"initial":null),this.renderer.setStyle(e,"grid-template-columns",this.gridTemplateColumns??null)}ngOnInit(){super.ngOnInit(),this.useOldTemplate=this.featureValues.DisableRemoveDuplicateIDs}ngAfterContentInit(){this.children.changes.pipe((0,l.startWith)(this.children),(0,l.takeUntil)(this.destroyed$)).subscribe(()=>{const e=this.children.map(({nativeElement:t})=>t);e?.length&&(this.slotHTMLElements=e,this.setSlotElementStyles(this.slotHTMLElements))})}static{this.\u0275fac=function(t){return new(t||fd)(i.\u0275\u0275directiveInject(i.Injector))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:fd,selectors:[["crt-grid"]],contentQueries:function(t,n,s){if(t&1&&i.\u0275\u0275contentQuery(s,u0,4,i.ElementRef),t&2){let a;i.\u0275\u0275queryRefresh(a=i.\u0275\u0275loadQuery())&&(n.children=a)}},hostVars:6,hostBindings:function(t,n){t&2&&(i.\u0275\u0275styleMap(n.hostGridStyles),i.\u0275\u0275classMap(n.hostClasses),i.\u0275\u0275styleProp("grid-template-columns",n.hostGridTemplateColumns))},inputs:{rows:"rows",columns:"columns",gap:"gap",justifyItems:"justifyItems",alignItems:"alignItems",allowOverlap:"allowOverlap"},features:[i.\u0275\u0275InheritDefinitionFeature],ngContentSelectors:d0,decls:3,vars:2,consts:[["template",""],["slotsTemplate",""],["itemsTemplate",""],["fixItemsLayoutConfig",""],["container",""],[4,"ngIf","ngIfElse"],[4,"ngIf","ngIfThen","ngIfElse"],[3,"slotchange"],[3,"ngStyle",4,"ngFor","ngForOf"],[3,"ngStyle"],[3,"crtViewElement"],[1,"crt-grid",3,"ngStyle","ngClass"],[3,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(t,n){if(t&1&&(i.\u0275\u0275projectionDef(),i.\u0275\u0275template(0,b0,5,3,"ng-template",null,0,i.\u0275\u0275templateRefExtractor)(2,S0,4,9,"ng-container",5)),t&2){const s=i.\u0275\u0275reference(1);i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",n.useOldTemplate)("ngIfElse",s)}},dependencies:[v.NgClass,v.NgForOf,v.NgIf,v.NgTemplateOutlet,v.NgStyle,mt],encapsulation:2})}};(0,y.__decorate)([re(),(0,y.__metadata)("design:type",Object)],Et.prototype,"rows",void 0),(0,y.__decorate)([re(),(0,y.__metadata)("design:type",Object)],Et.prototype,"columns",void 0),(0,y.__decorate)([re(),(0,y.__metadata)("design:type",Object)],Et.prototype,"gap",void 0),(0,y.__decorate)([re(),(0,y.__metadata)("design:type",String)],Et.prototype,"justifyItems",void 0),(0,y.__decorate)([re(),(0,y.__metadata)("design:type",String)],Et.prototype,"alignItems",void 0),(0,y.__decorate)([re(),(0,y.__metadata)("design:type",Boolean)],Et.prototype,"allowOverlap",void 0),Et=(0,y.__decorate)([gi({type:"crt.GridContainer",contentSlots:["items"],reuseStrategy:Ht.Reuse}),i0({toolbarConfig:[M0(1,40),Xa(1,50),Xa(2,60),Xa(3,70),Xa(4,80)],designControlConfig:{allowDesignContent:!0},propertiesPanelComponentTypeName:"crt.GridPropertiesPanel",viewElementGroupType:Pl.LayoutElements,typeCaption:"TypeCaptions.GridContainer"}),(0,y.__metadata)("design:paramtypes",[i.Injector])],Et);function Ol(){return function(r,e){Reflect.defineMetadata(tc+e.toString(),{},r.constructor)}}const v0=["items"],I0=["*"];function w0(r,e){r&1&&i.\u0275\u0275elementContainer(0)}function E0(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"slot",5),i.\u0275\u0275listener("slotchange",function(s){i.\u0275\u0275restoreView(t);const a=i.\u0275\u0275nextContext(2);return i.\u0275\u0275resetView(a.slotChange(s))}),i.\u0275\u0275elementEnd(),i.\u0275\u0275projection(1)}}function x0(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"div",7),i.\u0275\u0275elementContainer(1,8),i.\u0275\u0275elementEnd()),r&2){const t=e.$implicit,n=i.\u0275\u0275nextContext(3);i.\u0275\u0275property("ngStyle",n.getItemLayout(t.layoutConfig)),i.\u0275\u0275advance(),i.\u0275\u0275property("crtViewElement",t)}}function T0(r,e){if(r&1&&i.\u0275\u0275template(0,x0,2,2,"div",6),r&2){const t=i.\u0275\u0275nextContext(2);i.\u0275\u0275property("ngForOf",t.items)}}function A0(r,e){if(r&1&&i.\u0275\u0275template(0,w0,1,0,"ng-container",4)(1,E0,2,0,"ng-template",null,1,i.\u0275\u0275templateRefExtractor)(3,T0,1,1,"ng-template",null,2,i.\u0275\u0275templateRefExtractor),r&2){const t=i.\u0275\u0275reference(2),n=i.\u0275\u0275reference(4),s=i.\u0275\u0275nextContext();i.\u0275\u0275property("ngIf",s.shouldUseSlots)("ngIfThen",t)("ngIfElse",n)}}function D0(r,e){r&1&&i.\u0275\u0275elementContainer(0)}function N0(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementContainerStart(0),i.\u0275\u0275elementStart(1,"div",9),i.\u0275\u0275listener("scroll",function(){i.\u0275\u0275restoreView(t);const s=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(s.onInnerScroll())}),i.\u0275\u0275template(2,D0,1,0,"ng-container",10),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementContainerEnd()}if(r&2){const t=i.\u0275\u0275nextContext(),n=i.\u0275\u0275reference(1);i.\u0275\u0275advance(),i.\u0275\u0275styleProp("flex-direction",t.flexDirection),i.\u0275\u0275property("ngStyle",t.flexStyles)("ngClass",t.classes),i.\u0275\u0275attribute("id",t.id)("flex-direction",t.flexDirection)("role",t.role),i.\u0275\u0275advance(),i.\u0275\u0275property("ngTemplateOutlet",n)}}const fi={...Bp,direction:"row",justifyContent:"start",gap:it.Small};let gt=class Yl extends Us{constructor(){super(...arguments),this._containerClasses=[],this.useOldTemplate=!1,this.direction=fi.direction,this.justifyContent=fi.justifyContent,this.alignItems=fi.alignItems,this.gap=fi.gap,this.innerScroll=new i.EventEmitter}get hostClasses(){if(!this.useOldTemplate)return this.classes}get hostRole(){if(!this.useOldTemplate)return this.role}getClasses(){const t=[...super.getClasses(),"crt-flex",...this._gapClasses()].sort();return(0,M.isEqual)(this._containerClasses,t)||(this._containerClasses=t),this._containerClasses}_gapClasses(){const e=[],t=this.gap||fi.gap;return this.applySizeClass("container-gap-{0}",t,e),e}castElementStylesToLayoutConfig(e){const[t,n,s,a,o,c,d,p,C,I]=["basis","align-self","grow","shrink","width","height","min-width","max-width","min-height","max-height"].map(O=>{const Y=`layout-config-${O}`,te=e.getAttribute(Y);if(te)return te});return{basis:t,alignSelf:n,grow:Number(s),shrink:Number(a),width:Number(o),height:Number(c),minWidth:Number(d),maxWidth:Number(p),minHeight:Number(C),maxHeight:Number(I)}}castSlotElements(e){for(const t of e){const n=this.castElementStylesToLayoutConfig(t);t.layoutConfig=n}return e}get hostFlexStyles(){if(!this.useOldTemplate)return this.flexStyles}get flexStyles(){const e={};e.justifyContent=this.justifyContent||fi.justifyContent,e.alignItems=this.alignItems||fi.alignItems,e.flexWrap=this.wrap||(this.isVertical?"nowrap":"wrap");const t=this.gap;return t&&(ud(t)?e.gap=t+"px":Rl(t)||(e.gap=t)),{...this.containerStyles,...e}}get hostFlexDirection(){if(!this.useOldTemplate)return this.direction||this.styles?.flexDirection}get flexDirection(){return this.isVertical?this.direction||this.styles?.flexDirection:this.direction||this.styles?.flexDirection}get isVertical(){return["column","column-reverse"].includes(this.direction)}getItemLayout(e){let t={};return e?.basis&&(e.basis==="fit-content"?this.direction==="column"?t.height="fit-content":t.width="fit-content":t.flexBasis=e.basis),e?.grow!==void 0&&(t.flexGrow=e.grow),e?.shrink!==void 0&&(t.flexShrink=e.shrink),e?.alignSelf&&(t.alignSelf=e.alignSelf),e?.width&&(t.width=`${e.width}px`,t.minWidth=`${e.width}px`),e?.minWidth&&(t.minWidth=`${e.minWidth}px`),e?.maxWidth&&(t.maxWidth=`${e.maxWidth}px`),e?.height&&(t.height=`${e.height}px`,t.minHeight=`${e.height}px`),e?.minHeight&&(t.minHeight=`${e.minHeight}px`),e?.maxHeight&&(t.maxHeight=`${e.maxHeight}px`),e&&e.styles&&(t={...t,...e.styles}),t}ngOnInit(){super.ngOnInit(),this.useOldTemplate=!!this.featureValues.DisableRemoveDuplicateIDs}ngAfterContentInit(){this.children.changes.pipe((0,l.startWith)(this.children),(0,l.takeUntil)(this.destroyed$)).subscribe(()=>{const e=this.children.map(({nativeElement:t})=>t);e?.length&&(this.slotHTMLElements=e,this.setSlotElementStyles(this.slotHTMLElements))})}slotChange(e){const t=e.target.assignedNodes();!t||!t.length||(this.slotHTMLElements=t,this.setSlotElementStyles(this.slotHTMLElements))}onHostInnerScroll(){this.useOldTemplate||this.innerScroll.emit()}onInnerScroll(){this.innerScroll.emit()}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=i.\u0275\u0275getInheritedFactory(Yl)))(n||Yl)}})()}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:Yl,selectors:[["crt-flex"]],contentQueries:function(t,n,s){if(t&1&&i.\u0275\u0275contentQuery(s,v0,4,i.ElementRef),t&2){let a;i.\u0275\u0275queryRefresh(a=i.\u0275\u0275loadQuery())&&(n.children=a)}},hostVars:8,hostBindings:function(t,n){t&1&&i.\u0275\u0275listener("scroll",function(){return n.onHostInnerScroll()}),t&2&&(i.\u0275\u0275attribute("role",n.hostRole)("flex-direction",n.hostFlexDirection),i.\u0275\u0275styleMap(n.hostFlexStyles),i.\u0275\u0275classMap(n.hostClasses),i.\u0275\u0275styleProp("flex-direction",n.hostFlexDirection))},inputs:{direction:"direction",justifyContent:"justifyContent",wrap:"wrap",alignItems:"alignItems",gap:"gap",role:"role"},outputs:{innerScroll:"innerScroll"},features:[i.\u0275\u0275InheritDefinitionFeature],ngContentSelectors:I0,decls:3,vars:2,consts:[["template",""],["slotsTemplate",""],["itemsTemplate",""],[4,"ngIf","ngIfElse"],[4,"ngIf","ngIfThen","ngIfElse"],[3,"slotchange"],["class","crt-view-element-container",3,"ngStyle",4,"ngFor","ngForOf"],[1,"crt-view-element-container",3,"ngStyle"],[3,"crtViewElement"],[3,"scroll","ngStyle","ngClass"],[4,"ngTemplateOutlet"]],template:function(t,n){if(t&1&&(i.\u0275\u0275projectionDef(),i.\u0275\u0275template(0,A0,5,3,"ng-template",null,0,i.\u0275\u0275templateRefExtractor)(2,N0,3,8,"ng-container",3)),t&2){const s=i.\u0275\u0275reference(1);i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",n.useOldTemplate)("ngIfElse",s)}},dependencies:[v.NgClass,v.NgForOf,v.NgIf,v.NgTemplateOutlet,v.NgStyle,mt],encapsulation:2})}};(0,y.__decorate)([re(),(0,y.__metadata)("design:type",String)],gt.prototype,"direction",void 0),(0,y.__decorate)([re(),(0,y.__metadata)("design:type",String)],gt.prototype,"justifyContent",void 0),(0,y.__decorate)([re(),(0,y.__metadata)("design:type",String)],gt.prototype,"wrap",void 0),(0,y.__decorate)([re(),(0,y.__metadata)("design:type",String)],gt.prototype,"alignItems",void 0),(0,y.__decorate)([re(),(0,y.__metadata)("design:type",Object)],gt.prototype,"gap",void 0),(0,y.__decorate)([re(),(0,y.__metadata)("design:type",String)],gt.prototype,"role",void 0),(0,y.__decorate)([Ol(),(0,y.__metadata)("design:type",Object)],gt.prototype,"innerScroll",void 0),gt=(0,y.__decorate)([gi({type:"crt.FlexContainer",contentSlots:["items"],reuseStrategy:Ht.Reuse})],gt);function P0(r,e){if(r&1&&i.\u0275\u0275elementContainer(0,3),r&2){const t=e.$implicit,n=i.\u0275\u0275nextContext(2);i.\u0275\u0275property("crtViewModel",t)("crtViewElement",n.itemViewConfig)}}function R0(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"div"),i.\u0275\u0275template(1,P0,1,2,"ng-container",2),i.\u0275\u0275elementEnd()),r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275advance(),i.\u0275\u0275property("ngForOf",t.viewModels)}}let _i=class Kl extends ze{static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=i.\u0275\u0275getInheritedFactory(Kl)))(n||Kl)}})()}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:Kl,selectors:[["ts-component-list"]],inputs:{itemViewConfig:"itemViewConfig",viewModels:"viewModels"},features:[i.\u0275\u0275InheritDefinitionFeature],decls:2,vars:4,consts:[[1,"ts-component-list",3,"ngStyle","ngClass"],[4,"ngIf"],[3,"crtViewModel","crtViewElement",4,"ngFor","ngForOf"],[3,"crtViewModel","crtViewElement"]],template:function(t,n){t&1&&(i.\u0275\u0275elementStart(0,"div",0),i.\u0275\u0275template(1,R0,2,1,"div",1),i.\u0275\u0275elementEnd()),t&2&&(i.\u0275\u0275property("ngStyle",n.styles)("ngClass",n.classes),i.\u0275\u0275attribute("id",n.id),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",n.viewModels))},dependencies:[v.NgClass,v.NgForOf,v.NgIf,v.NgStyle,ci,mt],encapsulation:2})}};(0,y.__decorate)([re(),(0,y.__metadata)("design:type",Object)],_i.prototype,"itemViewConfig",void 0),(0,y.__decorate)([re(),(0,y.__metadata)("design:type",tt)],_i.prototype,"viewModels",void 0),_i=(0,y.__decorate)([gi({type:"crt.ComponentList",reuseStrategy:Ht.Reuse})],_i);let Vl=class ql extends ze{static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=i.\u0275\u0275getInheritedFactory(ql)))(n||ql)}})()}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:ql,selectors:[["ts-list"]],features:[i.\u0275\u0275InheritDefinitionFeature],decls:16,vars:3,consts:[[1,"ts-list",3,"ngStyle","ngClass"]],template:function(t,n){t&1&&(i.\u0275\u0275elementStart(0,"div",0)(1,"ul")(2,"li"),i.\u0275\u0275text(3,"1 Item"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(4,"li"),i.\u0275\u0275text(5,"2 Item"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(6,"li"),i.\u0275\u0275text(7,"3 Item"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(8,"li"),i.\u0275\u0275text(9,"4 Item"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(10,"li"),i.\u0275\u0275text(11,"5 Item"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(12,"li"),i.\u0275\u0275text(13,"6 Item"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(14,"li"),i.\u0275\u0275text(15,"7 Item"),i.\u0275\u0275elementEnd()()()),t&2&&(i.\u0275\u0275property("ngStyle",n.styles)("ngClass",n.classes),i.\u0275\u0275attribute("id",n.id))},dependencies:[v.NgClass,v.NgStyle],encapsulation:2})}};Vl=(0,y.__decorate)([gi({type:"crt.List",reuseStrategy:Ht.Reuse})],Vl);const O0=["*"],V0=r=>({"actions-menu-button-with-icon":r});function L0(r,e){if(r&1&&i.\u0275\u0275element(0,"mat-icon",11),r&2){const t=i.\u0275\u0275nextContext(2);i.\u0275\u0275property("svgIcon",t.config.trigger.svgIconName)}}function k0(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"span",12),i.\u0275\u0275text(1),i.\u0275\u0275elementEnd()),r&2){const t=i.\u0275\u0275nextContext(2);i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(t.config.trigger.caption)}}function j0(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"button",6),i.\u0275\u0275listener("menuOpened",function(){i.\u0275\u0275restoreView(t);const s=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(s.onMenuOpened())}),i.\u0275\u0275template(1,L0,1,1,"mat-icon",7)(2,k0,2,1,"span",8),i.\u0275\u0275elementStart(3,"div",9),i.\u0275\u0275element(4,"div",10),i.\u0275\u0275elementEnd()()}if(r&2){const t=i.\u0275\u0275nextContext(),n=i.\u0275\u0275reference(4);i.\u0275\u0275property("matMenuTriggerFor",n)("disabled",t.config.trigger.disabled),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",t.config.trigger.svgIconName),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",t.config.trigger.caption)}}function F0(r,e){if(r&1&&i.\u0275\u0275element(0,"mat-divider"),r&2){const t=i.\u0275\u0275nextContext().index;i.\u0275\u0275styleProp("visibility",t===0?"hidden":"visible")}}function B0(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"div",15),i.\u0275\u0275text(1),i.\u0275\u0275elementEnd()),r&2){const t=i.\u0275\u0275nextContext().$implicit;i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(t.caption)}}function U0(r,e){if(r&1&&i.\u0275\u0275element(0,"mat-icon",23),r&2){const t=i.\u0275\u0275nextContext(3).$implicit;i.\u0275\u0275property("svgIcon",t.svgIconName)}}function z0(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"span",21),i.\u0275\u0275template(1,U0,1,1,"mat-icon",22),i.\u0275\u0275elementEnd()),r&2){const t=i.\u0275\u0275nextContext(2).$implicit;i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",t.svgIconName)}}function H0(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"div",16),i.\u0275\u0275listener("click",function(s){i.\u0275\u0275restoreView(t);const a=i.\u0275\u0275nextContext().$implicit,o=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(o.onMenuItemContainerClick(s,a))}),i.\u0275\u0275elementStart(1,"button",17),i.\u0275\u0275listener("click",function(){i.\u0275\u0275restoreView(t);const s=i.\u0275\u0275nextContext().$implicit,a=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(a.onMenuItemClick(s))}),i.\u0275\u0275elementStart(2,"div",18),i.\u0275\u0275template(3,z0,2,1,"span",19),i.\u0275\u0275elementStart(4,"span",20),i.\u0275\u0275text(5),i.\u0275\u0275elementEnd()()()()}if(r&2){const t=i.\u0275\u0275nextContext().$implicit,n=i.\u0275\u0275nextContext();i.\u0275\u0275advance(),i.\u0275\u0275property("disabled",n.isMenuItemDisabled(t))("ngClass",i.\u0275\u0275pureFunction1(4,V0,n.hasIcons())),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",n.hasIcons()),i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(t.caption)}}function W0(r,e){if(r&1&&(i.\u0275\u0275elementContainerStart(0),i.\u0275\u0275template(1,F0,1,2,"mat-divider",13)(2,B0,2,1,"div",14)(3,H0,6,6,"ng-template",null,1,i.\u0275\u0275templateRefExtractor),i.\u0275\u0275elementContainerEnd()),r&2){const t=e.$implicit,n=i.\u0275\u0275reference(4),s=i.\u0275\u0275nextContext();i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",t.code===s.dividerItemCode)("ngIfElse",n),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",t.code===s.dividerItemCode&&t.caption)}}const zp={code:"__divider",caption:null};Object.freeze(zp);class eo{constructor(){this.menuItemClick=new i.EventEmitter}static{this.\u0275fac=function(t){return new(t||eo)}}static{this.\u0275dir=i.\u0275\u0275defineDirective({type:eo,outputs:{menuItemClick:"menuItemClick"}})}}class yi extends eo{constructor(){super(...arguments),this.dividerItemCode=zp.code}isMenuItemDisabled(e){return e.disabled===!0}onMenuItemClick(e){e.handler&&e.handler(),this.menuItemClick.emit(e.code)}onMenuItemContainerClick(e,t){this.isMenuItemDisabled(t)&&e.stopPropagation()}hasIcons(){return this.config?.menuItems?.some(e=>e.svgIconName)}trackByCode(e,t){return t.code}onMenuOpened(){this.visibleMenuItems=this.config?.menuItems?.filter(e=>!e.hidden)??[]}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=i.\u0275\u0275getInheritedFactory(yi)))(n||yi)}})()}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:yi,selectors:[["ts-actions-menu"]],inputs:{config:"config"},features:[i.\u0275\u0275InheritDefinitionFeature],ngContentSelectors:O0,decls:6,vars:7,consts:[["menu","matMenu"],["menuItem",""],[1,"actions-menu-trigger-wrapper",3,"menuOpened","matMenuTriggerFor"],["mat-button","","class","actions-menu-trigger default",3,"matMenuTriggerFor","disabled","menuOpened",4,"ngIf"],[1,"actions-menu-panel",3,"overlapTrigger"],[4,"ngFor","ngForOf","ngForTrackBy"],["mat-button","",1,"actions-menu-trigger","default",3,"menuOpened","matMenuTriggerFor","disabled"],["class","actions-menu-trigger-icon",3,"svgIcon",4,"ngIf"],["class","actions-menu-trigger-caption",4,"ngIf"],[1,"mat-select-arrow-wrapper"],[1,"mat-select-arrow"],[1,"actions-menu-trigger-icon",3,"svgIcon"],[1,"actions-menu-trigger-caption"],[3,"visibility",4,"ngIf","ngIfElse"],["class","menu-divider-caption",4,"ngIf"],[1,"menu-divider-caption"],[3,"click"],["mat-menu-item","",3,"click","disabled","ngClass"],[1,"actions-menu-item-button-content"],["class","actions-menu-item-icon-wrapper",4,"ngIf"],[1,"actions-menu-item-text"],[1,"actions-menu-item-icon-wrapper"],[3,"svgIcon",4,"ngIf"],[3,"svgIcon"]],template:function(t,n){if(t&1){const s=i.\u0275\u0275getCurrentView();i.\u0275\u0275projectionDef(),i.\u0275\u0275elementStart(0,"div",2),i.\u0275\u0275listener("menuOpened",function(){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.onMenuOpened())}),i.\u0275\u0275projection(1),i.\u0275\u0275elementEnd(),i.\u0275\u0275template(2,j0,5,4,"button",3),i.\u0275\u0275elementStart(3,"mat-menu",4,0),i.\u0275\u0275template(5,W0,5,3,"ng-container",5),i.\u0275\u0275elementEnd()}if(t&2){const s=i.\u0275\u0275reference(4);i.\u0275\u0275property("matMenuTriggerFor",s),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",n.config==null?null:n.config.trigger),i.\u0275\u0275advance(),i.\u0275\u0275classMap(n.config==null?null:n.config.cssClasses),i.\u0275\u0275property("overlapTrigger",n.config==null?null:n.config.overlapTrigger),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngForOf",n.visibleMenuItems)("ngForTrackBy",n.trackByCode)}},dependencies:[v.NgClass,v.NgForOf,v.NgIf,$.MatLegacyButton,Mt.MatDivider,G.MatIcon,zn.MatLegacyMenu,zn.MatLegacyMenuItem,zn.MatLegacyMenuTrigger],styles:[`ts-actions-menu .actions-menu-trigger-wrapper{display:flex;align-items:center}.mat-menu-content .menu-divider-caption{padding:0 16px;text-transform:uppercase;font-size:14px;color:#4b7fc7;height:33px;line-height:33px}.actions-menu-panel{max-width:500px!important}.actions-menu-panel button.mat-menu-item{height:33px!important;line-height:33px!important;padding-right:30px}.actions-menu-panel button.mat-menu-item.actions-menu-button-with-icon{padding-left:12px!important}.actions-menu-panel button.mat-menu-item .actions-menu-item-button-content{display:flex;flex-direction:row;align-items:center}.actions-menu-panel button.mat-menu-item .actions-menu-item-button-content .actions-menu-item-icon-wrapper{width:16px;height:16px;padding-right:8px;line-height:16px}.actions-menu-panel button.mat-menu-item .actions-menu-item-button-content .actions-menu-item-icon-wrapper mat-icon{width:16px;height:16px;margin:0!important}.actions-menu-panel mat-divider{margin:5px 12px}
`],encapsulation:2,changeDetection:0})}}class Hp{constructor(e){Object.assign(this,e)}}class lM extends Hp{constructor(e){super(e),this.externalLink=!1}}class dd extends Hp{}var $0=h(81398);function G0(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"mat-checkbox",1),i.\u0275\u0275listener("change",function(s){i.\u0275\u0275restoreView(t);const a=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(a.setValue(s.checked))}),i.\u0275\u0275elementEnd()}if(r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275property("disabled",t.isDisabled())("checked",t.getValue())("matTooltip",t.getTooltipText())}}class cM extends dd{constructor(e){super(e),this.cellComponentClass=Ci,this.valueType=E.r.Boolean}}class Ci extends $0.P{isDisabled(){const e=this.columnDataSchema.disabled;return typeof e=="function"?e(this.record):e}getTooltipText(){const e=this.columnDataSchema.tooltip;return typeof e=="function"?e(this.record):e}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=i.\u0275\u0275getInheritedFactory(Ci)))(n||Ci)}})()}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:Ci,selectors:[["ts-checkbox-table-cell"]],features:[i.\u0275\u0275InheritDefinitionFeature],decls:1,vars:1,consts:[[3,"disabled","checked","matTooltip","change",4,"ngIf"],[3,"change","disabled","checked","matTooltip"]],template:function(t,n){t&1&&i.\u0275\u0275template(0,G0,1,3,"mat-checkbox",0),t&2&&i.\u0275\u0275property("ngIf",!n.isEmpty())},dependencies:[v.NgIf,Ge.MatLegacyCheckbox,ct.MatTooltip],encapsulation:2})}}const Z0=(r,e,t)=>({menuItems:r,overlapTrigger:e,cssClasses:t});class to extends eo{constructor(e,t){super(),this._matIconRegistry=e,this._domSanitizer=t,this.menuItems=[],this.cssClasses="",this.overlapTrigger=!0,this._registerIcons()}_registerIcons(){this._matIconRegistry.addSvgIconLiteral("vertical-dots",this._domSanitizer.bypassSecurityTrustHtml(h(112)))}static{this.\u0275fac=function(t){return new(t||to)(i.\u0275\u0275directiveInject(G.MatIconRegistry),i.\u0275\u0275directiveInject(g.DomSanitizer))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:to,selectors:[["ts-compact-actions-menu"]],inputs:{menuItems:"menuItems",cssClasses:"cssClasses",overlapTrigger:"overlapTrigger"},features:[i.\u0275\u0275InheritDefinitionFeature],decls:2,vars:5,consts:[[3,"menuItemClick","config"],["svgIcon","vertical-dots"]],template:function(t,n){t&1&&(i.\u0275\u0275elementStart(0,"ts-actions-menu",0),i.\u0275\u0275listener("menuItemClick",function(a){return n.menuItemClick.emit(a)}),i.\u0275\u0275element(1,"mat-icon",1),i.\u0275\u0275elementEnd()),t&2&&i.\u0275\u0275property("config",i.\u0275\u0275pureFunction3(1,Z0,n.menuItems,n.overlapTrigger,n.cssClasses))},dependencies:[G.MatIcon,yi],styles:["[_nghost-%COMP%]{display:block}mat-icon[_ngcontent-%COMP%]{width:16px;height:16px;cursor:pointer}"],changeDetection:0})}}class Y0{}class no{constructor(){this._value=new Y0,this.valueChange=new i.EventEmitter}get startDate(){return this._startDate}set startDate(e){e.isSame(this._startDate)||(this._value.startDate=e.toDate(),this._startDate=e)}get endDate(){return this._endDate}set endDate(e){e.isSame(this._endDate)||(this._value.endDate=e.toDate(),this._endDate=e)}set value(e){const t={startDate:I_(e.startDate),endDate:Kh(e.endDate)};this._value=t,this._startDate=No()(t.startDate),this._endDate=No()(t.endDate)}get value(){return this._value}onValueChanged(){this.value.endDate=Kh(this.value.endDate),this.valueChange.emit(this.value)}static{this.\u0275fac=function(t){return new(t||no)}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:no,selectors:[["ts-date-range"]],inputs:{startDateRequired:"startDateRequired",endDateRequired:"endDateRequired",maxDate:"maxDate",value:"value"},outputs:{valueChange:"valueChange"},decls:15,vars:14,consts:[["startDatePicker",""],["endDatePicker",""],["floatLabel","never",1,"date-picker"],["matInput","",3,"ngModelChange","dateChange","max","matDatepicker","ngModel","disabled"],["matSuffix","",3,"for"],["svgIcon","start-date","matDatepickerToggleIcon","",1,"date-picker-icon"],["disabled","false"],[1,"period-separator"],["matInput","",3,"ngModelChange","dateChange","min","max","matDatepicker","ngModel","disabled"],["svgIcon","end-date","matDatepickerToggleIcon","",1,"date-picker-icon"]],template:function(t,n){if(t&1){const s=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"mat-form-field",2)(1,"input",3),i.\u0275\u0275twoWayListener("ngModelChange",function(o){return i.\u0275\u0275restoreView(s),i.\u0275\u0275twoWayBindingSet(n.startDate,o)||(n.startDate=o),i.\u0275\u0275resetView(o)}),i.\u0275\u0275listener("dateChange",function(){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.onValueChanged())}),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(2,"mat-datepicker-toggle",4),i.\u0275\u0275element(3,"mat-icon",5),i.\u0275\u0275elementEnd(),i.\u0275\u0275element(4,"mat-datepicker",6,0),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(6,"span",7),i.\u0275\u0275text(7),i.\u0275\u0275pipe(8,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(9,"mat-form-field",2)(10,"input",8),i.\u0275\u0275twoWayListener("ngModelChange",function(o){return i.\u0275\u0275restoreView(s),i.\u0275\u0275twoWayBindingSet(n.endDate,o)||(n.endDate=o),i.\u0275\u0275resetView(o)}),i.\u0275\u0275listener("dateChange",function(){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.onValueChanged())}),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(11,"mat-datepicker-toggle",4),i.\u0275\u0275element(12,"mat-icon",9),i.\u0275\u0275elementEnd(),i.\u0275\u0275element(13,"mat-datepicker",6,1),i.\u0275\u0275elementEnd()}if(t&2){const s=i.\u0275\u0275reference(5),a=i.\u0275\u0275reference(14);i.\u0275\u0275advance(),i.\u0275\u0275property("max",n.value.endDate)("matDatepicker",s),i.\u0275\u0275twoWayProperty("ngModel",n.startDate),i.\u0275\u0275property("disabled",n.startDateRequired),i.\u0275\u0275advance(),i.\u0275\u0275property("for",s),i.\u0275\u0275advance(5),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(8,12,"DateRange.To")),i.\u0275\u0275advance(3),i.\u0275\u0275property("min",n.value.startDate)("max",n.maxDate)("matDatepicker",a),i.\u0275\u0275twoWayProperty("ngModel",n.endDate),i.\u0275\u0275property("disabled",n.endDateRequired),i.\u0275\u0275advance(),i.\u0275\u0275property("for",a)}},dependencies:[Z.DefaultValueAccessor,Z.NgControlStatus,Z.NgModel,yn.MatDatepicker,yn.MatDatepickerInput,yn.MatDatepickerToggle,yn.MatDatepickerToggleIcon,ee.MatLegacyFormField,ee.MatLegacySuffix,G.MatIcon,me.MatLegacyInput,m.TranslatePipe],styles:["[_nghost-%COMP%]{display:flex}[_nghost-%COMP%]   .period-separator[_ngcontent-%COMP%]{padding-left:16px;padding-right:16px;padding-top:5px}[_nghost-%COMP%]   .date-picker-icon[_ngcontent-%COMP%]{width:20px!important;height:20px;padding-bottom:4px}[_nghost-%COMP%]   .date-picker-icon[_ngcontent-%COMP%]     svg{width:20px;height:20px}[_nghost-%COMP%]   mat-form-field[_ngcontent-%COMP%]{margin-bottom:-1em}"]})}}class zs extends To.X{constructor(){super(...arguments),this.getRegisteredEvents=()=>[{name:"click"}]}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=i.\u0275\u0275getInheritedFactory(zs)))(n||zs)}})()}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:zs,selectors:[["ts-delete-button-table-cell"]],features:[i.\u0275\u0275InheritDefinitionFeature],decls:3,vars:3,consts:[["mat-icon-button","",1,"trash-icon",3,"click","title"],["svgIcon","trash"]],template:function(t,n){t&1&&(i.\u0275\u0275elementStart(0,"button",0),i.\u0275\u0275pipe(1,"translate"),i.\u0275\u0275listener("click",function(){return n.fireEvent("click")}),i.\u0275\u0275element(2,"mat-icon",1),i.\u0275\u0275elementEnd()),t&2&&i.\u0275\u0275property("title",i.\u0275\u0275pipeBind1(1,1,"DeleteButtonTableCell.Tooltip"))},dependencies:[$.MatLegacyButton,G.MatIcon,m.TranslatePipe],encapsulation:2})}}var io;(function(r){r[r.Error=1]="Error",r[r.Warning=2]="Warning",r[r.Information=4]="Information"})(io||(io={}));function K0(r,e){if(r&1&&i.\u0275\u0275element(0,"mat-icon",1),r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275property("svgIcon",t.svgIconName)}}class uM extends dd{constructor(e){super(e),this.cellComponentClass=Hs}}class Hs extends To.X{get svgIconName(){return{[io.Error]:this.errorIconName,[io.Warning]:this.warningIconName,[io.Information]:""}[this.getValue()]??""}constructor(e,t){super(),this._matIconRegistry=e,this._domSanitizer=t,this.errorIconName="error-icon",this.warningIconName="warning-icon",this._registerIcons()}_registerIcons(){[this.warningIconName,this.errorIconName].forEach(e=>{this._matIconRegistry.addSvgIconLiteral(e,this._domSanitizer.bypassSecurityTrustHtml(h(48422)("./"+e+".svg")))})}static{this.\u0275fac=function(t){return new(t||Hs)(i.\u0275\u0275directiveInject(G.MatIconRegistry),i.\u0275\u0275directiveInject(g.DomSanitizer))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:Hs,selectors:[["ts-error-type-icon-table-cell"]],features:[i.\u0275\u0275InheritDefinitionFeature],decls:1,vars:1,consts:[["class","error-type-icon",3,"svgIcon",4,"ngIf"],[1,"error-type-icon",3,"svgIcon"]],template:function(t,n){t&1&&i.\u0275\u0275template(0,K0,1,1,"mat-icon",0),t&2&&i.\u0275\u0275property("ngIf",!n.isEmpty()&&n.getValue())},dependencies:[v.NgIf,G.MatIcon],styles:[".error-type-icon[_ngcontent-%COMP%]{height:16px;width:16px}"]})}}class so{constructor(e){this._environment=e}getUrl(){const e=this._environment.runtimeApplicationUrl||this._environment.defaultApplicationUrl;return v.Location.joinWithSlash(this._environment.workspaceBaseUrl,e)}static{this.\u0275fac=function(t){return new(t||so)(i.\u0275\u0275inject("environment"))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:so,factory:so.\u0275fac,providedIn:"root"})}}const q0=[[["","header",""]],"*"],J0=["[header]","*"];function Q0(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"span",8),i.\u0275\u0275text(1),i.\u0275\u0275elementEnd()),r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(t.title)}}class ft{static{this._logoLinkUrl=""}static{this._logoImageUrl=""}get logoLinkUrl(){return ft._logoLinkUrl}get logoImageUrl(){return ft._logoImageUrl}constructor(e,t){this._environment=e,this._runtimeUrlProvider=t}static setLogoLinkUrl(e){ft._logoLinkUrl=e}static setLogoImageUrl(e){ft._logoImageUrl=e}buildLogoImageUrl(){return"img/terrasoft.axd?s=nui-binary-syssetting&r=MenuLogoImage&source_hash="+Date.now().toString().slice(0,-5)}initDefaultLogoImageUrl(){ft.setLogoImageUrl("assets/app-logo.svg")}ngOnInit(){if(!this.logoLinkUrl){const e=this._runtimeUrlProvider.getUrl();ft.setLogoLinkUrl(e)}this.logoImageUrl||ft.setLogoImageUrl(v.Location.joinWithSlash(this._environment.workspaceBaseUrl,this.buildLogoImageUrl()))}static{this.\u0275fac=function(t){return new(t||ft)(i.\u0275\u0275directiveInject("environment"),i.\u0275\u0275directiveInject(so))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:ft,selectors:[["ts-header"]],inputs:{title:"title"},ngContentSelectors:J0,decls:10,vars:3,consts:[[1,"top-container"],[1,"left-container"],["class","title",4,"ngIf"],[1,"content-wrapper"],[1,"right-container"],[1,"logo-wrapper",3,"href"],["alt","logo image",1,"logo",3,"error","src"],[1,"content-wrapper","bottom-content-wrapper"],[1,"title"]],template:function(t,n){t&1&&(i.\u0275\u0275projectionDef(q0),i.\u0275\u0275elementStart(0,"div",0)(1,"div",1),i.\u0275\u0275template(2,Q0,2,1,"span",2),i.\u0275\u0275elementStart(3,"div",3),i.\u0275\u0275projection(4),i.\u0275\u0275elementEnd()(),i.\u0275\u0275elementStart(5,"div",4)(6,"a",5)(7,"img",6),i.\u0275\u0275listener("error",function(){return n.initDefaultLogoImageUrl()}),i.\u0275\u0275elementEnd()()()(),i.\u0275\u0275elementStart(8,"div",7),i.\u0275\u0275projection(9,1),i.\u0275\u0275elementEnd()),t&2&&(i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",n.title),i.\u0275\u0275advance(4),i.\u0275\u0275propertyInterpolate("href",n.logoLinkUrl,i.\u0275\u0275sanitizeUrl),i.\u0275\u0275advance(),i.\u0275\u0275propertyInterpolate("src",n.logoImageUrl,i.\u0275\u0275sanitizeUrl))},dependencies:[v.NgIf],styles:["[_nghost-%COMP%]{display:block;padding:12px 22px 12px 21px}.top-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center}.top-container[_ngcontent-%COMP%]   .left-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;overflow:hidden}.top-container[_ngcontent-%COMP%]   .left-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:block;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;font-family:Bpmonline Open Sans Light,serif;font-size:26px;height:26px}.top-container[_ngcontent-%COMP%]   .right-container[_ngcontent-%COMP%]{display:flex;flex-direction:row-reverse;align-items:center}.top-container[_ngcontent-%COMP%]   .right-container[_ngcontent-%COMP%]   .logo-wrapper[_ngcontent-%COMP%]{display:block}.top-container[_ngcontent-%COMP%]   .right-container[_ngcontent-%COMP%]   .logo-wrapper[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{height:-moz-fit-content;height:fit-content;max-height:28px;max-width:134px}.content-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row}.content-wrapper[_ngcontent-%COMP%]:not(:empty).top-left-content-wrapper:not(:first-child){padding-left:15px}.content-wrapper[_ngcontent-%COMP%]:not(:empty).bottom-content-wrapper{margin:14px 0 0}"]})}}function X0(r,e,t){const n=r.toLowerCase();switch(t){case wt.Contains:return n.includes(e);case wt.StartsWith:return n.indexOf(e)===0;case wt.Equals:return n===e}}function eb(r,e=wt.Contains){return ue.checkArgumentEmpty("columnSelectors",r),(t,n)=>n?r.some(s=>{const a=typeof s=="string"?t[s]:s(t);return!a||typeof a!="string"?!1:X0(a,n,e)}):!0}var hd=h(14715);class Wp extends hd.MatLegacyTableDataSource{constructor(e=[]){super(e),this._visibleContentSize=0,this._pageSize=40,this.resetVisibleContentSize()}resetVisibleContentSize(){this._visibleContentSize=this._pageSize}loadNext(){this._visibleContentSize+=this._pageSize,this._updateChangeSubscription()}_pageData(e){return this._visibleContentSize>=e.length?e:e.slice(0,this._visibleContentSize)}}const tb=["tableWrapper"],nb=["tableNgContainer"];function ib(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"div",16)(1,"span",17),i.\u0275\u0275text(2),i.\u0275\u0275pipe(3,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(4,"span",18),i.\u0275\u0275text(5),i.\u0275\u0275elementEnd()()),r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(3,2,"MultiselectDialog.Selected")),i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate1(" ",t.selectedValues.length,"")}}function sb(r,e){r&1&&(i.\u0275\u0275elementContainerStart(0),i.\u0275\u0275elementStart(1,"span"),i.\u0275\u0275text(2),i.\u0275\u0275pipe(3,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementContainerEnd()),r&2&&(i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(3,1,"MultiselectDialog.Blankslate")))}function rb(r,e){r&1&&(i.\u0275\u0275elementStart(0,"span"),i.\u0275\u0275text(1),i.\u0275\u0275pipe(2,"translate"),i.\u0275\u0275elementEnd()),r&2&&(i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(2,1,"MultiselectDialog.BlankslateWithFilters")))}function ab(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"div",19),i.\u0275\u0275template(1,sb,4,3,"ng-container",20)(2,rb,3,3,"ng-template",null,2,i.\u0275\u0275templateRefExtractor),i.\u0275\u0275elementEnd()),r&2){const t=i.\u0275\u0275reference(3),n=i.\u0275\u0275nextContext();i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",!n.searchKey)("ngIfElse",t)}}class ro{get searchKey(){return this.searchKeyValue}set searchKey(e){this.searchKeyValue=e,this.tableDataSource.filter=e&&e.trim().toLowerCase()}constructor(e,t,n){this._dialogData=e,this._scrollToBottomObserverFactory=t,this._dialogRef=n,this.searchColumns=[],this.tableData=[],this.searchKeyValue="",this.title="",this.selectedValues=[],this.tableDataSource=new Wp}renderTableComponent(e){var t=this;return(0,f.A)(function*(){yield h.e(1029).then(h.bind(h,61029)).then(n=>{const s=n.TableComponent;t.table=e.createComponent(s).instance,t.table.selectMode=t.selectMode,t.table.dataSchema=t.dataSchema,t.table.dataSource=t.tableDataSource,t.table.sortColumn=t.sortColumn,t.table.sortDirection=t.sortDirection,t.table.showSelectAllButton=t.showSelectAllButton,t.table.headerSticky=!0,t.table.selected=t.selectedValues,t.table.selectedChange.subscribe(a=>t.selectedValues=a),t.table.rowDoubleClick.subscribe(a=>t.closeWithSelection(a))})})()}initDataSource(){this.tableDataSource.data=this.tableData,this.tableDataSource.filterPredicate=eb(this.searchColumns)}loadNextData(){this.tableDataSource.loadNext()}ngOnInit(){var e=this;return(0,f.A)(function*(){!e._dialogData||!e._dialogData.data||(e.tableData=e._dialogData.data,e.dataSchema=e._dialogData.dataSchema,e.sortDirection=e._dialogData.sortDirection||"asc",e.sortColumn=e._dialogData.sortColumn,e.title=e._dialogData.title||e.title,e.selectMode=e._dialogData.selectMode||"multi",e.showSelectAllButton=e._dialogData.showSelectAllButton!==void 0?e._dialogData.showSelectAllButton:!0,e.searchColumns=e._dialogData.searchColumns||[],e.initDataSource(),yield e.renderTableComponent(e.tableNgContainer))})()}ngAfterViewInit(){const e=this.tableWrapper.nativeElement;e&&(this.scrollTableToBottomObserver=this._scrollToBottomObserverFactory.createObserver(e,this.loadNextData.bind(this)))}isEmpty(){return this.table?this.table.isEmpty():!0}closeWithSelection(e){this.selectMode==="single"&&this._dialogRef.close([e])}static{this.\u0275fac=function(t){return new(t||ro)(i.\u0275\u0275directiveInject(N.MAT_LEGACY_DIALOG_DATA),i.\u0275\u0275directiveInject(hi),i.\u0275\u0275directiveInject(N.MatLegacyDialogRef))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:ro,selectors:[["ts-multiselect-dialog"]],viewQuery:function(t,n){if(t&1&&(i.\u0275\u0275viewQuery(tb,7),i.\u0275\u0275viewQuery(nb,7,i.ViewContainerRef)),t&2){let s;i.\u0275\u0275queryRefresh(s=i.\u0275\u0275loadQuery())&&(n.tableWrapper=s.first),i.\u0275\u0275queryRefresh(s=i.\u0275\u0275loadQuery())&&(n.tableNgContainer=s.first)}},decls:22,vars:14,consts:[["tableWrapper",""],["tableNgContainer",""],["blankslateWithFilters",""],["mat-dialog-title",""],[1,"title"],["mat-icon-button","",1,"close-dialog",3,"mat-dialog-close"],["svgIcon","close",1,"close-button-icon"],[1,"multiselect-dialog-top-panel"],[1,"dialog-filters"],[3,"valueChange","value"],["class","select-counter-container",4,"ngIf"],["mat-dialog-content",""],["class","multiselect-dialog-blank-slate",4,"ngIf"],["mat-dialog-actions",""],["mat-button","","cdkFocusInitial","",3,"mat-dialog-close"],["mat-flat-button","","color","primary",3,"mat-dialog-close","disabled"],[1,"select-counter-container"],[1,"counter-label"],[1,"counter-value"],[1,"multiselect-dialog-blank-slate"],[4,"ngIf","ngIfElse"]],template:function(t,n){if(t&1){const s=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"div",3)(1,"span",4),i.\u0275\u0275text(2),i.\u0275\u0275pipe(3,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(4,"button",5),i.\u0275\u0275element(5,"mat-icon",6),i.\u0275\u0275elementEnd()(),i.\u0275\u0275elementStart(6,"div",7)(7,"div",8)(8,"ts-search-input",9),i.\u0275\u0275twoWayListener("valueChange",function(o){return i.\u0275\u0275restoreView(s),i.\u0275\u0275twoWayBindingSet(n.searchKey,o)||(n.searchKey=o),i.\u0275\u0275resetView(o)}),i.\u0275\u0275elementEnd()(),i.\u0275\u0275template(9,ib,6,4,"div",10),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(10,"div",11,0),i.\u0275\u0275elementContainer(12,null,1),i.\u0275\u0275template(14,ab,4,2,"div",12),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(15,"div",13)(16,"button",14),i.\u0275\u0275text(17),i.\u0275\u0275pipe(18,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(19,"button",15),i.\u0275\u0275text(20),i.\u0275\u0275pipe(21,"translate"),i.\u0275\u0275elementEnd()()}t&2&&(i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(3,8,n.title||"MultiselectDialog.Select")),i.\u0275\u0275advance(6),i.\u0275\u0275twoWayProperty("value",n.searchKey),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",n.selectMode==="multi"),i.\u0275\u0275advance(5),i.\u0275\u0275property("ngIf",n.isEmpty()),i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(18,10,"MultiselectDialog.Cancel")),i.\u0275\u0275advance(2),i.\u0275\u0275property("mat-dialog-close",n.selectedValues)("disabled",n.selectedValues.length==0),i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(21,12,"MultiselectDialog.Select")))},dependencies:[v.NgIf,$.MatLegacyButton,N.MatLegacyDialogClose,N.MatLegacyDialogTitle,N.MatLegacyDialogContent,N.MatLegacyDialogActions,G.MatIcon,pi,m.TranslatePipe],styles:["[_nghost-%COMP%]{padding:4px 10px;width:834px;max-width:100%;min-width:420px;box-sizing:border-box}[mat-dialog-title][_ngcontent-%COMP%]{display:flex}[mat-dialog-title][_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{width:calc(100% - 20px);display:inline-block;overflow:hidden;text-overflow:ellipsis}.multiselect-dialog-top-panel[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;font-size:14px;font-family:Bpmonline Open Sans,serif;line-height:19px;margin-top:20px;margin-bottom:5px}.multiselect-dialog-top-panel[_ngcontent-%COMP%]   .dialog-filters[_ngcontent-%COMP%]{flex-grow:1}.multiselect-dialog-top-panel[_ngcontent-%COMP%]   .dialog-filters[_ngcontent-%COMP%]   ts-search-input[_ngcontent-%COMP%]{width:max(40%,300px)}.multiselect-dialog-top-panel[_ngcontent-%COMP%]   .select-counter-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center}.multiselect-dialog-top-panel[_ngcontent-%COMP%]   .select-counter-container[_ngcontent-%COMP%]   .counter-label[_ngcontent-%COMP%]{font-size:13px;color:#757575}.multiselect-dialog-top-panel[_ngcontent-%COMP%]   .select-counter-container[_ngcontent-%COMP%]   .counter-value[_ngcontent-%COMP%]{padding-left:3px;font-size:14px;color:#444}[mat-dialog-content][_ngcontent-%COMP%]{overflow:auto!important;max-height:55vh!important;min-height:267px;height:862px}[mat-dialog-content][_ngcontent-%COMP%]   .multiselect-dialog-blank-slate[_ngcontent-%COMP%]{display:flex;justify-content:center;font-size:14px;color:#999;text-align:center}[mat-dialog-actions][_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end}"]})}}var ob=h(75956);function lb(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"a",6),i.\u0275\u0275text(1),i.\u0275\u0275elementEnd()),r&2){const t=e.$implicit,n=i.\u0275\u0275nextContext(2).$implicit,s=i.\u0275\u0275nextContext();i.\u0275\u0275property("routerLink",t),i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(s.formatTextValue(n,s.columnDataSchema.valueType))}}function cb(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"span"),i.\u0275\u0275text(1),i.\u0275\u0275elementEnd()),r&2){const t=i.\u0275\u0275nextContext(2).$implicit,n=i.\u0275\u0275nextContext();i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(n.formatTextValue(t,n.columnDataSchema.valueType))}}function ub(r,e){if(r&1&&(i.\u0275\u0275elementContainerStart(0),i.\u0275\u0275template(1,lb,2,2,"a",5)(2,cb,2,1,"ng-template",null,0,i.\u0275\u0275templateRefExtractor),i.\u0275\u0275elementContainerEnd()),r&2){const t=i.\u0275\u0275reference(3),n=i.\u0275\u0275nextContext(2);i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",n.columnDataSchema.linkGenerator&&n.columnDataSchema.linkGenerator(n.record))("ngIfElse",t)}}function db(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"div",2),i.\u0275\u0275element(1,"span",3),i.\u0275\u0275template(2,ub,4,2,"ng-container",4),i.\u0275\u0275elementEnd()),r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",t.isDisplayedAsText())}}class Ws extends ob.U{getValue(){if(!this.isDisplayedAsText())throw new Dr("Only text columns can be displayed via NamedFolderTableCellComponent.");return super.getValue()}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=i.\u0275\u0275getInheritedFactory(Ws)))(n||Ws)}})()}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:Ws,selectors:[["ts-named-folder-table-cell"]],features:[i.\u0275\u0275InheritDefinitionFeature],decls:1,vars:1,consts:[["elseBlock",""],["class","named-folder-cell-wrapper",4,"ngIf"],[1,"named-folder-cell-wrapper"],[1,"folder-icon"],[4,"ngIf"],[3,"routerLink",4,"ngIf","ngIfElse"],[3,"routerLink"]],template:function(t,n){t&1&&i.\u0275\u0275template(0,db,3,1,"div",1),t&2&&i.\u0275\u0275property("ngIf",!n.isEmpty()&&n.getValue())},dependencies:[v.NgIf,sc.RouterLink],styles:[".named-folder-cell-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center}.named-folder-cell-wrapper[_ngcontent-%COMP%]   .folder-icon[_ngcontent-%COMP%]{display:inline-block;width:16px;height:16px;margin-right:8px;background:url(folder-icon.svg) no-repeat}"]})}}var $s;(function(r){r.All="0",r.Section="1",r.Lookup="2"})($s||($s={}));class ao{constructor(){this.value=$s.All,this.valueChange=new i.EventEmitter}onValueChanged(e){this.value=e.value,this.valueChange.emit(this.value)}static{this.\u0275fac=function(t){return new(t||ao)}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:ao,selectors:[["ts-object-type-filter"]],inputs:{value:"value"},outputs:{valueChange:"valueChange"},decls:22,vars:14,consts:[["typeViewFilter",""],[1,"type-filter"],["disableOptionCentering","true",3,"valueChange","selectionChange","value"],[1,"filter-type-caption"],["value","0",1,"type-mat-option"],[1,"filter-type-icon","filter-type-icon-0"],["value","1",1,"type-mat-option"],[1,"filter-type-icon","filter-type-icon-1"],["value","2",1,"type-mat-option"],[1,"filter-type-icon","filter-type-icon-2"]],template:function(t,n){if(t&1){const s=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"mat-form-field",1)(1,"mat-select",2,0),i.\u0275\u0275twoWayListener("valueChange",function(o){return i.\u0275\u0275restoreView(s),i.\u0275\u0275twoWayBindingSet(n.value,o)||(n.value=o),i.\u0275\u0275resetView(o)}),i.\u0275\u0275listener("selectionChange",function(o){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.onValueChanged(o))}),i.\u0275\u0275elementStart(3,"mat-select-trigger"),i.\u0275\u0275element(4,"span"),i.\u0275\u0275elementStart(5,"span",3),i.\u0275\u0275text(6),i.\u0275\u0275elementEnd()(),i.\u0275\u0275elementStart(7,"mat-option",4),i.\u0275\u0275element(8,"span",5),i.\u0275\u0275elementStart(9,"span"),i.\u0275\u0275text(10),i.\u0275\u0275pipe(11,"translate"),i.\u0275\u0275elementEnd()(),i.\u0275\u0275elementStart(12,"mat-option",6),i.\u0275\u0275element(13,"span",7),i.\u0275\u0275elementStart(14,"span"),i.\u0275\u0275text(15),i.\u0275\u0275pipe(16,"translate"),i.\u0275\u0275elementEnd()(),i.\u0275\u0275elementStart(17,"mat-option",8),i.\u0275\u0275element(18,"span",9),i.\u0275\u0275elementStart(19,"span"),i.\u0275\u0275text(20),i.\u0275\u0275pipe(21,"translate"),i.\u0275\u0275elementEnd()()()()}if(t&2){const s=i.\u0275\u0275reference(2);i.\u0275\u0275advance(),i.\u0275\u0275twoWayProperty("value",n.value),i.\u0275\u0275advance(3),i.\u0275\u0275classMapInterpolate1("filter-type-icon filter-type-icon-",n.value,""),i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(s.triggerValue),i.\u0275\u0275advance(4),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(11,8,"ObjectTypeFilter.AllObjects")),i.\u0275\u0275advance(5),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(16,10,"ObjectTypeFilter.Sections")),i.\u0275\u0275advance(5),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(21,12,"ObjectTypeFilter.Lookups"))}},dependencies:[Yt.MatLegacyOption,ee.MatLegacyFormField,Qe.MatLegacySelect,Qe.MatLegacySelectTrigger,m.TranslatePipe],styles:["[_nghost-%COMP%]{line-height:16px;padding:4px 10px 0 0;min-width:100px}.filter-type-icon[_ngcontent-%COMP%]{width:16px;height:16px;background-repeat:no-repeat;margin-right:6px;display:inline-block}.filter-type-icon.filter-type-icon-0[_ngcontent-%COMP%]{background-image:url(filter_objects.svg)}.filter-type-icon.filter-type-icon-1[_ngcontent-%COMP%]{background-image:url(filter_sections.svg)}.filter-type-icon.filter-type-icon-2[_ngcontent-%COMP%]{background-image:url(filter_lookups.svg)}"]})}}function hb(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"mat-option",14),i.\u0275\u0275text(1),i.\u0275\u0275elementEnd()),r&2){const t=e.$implicit;i.\u0275\u0275property("value",t),i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate1(" ",t.caption," ")}}class oo{constructor(e,t){this.entitySchemaService=e,this.data=t,this.isLoading=!1}_prepareEntityColumns(e){if(!e||!e.success){this.isLoading=!1;return}this.entitySchemaColumns=e.entitySchema.columns,this.entitySchemaColumns.sort((t,n)=>t.caption<n.caption?-1:1),this.data&&this.data.excludeFilter&&(this.entitySchemaColumns=this.entitySchemaColumns.filter(this.data.excludeFilter)),this.isLoading=!1}ngOnInit(){!this.data||!this.data.entitySchemaUId||(this.isLoading=!0,this.entitySchemaService.getEntitySchemaByUId(this.data.entitySchemaUId).subscribe(this._prepareEntityColumns.bind(this)))}onFilteredEntitySchemaColumnSelected(e){const t=e.option.value;this.selectedColumn=t}getEntitySchemaColumnCaption(e){return e&&e.caption}search(e){if(!e){this.filteredEntitySchemaColumns=this.entitySchemaColumns;return}e=e.toLowerCase(),this.filteredEntitySchemaColumns=this.entitySchemaColumns.filter(t=>t.caption.toLowerCase().indexOf(e)!==-1)}static{this.\u0275fac=function(t){return new(t||oo)(i.\u0275\u0275directiveInject(nt),i.\u0275\u0275directiveInject(N.MAT_LEGACY_DIALOG_DATA))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:oo,selectors:[["ts-select-entity-schema-column-dialog"]],decls:22,vars:17,consts:[["auto","matAutocomplete"],["mat-dialog-title",""],["mat-icon-button","",1,"close-dialog",3,"mat-dialog-close"],["svgIcon","close",1,"close-button-icon"],["mat-dialog-actions",""],["mat-flat-button","","color","accent",3,"mat-dialog-close","disabled"],["mat-button","","cdkFocusInitial","",3,"mat-dialog-close"],["mat-dialog-content",""],["floatLabel","never",1,"entity-schema-column"],["type","text","matInput","",3,"input","focus","placeholder","matAutocomplete"],["matSuffix","",1,"mat-select-arrow-wrapper"],[1,"mat-select-arrow"],[3,"optionSelected","displayWith"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,n){if(t&1){const s=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"div",1)(1,"span"),i.\u0275\u0275text(2),i.\u0275\u0275pipe(3,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(4,"button",2),i.\u0275\u0275element(5,"mat-icon",3),i.\u0275\u0275elementEnd()(),i.\u0275\u0275elementStart(6,"div",4)(7,"button",5),i.\u0275\u0275text(8),i.\u0275\u0275pipe(9,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(10,"button",6),i.\u0275\u0275text(11),i.\u0275\u0275pipe(12,"translate"),i.\u0275\u0275elementEnd()(),i.\u0275\u0275elementStart(13,"div",7)(14,"mat-form-field",8)(15,"input",9),i.\u0275\u0275pipe(16,"translate"),i.\u0275\u0275listener("input",function(o){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.search(o.target.value))})("focus",function(){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.search(""))}),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(17,"div",10),i.\u0275\u0275element(18,"div",11),i.\u0275\u0275elementEnd()(),i.\u0275\u0275elementStart(19,"mat-autocomplete",12,0),i.\u0275\u0275listener("optionSelected",function(o){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.onFilteredEntitySchemaColumnSelected(o))}),i.\u0275\u0275template(21,hb,2,2,"mat-option",13),i.\u0275\u0275elementEnd()()}if(t&2){const s=i.\u0275\u0275reference(20);i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(3,9,"SelectEntitySchemaColumnDialog.Title")),i.\u0275\u0275advance(5),i.\u0275\u0275property("mat-dialog-close",n.selectedColumn)("disabled",!n.selectedColumn),i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(9,11,"SelectEntitySchemaColumnDialog.Select")),i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(12,13,"SelectEntitySchemaColumnDialog.Cancel")),i.\u0275\u0275advance(4),i.\u0275\u0275property("placeholder",i.\u0275\u0275pipeBind1(16,15,"SelectEntitySchemaColumnDialog.SelectFieldPlaceholder"))("matAutocomplete",s),i.\u0275\u0275advance(4),i.\u0275\u0275property("displayWith",n.getEntitySchemaColumnCaption),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngForOf",n.filteredEntitySchemaColumns)}},dependencies:[v.NgForOf,qe.MatLegacyAutocomplete,qe.MatLegacyAutocompleteTrigger,Yt.MatLegacyOption,$.MatLegacyButton,N.MatLegacyDialogClose,N.MatLegacyDialogTitle,N.MatLegacyDialogContent,N.MatLegacyDialogActions,ee.MatLegacyFormField,ee.MatLegacySuffix,G.MatIcon,me.MatLegacyInput,m.TranslatePipe],styles:["[_nghost-%COMP%]{padding:4px 10px 0;min-width:420px;min-height:136px}[mat-dialog-actions][_ngcontent-%COMP%]{margin-bottom:23px!important}[mat-dialog-content][_ngcontent-%COMP%]   .field-title[_ngcontent-%COMP%]{font-family:Bpmonline Open Sans,serif;color:#444;font-size:14px;line-height:18px;text-align:left}[mat-dialog-content][_ngcontent-%COMP%]   .entity-schema-column[_ngcontent-%COMP%]{width:100%;line-height:19px;font-size:14px}[mat-dialog-content][_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{font-size:14px;width:100%;line-height:18px!important}"]})}}const pb=["dataViewWrapper"],mb=["tableNgContainer"];function gb(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"div",10),i.\u0275\u0275text(1),i.\u0275\u0275elementEnd()),r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(t.additionalText)}}function fb(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"div",11)(1,"a",12),i.\u0275\u0275text(2),i.\u0275\u0275elementEnd()()),r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275advance(),i.\u0275\u0275property("href",t.helpLinkUrl.url,i.\u0275\u0275sanitizeUrl),i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(t.helpLinkUrl.caption)}}function _b(r,e){if(r&1&&(i.\u0275\u0275elementContainerStart(0),i.\u0275\u0275elementStart(1,"button",13),i.\u0275\u0275text(2),i.\u0275\u0275pipe(3,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(4,"button",14),i.\u0275\u0275text(5),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementContainerEnd()),r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275advance(),i.\u0275\u0275property("mat-dialog-close",!1),i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate1(" ",i.\u0275\u0275pipeBind1(3,4,"TableDialog.Cancel")," "),i.\u0275\u0275advance(2),i.\u0275\u0275property("mat-dialog-close",!0),i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(t.continueButtonCaption)}}function yb(r,e){r&1&&(i.\u0275\u0275elementStart(0,"button",13),i.\u0275\u0275text(1),i.\u0275\u0275pipe(2,"translate"),i.\u0275\u0275elementEnd()),r&2&&(i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate1(" ",i.\u0275\u0275pipeBind1(2,1,"TableDialog.Close")," "))}class lo{constructor(e,t){this.dialogData=e,this.scrollToBottomObserverFactory=t,this.title="",this.sortColumn="",this.additionalText="",this.continueButtonCaption=""}_renderTableComponent(e){var t=this;return(0,f.A)(function*(){yield h.e(1029).then(h.bind(h,61029)).then(n=>{const s=n.TableComponent;t._table=e.createComponent(s).instance,t._table.dataSchema=t.dataSchema,t._table.dataSource=t.tableDataSource,t._table.sortColumn=t.sortColumn,t._table.headerSticky=!0})})()}_initScrollToBottomObserver(){const e=this.dataViewWrapper.nativeElement;this._scrollToBottomObserver=this.scrollToBottomObserverFactory.createObserver(e,this._loadNextData.bind(this))}_loadNextData(){this.tableDataSource&&this.tableDataSource.loadNext()}ngAfterViewInit(){this._initScrollToBottomObserver()}ngOnInit(){var e=this;return(0,f.A)(function*(){!e.dialogData||!e.dialogData.data||(e.tableDataSource=new Wp(e.dialogData.data),e.dataSchema=e.dialogData.dataSchema,e.title=e.dialogData.title||e.title,e.sortColumn=e.dialogData.sortColumn,e.additionalText=e.dialogData.additionalText,e.helpLinkUrl=e.dialogData.helpLinkUrl,e.continueButtonCaption=e.dialogData.continueButtonCaption,yield e._renderTableComponent(e.tableNgContainer))})()}ngOnDestroy(){this._scrollToBottomObserver&&this._scrollToBottomObserver.destroy()}static{this.\u0275fac=function(t){return new(t||lo)(i.\u0275\u0275directiveInject(N.MAT_LEGACY_DIALOG_DATA),i.\u0275\u0275directiveInject(hi))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:lo,selectors:[["ts-table-dialog"]],viewQuery:function(t,n){if(t&1&&(i.\u0275\u0275viewQuery(pb,7),i.\u0275\u0275viewQuery(mb,7,i.ViewContainerRef)),t&2){let s;i.\u0275\u0275queryRefresh(s=i.\u0275\u0275loadQuery())&&(n.dataViewWrapper=s.first),i.\u0275\u0275queryRefresh(s=i.\u0275\u0275loadQuery())&&(n.tableNgContainer=s.first)}},decls:14,vars:5,consts:[["dataViewWrapper",""],["tableNgContainer",""],["withoutContinue",""],["mat-dialog-title",""],[1,"dialog-content-wrapper"],["class","table-dialog-additional-text",4,"ngIf"],["class","table-dialog-help-link-url",4,"ngIf"],["mat-dialog-content","",1,"data-table"],["mat-dialog-actions",""],[4,"ngIf","ngIfElse"],[1,"table-dialog-additional-text"],[1,"table-dialog-help-link-url"],["target","_blank","rel","noopener noreferrer",3,"href"],["mat-flat-button","","color","primary","cdkFocusInitial","",3,"mat-dialog-close"],["mat-button","",3,"mat-dialog-close"]],template:function(t,n){if(t&1&&(i.\u0275\u0275elementStart(0,"div",3)(1,"span"),i.\u0275\u0275text(2),i.\u0275\u0275elementEnd()(),i.\u0275\u0275elementStart(3,"div",4),i.\u0275\u0275template(4,gb,2,1,"div",5)(5,fb,3,2,"div",6),i.\u0275\u0275elementStart(6,"div",7,0),i.\u0275\u0275elementContainer(8,null,1),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(10,"div",8),i.\u0275\u0275template(11,_b,6,6,"ng-container",9)(12,yb,3,3,"ng-template",null,2,i.\u0275\u0275templateRefExtractor),i.\u0275\u0275elementEnd()()),t&2){const s=i.\u0275\u0275reference(13);i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(n.title),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",n.additionalText),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",n.helpLinkUrl),i.\u0275\u0275advance(6),i.\u0275\u0275property("ngIf",n.continueButtonCaption)("ngIfElse",s)}},dependencies:[v.NgIf,$.MatLegacyButton,N.MatLegacyDialogClose,N.MatLegacyDialogTitle,N.MatLegacyDialogContent,N.MatLegacyDialogActions,m.TranslatePipe],styles:[`ts-table-dialog{min-width:850px;max-width:900px;margin:0 8px!important;padding:0}ts-table-dialog .table-dialog-additional-text{margin-bottom:4px;display:inline}ts-table-dialog .table-dialog-help-link-url{display:inline;cursor:pointer}ts-table-dialog .data-table{overflow-y:auto!important;max-height:330px;margin:0;padding:0}ts-table-dialog .data-table table{padding-top:0}ts-table-dialog [mat-dialog-actions]{display:flex;flex-direction:row;justify-content:flex-end;margin:20px 0 10px!important}
`],encapsulation:2})}}function Cb(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"span",7),i.\u0275\u0275text(1),i.\u0275\u0275elementEnd()),r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(t.data.additionalText)}}function bb(r,e){if(r&1&&(i.\u0275\u0275elementContainerStart(0),i.\u0275\u0275elementStart(1,"button",8),i.\u0275\u0275text(2),i.\u0275\u0275pipe(3,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(4,"button",9),i.\u0275\u0275text(5),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementContainerEnd()),r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275advance(),i.\u0275\u0275property("mat-dialog-close",!1),i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(3,4,"ValidationErrorDialogComponent.Cancel")),i.\u0275\u0275advance(2),i.\u0275\u0275property("mat-dialog-close",!0),i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(t.data.continueButtonCaption)}}function Sb(r,e){r&1&&(i.\u0275\u0275elementStart(0,"button",8),i.\u0275\u0275text(1),i.\u0275\u0275pipe(2,"translate"),i.\u0275\u0275elementEnd()),r&2&&(i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(2,1,"ValidationErrorDialogComponent.Close")))}class Ll{constructor(e){this.data=e}static{this.\u0275fac=function(t){return new(t||Ll)(i.\u0275\u0275directiveInject(N.MAT_LEGACY_DIALOG_DATA))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:Ll,selectors:[["ts-validation-error-dialog"]],decls:11,vars:5,consts:[["withoutContinue",""],["mat-dialog-title",""],["mat-dialog-content",""],["class","validation-dialog-additional-text",4,"ngIf"],[1,"validation-dialog-error"],["mat-dialog-actions",""],[4,"ngIf","ngIfElse"],[1,"validation-dialog-additional-text"],["mat-flat-button","","color","primary","cdkFocusInitial","",3,"mat-dialog-close"],["mat-button","",3,"mat-dialog-close"]],template:function(t,n){if(t&1&&(i.\u0275\u0275elementStart(0,"div",1)(1,"span"),i.\u0275\u0275text(2),i.\u0275\u0275elementEnd()(),i.\u0275\u0275elementStart(3,"div",2),i.\u0275\u0275template(4,Cb,2,1,"span",3),i.\u0275\u0275elementStart(5,"span",4),i.\u0275\u0275text(6),i.\u0275\u0275elementEnd()(),i.\u0275\u0275elementStart(7,"div",5),i.\u0275\u0275template(8,bb,6,6,"ng-container",6)(9,Sb,3,3,"ng-template",null,0,i.\u0275\u0275templateRefExtractor),i.\u0275\u0275elementEnd()),t&2){const s=i.\u0275\u0275reference(10);i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(n.data.title),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",n.data.additionalText),i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(n.data.validationError),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",n.data.continueButtonCaption)("ngIfElse",s)}},dependencies:[v.NgIf,$.MatLegacyButton,N.MatLegacyDialogClose,N.MatLegacyDialogTitle,N.MatLegacyDialogContent,N.MatLegacyDialogActions,m.TranslatePipe],styles:[`ts-validation-error-dialog{margin:0!important;padding:0 6px;width:720px}ts-validation-error-dialog [mat-dialog-actions]{float:right}ts-validation-error-dialog [mat-dialog-content] .validation-dialog-error,ts-validation-error-dialog [mat-dialog-content] .validation-dialog-additional-text{white-space:pre-wrap}ts-validation-error-dialog [mat-dialog-content] .validation-dialog-error{font-family:monospace;font-size:13px}
`],encapsulation:2})}}class co{set template(e){this._clearView(),e&&this._renderTemplate(e)}constructor(e,t){this._viewContainer=e,this._injector=t}_clearView(){this._viewContainer.clear()}_renderTemplate(e){const t=i.Injector.create({providers:[],parent:this._injector});this._viewContainer.createEmbeddedView(e,{},{injector:t})}static{this.\u0275fac=function(t){return new(t||co)(i.\u0275\u0275directiveInject(i.ViewContainerRef),i.\u0275\u0275directiveInject(i.Injector))}}static{this.\u0275dir=i.\u0275\u0275defineDirective({type:co,selectors:[["","crtTemplateOutletWithCurrentInjector",""]],inputs:{template:[i.\u0275\u0275InputFlags.None,"crtTemplateOutletWithCurrentInjector","template"]}})}}function Mb(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"mat-option",9),i.\u0275\u0275text(1),i.\u0275\u0275elementEnd()),r&2){const t=e.$implicit,n=i.\u0275\u0275nextContext();i.\u0275\u0275property("value",t),i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate1(" ",n.selectDisplayValue(t)," ")}}class uo{constructor(){this.label="",this.selectedItem=null,this.selectedItemChange=new i.EventEmitter,this.list=[],this.fieldFocus=new i.EventEmitter,this.disabled="false"}_filterList(e){e?this.filteredList=this.list.filter(t=>t.displayValue.toLowerCase().indexOf(e.toLowerCase())>=0):this.filteredList=this.list}ngOnInit(){console.warn('Component "ComboboxEditComponent" is deprecated and will removed in future versions'),this.list$&&this.list$.pipe((0,l.map)(e=>this.list=e)).subscribe()}selectDisplayValue(e){return e&&e.displayValue||""}onOptionSelected(e){const t=e.option.value;this.selectedItem=t,this.selectedItemChange.emit(t)}onFieldInput(e){this._filterList(e.target.value)}onFieldFocus(){this.filteredList=this.list,this.fieldFocus.emit()}onAutocompleteClosed(e){this.list.some(n=>n.displayValue.toLowerCase()===e.toLowerCase())||(this.selectedItem=null,this.selectedItemChange.emit(null),this._filterList(""))}static{this.\u0275fac=function(t){return new(t||uo)}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:uo,selectors:[["ts-combobox-edit"]],inputs:{label:"label",selectedItem:"selectedItem",list$:"list$",disabled:"disabled"},outputs:{selectedItemChange:"selectedItemChange",fieldFocus:"fieldFocus"},decls:11,vars:6,consts:[["input",""],["auto","matAutocomplete"],["floatLabel","always",1,"combobox-edit"],[1,"combobox-edit-search-input"],["type","text","matInput","","spellcheck","false",3,"input","focus","matAutocomplete","value","disabled"],[1,"mat-select-arrow-wrapper"],[1,"mat-select-arrow"],[3,"optionSelected","closed","displayWith"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,n){if(t&1){const s=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"mat-form-field",2)(1,"mat-label"),i.\u0275\u0275text(2),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(3,"div",3)(4,"input",4,0),i.\u0275\u0275listener("input",function(o){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.onFieldInput(o))})("focus",function(){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.onFieldFocus())}),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(6,"div",5),i.\u0275\u0275element(7,"div",6),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(8,"mat-autocomplete",7,1),i.\u0275\u0275listener("optionSelected",function(o){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.onOptionSelected(o))})("closed",function(){i.\u0275\u0275restoreView(s);const o=i.\u0275\u0275reference(5);return i.\u0275\u0275resetView(n.onAutocompleteClosed(o.value))}),i.\u0275\u0275template(10,Mb,2,2,"mat-option",8),i.\u0275\u0275elementEnd()()()}if(t&2){const s=i.\u0275\u0275reference(9);i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(n.label),i.\u0275\u0275advance(2),i.\u0275\u0275property("matAutocomplete",s)("value",n.selectDisplayValue(n.selectedItem))("disabled",n.disabled),i.\u0275\u0275advance(4),i.\u0275\u0275property("displayWith",n.selectDisplayValue),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngForOf",n.filteredList)}},dependencies:[v.NgForOf,qe.MatLegacyAutocomplete,qe.MatLegacyAutocompleteTrigger,Yt.MatLegacyOption,ee.MatLegacyFormField,ee.MatLegacyLabel,me.MatLegacyInput],styles:[".combobox-edit[_ngcontent-%COMP%]{width:100%}.combobox-edit[_ngcontent-%COMP%]   .combobox-edit-search-input[_ngcontent-%COMP%]{width:100%;display:inline-flex;align-items:center}"]})}}var kl=h(11587);const $p=new i.InjectionToken("Represents a set of configuration properties for getting resources");class vb{constructor(e,t,n){this._getResourcesEventName=e,this._setResourcesEventName=t,this._defaultResources=n}get defaultResources(){return this._defaultResources}get getResourcesEventName(){return ue.checkStringIsNotEmpty("getResourcesEventName",this._getResourcesEventName)}get setResourcesEventName(){return ue.checkStringIsNotEmpty("setResourcesEventName",this._setResourcesEventName)}}class bi{constructor(e,t){this._customEventService=e,this._destroyed$=new u.Subject,this._defaultResources=this._getSafeResources(t.defaultResources),this._setResourcesEventName=t.setResourcesEventName,this._getResourcesEventName=t.getResourcesEventName}_getSafeResources(e){return e=e||{},e.localizableStrings=e.localizableStrings||{},e}getResources(){const e=new u.ReplaySubject;return this._customEventService.subscribe(this._setResourcesEventName).pipe((0,l.take)(1),(0,l.map)(t=>this._getSafeResources(t)),(0,l.map)(t=>(0,M.merge)(this._defaultResources,t)),(0,l.takeUntil)(this._destroyed$)).subscribe(t=>{e.next(t),e.complete()}),this._customEventService.createOutboundChannel(this._getResourcesEventName).next({}),e}ngOnDestroy(){this._destroyed$.next(),this._destroyed$.complete()}static{this.\u0275fac=function(t){return new(t||bi)(i.\u0275\u0275inject(T.Dj),i.\u0275\u0275inject($p))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:bi,factory:bi.\u0275fac})}}class Gp{constructor(e,t){this._value=e,this._property=t}get property(){return this._property}get value(){return this._value}canMatchItem(e){if(!e)return!1;const t=e[this.property],n=t!=null,s=typeof t===this._value.constructor.name.toLowerCase();return n&&s}isItemMatch(e){return this.canMatchItem(e)&&this.isValueMatch(e[this.property])}}class pd extends Gp{static{this.DEFAULT_PROPERTY="caption"}constructor(e,t){super(e,t||pd.DEFAULT_PROPERTY)}isValueMatch(e){const t=e.toLowerCase(),n=this.value.toLowerCase(),s=(0,M.compact)(t.split(" "));return(0,M.compact)(n.split(" ")).every(o=>s.find(c=>c.includes(o)))}}class Ib extends Gp{isValueMatch(e){return e===this.value}}class ho{_isFilterNotFalsy(e){return e&&e.value!==null&&e.value!==void 0}transform(e,t){if(!e)return[];if(!t)return e;let n=[...e];return t.filter(this._isFilterNotFalsy).forEach(a=>{n=n.filter(o=>a.isItemMatch(o))}),n}static{this.\u0275fac=function(t){return new(t||ho)}}static{this.\u0275pipe=i.\u0275\u0275definePipe({name:"filter",type:ho,pure:!0})}}function wb(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"button",10),i.\u0275\u0275listener("click",function(){i.\u0275\u0275restoreView(t);const s=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(s.filteringValue="")}),i.\u0275\u0275element(1,"mat-icon",11),i.\u0275\u0275pipe(2,"async"),i.\u0275\u0275elementEnd()}if(r&2){let t;const n=i.\u0275\u0275nextContext();i.\u0275\u0275advance(),i.\u0275\u0275property("title",(t=i.\u0275\u0275pipeBind1(2,1,n.localizableStrings$))==null?null:t.ClearButtonTitle)}}function Eb(r,e){r&1&&i.\u0275\u0275element(0,"mat-icon",12)}function xb(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"mat-list-item",16),i.\u0275\u0275listener("click",function(){const s=i.\u0275\u0275restoreView(t).$implicit,a=i.\u0275\u0275nextContext(3);return i.\u0275\u0275resetView(a.onItemSelected(s))}),i.\u0275\u0275elementStart(1,"button",17),i.\u0275\u0275pipe(2,"async"),i.\u0275\u0275pipe(3,"async"),i.\u0275\u0275listener("click",function(s){const a=i.\u0275\u0275restoreView(t).$implicit,o=i.\u0275\u0275nextContext(3);return i.\u0275\u0275resetView(o.toggleFavorite(a,s))}),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(4,"div",18),i.\u0275\u0275text(5),i.\u0275\u0275elementEnd()()}if(r&2){let t;const n=e.$implicit,s=i.\u0275\u0275nextContext(3);i.\u0275\u0275classProp("active",n.isActive),i.\u0275\u0275attribute("data-qa",n.caption),i.\u0275\u0275advance(),i.\u0275\u0275property("ngClass",n.isFavorite?s.favoriteCssClass:s.regularCssClass)("title",n.isFavorite?(t=i.\u0275\u0275pipeBind1(2,6,s.localizableStrings$))==null?null:t.RemoveFromFavoriteButtonTitle:(t=i.\u0275\u0275pipeBind1(3,8,s.localizableStrings$))==null?null:t.AddToFavoriteButtonTitle),i.\u0275\u0275advance(4),i.\u0275\u0275textInterpolate1(" ",n.caption," ")}}function Tb(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"div",14),i.\u0275\u0275template(1,xb,6,10,"mat-list-item",15),i.\u0275\u0275elementEnd()),r&2){const t=i.\u0275\u0275nextContext().ngIf;i.\u0275\u0275advance(),i.\u0275\u0275property("ngForOf",t)}}function Ab(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"div",19),i.\u0275\u0275element(1,"div",20),i.\u0275\u0275elementStart(2,"div",21),i.\u0275\u0275text(3),i.\u0275\u0275pipe(4,"async"),i.\u0275\u0275elementEnd()()),r&2){let t;const n=i.\u0275\u0275nextContext(2);i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate1(" ",(t=i.\u0275\u0275pipeBind1(4,1,n.localizableStrings$))==null?null:t.NoDataPlaceholder," ")}}function Db(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"mat-action-list"),i.\u0275\u0275template(1,Tb,2,1,"div",13)(2,Ab,5,3,"ng-template",null,1,i.\u0275\u0275templateRefExtractor),i.\u0275\u0275elementEnd()),r&2){const t=e.ngIf,n=i.\u0275\u0275reference(3);i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",t.length>0)("ngIfElse",n)}}let Nn=class _d extends ze{constructor(e,t,n){super(n),this._resourcesService=e,this._changeDetector=t,this._filters=[],this.regularCssClass="regular",this.favoriteCssClass="favorite",this.filteringValue="",this.displayOnlyFavorites=!1,this.items=[],this.itemSelected=new i.EventEmitter,this.favoriteStateChanged=new i.EventEmitter}get _searchFilter(){return new pd(this.filteringValue)}get _favoritesFilter(){return new Ib(this.displayOnlyFavorites,"isFavorite")}get filters(){return this._filters=[this._searchFilter],this.displayOnlyFavorites&&this._filters.push(this._favoritesFilter),this._filters}get localizableStrings$(){return this._resources$.pipe((0,l.map)(e=>e.localizableStrings))}ngOnInit(){this._resources$=this._resourcesService.getResources()}onItemSelected(e){const t={id:e.id};this.itemSelected.emit(t)}toggleFavorite(e,t){t.stopPropagation();const{id:n,isFavorite:s}=e,a={id:n,isFavorite:!s};this.favoriteStateChanged.emit(a)}onFilteringValueChanged(e){this.filteringValue=e,this._changeDetector.detectChanges()}toggleDisplayOnlyFavorites(){this.displayOnlyFavorites=!this.displayOnlyFavorites,this._changeDetector.detectChanges()}static{this.\u0275fac=function(t){return new(t||_d)(i.\u0275\u0275directiveInject(bi),i.\u0275\u0275directiveInject(i.ChangeDetectorRef),i.\u0275\u0275directiveInject(i.Injector))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:_d,selectors:[["ts-filterable-list"]],inputs:{items:"items"},outputs:{itemSelected:"itemSelected",favoriteStateChanged:"favoriteStateChanged"},features:[i.\u0275\u0275InheritDefinitionFeature],decls:14,vars:17,consts:[["searchIcon",""],["noData",""],[1,"filterable-list-container",3,"ngStyle","ngClass"],[1,"filter-input-container"],[1,"display-only-favorites-button-container"],["mat-icon-button","","data-qa","filter-favorite-btn",3,"click","ngClass","title"],["floatLabel","never"],["matInput","","type","text","spellcheck","false","autocomplete","off","data-qa","search-input",3,"input","value","placeholder"],["matSuffix","","mat-icon-button","","aria-label","Clear","data-qa","clear-filter-btn",3,"click",4,"ngIf","ngIfElse"],[4,"ngIf"],["matSuffix","","mat-icon-button","","aria-label","Clear","data-qa","clear-filter-btn",3,"click"],["matSuffix","",1,"clear-icon",3,"title"],["matSuffix","",1,"search-icon"],["class","items-list",4,"ngIf","ngIfElse"],[1,"items-list"],["disableRipple","",3,"active","click",4,"ngFor","ngForOf"],["disableRipple","",3,"click"],["mat-icon-button","","data-qa","favorite-btn",3,"click","ngClass","title"],[1,"item-caption"],["data-qa","blank-slate",1,"blank-slate"],["data-qa","blank-slate-icon",1,"icon"],["data-qa","blank-slate-label",1,"label"]],template:function(t,n){if(t&1){const s=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"div",2)(1,"div")(2,"div",3)(3,"div",4)(4,"button",5),i.\u0275\u0275pipe(5,"async"),i.\u0275\u0275listener("click",function(){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.toggleDisplayOnlyFavorites())}),i.\u0275\u0275elementEnd()(),i.\u0275\u0275elementStart(6,"mat-form-field",6)(7,"input",7),i.\u0275\u0275pipe(8,"async"),i.\u0275\u0275listener("input",function(o){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.onFilteringValueChanged(o.target.value))}),i.\u0275\u0275elementEnd(),i.\u0275\u0275template(9,wb,3,3,"button",8)(10,Eb,1,0,"ng-template",null,0,i.\u0275\u0275templateRefExtractor),i.\u0275\u0275elementEnd()()(),i.\u0275\u0275template(12,Db,4,2,"mat-action-list",9),i.\u0275\u0275pipe(13,"filter"),i.\u0275\u0275elementEnd()}if(t&2){let s,a;const o=i.\u0275\u0275reference(11);i.\u0275\u0275property("ngStyle",n.styles)("ngClass",n.classes),i.\u0275\u0275attribute("id",n.id),i.\u0275\u0275advance(4),i.\u0275\u0275property("ngClass",n.displayOnlyFavorites?n.favoriteCssClass:n.regularCssClass)("title",(s=i.\u0275\u0275pipeBind1(5,10,n.localizableStrings$))==null?null:s.FilterFavoriteTitle),i.\u0275\u0275advance(3),i.\u0275\u0275property("value",n.filteringValue)("placeholder",(a=i.\u0275\u0275pipeBind1(8,12,n.localizableStrings$))==null?null:a.SearchPlaceholder),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",n.filteringValue)("ngIfElse",o),i.\u0275\u0275advance(3),i.\u0275\u0275property("ngIf",i.\u0275\u0275pipeBind2(13,14,n.items,n.filters))}},dependencies:[v.NgClass,v.NgForOf,v.NgIf,v.NgStyle,ee.MatLegacyFormField,ee.MatLegacySuffix,G.MatIcon,me.MatLegacyInput,kl.MatActionList,kl.MatListItem,$.MatLegacyButton,v.AsyncPipe,ho],styles:[`.filterable-list-container{display:flex;flex-direction:column;height:100%;min-height:inherit;max-height:inherit}.filterable-list-container .display-only-favorites-button-container .mat-icon-button{height:32px;width:32px}.filterable-list-container .items-list{margin-top:8px}.filterable-list-container .blank-slate{display:flex;flex-direction:column;align-items:center}.filterable-list-container .blank-slate .label{color:#757575;font-size:12px;font-family:Open Sans,Regular,sans-serif;margin-top:16px}.filterable-list-container .blank-slate .icon{width:100px;height:104px;margin-top:24px;background:no-repeat url(data:image/svg+xml;base64,PHN2ZyBpZD0iaWNvbl9zZWFyY2hfYmlnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAiIGhlaWdodD0iMTA0IiB2aWV3Qm94PSIwIDAgMTAwIDEwNCI+DQogIDxnIGlkPSJQYXRoXzc0NTciIGRhdGEtbmFtZT0iUGF0aCA3NDU3IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTcxNC44MTggLTY0OS41MTIpIiBmaWxsPSJyZ2JhKDEwMCwxODQsMjIzLDAuMSkiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCI+DQogICAgPHBhdGggZD0iTSAxNzE4LjYwMTY4NDU3MDMxMyA3NTIuNTA1ODU5Mzc1IEMgMTcyMS41NjE2NDU1MDc4MTMgNzUwLjM3MDQyMjM2MzI4MTMgMTcyNC4zMTk3MDIxNDg0MzggNzQ3LjEzMzIzOTc0NjA5MzggMTcyNi44MzQ1OTQ3MjY1NjMgNzQyLjgzNTgxNTQyOTY4NzUgQyAxNzI5LjQyMTI2NDY0ODQzOCA3MzguNDE1NTg4Mzc4OTA2MyAxNzMwLjc1NTM3MTA5Mzc1IDczNC41MjIwMzM2OTE0MDYzIDE3MzAuODEwOTEzMDg1OTM4IDczNC4zNTgzOTg0Mzc1IEwgMTczMS4wMDY1OTE3OTY4NzUgNzMzLjc4MTkyMTM4NjcxODggTCAxNzMwLjU4NDM1MDU4NTkzOCA3MzMuMzQzMzIyNzUzOTA2MyBDIDE3MjYuMjg1NTIyNDYwOTM4IDcyOC44NzkzMzM0OTYwOTM4IDE3MjIuOTE0MzA2NjQwNjI1IDcyMy43MTg5MzMxMDU0Njg4IDE3MjAuNTY0MzMxMDU0Njg4IDcxOC4wMDUzNzEwOTM3NSBDIDE3MTguMTI5NTE2NjAxNTYzIDcxMi4wODU1NzEyODkwNjI1IDE3MTYuODk1MDE5NTMxMjUgNzA1LjgwNzY3ODIyMjY1NjMgMTcxNi44OTUwMTk1MzEyNSA2OTkuMzQ2MDA4MzAwNzgxMyBDIDE3MTYuODk1MDE5NTMxMjUgNjkyLjc1MTk1MzEyNSAxNzE4LjE3NjUxMzY3MTg3NSA2ODYuMzU1NzczOTI1NzgxMyAxNzIwLjcwMzczNTM1MTU2MyA2ODAuMzM1MjY2MTEzMjgxMyBDIDE3MjMuMTQ0ODk3NDYwOTM4IDY3NC41MTk5NTg0OTYwOTM4IDE3MjYuNjM5NzcwNTA3ODEzIDY2OS4yOTczMDIyNDYwOTM4IDE3MzEuMDkxMTg2NTIzNDM4IDY2NC44MTIzMTY4OTQ1MzEzIEMgMTczNS41NDIxMTQyNTc4MTMgNjYwLjMyNzgxOTgyNDIxODggMTc0MC43MjQ4NTM1MTU2MjUgNjU2LjgwNzEyODkwNjI1IDE3NDYuNDk1MzYxMzI4MTI1IDY1NC4zNDgwODM0OTYwOTM4IEMgMTc1Mi40Njg3NSA2NTEuODAyNjczMzM5ODQzOCAxNzU4LjgxNDY5NzI2NTYyNSA2NTAuNTEyMDIzOTI1NzgxMyAxNzY1LjM1NzA1NTY2NDA2MyA2NTAuNTEyMDIzOTI1NzgxMyBDIDE3NzEuODk5MTY5OTIxODc1IDY1MC41MTIwMjM5MjU3ODEzIDE3NzguMjQ0ODczMDQ2ODc1IDY1MS44MDI2NzMzMzk4NDM4IDE3ODQuMjE4MjYxNzE4NzUgNjU0LjM0ODA4MzQ5NjA5MzggQyAxNzg5Ljk4ODc2OTUzMTI1IDY1Ni44MDcxMjg5MDYyNSAxNzk1LjE3MTUwODc4OTA2MyA2NjAuMzI3ODE5ODI0MjE4OCAxNzk5LjYyMjU1ODU5Mzc1IDY2NC44MTIzMTY4OTQ1MzEzIEMgMTgwNC4wNzM5NzQ2MDkzNzUgNjY5LjI5NzM2MzI4MTI1IDE4MDcuNTY4ODQ3NjU2MjUgNjc0LjUyMDAxOTUzMTI1IDE4MTAuMDEwMTMxODM1OTM4IDY4MC4zMzUyNjYxMTMyODEzIEMgMTgxMi41Mzc0NzU1ODU5MzggNjg2LjM1NTgzNDk2MDkzNzUgMTgxMy44MTg5Njk3MjY1NjMgNjkyLjc1MTk1MzEyNSAxODEzLjgxODk2OTcyNjU2MyA2OTkuMzQ2MDA4MzAwNzgxMyBDIDE4MTMuODE4OTY5NzI2NTYzIDcwNS45Mzk4MTkzMzU5Mzc1IDE4MTIuNTM3NDc1NTg1OTM4IDcxMi4zMzU3NTQzOTQ1MzEzIDE4MTAuMDEwMTMxODM1OTM4IDcxOC4zNTYxNDAxMzY3MTg4IEMgMTgwNy41Njg4NDc2NTYyNSA3MjQuMTcxMjY0NjQ4NDM3NSAxODA0LjA3Mzk3NDYwOTM3NSA3MjkuMzkzODU5ODYzMjgxMyAxNzk5LjYyMjU1ODU5Mzc1IDczMy44Nzg3ODQxNzk2ODc1IEMgMTc5NS4xNzE1MDg3ODkwNjMgNzM4LjM2MzI4MTI1IDE3ODkuOTg4NzY5NTMxMjUgNzQxLjg4MzkxMTEzMjgxMjUgMTc4NC4yMTgyNjE3MTg3NSA3NDQuMzQyOTU2NTQyOTY4OCBDIDE3NzguMjQ0ODczMDQ2ODc1IDc0Ni44ODgzNjY2OTkyMTg4IDE3NzEuODk5MDQ3ODUxNTYzIDc0OC4xNzkwMTYxMTMyODEzIDE3NjUuMzU3MDU1NjY0MDYzIDc0OC4xNzkwMTYxMTMyODEzIEMgMTc1OS42MDc1NDM5NDUzMTMgNzQ4LjE3OTAxNjExMzI4MTMgMTc1My45Nzk4NTgzOTg0MzggNzQ3LjE3MzUyMjk0OTIxODggMTc0OC42MzA2MTUyMzQzNzUgNzQ1LjE5MDM2ODY1MjM0MzggTCAxNzQ4LjA3MDQzNDU3MDMxMyA3NDQuOTgyNjY2MDE1NjI1IEwgMTc0Ny42MjIwNzAzMTI1IDc0NS4zNzc1MDI0NDE0MDYzIEMgMTc0Ny4yODQ3OTAwMzkwNjMgNzQ1LjY3NDQ5OTUxMTcxODggMTc0Ni45NDcxNDM1NTQ2ODggNzQ1LjkyMTgxMzk2NDg0MzggMTc0Ni41NTkzMjYxNzE4NzUgNzQ2LjE1NTgyMjc1MzkwNjMgQyAxNzM3LjA4NTQ0OTIxODc1IDc1MS44ODMxNzg3MTA5Mzc1IDE3MjkuNjYxNzQzMTY0MDYzIDc1Mi40NDk4MjkxMDE1NjI1IDE3MTguNjAxNjg0NTcwMzEzIDc1Mi41MDU4NTkzNzUgWiIgc3Ryb2tlPSJub25lIi8+DQogICAgPHBhdGggZD0iTSAxNzY1LjM1NzA1NTY2NDA2MyA2NTEuNTEyMDIzOTI1NzgxMyBDIDE3NTguOTUwMTk1MzEyNSA2NTEuNTEyMDIzOTI1NzgxMyAxNzUyLjczNjIwNjA1NDY4OCA2NTIuNzc1NzU2ODM1OTM3NSAxNzQ2Ljg4NzQ1MTE3MTg3NSA2NTUuMjY4MDY2NDA2MjUgQyAxNzQxLjIzNjIwNjA1NDY4OCA2NTcuNjc2MjA4NDk2MDkzOCAxNzM2LjE2MDQwMDM5MDYyNSA2NjEuMTI0Mzg5NjQ4NDM3NSAxNzMxLjgwMDkwMzMyMDMxMyA2NjUuNTE2Nzg0NjY3OTY4OCBDIDE3MjcuNDQwNDI5Njg3NSA2NjkuOTEwMTU2MjUgMTcyNC4wMTY5Njc3NzM0MzggNjc1LjAyNjA2MjAxMTcxODggMTcyMS42MjU4NTQ0OTIxODggNjgwLjcyMjI5MDAzOTA2MjUgQyAxNzE5LjE1MDI2ODU1NDY4OCA2ODYuNjE5NjI4OTA2MjUgMTcxNy44OTUwMTk1MzEyNSA2OTIuODg1NTU5MDgyMDMxMyAxNzE3Ljg5NTAxOTUzMTI1IDY5OS4zNDYwMDgzMDA3ODEzIEMgMTcxNy44OTUwMTk1MzEyNSA3MDUuNjc2NTEzNjcxODc1IDE3MTkuMTA0MjQ4MDQ2ODc1IDcxMS44MjY0NzcwNTA3ODEzIDE3MjEuNDg5MTM1NzQyMTg4IDcxNy42MjUgQyAxNzIzLjc5MTAxNTYyNSA3MjMuMjIxNjc5Njg3NSAxNzI3LjA5MzM4Mzc4OTA2MyA3MjguMjc2NjcyMzYzMjgxMyAxNzMxLjMwNDU2NTQyOTY4OCA3MzIuNjQ5NjU4MjAzMTI1IEwgMTczMi4xNDkyOTE5OTIxODggNzMzLjUyNjc5NDQzMzU5MzggTCAxNzMxLjc1NzgxMjUgNzM0LjY3OTg3MDYwNTQ2ODggQyAxNzMxLjU3OTIyMzYzMjgxMyA3MzUuMjA2MDU0Njg3NSAxNzI4LjEyNDc1NTg1OTM3NSA3NDUuMTg4OTY0ODQzNzUgMTcyMS4zOTczMzg4NjcxODggNzUxLjQ3NjY4NDU3MDMxMjUgQyAxNzI1LjExMzY0NzQ2MDkzOCA3NTEuNDEyNTk3NjU2MjUgMTcyOC40MDk1NDU4OTg0MzggNzUxLjIzMjIzODc2OTUzMTMgMTczMS41NzE0MTExMzI4MTMgNzUwLjcyNDc5MjQ4MDQ2ODggQyAxNzM2Ljc0NzMxNDQ1MzEyNSA3NDkuODk0MTA0MDAzOTA2MyAxNzQxLjIwOTk2MDkzNzUgNzQ4LjIyMTE5MTQwNjI1IDE3NDYuMDQyNjAyNTM5MDYzIDc0NS4yOTk2ODI2MTcxODc1IEMgMTc0Ni4zNzgwNTE3NTc4MTMgNzQ1LjA5NzI5MDAzOTA2MjUgMTc0Ni42Njk5MjE4NzUgNzQ0Ljg4MzU0NDkyMTg3NSAxNzQ2Ljk2MTA1OTU3MDMxMyA3NDQuNjI3MDc1MTk1MzEyNSBMIDE3NDcuODU3Nzg4MDg1OTM4IDc0My44MzczNDEzMDg1OTM4IEwgMTc0OC45NzgxNDk0MTQwNjMgNzQ0LjI1MjY4NTU0Njg3NSBDIDE3NTQuMjE1ODIwMzEyNSA3NDYuMTk0NDU4MDA3ODEyNSAxNzU5LjcyNjU2MjUgNzQ3LjE3OTAxNjExMzI4MTMgMTc2NS4zNTcwNTU2NjQwNjMgNzQ3LjE3OTAxNjExMzI4MTMgQyAxNzcxLjc2MzY3MTg3NSA3NDcuMTc5MDE2MTEzMjgxMyAxNzc3Ljk3NzUzOTA2MjUgNzQ1LjkxNTI4MzIwMzEyNSAxNzgzLjgyNjE3MTg3NSA3NDMuNDIyOTczNjMyODEyNSBDIDE3ODkuNDc3Mjk0OTIxODc1IDc0MS4wMTQ4MzE1NDI5Njg4IDE3OTQuNTUzMjIyNjU2MjUgNzM3LjU2NjcxMTQyNTc4MTMgMTc5OC45MTI3MTk3MjY1NjMgNzMzLjE3NDMxNjQwNjI1IEMgMTgwMy4yNzMzMTU0Mjk2ODggNzI4Ljc4MTAwNTg1OTM3NSAxODA2LjY5Njc3NzM0Mzc1IDcyMy42NjUyMjIxNjc5Njg4IDE4MDkuMDg4MDEyNjk1MzEzIDcxNy45NjkxMTYyMTA5Mzc1IEMgMTgxMS41NjM3MjA3MDMxMjUgNzEyLjA3MTg5OTQxNDA2MjUgMTgxMi44MTg5Njk3MjY1NjMgNzA1LjgwNjE1MjM0Mzc1IDE4MTIuODE4OTY5NzI2NTYzIDY5OS4zNDYwMDgzMDA3ODEzIEMgMTgxMi44MTg5Njk3MjY1NjMgNjkyLjg4NTU1OTA4MjAzMTMgMTgxMS41NjM3MjA3MDMxMjUgNjg2LjYxOTY4OTk0MTQwNjMgMTgwOS4wODgwMTI2OTUzMTMgNjgwLjcyMjI5MDAzOTA2MjUgQyAxODA2LjY5Njc3NzM0Mzc1IDY3NS4wMjYxMjMwNDY4NzUgMTgwMy4yNzMzMTU0Mjk2ODggNjY5LjkxMDIxNzI4NTE1NjMgMTc5OC45MTI3MTk3MjY1NjMgNjY1LjUxNjc4NDY2Nzk2ODggQyAxNzk0LjU1MzIyMjY1NjI1IDY2MS4xMjQzODk2NDg0Mzc1IDE3ODkuNDc3Mjk0OTIxODc1IDY1Ny42NzYyMDg0OTYwOTM4IDE3ODMuODI2MTcxODc1IDY1NS4yNjgwNjY0MDYyNSBDIDE3NzcuOTc3NTM5MDYyNSA2NTIuNzc1NzU2ODM1OTM3NSAxNzcxLjc2MzY3MTg3NSA2NTEuNTEyMDIzOTI1NzgxMyAxNzY1LjM1NzA1NTY2NDA2MyA2NTEuNTEyMDIzOTI1NzgxMyBNIDE3NjUuMzU3MDU1NjY0MDYzIDY0OS41MTIwMjM5MjU3ODEzIEMgMTc5Mi42NzUwNDg4MjgxMjUgNjQ5LjUxMjAyMzkyNTc4MTMgMTgxNC44MTg5Njk3MjY1NjMgNjcxLjgyMjk5ODA0Njg3NSAxODE0LjgxODk2OTcyNjU2MyA2OTkuMzQ2MDA4MzAwNzgxMyBDIDE4MTQuODE4OTY5NzI2NTYzIDcyNi44Njc5ODA5NTcwMzEzIDE3OTIuNjc1MDQ4ODI4MTI1IDc0OS4xNzkwMTYxMTMyODEzIDE3NjUuMzU3MDU1NjY0MDYzIDc0OS4xNzkwMTYxMTMyODEzIEMgMTc1OS4zNTQ5ODA0Njg3NSA3NDkuMTc5MDE2MTEzMjgxMyAxNzUzLjYwNDk4MDQ2ODc1IDc0OC4xMDEwMTMxODM1OTM4IDE3NDguMjgyOTU4OTg0Mzc1IDc0Ni4xMjc5OTA3MjI2NTYzIEMgMTc0Ny45NDc5OTgwNDY4NzUgNzQ2LjQyMjk3MzYzMjgxMjUgMTc0Ny41NjQ5NDE0MDYyNSA3NDYuNzE2OTc5OTgwNDY4OCAxNzQ3LjA3NjA0OTgwNDY4OCA3NDcuMDEyMDIzOTI1NzgxMyBDIDE3MzYuMzIzOTc0NjA5Mzc1IDc1My41MTIwMjM5MjU3ODEzIDE3MjguMDc5OTU2MDU0Njg4IDc1My41MTIwMjM5MjU3ODEzIDE3MTQuODE4OTY5NzI2NTYzIDc1My41MTIwMjM5MjU3ODEzIEMgMTcyNC41ODg5ODkyNTc4MTMgNzQ5LjM5Njk3MjY1NjI1IDE3MjkuNzc0MDQ3ODUxNTYzIDczNC4zMDIwMDE5NTMxMjUgMTcyOS44NjQwMTM2NzE4NzUgNzM0LjAzNjk4NzMwNDY4NzUgQyAxNzIxLjIyMzk5OTAyMzQzOCA3MjUuMDY1MDAyNDQxNDA2MyAxNzE1Ljg5NTAxOTUzMTI1IDcxMi44MzU5OTg1MzUxNTYzIDE3MTUuODk1MDE5NTMxMjUgNjk5LjM0NjAwODMwMDc4MTMgQyAxNzE1Ljg5NTAxOTUzMTI1IDY3MS44MjI5OTgwNDY4NzUgMTczOC4wMzc5NjM4NjcxODggNjQ5LjUxMjAyMzkyNTc4MTMgMTc2NS4zNTcwNTU2NjQwNjMgNjQ5LjUxMjAyMzkyNTc4MTMgWiIgc3Ryb2tlPSJub25lIiBmaWxsPSIjNjRiOGRmIi8+DQogIDwvZz4NCiAgPGcgaWQ9Ikdyb3VwXzc3NjAiIGRhdGEtbmFtZT0iR3JvdXAgNzc2MCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTE3MTQuODE4IC02NDkuNTEyKSI+DQogICAgPGNpcmNsZSBpZD0iRWxsaXBzZV8xMzM2IiBkYXRhLW5hbWU9IkVsbGlwc2UgMTMzNiIgY3g9IjEyLjI1IiBjeT0iMTIuMjUiIHI9IjEyLjI1IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNzQ4LjA2OSA2ODIuMDQyKSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjNjRiOGRmIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHN0cm9rZS13aWR0aD0iMiIvPg0KICAgIDxsaW5lIGlkPSJMaW5lXzUxMyIgZGF0YS1uYW1lPSJMaW5lIDUxMyIgeDE9IjEyLjQ2MyIgeTE9IjEyLjQ2MyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTc2OS4xMDYgNzAyLjgyOSkiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzY0YjhkZiIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBzdHJva2Utd2lkdGg9IjIiLz4NCiAgPC9nPg0KPC9zdmc+DQo=);background-position:center}.filterable-list-container .mat-icon-button{background-color:transparent}.filterable-list-container .mat-icon-button.favorite{background:no-repeat url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2Ij48ZGVmcz48c3R5bGU+LmF7ZmlsbDojZmZiNzRkO30uYntmaWxsOm5vbmU7fTwvc3R5bGU+PC9kZWZzPjxwYXRoIGNsYXNzPSJhIiBkPSJNOC41LDEuMWwyLjMsNC42NjcsNS4yLjcxLTMuNywzLjY1Mi44LDQuOTcxTDguNSwxMi43NjcsMy45LDE1LjFsLjktNC45NzFMMSw2LjQ3N2w1LjItLjcxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMSAtMC4xKSIvPjxyZWN0IGNsYXNzPSJiIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiLz48L3N2Zz4=);background-position:center}.filterable-list-container .mat-icon-button.regular{background:no-repeat url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2Ij48ZGVmcz48c3R5bGU+LmF7ZmlsbDojZGJkYmRiO30uYntmaWxsOm5vbmU7fTwvc3R5bGU+PC9kZWZzPjxwYXRoIGNsYXNzPSJhIiBkPSJNOC41LDMuMyw5LjksNi4ybC4yLjUuNS4xLDMuMi40TDExLjYsOS40bC0uNC40LjEuNS41LDMuMUw5LDExLjhsLS41LS4yLS41LjJMNS4yLDEzLjJsLjYtMywuMS0uNS0uNC0uNEwzLjIsNy4xbDMuMS0uNC41LS4xTDcsNi4xLDguNSwzLjNNOC41LDEsNi4yLDUuNywxLDYuNCw0LjgsMTBsLS45LDUsNC42LTIuM0wxMy4xLDE1bC0uOC01TDE2LDYuNGwtNS4yLS43WiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEpIi8+PHJlY3QgY2xhc3M9ImIiIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIvPjwvc3ZnPg==);background-position:center}.filterable-list-container .mat-icon-button.regular:hover{background:no-repeat url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2Ij4NCjxkZWZzPiA8c3R5bGU+LmF7ZmlsbDojZmZiNzRkO30uYntmaWxsOm5vbmU7fTwvc3R5bGU+PC9kZWZzPg0KPHBhdGggY2xhc3M9ImEiIGQ9Ik04LjUsMy4zLDkuOSw2LjJsLjIuNS41LjEsMy4yLjRMMTEuNiw5LjRsLS40LjQuMS41LjUsMy4xTDksMTEuOGwtLjUtLjItLjUuMkw1LjIsMTMuMmwuNi0zLC4xLS41LS40LS40TDMuMiw3LjFsMy4xLS40LjUtLjFMNyw2LjEsOC41LDMuM004LjUsMSw2LjIsNS43LDEsNi40LDQuOCwxMGwtLjksNSw0LjYtMi4zTDEzLjEsMTVsLS44LTVMMTYsNi40bC01LjItLjdaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMSkiLz4NCjxyZWN0IGNsYXNzPSJiIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiLz48L3N2Zz4=);background-position:center}.filter-input-container{display:flex;flex-direction:row;margin-right:10px;padding-left:6px}.filter-input-container .mat-form-field{font-size:13px;width:100%}.filter-input-container .mat-form-field input{font-family:Open Sans,Regular,sans-serif;color:#444}.filter-input-container .mat-form-field .mat-input-element{vertical-align:middle}.filter-input-container .mat-form-field .mat-form-field-ripple{top:1px;height:1px;background:#006ce0}.filter-input-container .mat-form-field .mat-form-field-underline{border-bottom:1px #c8c8c8 solid;background-color:transparent;margin-top:3px}.filter-input-container .mat-form-field .mat-form-field-wrapper{padding-top:5px;margin-bottom:-1.25em}.filter-input-container .mat-form-field .mat-form-field-empty.mat-form-field-label{padding-top:2px;color:#999}.filter-input-container .mat-form-field .mat-form-field-infix{border-top:none}.filter-input-container .mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button,.filter-input-container .mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon{width:18px;height:18px;margin-right:8px}.filter-input-container .mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon{color:#999;vertical-align:middle}.filter-input-container .mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon.search-icon{background:no-repeat url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMTYgMTYiPjxnIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzgwOTViMyIgc3Ryb2tlLXdpZHRoPSIxLjIiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCI+PGNpcmNsZSBjeD0iNiIgY3k9IjYiIHI9IjQuNSIvPjxwYXRoIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgZD0iTSA5LjQsOS40IDE0LDE0Ii8+PC9nPjwvc3ZnPg==)}.filter-input-container .mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon.clear-icon{background:no-repeat url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2Ij4NCiAgPGcgaWQ9Ikdyb3VwXzIzNTUiIGRhdGEtbmFtZT0iR3JvdXAgMjM1NSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTk0MyAtMjEzNCkiPg0KICAgIDxsaW5lIGlkPSJMaW5lXzE0NiIgZGF0YS1uYW1lPSJMaW5lIDE0NiIgeTE9IjEwIiB4Mj0iMTAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDk0Ni41IDIxMzcuNSkiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzc1NzU3NSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBzdHJva2Utd2lkdGg9IjEiLz4NCiAgICA8bGluZSBpZD0iTGluZV8xNDciIGRhdGEtbmFtZT0iTGluZSAxNDciIHgyPSIxMCIgeTI9IjEwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg5NDYuNSAyMTM3LjUpIiBmaWxsPSJub25lIiBzdHJva2U9IiM3NTc1NzUiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLXdpZHRoPSIxIi8+DQogICAgPHJlY3QgaWQ9IlJlY3RhbmdsZV8xMDkyIiBkYXRhLW5hbWU9IlJlY3RhbmdsZSAxMDkyIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDk0MyAyMTM0KSIgZmlsbD0ibm9uZSIvPg0KICA8L2c+DQo8L3N2Zz4NCg==)}.mdc-list.mat-mdc-list-base.mat-mdc-action-list{padding-top:0;overflow:auto}.mdc-list.mat-mdc-list-base.mat-mdc-action-list::-webkit-scrollbar{width:4px}.mdc-list.mat-mdc-list-base.mat-mdc-action-list::-webkit-scrollbar-track{background:transparent;border:4px solid transparent;background-clip:content-box}.mdc-list.mat-mdc-list-base.mat-mdc-action-list::-webkit-scrollbar-thumb{background:#999;border-radius:4px}.mdc-list.mat-mdc-list-base.mat-mdc-action-list .mat-mdc-list-item{font-size:13px;font-family:Open Sans,Regular,sans-serif;color:#444;height:33px;padding-left:6px;box-sizing:border-box}.mdc-list.mat-mdc-list-base.mat-mdc-action-list .mat-mdc-list-item.active{background-color:#e5ebfb}.mdc-list.mat-mdc-list-base.mat-mdc-action-list .mat-mdc-list-item:hover{background:#f2f5ff}.mdc-list.mat-mdc-list-base.mat-mdc-action-list .mat-mdc-list-item .mdc-list-item__content .mat-mdc-list-item-unscoped-content{display:flex;flex-direction:row;padding-left:8px}.mdc-list.mat-mdc-list-base.mat-mdc-action-list .mat-mdc-list-item .mdc-list-item__content .mat-mdc-list-item-unscoped-content .mat-icon-button{height:16px;width:16px}.mdc-list.mat-mdc-list-base.mat-mdc-action-list .mat-mdc-list-item .mdc-list-item__content .mat-mdc-list-item-unscoped-content .item-caption{padding-left:8px;display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
`],encapsulation:3})}};(0,y.__decorate)([re(),(0,y.__metadata)("design:type",Array)],Nn.prototype,"items",void 0),(0,y.__decorate)([Ol(),(0,y.__metadata)("design:type",i.EventEmitter)],Nn.prototype,"itemSelected",void 0),(0,y.__decorate)([Ol(),(0,y.__metadata)("design:type",i.EventEmitter)],Nn.prototype,"favoriteStateChanged",void 0),Nn=(0,y.__decorate)([gi({type:"crt.FilterableList",reuseStrategy:Ht.Reuse}),(0,y.__metadata)("design:paramtypes",[bi,i.ChangeDetectorRef,i.Injector])],Nn);class Gs{static{this.\u0275fac=function(t){return new(t||Gs)}}static{this.\u0275mod=i.\u0275\u0275defineNgModule({type:Gs})}static{this.\u0275inj=i.\u0275\u0275defineInjector({providers:[T.Dj,bi,{provide:$p,useValue:new vb("getFilterableListResources","setFilterableListResources",{localizableStrings:{NoDataPlaceholder:"No data",SearchPlaceholder:"Search",FilterFavoriteTitle:"Only favorites",RemoveFromFavoriteButtonTitle:"Remove from favorites",AddToFavoriteButtonTitle:"Add to favorites",ClearButtonTitle:"Cancel"}})}],imports:[v.CommonModule,Z.FormsModule,ee.MatLegacyFormFieldModule,G.MatIconModule,me.MatLegacyInputModule,kl.MatListModule,$.MatLegacyButtonModule]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&i.\u0275\u0275setNgModuleScope(Gs,{declarations:[Nn,ho],imports:[v.CommonModule,Z.FormsModule,ee.MatLegacyFormFieldModule,G.MatIconModule,me.MatLegacyInputModule,kl.MatListModule,$.MatLegacyButtonModule],exports:[Nn]})})();function Nb(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"div",1),i.\u0275\u0275element(1,"mat-icon",2),i.\u0275\u0275elementEnd()),r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275advance(),i.\u0275\u0275property("svgIcon",t.iconName)}}class dM extends dd{constructor(e,t){super(e),this.cellComponentClass=Zs,this.iconName=t}}class Zs extends To.X{get iconName(){return this.columnDataSchema.iconName.length?this.columnDataSchema.iconName:this.getValue()}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=i.\u0275\u0275getInheritedFactory(Zs)))(n||Zs)}})()}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:Zs,selectors:[["ts-icon-table-cell"]],features:[i.\u0275\u0275InheritDefinitionFeature],decls:1,vars:1,consts:[["class","drag-drop-icon-wrapper","cdkDragHandle","",4,"ngIf"],["cdkDragHandle","",1,"drag-drop-icon-wrapper"],[3,"svgIcon"]],template:function(t,n){t&1&&i.\u0275\u0275template(0,Nb,2,1,"div",0),t&2&&i.\u0275\u0275property("ngIf",!n.isEmpty())},dependencies:[v.NgIf,G.MatIcon]})}}function Pb(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"mat-form-field",1)(1,"mat-label"),i.\u0275\u0275text(2),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(3,"input",2),i.\u0275\u0275listener("keydown.enter",function(s){i.\u0275\u0275restoreView(t);const a=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(a.onEnterKeyDown(s))}),i.\u0275\u0275elementEnd()()}if(r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275property("ngStyle",t.styles)("ngClass",t.classes),i.\u0275\u0275attribute("id",t.id),i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(t.caption),i.\u0275\u0275advance(),i.\u0275\u0275property("formControl",t.value)("value",t.value==null?null:t.value.value)}}let Pn=class Jl extends ze{constructor(){super(...arguments),this.enterKeyDown=new i.EventEmitter}onEnterKeyDown(e){this.enterKeyDown.next(e)}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=i.\u0275\u0275getInheritedFactory(Jl)))(n||Jl)}})()}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:Jl,selectors:[["ts-input"]],inputs:{caption:"caption",value:"value"},outputs:{enterKeyDown:"enterKeyDown"},features:[i.\u0275\u0275InheritDefinitionFeature],decls:1,vars:1,consts:[["class","full-width ts-input","appearance","fill",3,"ngStyle","ngClass",4,"ngIf"],["appearance","fill",1,"full-width","ts-input",3,"ngStyle","ngClass"],["matInput","","autocomplete","off",3,"keydown.enter","formControl","value"]],template:function(t,n){t&1&&i.\u0275\u0275template(0,Pb,4,6,"mat-form-field",0),t&2&&i.\u0275\u0275property("ngIf",n.value)},dependencies:[v.NgClass,v.NgIf,v.NgStyle,Z.DefaultValueAccessor,Z.NgControlStatus,ee.MatLegacyFormField,ee.MatLegacyLabel,me.MatLegacyInput,Z.FormControlDirective],encapsulation:2})}};(0,y.__decorate)([re(),(0,y.__metadata)("design:type",String)],Pn.prototype,"caption",void 0),(0,y.__decorate)([re(),(0,y.__metadata)("design:type",Z.FormControl)],Pn.prototype,"value",void 0),(0,y.__decorate)([Ol(),(0,y.__metadata)("design:type",Object)],Pn.prototype,"enterKeyDown",void 0),Pn=(0,y.__decorate)([gi({type:"crt.DeprecatedInput",formControlConfig:{relatesTo:"value"},reuseStrategy:Ht.Reuse})],Pn);let Ys=class Ql extends ze{static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=i.\u0275\u0275getInheritedFactory(Ql)))(n||Ql)}})()}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:Ql,selectors:[["ts-label"]],inputs:{label:"label"},features:[i.\u0275\u0275InheritDefinitionFeature],decls:3,vars:4,consts:[[1,"ts-label",3,"ngStyle","ngClass"]],template:function(t,n){t&1&&(i.\u0275\u0275elementStart(0,"div",0)(1,"label"),i.\u0275\u0275text(2),i.\u0275\u0275elementEnd()()),t&2&&(i.\u0275\u0275property("ngStyle",n.styles)("ngClass",n.classes),i.\u0275\u0275attribute("id",n.id),i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate(n.label))},dependencies:[v.NgClass,v.NgStyle],encapsulation:2})}};(0,y.__decorate)([re(),(0,y.__metadata)("design:type",String)],Ys.prototype,"label",void 0),Ys=(0,y.__decorate)([gi({type:"crt.DeprecatedLabel",reuseStrategy:Ht.Reuse})],Ys);class Wt{static{this.\u0275fac=function(t){return new(t||Wt)}}static{this.\u0275mod=i.\u0275\u0275defineNgModule({type:Wt})}static{this.\u0275inj=i.\u0275\u0275defineInjector({providers:[Vs],imports:[v.CommonModule,Nl.MatLegacyRadioModule,Z.FormsModule,$.MatLegacyButtonModule,Ge.MatLegacyCheckboxModule,N.MatLegacyDialogModule,Mt.MatDividerModule,ee.MatLegacyFormFieldModule,G.MatIconModule,me.MatLegacyInputModule,m.TranslateModule]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&i.\u0275\u0275setNgModuleScope(Wt,{declarations:[pi,qa],imports:[v.CommonModule,Nl.MatLegacyRadioModule,Z.FormsModule,$.MatLegacyButtonModule,Ge.MatLegacyCheckboxModule,N.MatLegacyDialogModule,Mt.MatDividerModule,ee.MatLegacyFormFieldModule,G.MatIconModule,me.MatLegacyInputModule,m.TranslateModule],exports:[pi]})})();const Rb=["*"],Ob=r=>({show:r});function Vb(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"crt-expansion-button",2),i.\u0275\u0275listener("toggle",function(){i.\u0275\u0275restoreView(t);const s=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(s.onToggle())}),i.\u0275\u0275elementEnd()}if(r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275property("direction",t.panelConfig==null?null:t.panelConfig.direction)("animationDisabled",t.panelConfig==null?null:t.panelConfig.animationDisabled)("isExpanded",t.isExpanded)}}class po{constructor(){this.isExpanded=!1,this.toggle=new i.EventEmitter}onToggle(){this.toggle.emit()}static{this.\u0275fac=function(t){return new(t||po)}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:po,selectors:[["ts-vertical-expansion-panel"]],inputs:{isExpanded:"isExpanded",panelConfig:"panelConfig"},outputs:{toggle:"toggle"},ngContentSelectors:Rb,decls:4,vars:7,consts:[["class","expansion-button",3,"direction","animationDisabled","isExpanded","toggle",4,"ngIf"],[1,"panel",3,"ngClass"],[1,"expansion-button",3,"toggle","direction","animationDisabled","isExpanded"]],template:function(t,n){t&1&&(i.\u0275\u0275projectionDef(),i.\u0275\u0275elementStart(0,"div"),i.\u0275\u0275template(1,Vb,1,3,"crt-expansion-button",0),i.\u0275\u0275elementStart(2,"div",1),i.\u0275\u0275projection(3),i.\u0275\u0275elementEnd()()),t&2&&(i.\u0275\u0275classMapInterpolate1("container button-placement-",n.panelConfig==null?null:n.panelConfig.direction,""),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",n.panelConfig==null?null:n.panelConfig.showToggleButton),i.\u0275\u0275advance(),i.\u0275\u0275property("ngClass",i.\u0275\u0275pureFunction1(5,Ob,n.isExpanded)))},dependencies:[v.NgClass,v.NgIf,Fs],styles:[".container[_ngcontent-%COMP%]{position:relative;height:100%}.expansion-button[_ngcontent-%COMP%]{position:absolute;z-index:3}.button-placement-left[_ngcontent-%COMP%]   .expansion-button[_ngcontent-%COMP%]{right:calc(100% + 10px)}.button-placement-right[_ngcontent-%COMP%]   .expansion-button[_ngcontent-%COMP%]{left:100%}.panel[_ngcontent-%COMP%]{display:none}.panel.show[_ngcontent-%COMP%]{display:flex;height:100%}"],changeDetection:0})}}const Lb=["default-file-icon","file-excel","file-image","file-pdf","file-powerpoint","file-word"];var Zp=h(49391),Si=h(84177),Yp=h(80203),Kp=h(17499);function kb(r,e){if(r&1&&i.\u0275\u0275element(0,"mat-icon",9),r&2){const t=e.$implicit;i.\u0275\u0275property("svgIcon",t)}}function jb(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"span",10),i.\u0275\u0275text(1),i.\u0275\u0275elementEnd()),r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate(t.getTriggerCaption())}}function Fb(r,e){if(r&1&&i.\u0275\u0275element(0,"mat-icon",14),r&2){const t=i.\u0275\u0275nextContext(2);i.\u0275\u0275property("svgIcon",t.config.emptyOption==null?null:t.config.emptyOption.svgIconName)}}function Bb(r,e){r&1&&i.\u0275\u0275element(0,"div",16)}function Ub(r,e){if(r&1&&i.\u0275\u0275template(0,Bb,1,0,"div",15),r&2){const t=i.\u0275\u0275nextContext(2);i.\u0275\u0275property("ngIf",t.needDisplayOptionIcons())}}function zb(r,e){r&1&&i.\u0275\u0275element(0,"mat-divider")}function Hb(r,e){if(r&1&&(i.\u0275\u0275elementContainerStart(0),i.\u0275\u0275elementStart(1,"mat-option",11)(2,"div",12),i.\u0275\u0275template(3,Fb,1,1,"mat-icon",13)(4,Ub,1,1,"ng-template",null,0,i.\u0275\u0275templateRefExtractor),i.\u0275\u0275elementStart(6,"span"),i.\u0275\u0275text(7),i.\u0275\u0275elementEnd()()(),i.\u0275\u0275template(8,zb,1,0,"mat-divider",7),i.\u0275\u0275elementContainerEnd()),r&2){const t=i.\u0275\u0275reference(5),n=i.\u0275\u0275nextContext();i.\u0275\u0275advance(),i.\u0275\u0275styleProp("display",n.config.emptyOption?"":"none"),i.\u0275\u0275property("value",n.emptyValue),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",n.config.emptyOption==null?null:n.config.emptyOption.svgIconName)("ngIfElse",t),i.\u0275\u0275advance(4),i.\u0275\u0275textInterpolate(n.config.emptyOption==null?null:n.config.emptyOption.caption),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",n.config.emptyOption)}}function Wb(r,e){if(r&1&&i.\u0275\u0275element(0,"mat-icon",14),r&2){const t=i.\u0275\u0275nextContext().$implicit;i.\u0275\u0275property("svgIcon",t.svgIconName)}}function $b(r,e){r&1&&i.\u0275\u0275element(0,"div",16)}function Gb(r,e){if(r&1&&i.\u0275\u0275template(0,$b,1,0,"div",15),r&2){const t=i.\u0275\u0275nextContext(2);i.\u0275\u0275property("ngIf",t.needDisplayOptionIcons())}}function Zb(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"mat-option",17)(1,"div",12),i.\u0275\u0275template(2,Wb,1,1,"mat-icon",13)(3,Gb,1,1,"ng-template",null,1,i.\u0275\u0275templateRefExtractor),i.\u0275\u0275elementStart(5,"span"),i.\u0275\u0275text(6),i.\u0275\u0275elementEnd()()()),r&2){const t=e.$implicit,n=i.\u0275\u0275reference(4);i.\u0275\u0275property("value",t.value),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",t.svgIconName)("ngIfElse",n),i.\u0275\u0275advance(4),i.\u0275\u0275textInterpolate(t.caption)}}class mo{constructor(){this._panelClass=[],this.emptyValue={},this.innerValue=this.emptyValue,this.valueChange=new i.EventEmitter,this.disabled=!1}set config(e){this._config=e,this._validateConfig()}get config(){return this._config}set value(e){this.innerValue=e??this.emptyValue}get value(){return this.isEmptyValueSelected()?null:this.innerValue}set panelClass(e){e?.length>0&&(this._panelClass=[...e])}get panelClass(){return[...this._panelClass,"select-menu-panel"]}_validateValue(){if(this.isEmptyValueSelected()||this._getSelectedOption())return;const e=this.value,t=typeof e=="object"?JSON.stringify(e):e;throw new Error(`Value "${t}" is not specified in select menu configuration.`)}_validateConfig(){if(!this.config?.options)throw new Error(`Property "config" must be specified and contain valid options. Actual config is "${JSON.stringify(this.config)}".`)}_resetToFirstOptionIfNeeded(){this.config&&this.config.options.length>0&&!this.config.placeholder&&this.isEmptyValueSelected()&&(this.value=this.config.options[0].value,setTimeout(()=>{this.emitValueChange()},0))}_getSelectedOption(){const e=this.innerValue;return this.config.options.find(t=>t.value===e)}ngDoCheck(){this._validateValue(),this._resetToFirstOptionIfNeeded()}emitValueChange(){this.valueChange.emit(this.value)}trackByValue(e,t){return t.value}getTriggerCaption(){return this.isEmptyValueSelected()?this.config.placeholder?.caption:this._getSelectedOption().caption}getTriggerSvgIconName(){const e=this.config.placeholder?.svgIconName??this.config.emptyOption?.svgIconName;return this.isEmptyValueSelected()?e:this._getSelectedOption()?.svgIconName??e}isEmptyValueSelected(){return this.innerValue===this.emptyValue}needDisplayOptionIcons(){return!!this.config.emptyOption?.svgIconName||this.config.options.some(e=>e.svgIconName)}needDisplaySelectedCaption(){return this._config.hideSelectedCaption!==!0}static{this.\u0275fac=function(t){return new(t||mo)}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:mo,selectors:[["ts-select-menu"]],inputs:{config:"config",value:"value",disabled:"disabled",panelClass:"panelClass"},outputs:{valueChange:"valueChange"},decls:8,vars:9,consts:[["emptyOptionIconPlaceholder",""],["optionIconPlaceholder",""],["floatLabel","never"],["disableOptionCentering","",3,"valueChange","selectionChange","value","disabled","matTooltip","panelClass"],[1,"select-menu-trigger"],["class","select-menu-trigger-icon",3,"svgIcon",4,"ngIf"],["class","select-menu-trigger-caption",4,"ngIf"],[4,"ngIf"],["class","select-menu-option",3,"value",4,"ngFor","ngForOf","ngForTrackBy"],[1,"select-menu-trigger-icon",3,"svgIcon"],[1,"select-menu-trigger-caption"],[1,"select-menu-option","select-menu-empty-option",3,"value"],[1,"select-menu-option-content"],[3,"svgIcon",4,"ngIf","ngIfElse"],[3,"svgIcon"],["class","select-menu-option-icon-placeholder",4,"ngIf"],[1,"select-menu-option-icon-placeholder"],[1,"select-menu-option",3,"value"]],template:function(t,n){t&1&&(i.\u0275\u0275elementStart(0,"mat-form-field",2)(1,"mat-select",3),i.\u0275\u0275twoWayListener("valueChange",function(a){return i.\u0275\u0275twoWayBindingSet(n.innerValue,a)||(n.innerValue=a),a}),i.\u0275\u0275listener("selectionChange",function(){return n.emitValueChange()}),i.\u0275\u0275elementStart(2,"mat-select-trigger")(3,"span",4),i.\u0275\u0275template(4,kb,1,1,"mat-icon",5)(5,jb,2,1,"span",6),i.\u0275\u0275elementEnd()(),i.\u0275\u0275template(6,Hb,9,7,"ng-container",7)(7,Zb,7,4,"mat-option",8),i.\u0275\u0275elementEnd()()),t&2&&(i.\u0275\u0275advance(),i.\u0275\u0275twoWayProperty("value",n.innerValue),i.\u0275\u0275property("disabled",n.disabled)("matTooltip",n.needDisplaySelectedCaption()?null:n.getTriggerCaption())("panelClass",n.panelClass),i.\u0275\u0275advance(3),i.\u0275\u0275property("ngIf",n.getTriggerSvgIconName()),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",n.needDisplaySelectedCaption()),i.\u0275\u0275advance(),i.\u0275\u0275property("ngIf",n.config.placeholder),i.\u0275\u0275advance(),i.\u0275\u0275property("ngForOf",n.config.options)("ngForTrackBy",n.trackByValue))},dependencies:[v.NgForOf,v.NgIf,ee.MatLegacyFormField,Mt.MatDivider,G.MatIcon,Yt.MatLegacyOption,Qe.MatLegacySelect,Qe.MatLegacySelectTrigger,ct.MatTooltip],styles:[`ts-select-menu .mat-form-field-type-mat-select .mat-form-field-wrapper{padding-bottom:0!important}ts-select-menu .mat-form-field-type-mat-select .mat-form-field-wrapper .mat-form-field-infix{width:auto;padding:0!important}ts-select-menu .mat-form-field-type-mat-select .mat-form-field-wrapper .mat-form-field-infix mat-select{width:auto;height:26px;display:flex;align-items:center;border-radius:2px}ts-select-menu .mat-form-field-type-mat-select .mat-form-field-wrapper .mat-form-field-infix mat-select:not(.mat-select-disabled):focus,ts-select-menu .mat-form-field-type-mat-select .mat-form-field-wrapper .mat-form-field-infix mat-select:not(.mat-select-disabled):hover{background-color:#f2f5ff}ts-select-menu .mat-form-field-type-mat-select .mat-form-field-wrapper .mat-form-field-infix mat-select .mat-select-trigger{padding:0 4px 0 8px}ts-select-menu .mat-form-field-type-mat-select .mat-form-field-wrapper .mat-form-field-infix mat-select .mat-select-trigger .mat-select-value{max-width:100%;width:auto;color:#444;font-size:14px}ts-select-menu .mat-form-field-type-mat-select .mat-form-field-wrapper .mat-form-field-infix mat-select .mat-select-trigger .mat-select-value .select-menu-trigger{display:flex;align-items:center;height:18px;line-height:18px;position:relative}ts-select-menu .mat-form-field-type-mat-select .mat-form-field-wrapper .mat-form-field-infix mat-select .mat-select-trigger .mat-select-value .select-menu-trigger .select-menu-trigger-icon{height:16px;width:16px;margin:0 8px 0 0!important}ts-select-menu .mat-form-field-type-mat-select .mat-form-field-wrapper .mat-form-field-infix mat-select .mat-select-trigger .mat-select-value .select-menu-trigger .select-menu-trigger-caption{position:relative;bottom:1px}ts-select-menu .mat-form-field-type-mat-select .mat-form-field-wrapper .mat-form-field-underline{display:none}.mat-select-panel.select-menu-panel{max-height:500px!important;position:absolute;top:22px;left:15px;padding:1px}.mat-select-panel.select-menu-panel mat-option.select-menu-option{padding:0 18px;height:33px!important;line-height:33px!important}.mat-select-panel.select-menu-panel mat-option.select-menu-option.select-menu-empty-option{margin-top:4px}.mat-select-panel.select-menu-panel mat-option.select-menu-option.select-menu-empty-option.select-menu-empty-option-hidden{display:none}.mat-select-panel.select-menu-panel mat-option.select-menu-option .select-menu-option-content{display:flex;align-items:center;font-size:14px;line-height:18px;padding-right:15px}.mat-select-panel.select-menu-panel mat-option.select-menu-option mat-icon,.mat-select-panel.select-menu-panel mat-option.select-menu-option .select-menu-option-icon-placeholder{height:16px;width:16px;margin:0 8px 0 0!important}.mat-select-panel.select-menu-panel mat-divider{margin:5px 12px}
`],encapsulation:2})}}class Ks{static{this.\u0275fac=function(t){return new(t||Ks)}}static{this.\u0275mod=i.\u0275\u0275defineNgModule({type:Ks})}static{this.\u0275inj=i.\u0275\u0275defineInjector({imports:[v.CommonModule,ee.MatLegacyFormFieldModule,Mt.MatDividerModule,G.MatIconModule,Yt.MatLegacyOptionModule,Qe.MatLegacySelectModule,ct.MatTooltipModule]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&i.\u0275\u0275setNgModuleScope(Ks,{declarations:[mo],imports:[v.CommonModule,ee.MatLegacyFormFieldModule,Mt.MatDividerModule,G.MatIconModule,Yt.MatLegacyOptionModule,Qe.MatLegacySelectModule,ct.MatTooltipModule],exports:[mo]})})();const Yb="a29a3ba5-4b0d-de11-9a51-005056c00008",Kb="720b771c-e7a7-4f31-9cfb-52cd21c3739f";var Be;(function(r){r[r.Organization=0]="Organization",r[r.Division=1]="Division",r[r.Manager=2]="Manager",r[r.Team=3]="Team",r[r.User=4]="User",r[r.SelfServicePortalUser=5]="SelfServicePortalUser",r[r.FunctionalRole=6]="FunctionalRole",r[r.TechnicalUser=7]="TechnicalUser"})(Be||(Be={}));class hM{}class qs{constructor(e){this.httpClient=e,this.serviceEndpoint="ServiceModel/RightManagementService.svc/"}saveAdministratedObject(e){const t=this.serviceEndpoint+"SaveAdministratedObject";return this.httpClient.post(t,{administratedObject:e})}getAdministratedObject(e){const t=this.serviceEndpoint+"GetAdministratedObject";return this.httpClient.post(t,{schemaUId:e})}getAdministratedObjects(e){let t;switch(e){case $s.Section:t="GetSectionObjects";break;case $s.Lookup:t="GetLookupObjects";break;case $s.All:default:t="GetAllObjects";break}const n=this.serviceEndpoint+t;return this.httpClient.post(n,null)}getSysAdminUnitList(){if(!this._getSysAdminUnitList$){const e=this.serviceEndpoint+"GetSysAdminUnitList";this._getSysAdminUnitList$=this.httpClient.post(e,null).pipe((0,l.shareReplay)(1)),this._getSysAdminUnitList$.subscribe()}return this._getSysAdminUnitList$}getSysAdminUnitById(e){const t=this.serviceEndpoint+"GetSysAdminUnitById";return this.httpClient.post(t,{sysAdminUnitId:e})}static{this.\u0275fac=function(t){return new(t||qs)(i.\u0275\u0275inject(P.HttpClient))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:qs,factory:qs.\u0275fac})}}const qb=["treeScrollWrapper"],qp=r=>({selected:r});function Jb(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"mat-tree-node",5),i.\u0275\u0275listener("click",function(){const s=i.\u0275\u0275restoreView(t).$implicit,a=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(a.onNodeClick(s))}),i.\u0275\u0275element(1,"div",6),i.\u0275\u0275text(2),i.\u0275\u0275elementEnd()}if(r&2){const t=e.$implicit,n=i.\u0275\u0275nextContext();i.\u0275\u0275property("ngClass",i.\u0275\u0275pureFunction1(2,qp,n.isSelectedNode(t))),i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate1(" ",t.name," ")}}function Qb(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"mat-tree-node",5),i.\u0275\u0275listener("click",function(){const s=i.\u0275\u0275restoreView(t).$implicit,a=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(a.onNodeClick(s))}),i.\u0275\u0275element(1,"div",7),i.\u0275\u0275text(2),i.\u0275\u0275elementEnd()}if(r&2){const t=e.$implicit,n=i.\u0275\u0275nextContext();i.\u0275\u0275property("ngClass",i.\u0275\u0275pureFunction1(4,qp,n.isSelectedNode(t))),i.\u0275\u0275advance(),i.\u0275\u0275property("ngClass",n.treeControl.isExpanded(t)?"minus":"plus"),i.\u0275\u0275attribute("aria-label","toggle "+t.name),i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate1(" ",t.name," ")}}class Xb extends Cd.FlatTreeControl{expandParents(e){const t=this.getLevel(e);if(t<1)return;const n=this.dataNodes.indexOf(e)-1;for(let s=n;s>=0;s--){const a=this.dataNodes[s];if(this.getLevel(a)<t){if(this.getDescendants(a).indexOf(e)===-1)continue;if(this.expand(a),this.getLevel(a)===0)break}}}}class go{constructor(){this.selectedUnitChange=new i.EventEmitter,this.treeControl=new Xb(e=>e.level,e=>e.expandable),this.treeFlattener=new Ae.MatTreeFlattener(this._transformNodeToFlatNode,e=>e.level,e=>e.expandable,e=>e.children),this.treeDataSource=new Ae.MatTreeFlatDataSource(this.treeControl,this.treeFlattener)}set dataSource(e){this._dataSource!==e&&(this._dataSource=e,this._initTreeDataSource(),this._expandToSysAdminUnit(this.selectedUnit))}set selectedUnit(e){this._selectedUnit!==e&&(this._selectedUnit=e,this._expandToSysAdminUnit(e))}get selectedUnit(){return this._selectedUnit}_createNode(e){return{id:e.id,name:e.name,children:[]}}_transformNodeToFlatNode(e,t){return{id:e.id,name:e.name,expandable:!!(e.children&&e.children.length>0),level:t}}_createTreeDataFromFlatList(e){const t=[],n=[],s=e.map((a,o)=>(n[a.id]=o,this._createNode(a)),this);return e.forEach(a=>{const o=s[n[a.id]];if((0,le.gZ)(a.parentRoleId)||a.sysAdminUnitTypeValue===Be.User)t.push(o);else{const c=s[n[a.parentRoleId]];if(!c)return;c.children.push(o)}}),t}_initTreeDataSource(){if(!Array.isArray(this._dataSource)){this.treeDataSource=null;return}this.treeDataSource.data=this._createTreeDataFromFlatList(this._dataSource)}_expandToSysAdminUnit(e){if(!e||!this.treeControl.dataNodes)return;const t=this.treeControl.dataNodes.find(n=>n.id===e.id);t&&(this.treeControl.expandParents(t),setTimeout(()=>this._scrollToItem(e),0))}_scrollToItem(e){const t=this._dataSource.findIndex(a=>a.id===e.id),n=this.treeScrollWrapper.nativeElement,s=n.scrollHeight/this._dataSource.length;n.scrollTop=t*s}hasChildren(e,t){return t.expandable}onNodeClick(e){const t=this._dataSource.find(n=>n.id===e.id);this._selectedUnit=t,this.selectedUnitChange.emit(t)}isSelectedNode(e){return!!(this.selectedUnit&&this.selectedUnit.id===e.id)}static{this.\u0275fac=function(t){return new(t||go)}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:go,selectors:[["ts-sysadminunit-tree"]],viewQuery:function(t,n){if(t&1&&i.\u0275\u0275viewQuery(qb,7),t&2){let s;i.\u0275\u0275queryRefresh(s=i.\u0275\u0275loadQuery())&&(n.treeScrollWrapper=s.first)}},inputs:{dataSource:"dataSource",selectedUnit:"selectedUnit"},outputs:{selectedUnitChange:"selectedUnitChange"},decls:5,vars:3,consts:[["treeScrollWrapper",""],[1,"tree-wrapper"],[3,"dataSource","treeControl"],["matTreeNodePadding","","matTreeNodePaddingIndent","27",3,"ngClass","click",4,"matTreeNodeDef"],["matTreeNodePadding","","matTreeNodePaddingIndent","27",3,"ngClass","click",4,"matTreeNodeDef","matTreeNodeDefWhen"],["matTreeNodePadding","","matTreeNodePaddingIndent","27",3,"click","ngClass"],[1,"toggle-icon"],["matTreeNodeToggle","",1,"toggle-icon",3,"ngClass"]],template:function(t,n){t&1&&(i.\u0275\u0275elementStart(0,"div",1,0)(2,"mat-tree",2),i.\u0275\u0275template(3,Jb,3,4,"mat-tree-node",3)(4,Qb,3,6,"mat-tree-node",4),i.\u0275\u0275elementEnd()()),t&2&&(i.\u0275\u0275advance(2),i.\u0275\u0275property("dataSource",n.treeDataSource)("treeControl",n.treeControl),i.\u0275\u0275advance(2),i.\u0275\u0275property("matTreeNodeDefWhen",n.hasChildren))},dependencies:[v.NgClass,Ae.MatTreeNodeDef,Ae.MatTreeNodePadding,Ae.MatTreeNodeToggle,Ae.MatTree,Ae.MatTreeNode],styles:[".tree-wrapper[_ngcontent-%COMP%]{padding-top:15px;display:block;overflow:auto;max-height:313px}.tree-wrapper[_ngcontent-%COMP%]   .mat-tree-node[_ngcontent-%COMP%]{color:#444;line-height:19px;max-height:30px;min-height:30px;white-space:nowrap}.tree-wrapper[_ngcontent-%COMP%]   .mat-tree-node.selected[_ngcontent-%COMP%]{background-color:#f2f5ff}.tree-wrapper[_ngcontent-%COMP%]   .mat-tree-node[_ngcontent-%COMP%]   .toggle-icon[_ngcontent-%COMP%]{width:16px;height:16px;margin-right:14px;margin-top:2px}.tree-wrapper[_ngcontent-%COMP%]   .mat-tree-node[_ngcontent-%COMP%]   .plus[_ngcontent-%COMP%]{background:url(plus.svg) no-repeat;cursor:pointer}.tree-wrapper[_ngcontent-%COMP%]   .mat-tree-node[_ngcontent-%COMP%]   .minus[_ngcontent-%COMP%]{background:url(minus.svg) no-repeat;cursor:pointer}"]})}}const eS=["usersListContainer"],tS=(r,e)=>({"mat-optgroup-label":r,"selectable-item":e}),nS=r=>({selected:r});function iS(r,e){r&1&&i.\u0275\u0275element(0,"ts-mask")}function sS(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"mat-option",22),i.\u0275\u0275text(1),i.\u0275\u0275elementEnd()),r&2){const t=e.$implicit;i.\u0275\u0275property("value",t.sysAdminUnit)("ngClass",i.\u0275\u0275pureFunction2(4,tS,!t.sysAdminUnit,t.sysAdminUnit))("disabled",!t.sysAdminUnit),i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate((t.sysAdminUnit==null?null:t.sysAdminUnit.name)||t.groupName)}}function rS(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"cdk-virtual-scroll-viewport",20),i.\u0275\u0275template(1,sS,2,7,"mat-option",21),i.\u0275\u0275elementEnd()),r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275styleProp("height",t.calculateSearchResultContainerHeight()),i.\u0275\u0275advance(),i.\u0275\u0275property("cdkVirtualForOf",t.filteredSysAdminUnits)}}function aS(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"ts-sysadminunit-tree",23),i.\u0275\u0275twoWayListener("selectedUnitChange",function(s){i.\u0275\u0275restoreView(t);const a=i.\u0275\u0275nextContext();return i.\u0275\u0275twoWayBindingSet(a.selectedUnit,s)||(a.selectedUnit=s),i.\u0275\u0275resetView(s)}),i.\u0275\u0275listener("dblclick",function(){i.\u0275\u0275restoreView(t);const s=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(s.onTreeDoubleClick())}),i.\u0275\u0275elementEnd()}if(r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275property("dataSource",t.dataSource),i.\u0275\u0275twoWayProperty("selectedUnit",t.selectedUnit)}}function oS(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"ts-sysadminunit-tree",23),i.\u0275\u0275twoWayListener("selectedUnitChange",function(s){i.\u0275\u0275restoreView(t);const a=i.\u0275\u0275nextContext();return i.\u0275\u0275twoWayBindingSet(a.selectedUnit,s)||(a.selectedUnit=s),i.\u0275\u0275resetView(s)}),i.\u0275\u0275listener("dblclick",function(){i.\u0275\u0275restoreView(t);const s=i.\u0275\u0275nextContext();return i.\u0275\u0275resetView(s.onTreeDoubleClick())}),i.\u0275\u0275elementEnd()}if(r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275property("dataSource",t.dataSource),i.\u0275\u0275twoWayProperty("selectedUnit",t.selectedUnit)}}function lS(r,e){if(r&1){const t=i.\u0275\u0275getCurrentView();i.\u0275\u0275elementStart(0,"div",27),i.\u0275\u0275listener("click",function(){const s=i.\u0275\u0275restoreView(t).$implicit,a=i.\u0275\u0275nextContext(2);return i.\u0275\u0275resetView(a.onItemClick(s))})("dblclick",function(){i.\u0275\u0275restoreView(t);const s=i.\u0275\u0275nextContext(2);return i.\u0275\u0275resetView(s.onTreeDoubleClick())}),i.\u0275\u0275elementStart(1,"div",28),i.\u0275\u0275text(2),i.\u0275\u0275elementEnd()()}if(r&2){const t=e.$implicit,n=i.\u0275\u0275nextContext(2);i.\u0275\u0275propertyInterpolate("id",t.id),i.\u0275\u0275property("ngClass",i.\u0275\u0275pureFunction1(3,nS,n.isSelectedItem(t))),i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate1(" ",t.name," ")}}function cS(r,e){if(r&1&&(i.\u0275\u0275elementStart(0,"div",24)(1,"cdk-virtual-scroll-viewport",25,1),i.\u0275\u0275template(3,lS,3,5,"div",26),i.\u0275\u0275elementEnd()()),r&2){const t=i.\u0275\u0275nextContext();i.\u0275\u0275advance(3),i.\u0275\u0275property("cdkVirtualForOf",t.dataSource)}}var xe;(function(r){r[r.OrganizationRoles=0]="OrganizationRoles",r[r.FunctionalRoles=1]="FunctionalRoles",r[r.Users=2]="Users"})(xe||(xe={}));class jl{constructor(e,t,n,s,a){this.dialogRef=e,this.dialogService=t,this.rightManagementService=n,this.translateService=s,this.data=a,this.isLoading=!1,this.selectedTabIndex=0}_getGroupNameByTabIndex(e){let t="";switch(e){case xe.OrganizationRoles:t=this.translateService.instant("SelectSysAdminUnitDialog.OrganizationalRoles");break;case xe.FunctionalRoles:t=this.translateService.instant("SelectSysAdminUnitDialog.FunctionalRoles");break;case xe.Users:t=this.translateService.instant("SelectSysAdminUnitDialog.Users");break}return t}_getAllEmployeesUnit(){return this.sysAdminUnits.find(e=>e.id===Yb)}_getAllPortalUsersUnit(){return this.sysAdminUnits.find(e=>e.id===Kb)}_getSysAdminUnitTypesByTabIndex(e){let t=[];switch(e){case xe.OrganizationRoles:t=[Be.Organization,Be.Division,Be.Manager,Be.SelfServicePortalUser];break;case xe.FunctionalRoles:t=[Be.FunctionalRole];break;case xe.Users:t=[Be.User,Be.TechnicalUser];break}return t}_fillSysAdminUnitsWithGroup(e){this.sysAdminUnitsWithGroup=[],Object.keys(xe).forEach(t=>{const n=Number(xe[t]);if(isNaN(n))return;const s=this._getSysAdminUnitTypesByTabIndex(n),a=this._getGroupNameByTabIndex(n);this.sysAdminUnitsWithGroup.push({sysAdminUnit:null,tabIndex:n,groupName:a}),e.filter(o=>s.indexOf(o.sysAdminUnitTypeValue)>-1).forEach(o=>{this.sysAdminUnitsWithGroup.push({sysAdminUnit:o,tabIndex:n,groupName:a})})})}_prepareSysAdminUnits(e){if(!e||!e.success){this.isLoading=!1,e&&e.errorInfo&&this.dialogService.openInfoDialog(e.errorInfo.message);return}this.sysAdminUnits=e.sysAdminUnits,this._fillSysAdminUnitsWithGroup(this.sysAdminUnits),this.fillContentByTab(xe.OrganizationRoles),this.isLoading=!1}_applySysAdminUnit(){const e=this.data&&this.data.validator,t=e&&e(this.selectedUnit);if(t&&!t.success){this.dialogService.openInfoDialog(t.message);return}this.dialogRef.close(this.selectedUnit)}_changeTabIndexBySysAdminUnitType(e){let t=this.selectedTabIndex;switch(e){case Be.Organization:case Be.Division:case Be.Manager:case Be.SelfServicePortalUser:t=xe.OrganizationRoles;break;case Be.FunctionalRole:t=xe.FunctionalRoles;break;case Be.User:case Be.TechnicalUser:t=xe.Users;break}this.selectedTabIndex=t}_scrollToSelectedItem(){const e=this.selectedUnit&&this.dataSource.findIndex(t=>t.id===this.selectedUnit.id);e!==-1&&setTimeout(()=>{this._viewport.scrollToIndex(e)},0)}ngOnInit(){this.isLoading=!0,this.rightManagementService.getSysAdminUnitList().subscribe(this._prepareSysAdminUnits.bind(this))}fillContentByTab(e){if(!Array.isArray(this.sysAdminUnits)){this.dataSource=null;return}const t=this._getSysAdminUnitTypesByTabIndex(e),n=this.sysAdminUnits.filter(s=>t.indexOf(s.sysAdminUnitTypeValue)>-1);if(e===xe.FunctionalRoles){n.push(this._getAllEmployeesUnit());const s=this._getAllPortalUsersUnit();s&&n.push(s)}this.dataSource=n,this.selectedTabIndex===xe.Users&&this._scrollToSelectedItem()}onTreeDoubleClick(){this.selectedUnit&&this._applySysAdminUnit()}onSelectButtonClick(){this._applySysAdminUnit()}getSysAdminUnitName(e){return e.name}onFilteredSysAdminUnitSelected(e){const t=e.option.value;this._changeTabIndexBySysAdminUnitType(t.sysAdminUnitTypeValue),this.selectedUnit=t,this.fillContentByTab(this.selectedTabIndex),this.selectedTabIndex===xe.Users&&this._scrollToSelectedItem()}search(e){if(!e||e.length<3){this.filteredSysAdminUnits=[];return}e=e.toLocaleLowerCase(),this.filteredSysAdminUnits=this.sysAdminUnitsWithGroup.filter(n=>!n.sysAdminUnit||n.sysAdminUnit.name.toLowerCase().indexOf(e.toLowerCase())!==-1).filter((n,s,a)=>n.sysAdminUnit||!n.sysAdminUnit&&a.findIndex(o=>o.groupName===n.groupName&&o.sysAdminUnit)>-1)}isOrganizationalRolesVisible(){return this.selectedTabIndex===xe.OrganizationRoles}isFunctionalRolesVisible(){return this.selectedTabIndex===xe.FunctionalRoles}isUsersVisible(){return this.selectedTabIndex===xe.Users}onItemClick(e){this.selectedUnit=e}isSelectedItem(e){return!!(this.selectedUnit&&this.selectedUnit.id===e.id)}calculateSearchResultContainerHeight(){return`${this.filteredSysAdminUnits.length*33}px`}static{this.\u0275fac=function(t){return new(t||jl)(i.\u0275\u0275directiveInject(N.MatLegacyDialogRef),i.\u0275\u0275directiveInject(lt),i.\u0275\u0275directiveInject(qs),i.\u0275\u0275directiveInject(m.TranslateService),i.\u0275\u0275directiveInject(N.MAT_LEGACY_DIALOG_DATA))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:jl,selectors:[["ts-select-sysadminunit-dialog"]],viewQuery:function(t,n){if(t&1&&i.\u0275\u0275viewQuery(eS,5),t&2){let s;i.\u0275\u0275queryRefresh(s=i.\u0275\u0275loadQuery())&&(n._viewport=s.first)}},decls:33,vars:30,consts:[["auto","matAutocomplete"],["usersListContainer",""],[4,"ngIf"],["mat-dialog-title",""],["mat-icon-button","",1,"close-dialog",3,"mat-dialog-close"],["svgIcon","close",1,"close-button-icon"],["mat-dialog-actions",""],["mat-flat-button","","color","accent",3,"click","disabled"],["mat-button","","cdkFocusInitial","",3,"mat-dialog-close"],["mat-dialog-content",""],[1,"search-input"],["floatLabel","never"],["matInput","","type","text","spellcheck","false",3,"input","focus","placeholder","matAutocomplete"],["matSuffix","","svgIcon","search"],[3,"optionSelected","displayWith"],["itemSize","33","minBufferPx","297","maxBufferPx","396","class","search-list-viewport",3,"height",4,"ngIf"],["mat-stretch-tabs","","animationDuration","0ms","disableRipple","true",3,"selectedIndexChange","selectedIndex"],[3,"label"],[3,"dataSource","selectedUnit","selectedUnitChange","dblclick",4,"ngIf"],["class","users-wrapper",4,"ngIf"],["itemSize","33","minBufferPx","297","maxBufferPx","396",1,"search-list-viewport"],[3,"value","ngClass","disabled",4,"cdkVirtualFor","cdkVirtualForOf"],[3,"value","ngClass","disabled"],[3,"selectedUnitChange","dblclick","dataSource","selectedUnit"],[1,"users-wrapper"],["itemSize","30","minBufferPx","300","maxBufferPx","600",1,"users-list-viewport"],["class","mat-tree-node",3,"ngClass","id","click","dblclick",4,"cdkVirtualFor","cdkVirtualForOf"],[1,"mat-tree-node",3,"click","dblclick","ngClass","id"],[1,"user-item"]],template:function(t,n){if(t&1){const s=i.\u0275\u0275getCurrentView();i.\u0275\u0275template(0,iS,1,0,"ts-mask",2),i.\u0275\u0275elementStart(1,"div",3)(2,"span"),i.\u0275\u0275text(3),i.\u0275\u0275pipe(4,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(5,"button",4),i.\u0275\u0275element(6,"mat-icon",5),i.\u0275\u0275elementEnd()(),i.\u0275\u0275elementStart(7,"div",6)(8,"button",7),i.\u0275\u0275listener("click",function(){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.onSelectButtonClick())}),i.\u0275\u0275text(9),i.\u0275\u0275pipe(10,"translate"),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(11,"button",8),i.\u0275\u0275text(12),i.\u0275\u0275pipe(13,"translate"),i.\u0275\u0275elementEnd()(),i.\u0275\u0275elementStart(14,"div",9)(15,"div",10)(16,"mat-form-field",11)(17,"input",12),i.\u0275\u0275pipe(18,"translate"),i.\u0275\u0275listener("input",function(o){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.search(o.target.value))})("focus",function(o){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.search(o.target.value))}),i.\u0275\u0275elementEnd(),i.\u0275\u0275element(19,"mat-icon",13),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(20,"mat-autocomplete",14,0),i.\u0275\u0275listener("optionSelected",function(o){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.onFilteredSysAdminUnitSelected(o))}),i.\u0275\u0275template(22,rS,2,3,"cdk-virtual-scroll-viewport",15),i.\u0275\u0275elementEnd()(),i.\u0275\u0275elementStart(23,"mat-tab-group",16),i.\u0275\u0275twoWayListener("selectedIndexChange",function(o){return i.\u0275\u0275restoreView(s),i.\u0275\u0275twoWayBindingSet(n.selectedTabIndex,o)||(n.selectedTabIndex=o),i.\u0275\u0275resetView(o)}),i.\u0275\u0275listener("selectedIndexChange",function(o){return i.\u0275\u0275restoreView(s),i.\u0275\u0275resetView(n.fillContentByTab(o))}),i.\u0275\u0275elementStart(24,"mat-tab",17),i.\u0275\u0275pipe(25,"translate"),i.\u0275\u0275template(26,aS,1,2,"ts-sysadminunit-tree",18),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(27,"mat-tab",17),i.\u0275\u0275pipe(28,"translate"),i.\u0275\u0275template(29,oS,1,2,"ts-sysadminunit-tree",18),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(30,"mat-tab",17),i.\u0275\u0275pipe(31,"translate"),i.\u0275\u0275template(32,cS,4,1,"div",19),i.\u0275\u0275elementEnd()()()}if(t&2){const s=i.\u0275\u0275reference(21);i.\u0275\u0275property("ngIf",n.isLoading),i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(4,16,"SelectSysAdminUnitDialog.Title")),i.\u0275\u0275advance(5),i.\u0275\u0275property("disabled",!n.selectedUnit),i.\u0275\u0275advance(),i.\u0275\u0275textInterpolate1(" ",i.\u0275\u0275pipeBind1(10,18,"SelectSysAdminUnitDialog.Select")," "),i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate(i.\u0275\u0275pipeBind1(13,20,"SelectSysAdminUnitDialog.Cancel")),i.\u0275\u0275advance(5),i.\u0275\u0275property("placeholder",i.\u0275\u0275pipeBind1(18,22,"SelectSysAdminUnitDialog.Search"))("matAutocomplete",s),i.\u0275\u0275advance(3),i.\u0275\u0275property("displayWith",n.getSysAdminUnitName),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",n.filteredSysAdminUnits&&n.filteredSysAdminUnits.length>0),i.\u0275\u0275advance(),i.\u0275\u0275twoWayProperty("selectedIndex",n.selectedTabIndex),i.\u0275\u0275advance(),i.\u0275\u0275property("label",i.\u0275\u0275pipeBind1(25,24,"SelectSysAdminUnitDialog.OrganizationalRoles")),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",n.isOrganizationalRolesVisible()),i.\u0275\u0275advance(),i.\u0275\u0275property("label",i.\u0275\u0275pipeBind1(28,26,"SelectSysAdminUnitDialog.FunctionalRoles")),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",n.isFunctionalRolesVisible()),i.\u0275\u0275advance(),i.\u0275\u0275property("label",i.\u0275\u0275pipeBind1(31,28,"SelectSysAdminUnitDialog.Users")),i.\u0275\u0275advance(2),i.\u0275\u0275property("ngIf",n.isUsersVisible())}},dependencies:[Ke,v.NgClass,v.NgIf,qe.MatLegacyAutocomplete,qe.MatLegacyAutocompleteTrigger,Yt.MatLegacyOption,$.MatLegacyButton,N.MatLegacyDialogClose,N.MatLegacyDialogTitle,N.MatLegacyDialogContent,N.MatLegacyDialogActions,G.MatIcon,ee.MatLegacyFormField,ee.MatLegacySuffix,me.MatLegacyInput,Nt.MatLegacyTabGroup,Nt.MatLegacyTab,Si.CdkFixedSizeVirtualScroll,Si.CdkVirtualForOf,Si.CdkVirtualScrollViewport,go,m.TranslatePipe],styles:["[_nghost-%COMP%]{padding:4px 10px;min-width:580px;min-height:512px}[mat-dialog-actions][_ngcontent-%COMP%]{margin-bottom:5px!important}.search-input[_ngcontent-%COMP%]{padding-top:12px;font-size:14px}.search-input[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{width:100%;line-height:18px!important}.search-input[_ngcontent-%COMP%]   mat-icon[svgicon=search][_ngcontent-%COMP%]{width:16px;height:16px;line-height:0;vertical-align:middle}.search-list-viewport[_ngcontent-%COMP%]{max-height:254px}.selectable-item[_ngcontent-%COMP%]{padding-left:50px}.users-wrapper[_ngcontent-%COMP%]   .users-list-viewport[_ngcontent-%COMP%]{height:325px}.users-wrapper[_ngcontent-%COMP%]   .mat-tree-node[_ngcontent-%COMP%]{color:#444;line-height:19px;max-height:30px;min-height:30px;white-space:nowrap}.users-wrapper[_ngcontent-%COMP%]   .mat-tree-node.selected[_ngcontent-%COMP%]{background-color:#f2f5ff}.users-wrapper[_ngcontent-%COMP%]   .mat-tree-node[_ngcontent-%COMP%]   .user-item[_ngcontent-%COMP%]{margin-left:30px}"]})}}class Js{static{this.\u0275fac=function(t){return new(t||Js)}}static{this.\u0275mod=i.\u0275\u0275defineNgModule({type:Js})}static{this.\u0275inj=i.\u0275\u0275defineInjector({providers:[qs],imports:[ut,_n,Pt,v.CommonModule,Zp.DragDropModule,Z.FormsModule,qe.MatLegacyAutocompleteModule,$.MatLegacyButtonModule,Ge.MatLegacyCheckboxModule,N.MatLegacyDialogModule,Mt.MatDividerModule,Vo.MatExpansionModule,G.MatIconModule,me.MatLegacyInputModule,zn.MatLegacyMenuModule,Qe.MatLegacySelectModule,Yp.MatLegacySlideToggleModule,Kp.MatSortModule,hd.MatLegacyTableModule,Nt.MatLegacyTabsModule,ct.MatTooltipModule,Ae.MatTreeModule,ee.MatLegacyFormFieldModule,Ks,m.TranslateModule,Si.ScrollingModule,Si.CdkVirtualScrollViewport]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&i.\u0275\u0275setNgModuleScope(Js,{declarations:[jl,go],imports:[ut,_n,Pt,v.CommonModule,Zp.DragDropModule,Z.FormsModule,qe.MatLegacyAutocompleteModule,$.MatLegacyButtonModule,Ge.MatLegacyCheckboxModule,N.MatLegacyDialogModule,Mt.MatDividerModule,Vo.MatExpansionModule,G.MatIconModule,me.MatLegacyInputModule,zn.MatLegacyMenuModule,Qe.MatLegacySelectModule,Yp.MatLegacySlideToggleModule,Kp.MatSortModule,hd.MatLegacyTableModule,Nt.MatLegacyTabsModule,ct.MatTooltipModule,Ae.MatTreeModule,ee.MatLegacyFormFieldModule,Ks,m.TranslateModule,Si.ScrollingModule,Si.CdkVirtualScrollViewport]})})();class fo{constructor(e){this._elRef=e,this.clickOutside=new i.EventEmitter}onOutsideClick(e){const t=e.target;this._elRef.nativeElement.contains(t)||this.clickOutside.emit()}static{this.\u0275fac=function(t){return new(t||fo)(i.\u0275\u0275directiveInject(i.ElementRef))}}static{this.\u0275dir=i.\u0275\u0275defineDirective({type:fo,selectors:[["","crtClickOutside",""]],hostBindings:function(t,n){t&1&&i.\u0275\u0275listener("click",function(a){return n.onOutsideClick(a)},!1,i.\u0275\u0275resolveDocument)},outputs:{clickOutside:"crtClickOutside"}})}}class Qs{constructor(){this.isRequired=!1}get ariaRequired(){return this.isRequired}static{this.\u0275fac=function(t){return new(t||Qs)}}static{this.\u0275dir=i.\u0275\u0275defineDirective({type:Qs,selectors:[["","crtAriaRequired",""]],hostVars:1,hostBindings:function(t,n){t&2&&i.\u0275\u0275attribute("aria-required",n.ariaRequired)},inputs:{isRequired:[i.\u0275\u0275InputFlags.None,"crtAriaRequired","isRequired"]}})}}(0,y.__decorate)([re(),(0,y.__metadata)("design:type",Object)],Qs.prototype,"isRequired",void 0);class $t{static{this.\u0275fac=function(t){return new(t||$t)}}static{this.\u0275mod=i.\u0275\u0275defineNgModule({type:$t})}static{this.\u0275inj=i.\u0275\u0275defineInjector({imports:[v.CommonModule,Ui.B]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&i.\u0275\u0275setNgModuleScope($t,{declarations:[Os],imports:[v.CommonModule,Ui.B],exports:[Os]})})();class Rn{static{this.\u0275fac=function(t){return new(t||Rn)}}static{this.\u0275mod=i.\u0275\u0275defineNgModule({type:Rn})}static{this.\u0275inj=i.\u0275\u0275defineInjector({providers:[ks],imports:[v.CommonModule,ut,$t,qe.MatLegacyAutocompleteModule,$.MatLegacyButtonModule,N.MatLegacyDialogModule,ee.MatLegacyFormFieldModule,G.MatIconModule,me.MatLegacyInputModule,Tt.MatProgressSpinnerModule,Wt,m.TranslateModule]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&i.\u0275\u0275setNgModuleScope(Rn,{declarations:[Ls,Ja],imports:[v.CommonModule,ut,$t,qe.MatLegacyAutocompleteModule,$.MatLegacyButtonModule,N.MatLegacyDialogModule,ee.MatLegacyFormFieldModule,G.MatIconModule,me.MatLegacyInputModule,Tt.MatProgressSpinnerModule,Wt,m.TranslateModule]})})();class _o{constructor(e){this._window=e,this._defaultBlinkInterval=500,this._defaultBlinkPrefix="*"}_getBlinkConfig(e){const t=this._window.document,n=e?.title||t.title;return{title:n,blinkTitle:e?.blinkTitle||`${this._defaultBlinkPrefix}${n}`,blinkInterval:e?.blinkInterval||this._defaultBlinkInterval,blinkOnce:(e||{}).blinkOnce===!0}}_createSyncSubject(){const e=new u.Subject;return(0,u.fromEvent)(this._window,"mousemove").pipe((0,l.first)(),(0,l.map)(t=>null)).subscribe(e),e}blink(e){return(0,u.of)(null)}static{this.\u0275fac=function(t){return new(t||_o)(i.\u0275\u0275inject(T.ZP))}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:_o,factory:_o.\u0275fac,providedIn:"root"})}}function uS(r){return r.cultureInfo.sysCultureName}const dS={showDelay:300,hideDelay:300,touchendHideDelay:1e3,position:"above"};let yo=class yd{constructor(e){this._materialIconsRegistrator=e,Lb.forEach(t=>{this._materialIconsRegistrator.addIcons([{name:t,icon:h(10722)(`./${t}.svg`)},{name:`${t}-large`,icon:h(12014)(`./${t}.svg`)}])})}static{this.\u0275fac=function(t){return new(t||yd)(i.\u0275\u0275inject(fn))}}static{this.\u0275mod=i.\u0275\u0275defineNgModule({type:yd})}static{this.\u0275inj=i.\u0275\u0275defineInjector({providers:[T.rK,_o,Rs,{provide:ki.MAT_DATE_LOCALE,useFactory:uS,deps:[We.oq]},{provide:ki.MAT_DATE_FORMATS,useValue:Lo.MAT_MOMENT_DATE_FORMATS},{provide:ki.DateAdapter,useClass:Lo.MomentDateAdapter,deps:[ki.MAT_DATE_LOCALE]},{provide:ct.MAT_TOOLTIP_DEFAULT_OPTIONS,useValue:dS}],imports:[v.CommonModule,dt,Dn,$t,Gs,Z.FormsModule,Rn,qe.MatLegacyAutocompleteModule,$.MatLegacyButtonModule,Ge.MatLegacyCheckboxModule,yn.MatDatepickerModule,N.MatLegacyDialogModule,Mt.MatDividerModule,ee.MatLegacyFormFieldModule,G.MatIconModule,me.MatLegacyInputModule,zn.MatLegacyMenuModule,Lo.MatMomentDateModule,Tt.MatProgressSpinnerModule,ki.MatRippleModule,Qe.MatLegacySelectModule,ct.MatTooltipModule,Wt,sc.RouterModule,Ui.B,Ba,m.TranslateModule,Z.ReactiveFormsModule,_s,Vo.MatExpansionModule,Bs,Bi,Js,dt,Dn,$t,Rn,Wt,Ui.B]})}};yo=(0,y.__decorate)([Od({viewElements:[Et,gt,Pn,Ys,_i,Nn,Vl],converters:[Ru,Ou,Al,Vu,Lu,ku,ju,Fu,Bu,Uu,zu,Hu,Wu,$u,Gu,Yu,Ku,qu,Ju,Qu,Xu,ed,td,nd,id,sd,rd],requestHandlers:[ad]}),(0,y.__metadata)("design:paramtypes",[fn])],yo),function(){(typeof ngJitMode>"u"||ngJitMode)&&i.\u0275\u0275setNgModuleScope(yo,{declarations:[yi,Ci,uo,to,no,zs,Hs,ft,Zs,ro,Ws,ao,oo,lo,Ll,Et,gt,Ys,_i,Pn,Vl,po,fo,Qs,co],imports:[v.CommonModule,dt,Dn,$t,Gs,Z.FormsModule,Rn,qe.MatLegacyAutocompleteModule,$.MatLegacyButtonModule,Ge.MatLegacyCheckboxModule,yn.MatDatepickerModule,N.MatLegacyDialogModule,Mt.MatDividerModule,ee.MatLegacyFormFieldModule,G.MatIconModule,me.MatLegacyInputModule,zn.MatLegacyMenuModule,Lo.MatMomentDateModule,Tt.MatProgressSpinnerModule,ki.MatRippleModule,Qe.MatLegacySelectModule,ct.MatTooltipModule,Wt,sc.RouterModule,Ui.B,Ba,m.TranslateModule,Z.ReactiveFormsModule,_s,Vo.MatExpansionModule,Bs,Bi,Js],exports:[yi,Ci,uo,to,no,dt,zs,Dn,$t,Hs,ft,Pn,Rn,ro,Ws,ao,Wt,oo,lo,Ui.B,Et,gt,Ys,_i,po,fo,Qs,co]})}();class Xs{static{this.\u0275fac=function(t){return new(t||Xs)}}static{this.\u0275mod=i.\u0275\u0275defineNgModule({type:Xs})}static{this.\u0275inj=i.\u0275\u0275defineInjector({providers:[m.TranslateService],imports:[Z.FormsModule,v.CommonModule,Pt,m.TranslateModule]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&i.\u0275\u0275setNgModuleScope(Xs,{declarations:[jn],imports:[Z.FormsModule,v.CommonModule,Pt,m.TranslateModule],exports:[jn]})})();var Jp=h(37440);class er{static{this.\u0275fac=function(t){return new(t||er)}}static{this.\u0275mod=i.\u0275\u0275defineNgModule({type:er})}static{this.\u0275inj=i.\u0275\u0275defineInjector({providers:[kn,Fn,_e,Bn,j,z],imports:[ee.MatLegacyFormFieldModule,Z.FormsModule,dt,v.CommonModule,ut,$.MatLegacyButtonModule,G.MatIconModule,me.MatLegacyInputModule,N.MatLegacyDialogModule,K.MatStepperModule,Qe.MatLegacySelectModule,Pt,Ae.MatTreeModule,Ge.MatLegacyCheckboxModule,yo,Xs,_n,m.TranslateModule.forRoot(),Nt.MatLegacyTabsModule,Jp.b]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&i.\u0275\u0275setNgModuleScope(er,{declarations:[yr,Cr,hr,br,Ti,mr,ur,pr,Ni,Di],imports:[ee.MatLegacyFormFieldModule,Z.FormsModule,dt,v.CommonModule,ut,$.MatLegacyButtonModule,G.MatIconModule,me.MatLegacyInputModule,N.MatLegacyDialogModule,K.MatStepperModule,Qe.MatLegacySelectModule,Pt,Ae.MatTreeModule,Ge.MatLegacyCheckboxModule,yo,Xs,_n,m.TranslateModule,Nt.MatLegacyTabsModule,Jp.b],exports:[Ni]})})();class Co{_buildRequestUrl(e){return this._isAbsoluteUrl(e)?e:v.Location.joinWithSlash(this.getUrl(),e)}_isAbsoluteUrl(e){return/^https?:\/\//i.test(e)}getUrl(){return L()}intercept(e,t){return e=e.clone({url:this._buildRequestUrl(e.url)}),t.handle(e).pipe((0,l.catchError)(n=>(console.log(n),(0,u.throwError)(n))))}static{this.\u0275fac=function(t){return new(t||Co)}}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:Co,factory:Co.\u0275fac})}}class tr extends Co{getUrl(){return pe()}static{this.\u0275fac=(()=>{let e;return function(n){return(e||(e=i.\u0275\u0275getInheritedFactory(tr)))(n||tr)}})()}static{this.\u0275prov=i.\u0275\u0275defineInjectable({token:tr,factory:tr.\u0275fac})}}const hS="DataService/json/SyncReply",pS="DataService/ssp/json/SyncReply",mS={provide:or,useFactory:r=>r?.isSSP?pS:hS,deps:[[new i.Optional,We.oq]]};function gS(r){return()=>(0,u.lastValueFrom)(r.loadCurrentUserInfo(),{defaultValue:null})}class bo{static{this.\u0275fac=function(t){return new(t||bo)}}static{this.\u0275mod=i.\u0275\u0275defineNgModule({type:bo})}static{this.\u0275inj=i.\u0275\u0275defineInjector({providers:[We.vn,{provide:xp.P,useValue:{name:rl.Oi,type:eu.P.PersistentAndMemory,options:{tableName:Tp.w.UserInfo}},multi:!0},{provide:i.APP_INITIALIZER,useFactory:gS,deps:[We.fv],multi:!0}]})}}class So{constructor(e,t,n,s){this._customEventService=e,this._webServiceWizardService=t,this._webServiceClientService=n,this._webServiceDtoConverterService=s,this._destroyed$=new u.Subject}_onServicesSetup(e){this._customEventService.createOutboundChannel(Gm).next(e)}_subscribeCustomEventService(e){return this._customEventService.subscribe(e).pipe((0,l.takeUntil)(this._destroyed$))}_convertToDto(e){return{services:e.services.map(t=>this._webServiceDtoConverterService.convertToDto(t)),resultCode:e.resultCode}}_getServiceSchema(e){const t=this._webServiceDtoConverterService.convertFromDto(e.serviceSchemaDto);return t.serviceMethods=t.serviceMethods.filter(n=>n.uId===e.methodUId),t}_openServiceWizard(){this._webServiceWizardService.showWizard().pipe((0,l.map)(e=>this._convertToDto(e))).subscribe(e=>{this._onServicesSetup(e)})}_openServiceClient(e){this._webServiceClientService.show(e)}ngOnInit(){this._subscribeCustomEventService($m).subscribe(()=>this._openServiceWizard()),this._subscribeCustomEventService(Zm).pipe((0,l.map)(e=>this._getServiceSchema(e))).subscribe(e=>this._openServiceClient(e))}ngOnDestroy(){this._destroyed$.next()}static{this.\u0275fac=function(t){return new(t||So)(i.\u0275\u0275directiveInject(T.Dj),i.\u0275\u0275directiveInject(kn),i.\u0275\u0275directiveInject(Fn),i.\u0275\u0275directiveInject(Bn))}}static{this.\u0275cmp=i.\u0275\u0275defineComponent({type:So,selectors:[["ts-web-service-proxy"]],decls:2,vars:0,template:function(t,n){t&1&&(i.\u0275\u0275elementStart(0,"p"),i.\u0275\u0275text(1,"web-service-proxy works!"),i.\u0275\u0275elementEnd())}})}}const fS=h.p+"assets/i18n/libs/";class Mo{constructor(e,t){this._customElementsBootstrapService=e,this.translate=t,this._customElements=[{componentName:"ts-web-service-proxy",componentType:So}]}ngDoBootstrap(){this.translate.use(this.translate.defaultLang).subscribe(()=>{this._customElements.forEach(({componentName:e,componentType:t})=>{this._customElementsBootstrapService.defineComponent(e,t)})})}static{this.\u0275fac=function(t){return new(t||Mo)(i.\u0275\u0275inject(T.SH),i.\u0275\u0275inject(m.TranslateService))}}static{this.\u0275mod=i.\u0275\u0275defineNgModule({type:Mo})}static{this.\u0275inj=i.\u0275\u0275defineInjector({providers:[kn,Fn,Bn,T.Dj,{provide:ar,useValue:"GetWebServiceTranslation"},{provide:P.HTTP_INTERCEPTORS,useClass:tr,multi:!0},mS,w,ir],imports:[g.BrowserModule,k.BrowserAnimationsModule,er,b.MatLegacySnackBarModule,P.HttpClientModule,bo,A.forNested({defaultLanguage:"en-US",loader:{provide:m.TranslateLoader,useClass:Ct},resourceSources:[{prefix:fS,suffix:".json"}]}),P.HttpClientXsrfModule.withOptions({cookieName:"BPMCSRF",headerName:"BPMCSRF"})]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&i.\u0275\u0275setNgModuleScope(Mo,{declarations:[So],imports:[g.BrowserModule,k.BrowserAnimationsModule,er,b.MatLegacySnackBarModule,P.HttpClientModule,bo,m.TranslateModule,P.HttpClientXsrfModule]})})(),g.platformBrowser().bootstrapModule(Mo).catch(r=>console.error(r))},86464:(R,H,h)=>{h.d(H,{r:()=>g});var g;(function(_){_[_.Guid=0]="Guid",_[_.Text=1]="Text",_[_.Integer=4]="Integer",_[_.Float=5]="Float",_[_.Money=6]="Money",_[_.DateTime=7]="DateTime",_[_.Date=8]="Date",_[_.Time=9]="Time",_[_.Lookup=10]="Lookup",_[_.Enum=11]="Enum",_[_.Boolean=12]="Boolean",_[_.Blob=13]="Blob",_[_.Image=14]="Image",_[_.CUSTOM_OBJECT=15]="CUSTOM_OBJECT",_[_.IMAGELOOKUP=16]="IMAGELOOKUP",_[_.COLLECTION=17]="COLLECTION",_[_.Color=18]="Color",_[_.LOCALIZABLE_STRING=19]="LOCALIZABLE_STRING",_[_.ENTITY=20]="ENTITY",_[_.ENTITY_COLLECTION=21]="ENTITY_COLLECTION",_[_.ENTITY_COLUMN_MAPPING_COLLECTION=22]="ENTITY_COLUMN_MAPPING_COLLECTION",_[_.HASH_TEXT=23]="HASH_TEXT",_[_.SECURE_TEXT=24]="SECURE_TEXT",_[_.FILE=25]="FILE",_[_.MAPPING=26]="MAPPING",_[_.SHORT_TEXT=27]="SHORT_TEXT",_[_.MEDIUM_TEXT=28]="MEDIUM_TEXT",_[_.MAXSIZE_TEXT=29]="MAXSIZE_TEXT",_[_.LONG_TEXT=30]="LONG_TEXT",_[_.FLOAT1=31]="FLOAT1",_[_.FLOAT2=32]="FLOAT2",_[_.FLOAT3=33]="FLOAT3",_[_.FLOAT4=34]="FLOAT4",_[_.LOCALIZABLE_PARAMETER_VALUES_LIST=35]="LOCALIZABLE_PARAMETER_VALUES_LIST",_[_.METADATA_TEXT=36]="METADATA_TEXT",_[_.STAGE_INDICATOR=37]="STAGE_INDICATOR",_[_.OBJECT_LIST=38]="OBJECT_LIST",_[_.COMPOSITE_OBJECT_LIST=39]="COMPOSITE_OBJECT_LIST",_[_.FLOAT8=40]="FLOAT8",_[_.FILE_LOCATOR=41]="FILE_LOCATOR",_[_.PHONE_TEXT=42]="PHONE_TEXT",_[_.RICH_TEXT=43]="RICH_TEXT",_[_.WEB_TEXT=44]="WEB_TEXT",_[_.EMAIL_TEXT=45]="EMAIL_TEXT",_[_.COMPOSITE_OBJECT=46]="COMPOSITE_OBJECT"})(g||(g={}))},6530:(R,H,h)=>{h.d(H,{gZ:()=>k,n7:()=>b,qv:()=>i});const g="00000000-0000-0000-0000-000000000000",_=new RegExp("^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$","i");function P(m){let T="";for(let M=0;M<m;M++)T+=((1+Math.random())*65536|0).toString(16).substring(1);return T}function i(){return[P(2),P(1),P(1),P(1),P(3)].join("-")}function b(m){return!!m&&_.test(m)}function k(m){return!m||m===g}},84065:(R,H,h)=>{h.d(H,{NS:()=>sr,Vx:()=>He,op:()=>yt,SH:()=>Zt,Dj:()=>m,X4:()=>Io,MV:()=>S,G8:()=>T,gX:()=>ir,sj:()=>$e,$A:()=>ke,wZ:()=>Ye,cn:()=>wo,rK:()=>un,ZP:()=>bt,S:()=>ne,BB:()=>q,hk:()=>w,mh:()=>wi,BV:()=>K,DH:()=>A,pR:()=>N});var g=h(40297),_=h(59131),P=h(62278),i=h(36486);const b=new _.InjectionToken("CustomEventApplicationIdToken"),k=new _.InjectionToken("CustomEventServiceToken");class m{constructor(x,f=null){this.document=x,this.appId=f,this.customEventName="TSCustomEventChannel",this.appId=f||Math.random().toString()}subscribe(x){return this.customEventObserver$=this.customEventObserver$||(0,P.fromEvent)(document,this.customEventName),this.customEventObserver$.pipe((0,i.filter)(f=>f.detail.eventName===x&&f.detail.sender!==this.appId),(0,i.map)(f=>f.detail.payload))}createOutboundChannel(x){const f=new P.Subject;return f.asObservable().subscribe(j=>{const z=new CustomEvent(this.customEventName,{detail:{eventName:x,sender:this.appId,payload:j}});this.document.dispatchEvent(z)}),f}getDataViaEvent(x,f={}){return new P.Observable(j=>{this.subscribe(x).pipe((0,i.first)()).subscribe(z=>{j.next(z),j.complete()}),this.createOutboundChannel(x).next(f)})}getDataStreamViaEvent(x,f={}){return new P.Observable(j=>{const z=this.subscribe(x).subscribe(_e=>{j.next(_e)},P.noop,()=>j.complete());return this.createOutboundChannel(x).next(f),()=>{z.unsubscribe()}})}static{this.\u0275fac=function(f){return new(f||m)(_.\u0275\u0275inject(g.DOCUMENT),_.\u0275\u0275inject(b,8))}}static{this.\u0275prov=_.\u0275\u0275defineInjectable({token:m,factory:m.\u0275fac,providedIn:"root"})}}const T=["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","title","video","xmp"];var M=h(34268),u=h.n(M);const v="(?=^.{1,250}$)^[\u0430-\u044F\u0410-\u042Fa-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[\u0430-\u044F\u0410-\u042Fa-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[\u0430-\u044F\u0410-\u042Fa-zA-Z0-9](?:[\u0430-\u044F\u0410-\u042Fa-zA-Z0-9-]*[\u0430-\u044F\u0410-\u042Fa-zA-Z0-9])?\\.)+[\u0430-\u044F\u0410-\u042Fa-zA-Z0-9](?:[\u0430-\u044F\u0410-\u042Fa-zA-Z0-9-]*[\u0430-\u044F\u0410-\u042Fa-zA-Z0-9])?$",ae=()=>new RegExp(v,"g"),ie=()=>new RegExp(CONTAINS_EMAIL_PATTERN,"g");function he(F){return ae().test(F)}function Me(F){return CONTAINS_EMAIL_REGEXP().test(F)}const de={name:"uponSanitizeElement",func:(F,x)=>{const f=x.tagName;he(f)&&F.insertAdjacentText("afterbegin",`<${f}>`)}},pe={name:"afterSanitizeAttributes",func:(F,x)=>{const f=window?.location?.origin;if(F.nodeName==="A"&&!F.getAttribute("href")?.toLowerCase().startsWith(f)){F.setAttribute("target","_blank");let j=F.getAttribute("rel")||"";["noopener","noreferrer"].forEach(z=>{j.includes(z)||(j+=" "+z)}),F.setAttribute("rel",j.trim())}}},S=new _.InjectionToken("Represents a DOM purifier",{factory:()=>(u().addHook(de.name,de.func),u().addHook(pe.name,pe.func),u()),providedIn:"platform"});function D(F){return F?Array.isArray(F)?F:[F]:[]}function L(F){return F||{}}function W(){}function ne(){return()=>{}}var J=h(26714);class V{static create(x){return new x}}class B{constructor(){this.speechResult=new P.Subject,this.speechEnd=new P.Subject}static _getInternalApiClass(){return window.SpeechRecognition||window.webkitSpeechRecognition}static isSupported(){return B._getInternalApiClass()!==void 0}_subscribeEvents(){this._internalApi.addEventListener("result",this.onResult.bind(this)),this._internalApi.addEventListener("speechend",this.onSpeechEnd.bind(this))}_unsubscribeEvents(){this._internalApi.removeEventListener("result",this.onResult),this._internalApi.removeEventListener("speechend",this.onSpeechEnd)}init(x){const f=B._getInternalApiClass();this._internalApi=V.create(f),this._internalApi.continuous=!0,this._internalApi.lang=x.lang||"en-US",this._subscribeEvents()}onResult(x){const{resultIndex:f,results:j}=x,z=j[f][0];if(!z)throw new Error("No results to transcript");this.speechResult.next(z.transcript)}onSpeechEnd(){this.speechEnd.next()}destroy(){this._unsubscribeEvents(),this._internalApi=null}startRecognition(){this._internalApi.start()}stopRecognition(){this._internalApi.stop()}static{this.\u0275fac=function(f){return new(f||B)}}static{this.\u0275prov=_.\u0275\u0275defineInjectable({token:B,factory:B.\u0275fac})}}var Q=h(73436);class Se{get messages$(){return this._messages$}constructor(x,f){this._ngZone=f;const j=new P.Subject;this._messages$=j.pipe(this._runInZone(this._ngZone)),this._broadcastChannel=new Q.BroadcastChannel(x),this._broadcastChannel.onmessage=z=>j.next(z)}_runInZone(x){return f=>new P.Observable(j=>{f.subscribe(z=>x.run(()=>j.next(z)))})}publish(x){return(0,P.from)(this._broadcastChannel.postMessage(x))}}class He{constructor(x){this._ngZone=x}createInstance(x){return new Se(x,this._ngZone)}static{this.\u0275fac=function(f){return new(f||He)(_.\u0275\u0275inject(_.NgZone))}}static{this.\u0275prov=_.\u0275\u0275defineInjectable({token:He,factory:He.\u0275fac,providedIn:"root"})}}class _t{static toColdObservable(x){return new Observable(f=>{x().subscribe(z=>{f.next(z),f.complete()})})}}class y{log(x,f,...j){console.log(x,...j)}warn(x,f,...j){console.warn(x,...j)}error(x,f,...j){console.error(x,...j)}exception(x,f,...j){(console.exception||console.error)(x,...j)}static{this.\u0275fac=function(f){return new(f||y)}}static{this.\u0275prov=_.\u0275\u0275defineInjectable({token:y,factory:y.\u0275fac})}}const fe={dataAccess:"data-access",feature:"feature",ui:"ui",util:"util",components:"components",deprecated:"deprecated"},vi={studioFree:"studio-free",studioEnterprise:"studio-enterprise",sdk:"sdk"};class rt{constructor(x,f,j=null){this._injector=x,this._registrationMap=f,this._defaultInstanceType=j}_getInstance(x,f){return f?"injectable"in f&&f.injectable!=null?this._injector.get(f.injectable):"useFactory"in f&&typeof f.useFactory=="function"?f.useFactory(x):"useValue"in f?f.useValue:null:null}_getDefaultInstance(x){return this._getInstance(x,this._defaultInstanceType)}_getInstanceByType(x){if(this._registrationMap.has(x)){const f=this._registrationMap.get(x);return this._getInstance(x,f)}}_getInstanceByPredicate(x){for(const[f,j]of this._registrationMap)if(typeof f=="function"&&f(x))return this._getInstance(x,j)}create(x=null){return x==null?this._getDefaultInstance(x):this._getInstanceByType(x)??this._getInstanceByPredicate(x)??this._getDefaultInstance(x)}static{this.\u0275fac=function(f){_.\u0275\u0275invalidFactory()}}static{this.\u0275prov=_.\u0275\u0275defineInjectable({token:rt,factory:rt.\u0275fac,providedIn:"root"})}}var cn=h(28399);class ir{static _createMappings(x){const f=new Map;return x=x??[],x.forEach(j=>{const z=j.predicate,_e=(0,cn.omit)(j,"predicate");f.set(z,_e)}),f}static create(x){const{mappings:f,default:j,token:z}=x??{};return{provide:z,useFactory:_e=>{const $=this._createMappings(f);return new rt(_e,$,j)},deps:[_.Injector]}}}class sr{setNext(x){return this.nextHandler=x,x}handle(x){if(this.nextHandler)return this.nextHandler.handle(x)}}function at(F){return Array.isArray(F)?F:[F]}function Ii(F,x){return x.forEach(({replaceMacros:f,replaceValue:j})=>{F=F.map(z=>z===f?j??"":z)}),F}function wi(F,x){if(!F)return"";if(!x)return F;let f=[F];return x=at(x),f=ot(f,x),f=Ii(f,x),f.join("")}function ot(F,x){if(!F)return[];let f=at(F);if(!x)return f;const j=at(x),z=j.map(({replaceMacros:_e})=>_e);return j.forEach(({searchValue:_e,replaceMacros:$})=>{if(_e&&$){const Tt=new RegExp(`(${$})`,"g"),Xl=f.map(Ke=>z.includes(Ke)?Ke:Ke.split(_e).join($).split(Tt));f=(0,cn.flatten)(Xl)}}),f}var rr=h(4930);function yt(F){return function(x){Reflect.defineMetadata("requestType",F.requestType,x)}}function ar(F){return x=>{const f=x.pipe(share()),j=f.pipe(tap(F),take(1));return concat(j,f)}}function Ct(F){return x=>x.pipe(concatMap((f,j)=>F(f,j).pipe(map(z=>[f,z]))))}function q(F){return x=>x.pipe((0,i.mergeMap)((f,j)=>F(f,j).pipe((0,i.map)(z=>[f,z]))))}function w(F){return x=>x.pipe((0,i.mergeMap)((f,j)=>F(f,j).pipe((0,i.map)(()=>f))))}function A(F){return x=>x.pipe((0,i.switchMap)((f,j)=>F(f,j).pipe((0,i.map)(z=>[f,z]))))}function N(F){return x=>x.pipe((0,i.switchMap)((f,j)=>F(f,j).pipe((0,i.map)(()=>f))))}function K(F){return x=>F?new P.Observable(f=>{const j=$=>F.run(()=>f.next($)),z=$=>F.run(()=>f.error($)),_e=()=>F.run(()=>f.complete());return x.subscribe({next:j,error:z,complete:_e})}):x}function oe(F){return x=>F?new Observable(f=>{const j=$=>F.runOutsideAngular(()=>f.next($)),z=$=>F.runOutsideAngular(()=>f.error($)),_e=()=>F.runOutsideAngular(()=>f.complete());return x.subscribe({next:j,error:z,complete:_e})}):x}var Pe=h(23710);class ke{static initialize(){Pe.config({disableDefaultAlphabetLength:!0,disableDefaultIdLength:!0,idLength:7}),Pe.characters("0123456789abcdefghijklmnopqrstuvwxyz")}static generateUnique(x,f="",j="_"){const z=new RegExp(`^${f}`);return f+x.replace(z,"")+j+Pe.generate()}static getUniqueIncrementalName(x,f){if(!f.includes(x))return x;let j;for(let z=1;z<=f.length;z++)if(j=`${x}-${z}`,!f.includes(j))return j;return j}}ke.initialize();const Ei=new _.InjectionToken("An abstraction over window.navigator object",{factory:()=>window.navigator,providedIn:"root"});var E=h(6530);const or=new _.InjectionToken("CURRENT_TAB_ID_TOKEN"),xi={provide:or,useValue:(0,E.qv)()},We=new _.InjectionToken("Dialog token"),bt=new _.InjectionToken("WindowToken",{providedIn:"root",factory:le});function le(){return window}const un={provide:bt,useFactory:le};class dn{constructor(x){this._window=x,this._hasFocus=!1,this._window.addEventListener("focus",()=>{this._hasFocus=!0}),this._window.addEventListener("blur",()=>{this._hasFocus=!1})}_getIsDocumentVisible(){return document.visibilityState!=="hidden"}get hasFocus(){return this._hasFocus}get isActive(){return this._getIsDocumentVisible()}focus(){this._window.focus()}static{this.\u0275fac=function(f){return new(f||dn)(_.\u0275\u0275inject(bt))}}static{this.\u0275prov=_.\u0275\u0275defineInjectable({token:dn,factory:dn.\u0275fac,providedIn:"root"})}}var X=h(3633);class Zt{constructor(x){this._injector=x}defineComponent(x,f,j=null){const z=(0,X.createCustomElement)(f,{injector:j||this._injector});customElements.get(x)||customElements.define(x,z)}static{this.\u0275fac=function(f){return new(f||Zt)(_.\u0275\u0275inject(_.Injector))}}static{this.\u0275prov=_.\u0275\u0275defineInjectable({token:Zt,factory:Zt.\u0275fac,providedIn:"root"})}}function lr(F,x){return F.creatio.tabId=x,(0,P.of)(void 0)}const On={provide:_.APP_INITIALIZER,multi:!0,useFactory:(F,x)=>()=>lr(F,x),deps:[bt,or]},hn=new _.InjectionToken("LOCAL_STORAGE_SERVICE_CONFIG");class Te{static forRoot(x={}){return{ngModule:Te,providers:[{provide:hn,useValue:x}]}}static{this.\u0275fac=function(f){return new(f||Te)}}static{this.\u0275mod=_.\u0275\u0275defineNgModule({type:Te})}static{this.\u0275inj=_.\u0275\u0275defineInjector({})}}const Vn="LOCAL_STORAGE_NOT_SUPPORTED";class $e{constructor(x={}){this._isSupported=!1,this._prefix="ls",this._storageType="localStorage";const{prefix:f,storageType:j}=x||{};f!=null&&this._setPrefix(f),j!=null&&this._setStorageType(j),this._isSupported=this._checkSupport()}_deriveKey(x){return`${this._prefix}${x}`}_checkSupport(){try{const x=this._storageType in window&&window[this._storageType]!==null;if(x){this._webStorage=window[this._storageType];const f=this._deriveKey(`__${Math.round(Math.random()*1e7)}`);this._webStorage.setItem(f,""),this._webStorage.removeItem(f)}return x}catch(x){return console.error(x.message),!1}}_setPrefix(x){this._prefix=x;const f=".";this._prefix&&!this._prefix.endsWith(f)&&(this._prefix=this._prefix?`${this._prefix}${f}`:"")}_setStorageType(x){this._storageType=x}get(x){if(!this._isSupported)return console.warn(Vn),null;const f=this._webStorage?this._webStorage.getItem(this._deriveKey(x)):null;if(!f||f==="null")return null;try{return JSON.parse(f)}catch{return null}}set(x,f){const j=f===void 0?null:JSON.stringify(f);if(!this._isSupported)return console.warn(Vn),!1;try{this._webStorage&&this._webStorage.setItem(this._deriveKey(x),j)}catch(z){return console.error(z.message),!1}return!0}remove(...x){let f=!0;return x.forEach(j=>{this._isSupported||(console.warn(Vn),f=!1);try{this._webStorage.removeItem(this._deriveKey(j))}catch(z){console.error(z.message),f=!1}}),f}static{this.\u0275fac=function(f){return new(f||$e)(_.\u0275\u0275inject(hn,8))}}static{this.\u0275prov=_.\u0275\u0275defineInjectable({token:$e,factory:$e.\u0275fac,providedIn:"root"})}}var xt=h(73308);class Ye{playFromSource(x,f=!1){return(0,xt.A)(function*(){const j=new Audio(x),z=j.play();if(z!==void 0)try{yield z}catch(_e){if(j.muted=!0,f)throw _e}})()}static{this.\u0275fac=function(f){return new(f||Ye)}}static{this.\u0275prov=_.\u0275\u0275defineInjectable({token:Ye,factory:Ye.\u0275fac,providedIn:"root"})}}var St;(function(F){F.Small="small",F.Medium="medium",F.Large="large",F.XL="xl",F.XXL="xxl"})(St||(St={}));class Ln{constructor(x,f){this._window=x,this._document=f,this._minScreenSize=600,this._mediumScreenSize=790,this._largeScreenSize=1079,this._xlScreenSize=1280,this._screenSizeChanges$=new P.BehaviorSubject(this._currentScreenSizeType),this._changeScreenSizeType()}get currentScreenSizeType(){return this._currentScreenSizeType}get currentScreenSize(){return this._currentScreenSize}get isSmallScreen(){return this._currentScreenSizeType===St.Small}_setScreenSizeTypeAttribute(x){this._document.body.setAttribute("screen-size-type",x)}_getScreenSizeType(){return this._currentScreenSize=this._window.innerWidth,this._currentScreenSize<=this._minScreenSize?St.Small:this._currentScreenSize<=this._mediumScreenSize?St.Medium:this._currentScreenSize<=this._largeScreenSize?St.Large:this._currentScreenSize<=this._xlScreenSize?St.XL:St.XXL}_changeScreenSizeType(){const x=this._getScreenSizeType();return x===this._currentScreenSizeType?!1:(this._currentScreenSizeType=x,this._setScreenSizeTypeAttribute(x),!0)}screenSizeTypeChangeNotifier(){return this._screenSizeChanges$.asObservable()}refreshCurrentScreenSizeType(){this._changeScreenSizeType()&&this._screenSizeChanges$.next(this._currentScreenSizeType)}static{this.\u0275fac=function(f){return new(f||Ln)(_.\u0275\u0275inject(bt),_.\u0275\u0275inject(g.DOCUMENT))}}static{this.\u0275prov=_.\u0275\u0275defineInjectable({token:Ln,factory:Ln.\u0275fac,providedIn:"root"})}}const Io=new _.InjectionToken("DESKTOP_NOTIFICATION_SENDER_PROVIDER");class wo{static get isMobile(){const x=window.navigator.userAgent;return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|mobile|CriOS/i.test(x)}}var Eo;(function(F){F[F.StayLoggedIn=0]="StayLoggedIn",F[F.Exit=1]="Exit",F[F.NotSet=2]="NotSet"})(Eo||(Eo={}));var xo=h(93277),cr=h(79772);class pn{constructor(){this._liveAnnouncer=(0,_.inject)(xo.LiveAnnouncer),this._translateService=(0,_.inject)(cr.TranslateService)}announce(x,f,j=200){var z=this;return(0,xt.A)(function*(){const _e=z._translateService.instant(x);yield z._liveAnnouncer.announce(_e,f,j)})()}static{this.\u0275fac=function(f){return new(f||pn)}}static{this.\u0275prov=_.\u0275\u0275defineInjectable({token:pn,factory:pn.\u0275fac,providedIn:"root"})}}},67102:(R,H,h)=>{h.d(H,{W:()=>ne,C:()=>W});var g=h(59131),_=h(56711),P=h(79273),i=h(65122),b=h(20920),k=h(27875),m=h(50304),T=h(73308),M=h(81299),u=h(5175),l=h(10316),v=h(37049),ae=h(66828),ie=h(66639),he=h(62179),Me=h(46572),de=h(1086),pe=h(21988),S=h(149);class D{static{this.supportedLanguages={[m.F.Markdown]:{lang:he.markdown,parser:he.markdownLanguage.parser},[m.F.Javascript]:{lang:v.javascript,parser:v.javascriptLanguage.parser},[m.F.Less]:{lang:ie.less,parser:ie.lessLanguage.parser},[m.F.Css]:{lang:ie.less,parser:l.cssLanguage.parser},[m.F.Sql]:{lang:Me.sql,parser:Me.StandardSQL.language.parser},[m.F.PgSql]:{lang:Me.sql,parser:Me.StandardSQL.language.parser},[m.F.SqlServer]:{lang:Me.sql,parser:Me.StandardSQL.language.parser},[m.F.Json]:{lang:ae.json,parser:ae.jsonLanguage.parser},[m.F.Csharp]:{lang:S.csharp,parser:S.csharpLanguage.parser},[m.F.Xml]:{lang:de.xml,parser:de.xmlLanguage.parser},[m.F.Http]:{lang:de.xml,parser:he.markdownLanguage.parser}}}static lintCode(V,B,Q={}){var Se=this;return(0,T.A)(function*(){if(B===m.F.Javascript)return yield Se.lintJavaScript(Q,V);if(B===m.F.Json)return Se.lintJson(V);const He=D.supportedLanguages[B]?.parser;if(!He)return console.warn(`No parser found for language: ${B}`),[];const _t=[];return He.parse(V.state.doc.toString()).iterate({enter:({type:fe,from:vi,to:rt})=>{fe.isError&&_t.push({from:vi,to:rt,severity:"warning",message:"Uncompleted condition"})}}),_t})()}static lintJson(V){const B=[];return(0,ae.jsonParseLinter)()(V).forEach(Q=>{B.push({from:Q.from,to:Q.to,severity:"error",message:Q.message})}),B}static lintJavaScript(V,B){return(0,T.A)(function*(){const{Linter:Q}=yield h.e(2277).then(h.t.bind(h,42277,23));return(0,v.esLint)(new Q,V)(B)})()}static{this.onChangeExtension=V=>k.EditorView.updateListener.of(B=>{if(!B.docChanged)return;const Q=B.state.doc.toString();V(Q)})}static{this.defaultExtensions=()=>[(0,P.syntaxHighlighting)(P.defaultHighlightStyle,{fallback:!0}),(0,i.lintGutter)(),(0,k.highlightSpecialChars)(),(0,k.highlightActiveLineGutter)(),(0,k.highlightActiveLine)(),(0,pe.highlightSelectionMatches)(),(0,M.autocompletion)(),(0,P.bracketMatching)(),(0,M.closeBrackets)(),(0,P.foldGutter)(),(0,k.lineNumbers)(),(0,k.rectangularSelection)(),k.EditorView.lineWrapping,(0,u.history)()]}static{this.defaultKeyMaps=()=>[...i.lintKeymap,...pe.searchKeymap,...u.historyKeymap,...u.defaultKeymap,...M.completionKeymap,u.indentWithTab,{key:"Alt-g",run:pe.gotoLine},{key:"Ctrl-Shift-f",run:pe.replaceNext},{key:"Ctrl-Shift-r",run:pe.replaceAll},{key:"Ctrl-Shift-z",run:u.redo},{key:"Ctrl-y",run:u.deleteLine},{key:"Ctrl-Space",run:M.startCompletion}]}}const L=["host"];var W;(function(J){J.CR="\r",J.LF=`
`,J.CRLF=`\r
`})(W||(W={}));class ne{set value(V){typeof V=="string"&&this._editorView?.state.doc.toString()!==V&&(this._value=V,this._editorView?.dispatch({changes:{from:0,to:this._editorView.state.doc.length,insert:this._value}}))}get value(){return this._value}get lineNumbers(){return this._editorView.state.doc.lines}set editable(V){this._editable!==V&&(this._editable=V,this._editorView?.dispatch({effects:this._editableCompartment.reconfigure(k.EditorView.editable.of(V))}))}set readOnly(V){this._readOnly!==V&&(this._readOnly=V,this._editorView?.dispatch({effects:this._readonlyCompartment.reconfigure(b.EditorState.readOnly.of(V))}))}set language(V){if(V||(V=m.F.Markdown),this._language!==V){if(!D.supportedLanguages[V])throw new Error(`Unsupported language: ${V}`);this._language=V,this._editorView?.dispatch({effects:this._languageCompartment.reconfigure(D.supportedLanguages[V].lang())})}}set lineSeparator(V){this._lineSeparator!==V&&(this._lineSeparator=V,this._editorView?.dispatch({effects:this._lineSeparatorCompartment.reconfigure(b.EditorState.lineSeparator.of(this._lineSeparator))}))}constructor(V){this._element=V,this._value="",this._language=m.F.Javascript,this._languageCompartment=new b.Compartment,this._editable=!0,this._editableCompartment=new b.Compartment,this._readOnly=!1,this._readonlyCompartment=new b.Compartment,this._lineSeparator=W.LF,this._lineSeparatorCompartment=new b.Compartment,this._lineWrappedCompartment=new b.Compartment,this.keyBinding=[],this.languageOptions={},this.indentUnitValue="  ",this.valueChanged=new g.EventEmitter,this.diagnostics=new g.EventEmitter,this.onChange=B=>{},this.onTouched=()=>{}}_onEditorValueChanged(V){this.value=V,this.onChange(V),this.valueChanged.emit(V),this.onTouched()}_initEditorView(){return new k.EditorView({doc:this.value,extensions:[this._lineSeparatorCompartment.of(b.EditorState.lineSeparator.of(this._lineSeparator)),this._languageCompartment.of(D.supportedLanguages[this._language].lang()),this._editableCompartment.of(k.EditorView.editable.of(this._editable)),this._readonlyCompartment.of(b.EditorState.readOnly.of(this._readOnly)),(0,i.linter)(V=>{const B=D.lintCode(V,this._language,this.languageOptions);return B.then(Q=>{this.diagnostics.emit(Q)}),B}),D.onChangeExtension(this._onEditorValueChanged.bind(this)),...D.defaultExtensions(),k.keymap.of([...D.defaultKeyMaps(),...this.keyBinding]),this._lineWrappedCompartment.of(k.EditorView.lineWrapping),P.indentUnit.of(this.indentUnitValue),k.EditorView.domEventHandlers({paste:V=>{this._onPaste&&this._onPaste(V)}})],parent:this.hostContainer?.nativeElement})}_adjustCodeEditorContent(){this._element.nativeElement.querySelector(".cm-content")?.setAttribute("aria-label","CodeEditorContent")}ngAfterViewInit(){this._editorView=this._initEditorView(),this._adjustCodeEditorContent()}ngOnDestroy(){this._editorView?.destroy()}writeValue(V){typeof V=="string"&&(this.value=V.toString())}registerOnChange(V){this.onChange=V}registerOnTouched(V){this.onTouched=V}registerOnPaste(V){this._onPaste=V}static{this.\u0275fac=function(B){return new(B||ne)(g.\u0275\u0275directiveInject(g.ElementRef))}}static{this.\u0275cmp=g.\u0275\u0275defineComponent({type:ne,selectors:[["ts-codemirror"]],viewQuery:function(B,Q){if(B&1&&g.\u0275\u0275viewQuery(L,5),B&2){let Se;g.\u0275\u0275queryRefresh(Se=g.\u0275\u0275loadQuery())&&(Q.hostContainer=Se.first)}},inputs:{value:"value",editable:"editable",readOnly:"readOnly",language:"language",lineSeparator:"lineSeparator",keyBinding:"keyBinding",languageOptions:"languageOptions",indentUnitValue:"indentUnitValue"},outputs:{valueChanged:"valueChanged",diagnostics:"diagnostics"},features:[g.\u0275\u0275ProvidersFeature([{provide:_.NG_VALUE_ACCESSOR,useExisting:(0,g.forwardRef)(()=>ne),multi:!0}])],decls:3,vars:0,consts:[["host",""],[1,"ts-codemirror"],[1,"ts-codemirror-container"]],template:function(B,Q){B&1&&(g.\u0275\u0275elementStart(0,"div",1),g.\u0275\u0275element(1,"div",2,0),g.\u0275\u0275elementEnd())},styles:[".ts-codemirror[_ngcontent-%COMP%]{position:relative;background-color:#fff;height:100%}.ts-codemirror[_ngcontent-%COMP%]   .ts-codemirror-container[_ngcontent-%COMP%]{height:100%}.ts-codemirror[_ngcontent-%COMP%]   .ts-codemirror-container[_ngcontent-%COMP%]     .cm-editor{height:100%}.ts-codemirror[_ngcontent-%COMP%]   .ts-codemirror-container[_ngcontent-%COMP%]     .cm-editor .cm-specialChar{display:none}"],changeDetection:0})}}},50304:(R,H,h)=>{h.d(H,{F:()=>g});var g;(function(_){_.Csharp="text/x-csharp",_.Javascript="text/javascript",_.Json="application/ld+json",_.Css="text/css",_.Less="text/x-less",_.Sql="text/x-sql",_.SqlServer="text/x-mssql",_.PgSql="text/x-pgsql",_.Xml="application/xml",_.Http="message/http",_.Markdown="text/x-markdown"})(g||(g={}))},81398:(R,H,h)=>{h.d(H,{P:()=>i});var g=h(59131),_=h.n(g),P=h(91592);class i extends P.X{constructor(){super(...arguments),this.valueChange=new g.EventEmitter}setRecordValue(k){this.record[this.columnDataSchema.name]=k}setValue(k){this.setRecordValue(k),this.valueChange.emit(k)}static{this.\u0275fac=(()=>{let k;return function(T){return(k||(k=g.\u0275\u0275getInheritedFactory(i)))(T||i)}})()}static{this.\u0275dir=g.\u0275\u0275defineDirective({type:i,outputs:{valueChange:"valueChange"},features:[g.\u0275\u0275InheritDefinitionFeature]})}}},91592:(R,H,h)=>{h.d(H,{X:()=>P});var g=h(59131),_=h.n(g);class P{constructor(){this.getRegisteredEvents=()=>[]}set eventHandlers(b){this._eventHandlers=b,this._validateEventHandlers()}get eventHandlers(){return this._eventHandlers}_stringify(b){const k=[()=>JSON.stringify(b),()=>b.toString()];for(let m=0;m<k.length;m++){const T=k[m];try{return T()}catch{}}return""}_checkEventCanBeHandled(b){const k=this.getRegisteredEvents();if(!k||k.some(M=>M.name===b))return;const m=k.map(M=>M.name).join(", ");let T=`Handler for event "${b}" can not be specified because the event was not registered in table cell class. Registered table column events to subscribe: ${m}.`;throw this.columnDataSchema&&(T+=` Column name: "${this.columnDataSchema.name}".`),new Error(T)}_checkHandlerIsFunction(b,k){if(typeof k!="function")throw new TypeError(`Handler for event with name "${b}" must be a function, but actual is"${this._stringify(k)}".`)}_validateEventHandlers(){if(!this.eventHandlers)return;Object.keys(this.eventHandlers).forEach(k=>{this._checkEventCanBeHandled(k),this._checkHandlerIsFunction(k,this.eventHandlers[k])})}_checkEventDataType(b,k){return b instanceof k||b.constructor===k}_validateFiringEvent(b,k){const m=this._registeredEvents.find(M=>M.name===b);if(!m)throw new Error(`Event with name "${b}" is not registered in the cell class and can not be fired.`);const T=m.dataType;if(k&&(!T||!this._checkEventDataType(k,T)))throw new TypeError(`Type of the data in the event "${b}" must be "${T}", but actual data is "${this._stringify(k)}".`)}_getValidEventHandler(b){const k=this.eventHandlers&&this.eventHandlers[b];if(k)return this._checkHandlerIsFunction(b,k),k}isEmpty(){return!(this.columnDataSchema&&this.record)}fireEvent(b,k){this._validateFiringEvent(b,k);const m=this._getValidEventHandler(b);return m&&m(this.record,k)}ngOnInit(){this._registeredEvents=this.getRegisteredEvents()}getValue(){const b=this.record[this.columnDataSchema.name],k=this.columnDataSchema.formatter;return k?k(b,this.record):b}static{this.\u0275fac=function(k){return new(k||P)}}static{this.\u0275dir=g.\u0275\u0275defineDirective({type:P,inputs:{columnDataSchema:"columnDataSchema",record:"record",eventHandlers:"eventHandlers"}})}}},75956:(R,H,h)=>{h.d(H,{U:()=>ne});var g=h(86464),_=h(47149),P=h(71260),i=h(91592),b=h(59131),k=h.n(b),m=h(23092),T=h(40297),M=h.n(T),u=h(53135),l=h.n(u),v=h(27397),ae=h.n(v);const ie=J=>({$implicit:J});function he(J,V){if(J&1&&(b.\u0275\u0275elementContainerStart(0),b.\u0275\u0275elementStart(1,"a",7),b.\u0275\u0275text(2),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementContainerEnd()),J&2){const B=b.\u0275\u0275nextContext().$implicit,Q=b.\u0275\u0275nextContext(2).$implicit,Se=b.\u0275\u0275nextContext(2);b.\u0275\u0275advance(),b.\u0275\u0275property("routerLink",Se.getLinkUrl(B))("target",Se.getLinkTarget(B)),b.\u0275\u0275advance(),b.\u0275\u0275textInterpolate(Se.formatTextValue(Q))}}function Me(J,V){if(J&1){const B=b.\u0275\u0275getCurrentView();b.\u0275\u0275elementStart(0,"a",8),b.\u0275\u0275listener("click",function(Se){b.\u0275\u0275restoreView(B);const He=b.\u0275\u0275nextContext().$implicit,_t=b.\u0275\u0275nextContext(4);return b.\u0275\u0275resetView(_t.onLinkClick(Se,He))}),b.\u0275\u0275text(1),b.\u0275\u0275elementEnd()}if(J&2){const B=b.\u0275\u0275nextContext().$implicit,Q=b.\u0275\u0275nextContext(2).$implicit,Se=b.\u0275\u0275nextContext(2);b.\u0275\u0275property("href",Se.getLinkUrl(B),b.\u0275\u0275sanitizeUrl)("target",Se.getLinkTarget(B)),b.\u0275\u0275advance(),b.\u0275\u0275textInterpolate(Se.formatTextValue(Q))}}function de(J,V){if(J&1&&(b.\u0275\u0275elementContainerStart(0),b.\u0275\u0275template(1,he,3,3,"ng-container",6)(2,Me,2,3,"ng-template",null,2,b.\u0275\u0275templateRefExtractor),b.\u0275\u0275elementContainerEnd()),J&2){const B=V.$implicit,Q=b.\u0275\u0275reference(3),Se=b.\u0275\u0275nextContext(4);b.\u0275\u0275advance(),b.\u0275\u0275property("ngIf",Se.getIsRouterLink(B))("ngIfElse",Q)}}function pe(J,V){if(J&1&&(b.\u0275\u0275elementStart(0,"span"),b.\u0275\u0275text(1),b.\u0275\u0275elementEnd()),J&2){const B=b.\u0275\u0275nextContext(2).$implicit,Q=b.\u0275\u0275nextContext(2);b.\u0275\u0275advance(),b.\u0275\u0275textInterpolate(Q.formatTextValue(B))}}function S(J,V){if(J&1&&(b.\u0275\u0275elementContainerStart(0),b.\u0275\u0275template(1,de,4,2,"ng-container",6)(2,pe,2,1,"ng-template",null,1,b.\u0275\u0275templateRefExtractor),b.\u0275\u0275elementContainerEnd()),J&2){const B=b.\u0275\u0275reference(3),Q=b.\u0275\u0275nextContext(3);b.\u0275\u0275advance(),b.\u0275\u0275property("ngIf",Q.getLink(Q.record))("ngIfElse",B)}}function D(J,V){if(J&1&&b.\u0275\u0275element(0,"mat-checkbox",9),J&2){const B=b.\u0275\u0275nextContext().$implicit;b.\u0275\u0275property("checked",!!B)}}function L(J,V){if(J&1&&b.\u0275\u0275template(0,S,4,2,"ng-container",3)(1,D,1,1,"mat-checkbox",5),J&2){const B=b.\u0275\u0275nextContext(2);b.\u0275\u0275property("ngIf",B.isDisplayedAsText()),b.\u0275\u0275advance(),b.\u0275\u0275property("ngIf",B.isDisplayedAsBoolean())}}function W(J,V){if(J&1&&(b.\u0275\u0275elementContainerStart(0),b.\u0275\u0275template(1,L,2,2,"ng-template",4,0,b.\u0275\u0275templateRefExtractor),b.\u0275\u0275elementContainerEnd()),J&2){const B=b.\u0275\u0275reference(2),Q=b.\u0275\u0275nextContext();b.\u0275\u0275advance(),b.\u0275\u0275property("ngTemplateOutletContext",b.\u0275\u0275pureFunction1(2,ie,Q.getValue()))("ngTemplateOutlet",B)}}class ne extends i.X{constructor(V,B){super(),this.numberUtils=B,this._textValueTypes=[g.r.Guid].concat(_.P.DateTime).concat(_.P.Number).concat(_.P.Text).concat(_.P.Lookup),this.getRegisteredEvents=()=>[{name:"click"}],this.userCulture=V.cultureInfo.sysCultureName}getLink(V){return this.columnDataSchema.linkGenerator?this.columnDataSchema.linkGenerator(V):""}getLinkUrl(V){return typeof V=="string"?V:V.url}getLinkTarget(V){const B="_self";return typeof V=="string"?B:V.target||B}getIsRouterLink(V){return V?typeof V=="string"?!0:V.useRouterLink||!1:!1}onLinkClick(V,B){B&&typeof B!="string"&&B.preventDefaultClick===!0&&(V.preventDefault(),this.fireEvent("click"))}isDisplayedAsText(){return!this.columnDataSchema.valueType||this._textValueTypes.indexOf(this.columnDataSchema.valueType)!==-1}isDisplayedAsBoolean(){return this.columnDataSchema.valueType===g.r.Boolean}formatTextValue(V){if(V==null)return"";switch(this.columnDataSchema.valueType){case g.r.Date:return V.toLocaleDateString(this.userCulture);case g.r.Time:return V.toLocaleTimeString(this.userCulture);case g.r.DateTime:return V.toLocaleString(this.userCulture);case g.r.Integer:return this.numberUtils.formatNumberValue(V,new P.V_({precision:0}));case g.r.Float:case g.r.Money:return this.numberUtils.formatNumberValue(V);case g.r.FLOAT1:return this.numberUtils.formatNumberValue(V,new P.V_({precision:1}));case g.r.FLOAT2:return this.numberUtils.formatNumberValue(V,new P.V_({precision:2}));case g.r.FLOAT3:return this.numberUtils.formatNumberValue(V,new P.V_({precision:3}));case g.r.FLOAT4:return this.numberUtils.formatNumberValue(V,new P.V_({precision:4}));case g.r.FLOAT8:return this.numberUtils.formatNumberValue(V,new P.V_({precision:8}));case g.r.IMAGELOOKUP:case g.r.Lookup:{const Q=V;return Q?.displayValue||Q?.value}case g.r.LOCALIZABLE_STRING:{const Q=V;return Q&&Q.getValue(this.userCulture)}default:return V}}static{this.\u0275fac=function(B){return new(B||ne)(b.\u0275\u0275directiveInject(m.oq),b.\u0275\u0275directiveInject(P.B4))}}static{this.\u0275cmp=b.\u0275\u0275defineComponent({type:ne,selectors:[["ts-table-cell"]],features:[b.\u0275\u0275InheritDefinitionFeature],decls:1,vars:1,consts:[["t",""],["textBlock",""],["hyperlinkBlock",""],[4,"ngIf"],[3,"ngTemplateOutletContext","ngTemplateOutlet"],["disabled","true",3,"checked",4,"ngIf"],[4,"ngIf","ngIfElse"],[3,"routerLink","target"],[3,"click","href","target"],["disabled","true",3,"checked"]],template:function(B,Q){B&1&&b.\u0275\u0275template(0,W,3,4,"ng-container",3),B&2&&b.\u0275\u0275property("ngIf",!Q.isEmpty())},dependencies:[T.NgIf,T.NgTemplateOutlet,u.MatLegacyCheckbox,v.RouterLink],encapsulation:2})}}},56911:(R,H,h)=>{h.d(H,{K:()=>g});var g;(function(_){_.None="none",_.Intermediate="intermediate",_.All="all"})(g||(g={}))},14276:(R,H,h)=>{h.d(H,{B:()=>J});var g=h(49391),_=h.n(g),P=h(40297),i=h.n(P),b=h(52989),k=h.n(b),m=h(23023),T=h.n(m),M=h(53135),u=h.n(M),l=h(14715),v=h.n(l),ae=h(17499),ie=h.n(ae),he=h(27397),Me=h.n(he),de=h(79772),pe=h.n(de),S=h(6900),D=h.n(S),L=h(75956),W=h(59131),ne=h.n(W);class J{static{this.\u0275fac=function(Q){return new(Q||J)}}static{this.\u0275mod=W.\u0275\u0275defineNgModule({type:J})}static{this.\u0275inj=W.\u0275\u0275defineInjector({imports:[S.AngularTreeGridModule,P.CommonModule,g.DragDropModule,m.MatLegacyButtonModule,b.MatIconModule,M.MatLegacyCheckboxModule,ae.MatSortModule,l.MatLegacyTableModule,he.RouterModule,de.TranslateModule]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&W.\u0275\u0275setNgModuleScope(J,{declarations:[L.U],imports:[S.AngularTreeGridModule,P.CommonModule,g.DragDropModule,m.MatLegacyButtonModule,b.MatIconModule,M.MatLegacyCheckboxModule,ae.MatSortModule,l.MatLegacyTableModule,he.RouterModule,de.TranslateModule],exports:[L.U]})})()},13679:(R,H,h)=>{h.d(H,{v:()=>M});var g=h(59131),_=h.n(g),P=h(75956),i=h(91592),b=h(81398),k=h(28399),m=h.n(k);const T=["tableCell"];class M{constructor(){this.valueChange=new g.EventEmitter}_generateTableCell(l){this.tableCell.clear();const v=this.tableCell.createComponent(l),ae=v.instance;if(l!==P.U&&!(ae instanceof i.X))throw new TypeError("Value of property `cellComponentClass` must be a component class inherited from `BaseTableCellComponent`");return v}_updateTableCell(){const l=this.columnDataSchema.cellComponentClass||P.U;(!this._cellComponentRef||!(this._cellComponentRef.instance instanceof l))&&(this._cellComponentRef=this._generateTableCell(l));const v=this._cellComponentRef.instance;v.columnDataSchema=this.columnDataSchema,v.record=this.record,v.eventHandlers=this.eventHandlers,v instanceof b.P&&v.valueChange.subscribe(ae=>this.valueChange.emit(ae)),this._cellComponentRef.changeDetectorRef.detectChanges()}ngOnChanges(l){!this.record||!this.columnDataSchema||!(l.record||l.columnDataSchema||l.eventHandlers&&!(0,k.isEqual)(l.eventHandlers.previousValue,l.eventHandlers.currentValue))||this._updateTableCell()}static{this.\u0275fac=function(v){return new(v||M)}}static{this.\u0275cmp=g.\u0275\u0275defineComponent({type:M,selectors:[["ts-table-cell-wrapper"]],viewQuery:function(v,ae){if(v&1&&g.\u0275\u0275viewQuery(T,7,g.ViewContainerRef),v&2){let ie;g.\u0275\u0275queryRefresh(ie=g.\u0275\u0275loadQuery())&&(ae.tableCell=ie.first)}},inputs:{columnDataSchema:"columnDataSchema",record:"record",eventHandlers:"eventHandlers"},outputs:{valueChange:"valueChange"},features:[g.\u0275\u0275NgOnChangesFeature],decls:2,vars:0,consts:[["tableCell",""]],template:function(v,ae){v&1&&g.\u0275\u0275element(0,"span",null,0)},encapsulation:2})}}},53707:(R,H,h)=>{h.d(H,{O:()=>Ct});var g=h(95567),_=h.n(g),P=h(62225),i=h.n(P),b=h(49391),k=h.n(b),m=h(59131),T=h.n(m),M=h(14715),u=h.n(M),l=h(17499),v=h.n(l),ae=h(86464),ie=h(56911),he=h(28399),Me=h.n(he),de=h(40297),pe=h.n(de),S=h(52989),D=h.n(S),L=h(53135),W=h.n(L),ne=h(13679);const J=()=>["expandableRow"];function V(q,w){if(q&1){const A=m.\u0275\u0275getCurrentView();m.\u0275\u0275elementStart(0,"th",11)(1,"mat-checkbox",12),m.\u0275\u0275listener("change",function(K){m.\u0275\u0275restoreView(A);const oe=m.\u0275\u0275nextContext(3);return m.\u0275\u0275resetView(K?oe.allRowsSelectToggle():null)}),m.\u0275\u0275elementEnd()()}if(q&2){const A=m.\u0275\u0275nextContext(3);m.\u0275\u0275advance(),m.\u0275\u0275styleProp("visibility",A.showSelectAllButton&&!A.isEmpty()?"visible":"hidden"),m.\u0275\u0275property("checked",A.isAllRowsCheckboxChecked())("indeterminate",A.isAllRowsCheckboxIntermediate())}}function B(q,w){q&1&&(m.\u0275\u0275elementContainerStart(0),m.\u0275\u0275template(1,V,2,4,"th",10),m.\u0275\u0275elementContainerEnd())}function Q(q,w){if(q&1){const A=m.\u0275\u0275getCurrentView();m.\u0275\u0275elementStart(0,"td",13)(1,"mat-checkbox",14),m.\u0275\u0275listener("click",function(K){const oe=m.\u0275\u0275restoreView(A).$implicit,Pe=m.\u0275\u0275nextContext(2);return m.\u0275\u0275resetView(Pe.onCheckboxClick(oe,K))})("change",function(){const K=m.\u0275\u0275restoreView(A).$implicit,oe=m.\u0275\u0275nextContext(2);return m.\u0275\u0275resetView(oe.recordSelectToggle(K))}),m.\u0275\u0275elementEnd()()}if(q&2){const A=w.$implicit,N=m.\u0275\u0275nextContext(2);m.\u0275\u0275advance(),m.\u0275\u0275property("checked",N.isRecordSelected(A))}}function Se(q,w){q&1&&m.\u0275\u0275element(0,"th",16)}function He(q,w){q&1&&(m.\u0275\u0275elementContainerStart(0),m.\u0275\u0275template(1,Se,1,0,"th",15),m.\u0275\u0275elementContainerEnd())}function _t(q,w){if(q&1){const A=m.\u0275\u0275getCurrentView();m.\u0275\u0275elementStart(0,"td",17)(1,"button",18),m.\u0275\u0275listener("click",function(K){const oe=m.\u0275\u0275restoreView(A).$implicit,Pe=m.\u0275\u0275nextContext(2);return m.\u0275\u0275resetView(Pe.toggleRowExpansion(oe,K))}),m.\u0275\u0275element(2,"mat-icon",19),m.\u0275\u0275elementEnd()()}if(q&2){const A=w.$implicit,N=m.\u0275\u0275nextContext(2);m.\u0275\u0275advance(),m.\u0275\u0275property("@rowExpanderTrigger",N.isRecordExpanded(A)?"expanded":"collapsed"),m.\u0275\u0275advance(),m.\u0275\u0275property("ngClass","row-expander-icon "+(N.isRecordExpanded(A)?"expanded":"collapsed"))}}function y(q,w){if(q&1&&(m.\u0275\u0275elementStart(0,"th",22)(1,"label"),m.\u0275\u0275text(2),m.\u0275\u0275elementEnd()()),q&2){const A=m.\u0275\u0275nextContext(3).$implicit,N=m.\u0275\u0275nextContext(2);m.\u0275\u0275property("disabled",!N.isColumnSortable(A))("ngClass",N.getColumnHeaderCssClass(A.valueType,A.span)),m.\u0275\u0275advance(2),m.\u0275\u0275textInterpolate(A.caption)}}function fe(q,w){q&1&&(m.\u0275\u0275elementContainerStart(0),m.\u0275\u0275template(1,y,3,3,"th",21),m.\u0275\u0275elementContainerEnd())}function vi(q,w){if(q&1){const A=m.\u0275\u0275getCurrentView();m.\u0275\u0275elementStart(0,"td",23)(1,"ts-table-cell-wrapper",24),m.\u0275\u0275listener("valueChange",function(K){const oe=m.\u0275\u0275restoreView(A).$implicit,Pe=m.\u0275\u0275nextContext(2).$implicit,ke=m.\u0275\u0275nextContext(2);return m.\u0275\u0275resetView(ke.onCellValueChange(oe,Pe,K))}),m.\u0275\u0275elementEnd()()}if(q&2){const A=w.$implicit,N=m.\u0275\u0275nextContext().$implicit,K=m.\u0275\u0275nextContext().$implicit,oe=m.\u0275\u0275nextContext(2);m.\u0275\u0275property("ngClass",oe.getValueTypeCssClass(K.valueType)),m.\u0275\u0275advance(),m.\u0275\u0275property("columnDataSchema",K)("record",A)("eventHandlers",oe.eventHandlers&&oe.eventHandlers[N])}}function rt(q,w){if(q&1&&(m.\u0275\u0275elementContainerStart(0,2),m.\u0275\u0275template(1,fe,2,0,"ng-container",3)(2,vi,2,4,"td",8),m.\u0275\u0275elementContainerEnd()),q&2){const A=w.$implicit,N=m.\u0275\u0275nextContext(3);m.\u0275\u0275propertyInterpolate("matColumnDef",A),m.\u0275\u0275advance(),m.\u0275\u0275property("ngIf",N.showHeader)}}function cn(q,w){if(q&1&&(m.\u0275\u0275elementContainerStart(0),m.\u0275\u0275template(1,rt,3,2,"ng-container",20),m.\u0275\u0275elementContainerEnd()),q&2){const A=w.$implicit;m.\u0275\u0275advance(),m.\u0275\u0275property("ngIf",A.name)}}function ir(q,w){if(q&1&&(m.\u0275\u0275elementStart(0,"td",23)(1,"div",25),m.\u0275\u0275element(2,"ts-table-cell-wrapper",26),m.\u0275\u0275elementEnd()()),q&2){const A=w.$implicit,N=m.\u0275\u0275nextContext(2);m.\u0275\u0275property("ngClass","expandable-cell-"+(N.isRecordExpanded(A)?"expanded":"collapsed")),m.\u0275\u0275attribute("colspan",N.columns.length),m.\u0275\u0275advance(),m.\u0275\u0275property("@expandableRowTrigger",N.isRecordExpanded(A)?"expanded":"collapsed"),m.\u0275\u0275advance(),m.\u0275\u0275property("columnDataSchema",N.dataSchema.expandableRow)("record",A)("eventHandlers",N.eventHandlers&&N.eventHandlers[N.dataSchema.expandableRow.name])}}function sr(q,w){q&1&&m.\u0275\u0275element(0,"tr",28)}function at(q,w){if(q&1&&(m.\u0275\u0275elementContainerStart(0),m.\u0275\u0275template(1,sr,1,0,"tr",27),m.\u0275\u0275elementContainerEnd()),q&2){const A=m.\u0275\u0275nextContext(2);m.\u0275\u0275advance(),m.\u0275\u0275property("matHeaderRowDef",A.columns)("matHeaderRowDefSticky",A.headerSticky)}}function Ii(q,w){if(q&1){const A=m.\u0275\u0275getCurrentView();m.\u0275\u0275elementStart(0,"tr",29),m.\u0275\u0275listener("click",function(){const K=m.\u0275\u0275restoreView(A).$implicit,oe=m.\u0275\u0275nextContext(2);return m.\u0275\u0275resetView(oe.onRowClick(K))})("dblclick",function(){const K=m.\u0275\u0275restoreView(A).$implicit,oe=m.\u0275\u0275nextContext(2);return m.\u0275\u0275resetView(oe.onRowDoubleClick(K))}),m.\u0275\u0275elementEnd()}if(q&2){const A=w.$implicit,N=w.even,K=m.\u0275\u0275nextContext(2);m.\u0275\u0275property("ngClass",K.getRowCssClass(A,N))("cdkDragData",A)("cdkDragBoundary",K.dragBoundarySelector)("cdkDragDisabled",!K.enableOrdering)}}function wi(q,w){q&1&&m.\u0275\u0275element(0,"tr",31)}function ot(q,w){q&1&&(m.\u0275\u0275elementStart(0,"div"),m.\u0275\u0275template(1,wi,1,0,"tr",30),m.\u0275\u0275elementEnd()),q&2&&(m.\u0275\u0275advance(),m.\u0275\u0275property("matRowDefColumns",m.\u0275\u0275pureFunction0(1,J)))}function rr(q,w){if(q&1){const A=m.\u0275\u0275getCurrentView();m.\u0275\u0275elementStart(0,"table",1),m.\u0275\u0275listener("matSortChange",function(K){m.\u0275\u0275restoreView(A);const oe=m.\u0275\u0275nextContext();return m.\u0275\u0275resetView(oe.onSortChange(K))})("cdkDropListDropped",function(K){m.\u0275\u0275restoreView(A);const oe=m.\u0275\u0275nextContext();return m.\u0275\u0275resetView(oe.onItemDrop(K))}),m.\u0275\u0275elementContainerStart(1,2),m.\u0275\u0275template(2,B,2,0,"ng-container",3)(3,Q,2,1,"td",4),m.\u0275\u0275elementContainerEnd(),m.\u0275\u0275elementContainerStart(4,2),m.\u0275\u0275template(5,He,2,0,"ng-container",3)(6,_t,3,2,"td",5),m.\u0275\u0275elementContainerEnd(),m.\u0275\u0275template(7,cn,2,1,"ng-container",6),m.\u0275\u0275elementContainerStart(8,7),m.\u0275\u0275template(9,ir,3,6,"td",8),m.\u0275\u0275elementContainerEnd(),m.\u0275\u0275template(10,at,2,2,"ng-container",3)(11,Ii,1,4,"tr",9)(12,ot,2,2,"div",3),m.\u0275\u0275elementEnd()}if(q&2){const A=m.\u0275\u0275nextContext();m.\u0275\u0275styleProp("display",A.isEmpty()?"none":null),m.\u0275\u0275property("dataSource",A.dataSource)("matSortDirection",A.sortDirection)("matSortActive",A.sortColumn)("cdkDropListDisabled",!A.enableOrdering)("trackBy",A.trackByFunction),m.\u0275\u0275advance(),m.\u0275\u0275propertyInterpolate("matColumnDef",A.getMultiSelectColumnName()),m.\u0275\u0275advance(),m.\u0275\u0275property("ngIf",A.showHeader),m.\u0275\u0275advance(2),m.\u0275\u0275propertyInterpolate("matColumnDef",A.getRowExpanderColumnName()),m.\u0275\u0275advance(),m.\u0275\u0275property("ngIf",A.showHeader),m.\u0275\u0275advance(2),m.\u0275\u0275property("ngForOf",A.dataSchema.columns),m.\u0275\u0275advance(3),m.\u0275\u0275property("ngIf",A.showHeader),m.\u0275\u0275advance(),m.\u0275\u0275property("matRowDefColumns",A.columns),m.\u0275\u0275advance(),m.\u0275\u0275property("ngIf",A.dataSchema.expandableRow)}}const yt=["headerSticky","selectMode","showHeader","showSelectAllButton","allRowsSelectState","allRowsSelectToggleHandler","sortable","sortColumn","sortDirection","selectedRowCssClass","evenRowCssClass","minWidthPerColumn"],ar={selectMode:"none",headerSticky:!1,showHeader:!0,showSelectAllButton:!0,sortable:!0,sortColumn:"",sortDirection:"asc",selectedRowCssClass:"selected",evenRowCssClass:"even-row",minWidthPerColumn:120};class Ct{get filteredData(){return this.dataSource?this.dataSource.filteredData:[]}get dataSchema(){return this._dataSchema}set dataSchema(w){this._dataSchema=w;const A={};w&&w.columns.forEach(N=>{A[N.name]=N}),this.columnsDataSchema=A,this.markForCheck()}get dataColumns(){const w=this.dataSchema;return!w||!w.columns?[]:w.columns.map(A=>A.name)}get columns(){const w=this.dataColumns;return this.selectMode==="multi"&&w.unshift(this.getMultiSelectColumnName()),this.dataSchema.expandableRow&&(this.rowExpanderPosition==="start"&&w.unshift(this.getRowExpanderColumnName()),this.rowExpanderPosition==="end"&&w.push(this.getRowExpanderColumnName())),w}get selected(){const w=this.selection.selected;return this.data.filter(A=>w.includes(this.trackRecord(A)))}set selected(w){this.deselectRedundant();const A=this.trackRecords(w);if(this.deselectExcluding(...A||[]),A){const N=this.trackRecordsAreInTable(A);this.selection.select(...N)}}get expanded(){const w=this.expansion.selected;return this.data.filter(A=>w.includes(this.trackRecord(A)))}set expanded(w){this.collapseRedundant();const A=this.trackRecords(w);if(this.collapseExcluding(...A||[]),A){const N=this.trackRecordsAreInTable(A);this.expansion.select(...N)}}set sort(w){w=w||{},this.sortColumn=w.columnName,this.sortDirection=w.direction}set matSort(w){this._matSort===w||!this._dataSource||!w||(this._matSort=w,this.dataSource.sort=w)}set data(w){w=w||[],this._dataSource||this.initDataSource(),this.dataSource.data=w}get data(){return this.dataSource&&this.dataSource.data||[]}set dataSource(w){this.initDataSource(w)}get dataSource(){return this._dataSource}get eventHandlers(){return this._eventHandlers}set eventHandlers(w){this._eventHandlers=w,this.markForCheck()}set config(w){w=w||{};const A=this._config;this._config=w,(0,he.isEqual)(w,A)||this._applyConfig(w)}constructor(w){this.changeDetectorRef=w,this.selection=new P.SelectionModel(!0,[]),this.expansion=new P.SelectionModel(!0,[]),this.dataValueType=ae.r,this.cellValueChange=new m.EventEmitter,this.enableOrdering=!1,this.rowExpanderPosition="end",this.selectedChange=new m.EventEmitter,this.sortChange=new m.EventEmitter,this.expandedChange=new m.EventEmitter,this.recordPositionChange=new m.EventEmitter,this.rowDoubleClick=new m.EventEmitter,this.getColumnSortingAccessor=(A,N)=>{const K=this.columnsDataSchema[N],oe=A&&A[N];if(!K)return oe;if(K.sortingDataAccessor)return K.sortingDataAccessor(A);switch(K.valueType){case ae.r.Lookup:const Pe=oe;return Pe&&Pe.displayValue;default:return oe}},this.getMultiSelectColumnName=()=>"_multiSelectColumn",this.getRowExpanderColumnName=()=>"_rowExpanderColumn",this.trackByFunction=(A,N)=>this.trackRecord(N),this.config=ar}_applyConfig(w){yt.forEach(A=>{const N=A,K=A,oe=w[N],Pe=this[K];oe!==void 0&&!(0,he.isEqual)(oe,Pe)&&(this[K]=w[N])})}trackRecord(w){return this._dataSchema?.trackBy?this._dataSchema.trackBy(w):w}trackRecords(w){return w?.map(A=>this.trackRecord(A))}isRecordInTable(w){return this.data.some(A=>this.trackRecord(A)===w)}deselectRedundant(){if(!this.dataSource)return null;const w=this.trackRecordsAreNotInTable(this.selection.selected);return w.length!==0&&this.selection.deselect(...w),w}collapseRedundant(){if(!this.dataSource)return null;const w=this.trackRecordsAreNotInTable(this.expansion.selected);return w.length!==0&&this.expansion.deselect(...w),w}deselectExcluding(...w){if(!this.data||!this.selection.hasValue())return;const N=this.trackRecordsExceptExcluded(w);this.selection.deselect(...N)}collapseExcluding(...w){const A=this.trackRecordsExceptExcluded(w);this.expansion.deselect(...A)}changeSelectionForRecords(w,A){w?this.selection.select(...A):this.selection.deselect(...A)}initDataSource(w){w=w||new M.MatLegacyTableDataSource,w.sortingDataAccessor=this.getColumnSortingAccessor,w.connect().subscribe(A=>{this.renderedDataTrackValues=this.trackRecords(A),this.deselectRedundant()?.length>0&&this.emitSelectionChange(),this.collapseRedundant()?.length>0&&this.emitExpandedChange(),this.markForCheck(),this.calculateMinWidth()}),this._dataSource=w}markForCheck(){this.changeDetectorRef.markForCheck()}emitSelectionChange(){this.selectedChange.emit(this.selected)}emitExpandedChange(){this.expandedChange.emit(this.expanded)}selectSingleRecord(w){this.deselectExcluding(w),this.selection.select(w),this.emitSelectionChange()}validateColumnEventHandlers(){const w=Object.keys(this.eventHandlers),A=this._dataSchema.expandableRow;let N=w.find(K=>!this.columnsDataSchema[K]);if(A&&N===A.name&&(N=null),N){const K=Object.keys(this.columnsDataSchema).join(", ");throw new Error(`Event handlers for column "${N}" can not be specified because the column was not defined in table data schema. Actual table columns: ${K}.`)}}changeSelectionForRange(w){if(!this.renderedDataTrackValues||!this.lastSelectToggledRecord||this.lastSelectToggledRecord===w)return!1;const A=this.renderedDataTrackValues.indexOf(this.lastSelectToggledRecord),N=this.renderedDataTrackValues.indexOf(w);if(A===-1||N===-1)return!1;const K=this.renderedDataTrackValues.slice(Math.min(A,N),Math.max(A,N)+1);return this.changeSelectionForRecords(!this.selection.isSelected(w),K),this.lastSelectToggledRecord=w,this.emitSelectionChange(),!0}trackRecordsAreInTable(w){return this.dataSource?w.filter(A=>this.isRecordInTable(A)):w}trackRecordsAreNotInTable(w){return this.dataSource?w.filter(A=>!this.isRecordInTable(A)):w}trackRecordsExceptExcluded(w){const A=this.trackRecords(this.data);return w?A.filter(N=>!w.includes(N)):A}calculateMinWidth(){const w=this.minWidthPerColumn,A=this.dataSchema?.columns?.length??0,N=!this.isEmpty()&&w>0&&A>0;this.minWidth=N?w*A+"px":""}getColumnSpanClass(w){return w>0&&w<=24?`ts-column-span-${w}`:""}allRecordsSelected(){return this.dataSource&&this.selection.hasValue()&&this.selection.selected.length>=this.filteredData.length&&this.filteredData.every(this.isRecordSelected.bind(this))}getAllRowsSelectState(){let w;return this.allRowsSelectState&&(w=this.allRowsSelectState())?w:this.allRecordsSelected()?ie.K.All:this.isAnyRecordSelected()?ie.K.Intermediate:ie.K.None}ngOnChanges(){this.eventHandlers&&this.columnsDataSchema&&this.validateColumnEventHandlers(),this.calculateMinWidth()}isDataSchemaEmpty(){return!this.dataSchema||!this.dataSchema.columns||this.dataColumns.length===0}isEmpty(){return this.isDataSchemaEmpty()||!this.renderedDataTrackValues||this.renderedDataTrackValues.length===0}recordSelectToggle(w){const A=this.trackRecord(w);this.selection.toggle(A),this.lastSelectToggledRecord=A,this.emitSelectionChange()}onSortChange(w){const A={columnName:w.active,direction:w.direction};this.sort=A,this.sortChange.emit(A)}isAnyRecordSelected(){return this.selection.hasValue()}isRecordSelected(w){return this.selection.isSelected(this.trackRecord(w))}isRecordExpanded(w){return this.expansion.isSelected(this.trackRecord(w))}isAllRowsCheckboxChecked(){return this.getAllRowsSelectState()===ie.K.All}isAllRowsCheckboxIntermediate(){return this.getAllRowsSelectState()===ie.K.Intermediate}allRowsSelectToggle(){if(this.selectMode!=="multi")throw new RangeError("Multi-select mode should be enabled to select all records.");if(this.allRowsSelectToggleHandler)this.allRowsSelectToggleHandler();else{const w=!this.isAllRowsCheckboxChecked();this.changeSelectionForRecords(w,this.trackRecords(this.filteredData)),this.emitSelectionChange()}}onRowClick(w){this.selectMode==="single"&&this.selectSingleRecord(this.trackRecord(w))}onRowDoubleClick(w){this.rowDoubleClick.emit(w)}getValueTypeCssClass(w){return"ts-value-type-"+(w&&ae.r[w].toString().toLowerCase())}getColumnHeaderCssClass(w,A){return[this.getValueTypeCssClass(w),this.getColumnSpanClass(A)].filter(N=>!!N)}getRowCssClass(w,A){const N=[];A&&N.push(this.evenRowCssClass),this.selectMode==="single"&&this.isRecordSelected(w)&&N.push(this.selectedRowCssClass);const K=typeof this.dataSchema.rowCssClass=="function"?this.dataSchema.rowCssClass(w):this.dataSchema.rowCssClass;return K&&N.push(K),N}isColumnSortable(w){return!w.caption||this.enableOrdering?!1:this.sortable?w.sortable!==!1:w.sortable===!0}onCheckboxClick(w,A){const N=this.trackRecord(w);A.shiftKey&&this.changeSelectionForRange(N)&&A.preventDefault(),A.stopPropagation()}toggleRowExpansion(w,A){if(A.stopPropagation(),!this.dataSchema.expandableRow)throw new Error("An expandable cell must be set for this operation");this.expansion.toggle(this.trackRecord(w)),this.emitExpandedChange()}onCellValueChange(w,A,N){this.data=this.data,this.cellValueChange.emit({record:w,columnDataSchema:A,value:N})}onItemDrop(w){const A=this.data.indexOf(w.item.data);(0,b.moveItemInArray)(this.data,A,w.currentIndex),this.data=this.data;const N={record:w.item.data,newIndex:w.currentIndex,prevIndex:A};this.recordPositionChange.emit(N)}static{this.\u0275fac=function(A){return new(A||Ct)(m.\u0275\u0275directiveInject(m.ChangeDetectorRef))}}static{this.\u0275cmp=m.\u0275\u0275defineComponent({type:Ct,selectors:[["ts-table"]],viewQuery:function(A,N){if(A&1&&m.\u0275\u0275viewQuery(l.MatSort,5),A&2){let K;m.\u0275\u0275queryRefresh(K=m.\u0275\u0275loadQuery())&&(N.matSort=K.first)}},hostVars:2,hostBindings:function(A,N){A&2&&m.\u0275\u0275styleProp("min-width",N.minWidth)},inputs:{dataSchema:"dataSchema",selectMode:"selectMode",headerSticky:"headerSticky",showHeader:"showHeader",showSelectAllButton:"showSelectAllButton",sortable:"sortable",sortColumn:"sortColumn",sortDirection:"sortDirection",selectedRowCssClass:"selectedRowCssClass",evenRowCssClass:"evenRowCssClass",minWidthPerColumn:"minWidthPerColumn",enableOrdering:"enableOrdering",dragBoundarySelector:"dragBoundarySelector",rowExpanderPosition:"rowExpanderPosition",selected:"selected",expanded:"expanded",sort:"sort",data:"data",dataSource:"dataSource",eventHandlers:"eventHandlers",config:"config",allRowsSelectState:"allRowsSelectState",allRowsSelectToggleHandler:"allRowsSelectToggleHandler"},outputs:{cellValueChange:"cellValueChange",selectedChange:"selectedChange",sortChange:"sortChange",expandedChange:"expandedChange",recordPositionChange:"recordPositionChange",rowDoubleClick:"rowDoubleClick"},features:[m.\u0275\u0275NgOnChangesFeature],decls:1,vars:1,consts:[["mat-table","","matSort","","matSortDisableClear","","multiTemplateDataRows","","cdkDropList","",3,"display","dataSource","matSortDirection","matSortActive","cdkDropListDisabled","trackBy","matSortChange","cdkDropListDropped",4,"ngIf"],["mat-table","","matSort","","matSortDisableClear","","multiTemplateDataRows","","cdkDropList","",3,"matSortChange","cdkDropListDropped","dataSource","matSortDirection","matSortActive","cdkDropListDisabled","trackBy"],[3,"matColumnDef"],[4,"ngIf"],["mat-cell","","class","multi-select-column",4,"matCellDef"],["mat-cell","","class","row-expander-column",4,"matCellDef"],[4,"ngFor","ngForOf"],["matColumnDef","expandableRow"],["mat-cell","",3,"ngClass",4,"matCellDef"],["mat-row","","cdkDragLockAxis","y","cdkDrag","",3,"ngClass","cdkDragData","cdkDragBoundary","cdkDragDisabled","click","dblclick",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","class","multi-select-column",4,"matHeaderCellDef"],["mat-header-cell","",1,"multi-select-column"],[3,"change","checked","indeterminate"],["mat-cell","",1,"multi-select-column"],[3,"click","change","checked"],["mat-header-cell","","class","row-expander-column",4,"matHeaderCellDef"],["mat-header-cell","",1,"row-expander-column"],["mat-cell","",1,"row-expander-column"],[1,"trigger-button",3,"click"],[3,"ngClass"],[3,"matColumnDef",4,"ngIf"],["mat-header-cell","","mat-sort-header","",3,"disabled","ngClass",4,"matHeaderCellDef"],["mat-header-cell","","mat-sort-header","",3,"disabled","ngClass"],["mat-cell","",3,"ngClass"],[3,"valueChange","columnDataSchema","record","eventHandlers"],[1,"expandable-row-wrapper"],[3,"columnDataSchema","record","eventHandlers"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-header-row",""],["mat-row","","cdkDragLockAxis","y","cdkDrag","",3,"click","dblclick","ngClass","cdkDragData","cdkDragBoundary","cdkDragDisabled"],["mat-row","","class","expandable-row",4,"matRowDef","matRowDefColumns"],["mat-row","",1,"expandable-row"]],template:function(A,N){A&1&&m.\u0275\u0275template(0,rr,13,15,"table",0),A&2&&m.\u0275\u0275property("ngIf",!N.isDataSchemaEmpty())},dependencies:[de.NgClass,de.NgForOf,de.NgIf,b.CdkDropList,b.CdkDrag,S.MatIcon,L.MatLegacyCheckbox,l.MatSort,l.MatSortHeader,M.MatLegacyTable,M.MatLegacyHeaderCellDef,M.MatLegacyHeaderRowDef,M.MatLegacyColumnDef,M.MatLegacyCellDef,M.MatLegacyRowDef,M.MatLegacyHeaderCell,M.MatLegacyCell,M.MatLegacyHeaderRow,M.MatLegacyRow,ne.v],styles:[`ts-table{display:inline-block;width:100%}ts-table table{width:100%}ts-table table tr.expandable-row{height:auto}ts-table table tr.expandable-row td.expandable-cell-collapsed{border-bottom:hidden}ts-table table tr td,ts-table table tr th{overflow:hidden}ts-table table tr td:not(.multi-select-column,.row-expander-column),ts-table table tr th:not(.multi-select-column,.row-expander-column){width:auto}ts-table table tr td:not(.multi-select-column,.row-expander-column).ts-column-span-1,ts-table table tr th:not(.multi-select-column,.row-expander-column).ts-column-span-1{width:4.1666666667%}ts-table table tr td:not(.multi-select-column,.row-expander-column).ts-column-span-2,ts-table table tr th:not(.multi-select-column,.row-expander-column).ts-column-span-2{width:8.3333333333%}ts-table table tr td:not(.multi-select-column,.row-expander-column).ts-column-span-3,ts-table table tr th:not(.multi-select-column,.row-expander-column).ts-column-span-3{width:12.5%}ts-table table tr td:not(.multi-select-column,.row-expander-column).ts-column-span-4,ts-table table tr th:not(.multi-select-column,.row-expander-column).ts-column-span-4{width:16.6666666667%}ts-table table tr td:not(.multi-select-column,.row-expander-column).ts-column-span-5,ts-table table tr th:not(.multi-select-column,.row-expander-column).ts-column-span-5{width:20.8333333333%}ts-table table tr td:not(.multi-select-column,.row-expander-column).ts-column-span-6,ts-table table tr th:not(.multi-select-column,.row-expander-column).ts-column-span-6{width:25%}ts-table table tr td:not(.multi-select-column,.row-expander-column).ts-column-span-7,ts-table table tr th:not(.multi-select-column,.row-expander-column).ts-column-span-7{width:29.1666666667%}ts-table table tr td:not(.multi-select-column,.row-expander-column).ts-column-span-8,ts-table table tr th:not(.multi-select-column,.row-expander-column).ts-column-span-8{width:33.3333333333%}ts-table table tr td:not(.multi-select-column,.row-expander-column).ts-column-span-9,ts-table table tr th:not(.multi-select-column,.row-expander-column).ts-column-span-9{width:37.5%}ts-table table tr td:not(.multi-select-column,.row-expander-column).ts-column-span-10,ts-table table tr th:not(.multi-select-column,.row-expander-column).ts-column-span-10{width:41.6666666667%}ts-table table tr td:not(.multi-select-column,.row-expander-column).ts-column-span-11,ts-table table tr th:not(.multi-select-column,.row-expander-column).ts-column-span-11{width:45.8333333333%}ts-table table tr td:not(.multi-select-column,.row-expander-column).ts-column-span-12,ts-table table tr th:not(.multi-select-column,.row-expander-column).ts-column-span-12{width:50%}ts-table table tr td:not(.multi-select-column,.row-expander-column).ts-column-span-13,ts-table table tr th:not(.multi-select-column,.row-expander-column).ts-column-span-13{width:54.1666666667%}ts-table table tr td:not(.multi-select-column,.row-expander-column).ts-column-span-14,ts-table table tr th:not(.multi-select-column,.row-expander-column).ts-column-span-14{width:58.3333333333%}ts-table table tr td:not(.multi-select-column,.row-expander-column).ts-column-span-15,ts-table table tr th:not(.multi-select-column,.row-expander-column).ts-column-span-15{width:62.5%}ts-table table tr td:not(.multi-select-column,.row-expander-column).ts-column-span-16,ts-table table tr th:not(.multi-select-column,.row-expander-column).ts-column-span-16{width:66.6666666667%}ts-table table tr td:not(.multi-select-column,.row-expander-column).ts-column-span-17,ts-table table tr th:not(.multi-select-column,.row-expander-column).ts-column-span-17{width:70.8333333333%}ts-table table tr td:not(.multi-select-column,.row-expander-column).ts-column-span-18,ts-table table tr th:not(.multi-select-column,.row-expander-column).ts-column-span-18{width:75%}ts-table table tr td:not(.multi-select-column,.row-expander-column).ts-column-span-19,ts-table table tr th:not(.multi-select-column,.row-expander-column).ts-column-span-19{width:79.1666666667%}ts-table table tr td:not(.multi-select-column,.row-expander-column).ts-column-span-20,ts-table table tr th:not(.multi-select-column,.row-expander-column).ts-column-span-20{width:83.3333333333%}ts-table table tr td:not(.multi-select-column,.row-expander-column).ts-column-span-21,ts-table table tr th:not(.multi-select-column,.row-expander-column).ts-column-span-21{width:87.5%}ts-table table tr td:not(.multi-select-column,.row-expander-column).ts-column-span-22,ts-table table tr th:not(.multi-select-column,.row-expander-column).ts-column-span-22{width:91.6666666667%}ts-table table tr td:not(.multi-select-column,.row-expander-column).ts-column-span-23,ts-table table tr th:not(.multi-select-column,.row-expander-column).ts-column-span-23{width:95.8333333333%}ts-table table tr td:not(.multi-select-column,.row-expander-column).ts-column-span-24,ts-table table tr th:not(.multi-select-column,.row-expander-column).ts-column-span-24{width:100%}ts-table table tr td:not(:first-of-type),ts-table table tr th:not(:first-of-type){padding-left:5px}ts-table table tr td:not(:last-of-type),ts-table table tr th:not(:last-of-type){padding-right:5px}ts-table table tr td.multi-select-column,ts-table table tr th.multi-select-column{padding-right:10px;width:16px!important;text-align:center;overflow:visible!important}ts-table table tr td.multi-select-column mat-checkbox .mat-checkbox-ripple,ts-table table tr th.multi-select-column mat-checkbox .mat-checkbox-ripple{overflow:visible;position:absolute;left:calc(50% - 16px);top:calc(50% - 16px);height:32px;width:32px}ts-table table tr td.multi-select-column mat-checkbox .mat-checkbox-ripple .mat-ripple-element:not(.mat-checkbox-persistent-ripple),ts-table table tr th.multi-select-column mat-checkbox .mat-checkbox-ripple .mat-ripple-element:not(.mat-checkbox-persistent-ripple){display:none}ts-table table tr td.row-expander-column .trigger-button,ts-table table tr th.row-expander-column .trigger-button{background:none;border:none}ts-table table tr td.row-expander-column .trigger-button:focus,ts-table table tr th.row-expander-column .trigger-button:focus{background:none;border:none;outline:none}ts-table table tr td.row-expander-column .trigger-button .row-expander-icon,ts-table table tr th.row-expander-column .trigger-button .row-expander-icon{background-image:url("data:image/svg+xml,%3Csvg id='Component_447' data-name='Component 447' xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 16 16'%3E%3Cpath id='Path_1315' data-name='Path 1315' d='M7,13,0,6.5,7,0' transform='translate(14.549 4.25) rotate(90)' fill='none' stroke='%23006ce0' stroke-width='1.1'/%3E%3Crect id='Rectangle_6725' data-name='Rectangle 6725' width='16' height='16' fill='none'/%3E%3C/svg%3E%0A");background-position:center}ts-table table tr td.row-expander-column .trigger-button .row-expander-icon.collapsed,ts-table table tr th.row-expander-column .trigger-button .row-expander-icon.collapsed{transform:rotate(-180deg)}ts-table table tr td .expandable-row-wrapper,ts-table table tr th .expandable-row-wrapper{display:flex}ts-table table tr td .expandable-row-wrapper ts-table-cell-wrapper,ts-table table tr th .expandable-row-wrapper ts-table-cell-wrapper{width:100%;margin:10px 0}ts-table table tr th.ts-value-type-boolean .mat-sort-header-container{justify-content:center;padding-left:21px}ts-table table tr td.ts-value-type-boolean{text-align:center}
`],encapsulation:2,data:{animation:[(0,g.trigger)("expandableRowTrigger",[(0,g.state)("collapsed",(0,g.style)({height:"0px",minHeight:"0"})),(0,g.state)("expanded",(0,g.style)({height:"unset"}))]),(0,g.trigger)("rowExpanderTrigger",[(0,g.transition)("collapsed <=> expanded",[(0,g.style)({transform:"rotate(180deg)",opacity:0})])])]},changeDetection:0})}}},93243:(R,H,h)=>{h.d(H,{k:()=>k});var g=h(6900),_=h.n(g),P=h(59131),i=h.n(P);const b=["angularTreeGrid"];class k{constructor(){this._config={id_field:"id",parent_id_field:"parent",parent_display_field:"name",data_loading_text:"",row_class_function:null,css:{expand_class:"right-arrow",collapse_class:"down-arrow"},columns:[]},this._notImplementedContracts=["sortable","valueType","linkGenerator","sortingDataAccessor"],this.data=[]}set primaryColumn(T){this._config.id_field=T}set parentColumn(T){this._config.parent_id_field=T}set primaryDisplayColumn(T){this._config.parent_display_field=T}get config(){return this._config}_validateTreeTableColumnContract(T){const M=Object.getOwnPropertyNames(T);this._notImplementedContracts.forEach(u=>{if(M.indexOf(u)!==-1)throw new Error(`Contract "${u}" in TreeTableColumnDataSchema not implemented.`)})}_rowLevelClassGenerator(T){return T.leaf?"leaf-level":"root-level"}_setColumnsConfig(T){const M=T.map(u=>(this._validateTreeTableColumnContract(u),{name:u.name,header:u.caption,css_class:"tree-table-column-"+u.name,renderer:u.formatter}));this._config.columns=M}_setRowCssClassGenerator(T){if(!this.dataSchema?.rowCssClass){this._config.row_class_function=this._rowLevelClassGenerator;return}const M=typeof this.dataSchema?.rowCssClass=="function"?this.dataSchema.rowCssClass:u=>this.dataSchema.rowCssClass;this._config.row_class_function=u=>[this._rowLevelClassGenerator(u),M(u)].join(" ")}get dataSchema(){return this._dataSchema}set dataSchema(T){this._dataSchema=T,T&&this._setColumnsConfig(T.columns),this._setRowCssClassGenerator(T)}collapseAll(){this.angularTreeGrid.collapseAll()}expandAll(){this.angularTreeGrid.expandAll()}static{this.\u0275fac=function(M){return new(M||k)}}static{this.\u0275cmp=P.\u0275\u0275defineComponent({type:k,selectors:[["ts-tree-table"]],viewQuery:function(M,u){if(M&1&&P.\u0275\u0275viewQuery(b,5),M&2){let l;P.\u0275\u0275queryRefresh(l=P.\u0275\u0275loadQuery())&&(u.angularTreeGrid=l.first)}},inputs:{primaryColumn:"primaryColumn",parentColumn:"parentColumn",primaryDisplayColumn:"primaryDisplayColumn",data:"data",dataSchema:"dataSchema"},decls:2,vars:2,consts:[["angularTreeGrid",""],[1,"tree-table",3,"data","configs"]],template:function(M,u){M&1&&P.\u0275\u0275element(0,"db-angular-tree-grid",1,0),M&2&&P.\u0275\u0275property("data",u.data)("configs",u.config)},dependencies:[g.AngularTreeGridComponent],styles:[`ts-tree-table .tree-table table.db-tree-view{border:0;width:100%}ts-tree-table .tree-table .db-tree-view thead tr th,ts-tree-table .tree-table .db-tree-view tbody tr td{border-left-width:0;border-right-width:0;border-top-width:0}ts-tree-table .tree-table .db-tree-view thead tr th{font:400 13px/17px Bpmonline Open Sans,Regular,sans-serif;color:#999;font-size:13px;text-align:left}ts-tree-table .tree-table .db-tree-view tbody tr{line-height:normal}ts-tree-table .tree-table .db-tree-view tbody tr td{font:400 14px/19px Bpmonline Open Sans,Regular,sans-serif;font-size:14px;color:#000000de}ts-tree-table .tree-table .db-tree-view .root-level td:first-child{padding-left:10px}ts-tree-table .tree-table .db-tree-view .leaf-level{background:#fcfcfc 0% 0% no-repeat padding-box}ts-tree-table .tree-table .db-tree-view .leaf-level td:first-child{padding-left:25px}ts-tree-table .tree-table .right-arrow:before{color:#006ce0;border-style:solid;border-width:1px 1px 0 0;content:"";display:inline-block;padding:3px;transform:rotate(45deg);vertical-align:middle;margin-bottom:6px}ts-tree-table .tree-table .down-arrow:before{color:#006ce0;border-style:solid;border-width:0 1px 1px 0;content:"";display:inline-block;padding:3px;transform:rotate(45deg);vertical-align:middle;margin-bottom:6px}
`],encapsulation:2})}}},37440:(R,H,h)=>{h.d(H,{b:()=>Q});var g=h(49391),_=h.n(g),P=h(40297),i=h.n(P),b=h(52989),k=h.n(b),m=h(23023),T=h.n(m),M=h(53135),u=h.n(M),l=h(14715),v=h.n(l),ae=h(17499),ie=h.n(ae),he=h(27397),Me=h.n(he),de=h(79772),pe=h.n(de),S=h(14276),D=h(6900),L=h.n(D),W=h(13679),ne=h(53707),J=h(93243),V=h(59131),B=h.n(V);class Q{static{this.\u0275fac=function(_t){return new(_t||Q)}}static{this.\u0275mod=V.\u0275\u0275defineNgModule({type:Q})}static{this.\u0275inj=V.\u0275\u0275defineInjector({imports:[D.AngularTreeGridModule,P.CommonModule,g.DragDropModule,m.MatLegacyButtonModule,b.MatIconModule,M.MatLegacyCheckboxModule,ae.MatSortModule,l.MatLegacyTableModule,he.RouterModule,de.TranslateModule,S.B,S.B]})}}(function(){(typeof ngJitMode>"u"||ngJitMode)&&V.\u0275\u0275setNgModuleScope(Q,{declarations:[W.v,ne.O,J.k],imports:[D.AngularTreeGridModule,P.CommonModule,g.DragDropModule,m.MatLegacyButtonModule,b.MatIconModule,M.MatLegacyCheckboxModule,ae.MatSortModule,l.MatLegacyTableModule,he.RouterModule,de.TranslateModule,S.B],exports:[W.v,ne.O,J.k,S.B]})})()},93248:(R,H,h)=>{h.d(H,{Fg:()=>_,HO:()=>P,Oi:()=>g,oy:()=>i});const g="user-info-cache",_="currentUserInfo",P="application-info-cache",i="applicationInfo"},61843:(R,H,h)=>{h.d(H,{dJ:()=>_,fX:()=>P});const g="A5420246-0A8E-E111-84A3-00155D054C03",_="en-US";class P{constructor(b){Object.assign(this,b)}static getDefaultCulture(){return new P({sysCultureId:g,sysCultureName:_,decimalSeparator:".",thousandSeparator:","})}}},47149:(R,H,h)=>{h.d(H,{P:()=>i,Q:()=>P});var g=h(86464);const _="DataValueType",P={[g.r.Date]:{type:g.r.Date,id:"603d4960-a1a2-45e9-b232-206a54421b01",name:"Date",icon:"data-type-date-icon.svg",designerIcon:h(26861),translateKey:`${_}.DateCaption`},[g.r.Time]:{type:g.r.Time,id:"04cc757b-8f06-482c-8a1a-0c0e171d2410",name:"Time",icon:"data-type-time-icon.svg",designerIcon:h(8510),translateKey:`${_}.TimeCaption`},[g.r.DateTime]:{type:g.r.DateTime,id:"d21e9ef4-c064-4012-b286-fa1a8171da44",name:"DateTime",icon:"data-type-datetime-icon.svg",designerIcon:h(55146),translateKey:`${_}.DateTimeCaption`},[g.r.Text]:{type:g.r.Text,id:"8b3f29bb-ea14-4ce5-a5c5-293a929b6ba2",name:"Text",icon:"data-type-text-icon.svg",autonumberIcon:"data-type-autonumber-icon.svg",designerIcon:h(97180),designerAutonumberIcon:h(78683),translateKey:`${_}.TextCaption`},[g.r.SHORT_TEXT]:{type:g.r.SHORT_TEXT,id:"325a73b8-0f47-44a0-8412-7606f78003ac",name:"ShortText",icon:"data-type-text-icon.svg",autonumberIcon:"data-type-autonumber-icon.svg",designerIcon:h(97180),designerAutonumberIcon:h(78683),translateKey:`${_}.ShortTextCaption`},[g.r.PHONE_TEXT]:{type:g.r.PHONE_TEXT,id:"26cba63c-daf1-4f36-b2ea-73c0d675d90c",name:"PhoneText",icon:"data-type-phone-icon.svg",designerIcon:h(59155),translateKey:`${_}.PhoneTextCaption`},[g.r.WEB_TEXT]:{type:g.r.WEB_TEXT,id:"26cba64c-daf1-4f36-b2ea-73c0d695d90c",name:"WebText",icon:"data-type-text-icon.svg",designerIcon:h(64337),translateKey:`${_}.WebTextCaption`},[g.r.EMAIL_TEXT]:{type:g.r.EMAIL_TEXT,id:"66cba64c-daf1-4f36-b8ea-73c0d695d90c",name:"EmailText",icon:"data-type-text-icon.svg",designerIcon:h(71011),translateKey:`${_}.EmailTextCaption`},[g.r.MEDIUM_TEXT]:{type:g.r.MEDIUM_TEXT,id:"ddb3a1ee-07e8-4d62-b7a9-d0e618b00fbd",name:"MediumText",icon:"data-type-text-icon.svg",autonumberIcon:"data-type-autonumber-icon.svg",designerIcon:h(97180),designerAutonumberIcon:h(78683),translateKey:`${_}.MediumTextCaption`},[g.r.LONG_TEXT]:{type:g.r.LONG_TEXT,id:"5ca35f10-a101-4c67-a96a-383da6afacfc",name:"LongText",icon:"data-type-text-icon.svg",autonumberIcon:"data-type-autonumber-icon.svg",designerIcon:h(97180),designerAutonumberIcon:h(78683),translateKey:`${_}.LongTextCaption`},[g.r.MAXSIZE_TEXT]:{type:g.r.MAXSIZE_TEXT,id:"c0f04627-4620-4bc0-84e5-9419dc8516b1",name:"MaxSizeText",icon:"data-type-unlimited-text-icon.svg",autonumberIcon:"data-type-autonumber-icon.svg",designerIcon:h(97180),designerAutonumberIcon:h(78683),translateKey:`${_}.MaxSizeTextCaption`},[g.r.Integer]:{type:g.r.Integer,id:"6b6b74e2-820d-490e-a017-2b73d4ccf2b0",name:"Integer",icon:"data-type-integer-icon.svg",designerIcon:h(60521),translateKey:`${_}.IntegerCaption`},[g.r.FLOAT1]:{type:g.r.FLOAT1,id:"07ba84ce-0bf7-44b4-9f2c-7b15032eb98c",name:"Float1",icon:"data-type-float1-icon.svg",designerIcon:h(68877),translateKey:`${_}.FLOAT1Caption`},[g.r.FLOAT2]:{type:g.r.FLOAT2,id:"5cc8060d-6d10-4773-89fc-8c12d6f659a6",name:"Float2",icon:"data-type-float2-icon.svg",designerIcon:h(68877),translateKey:`${_}.FLOAT2Caption`},[g.r.FLOAT3]:{type:g.r.FLOAT3,id:"3f62414e-6c25-4182-bcef-a73c9e396f31",name:"Float3",icon:"data-type-float3-icon.svg",designerIcon:h(68877),translateKey:`${_}.FLOAT3Caption`},[g.r.FLOAT4]:{type:g.r.FLOAT4,id:"ff22e049-4d16-46ee-a529-92d8808932dc",name:"Float4",icon:"data-type-float4-icon.svg",designerIcon:h(68877),translateKey:`${_}.FLOAT4Caption`},[g.r.FLOAT8]:{type:g.r.FLOAT8,id:"a4aaf398-3531-4a0d-9d75-a587f5b5b59e",name:"Float8",icon:"data-type-float8-icon.svg",designerIcon:h(68877),translateKey:`${_}.FLOAT8Caption`},[g.r.Guid]:{type:g.r.Guid,id:"23018567-a13c-4320-8687-fd6f9e3699bd",name:"Guid",icon:"data-type-guid-icon.svg",designerIcon:h(92458),translateKey:`${_}.GuidCaption`},[g.r.Lookup]:{type:g.r.Lookup,id:"b295071f-7ea9-4e62-8d1a-919bf3732ff2",name:"Lookup",icon:"data-type-lookup-icon.svg",designerIcon:h(61631),translateKey:`${_}.LookupCaption`},[g.r.Boolean]:{type:g.r.Boolean,id:"90b65bf8-0ffc-4141-8779-2420877af907",name:"Boolean",icon:"data-type-boolean-icon.svg",designerIcon:h(36659),translateKey:`${_}.BooleanCaption`},[g.r.HASH_TEXT]:{type:g.r.HASH_TEXT,id:"ecbcce18-2a17-4ead-829a-9d02fa9578a4",name:"HashText",icon:"data-type-crs-text-icon.svg",designerIcon:h(97180),translateKey:`${_}.HashTextCaption`},[g.r.SECURE_TEXT]:{type:g.r.SECURE_TEXT,id:"3509b9dd-2c90-4540-b82e-8f6ae85d8248",name:"SecureText",icon:"data-type-encrypted-text-icon.svg",designerIcon:h(28010),translateKey:`${_}.SecureTextCaption`},[g.r.IMAGELOOKUP]:{type:g.r.IMAGELOOKUP,id:"b039feb0-ee7c-4884-8aa6-d6d45d84316f",name:"ImageLookup",icon:"data-type-image-link-icon.svg",designerIcon:h(65689),translateKey:`${_}.ImageLookupCaption`},[g.r.Money]:{type:g.r.Money,id:"969093e2-2b4e-463b-883a-3d3b8c61f0cd",name:"Money",icon:"data-type-float2-icon.svg",designerIcon:h(32643),translateKey:`${_}.MoneyCaption`},[g.r.Float]:{type:g.r.Float,id:"57ee4c31-5ec4-45fa-b95d-3a2868aa89a8",name:"Float",icon:"data-type-float1-icon.svg",designerIcon:h(68877),translateKey:`${_}.FloatCaption`},[g.r.FILE]:{type:g.r.FILE,id:"a33c9252-d401-453e-949d-169157067ed9",name:"File",icon:"data-type-file-icon.svg",designerIcon:h(55039),translateKey:`${_}.FileCaption`},[g.r.Image]:{type:g.r.Image,id:"fa6e6e49-b996-475e-a77e-73904e4c5a88",name:"Image",icon:"data-type-image-icon.svg",designerIcon:h(55039),translateKey:`${_}.ImageCaption`},[g.r.Blob]:{type:g.r.Blob,id:"b7342b7a-5dde-40de-aa7c-24d2a57b3202",name:"Blob",icon:"data-type-blob-icon.svg",designerIcon:h(55039),translateKey:`${_}.BlobCaption`},[g.r.Color]:{type:g.r.Color,id:"dafb71f9-ee9f-4e0b-a4d7-37aa15987155",name:"Color",icon:"data-type-color-icon.svg",designerIcon:h(39078),translateKey:`${_}.ColorCaption`},[g.r.RICH_TEXT]:{type:g.r.RICH_TEXT,id:"79bccffa-8c8b-4863-b376-a69d2244182b",name:"RichText",icon:"data-type-rich-text-icon.svg",designerIcon:h(67021),translateKey:`${_}.RichCaption`},[g.r.ENTITY]:{type:g.r.ENTITY,id:"ebd85d37-0abf-4bbf-bb32-97dc3dffcc8c",name:"Entity",icon:"data-type-other-icon.svg",designerIcon:h(97180),translateKey:`${_}.Entity`},[g.r.ENTITY_COLLECTION]:{type:g.r.ENTITY_COLLECTION,id:"51fb23ba-3eb2-11e2-b7d5-b0c76188709b",name:"EntityCollection",icon:"data-type-other-icon.svg",designerIcon:h(97180),translateKey:`${_}.EntityCollection`},[g.r.ENTITY_COLUMN_MAPPING_COLLECTION]:{type:g.r.ENTITY_COLUMN_MAPPING_COLLECTION,id:"b53eaa2a-4bb7-4a6b-9f4f-58ccab293e31",name:"EntityColumnMappingCollection",icon:"data-type-other-icon.svg",designerIcon:h(97180),translateKey:`${_}.EntityColumnMappingCollection`},[g.r.CUSTOM_OBJECT]:{type:g.r.CUSTOM_OBJECT,id:"84ed6865-9692-4c98-aaed-4d15b96a95c2",name:"CustomObject",icon:"data-type-other-icon.svg",designerIcon:h(97180),translateKey:`${_}.CustomObject`},[g.r.OBJECT_LIST]:{type:g.r.OBJECT_LIST,id:"4b51a8b5-1ee9-4437-9d58-f35e083cbcdf",name:"ObjectList",icon:"data-type-other-icon.svg",designerIcon:h(97180),translateKey:`${_}.ObjectList`},[g.r.COMPOSITE_OBJECT_LIST]:{type:g.r.COMPOSITE_OBJECT_LIST,id:"651ec16f-d140-46db-b9e2-825c985a8ac2",name:"CompositeObjectList",icon:"data-type-other-icon.svg",designerIcon:h(97180),translateKey:`${_}.CompositeObjectList`},[g.r.COMPOSITE_OBJECT]:{type:g.r.COMPOSITE_OBJECT,id:"632e4371-0a7f-46cd-a284-a623b3933027",name:"CompositeObject",icon:"data-type-composite-object-icon.svg",designerIcon:h(97180),translateKey:`${_}.CompositeObject`},[g.r.COLLECTION]:{type:g.r.COLLECTION,name:"Collection",icon:"data-type-other-icon.svg",designerIcon:h(97180),translateKey:`${_}.Collection`},[g.r.LOCALIZABLE_STRING]:{type:g.r.LOCALIZABLE_STRING,id:"95c6e6c4-2cc8-46be-a1cb-96f942655f86",name:"LocalizableString",icon:"data-type-text-icon.svg",designerIcon:h(97180),translateKey:`${_}.LocalizableString`},[g.r.METADATA_TEXT]:{type:g.r.METADATA_TEXT,id:"394e160f-c8e0-46fa-9c0d-75d97e9e9169",name:"MetaDataText",icon:"data-type-text-icon.svg",designerIcon:h(97180),translateKey:`${_}.MetaDataText`}},i={DateTime:[g.r.Date,g.r.Time,g.r.DateTime],Text:[g.r.Text,g.r.SHORT_TEXT,g.r.MEDIUM_TEXT,g.r.LONG_TEXT,g.r.PHONE_TEXT,g.r.WEB_TEXT,g.r.EMAIL_TEXT,g.r.MAXSIZE_TEXT,g.r.LOCALIZABLE_STRING,g.r.RICH_TEXT],Number:[g.r.FLOAT1,g.r.FLOAT2,g.r.FLOAT3,g.r.FLOAT4,g.r.FLOAT8,g.r.Integer,g.r.Money,g.r.Float],Lookup:[g.r.Lookup,g.r.IMAGELOOKUP]}},74975:(R,H,h)=>{h.d(H,{S:()=>P});var g=h(59131),_=h.n(g);class P{constructor(){const b=this.constructor;if((0,g.inject)(b,g.InjectFlags.Optional|g.InjectFlags.SkipSelf))throw Error(`[${b.name}]: trying to create multiple instances,
			but this service should be a singleton.`)}}},23092:(R,H,h)=>{h.d(H,{fv:()=>de,oq:()=>l,vn:()=>Me});var g=h(63721),_=h.n(g),P=h(59131),i=h.n(P),b=h(62278),k=h.n(b),m=h(93248),T=h(61843),M=h(74975),u=h(49820);class l{constructor(){this.cultureInfo=new T.fX,this.defCultureInfo=new T.fX}}const v="Information about the current user is not initialized yet. Use UserInfoService to load current user information.";function ae(){return{get id(){throw new ReferenceError(v)},get contactId(){throw new ReferenceError(v)},get contactName(){throw new ReferenceError(v)},get accountId(){throw new ReferenceError(v)},get accountName(){throw new ReferenceError(v)},get isSSP(){throw new ReferenceError(v)},get timeZoneId(){throw new ReferenceError(v)},get cultureInfo(){throw new ReferenceError(v)},get defCultureInfo(){throw new ReferenceError(v)},get timeZoneOffsetHours(){throw new ReferenceError(v)},get photoId(){throw new ReferenceError(v)},get accessType(){throw new ReferenceError(v)},get sessionId(){throw new ReferenceError(v)}}}const ie=ae(),he={get id(){return ie.id},get contactId(){return ie.contactId},get contactName(){return ie.contactName},get accountId(){return ie.accountId},get accountName(){return ie.accountName},get isSSP(){return ie.isSSP},get timeZoneId(){return ie.timeZoneId},get cultureInfo(){return ie.cultureInfo},get defCultureInfo(){return ie.defCultureInfo},get timeZoneOffsetHours(){return ie.timeZoneOffsetHours},get photoId(){return ie.photoId},get accessType(){return ie.accessType},get sessionId(){return ie.sessionId}};Object.freeze(he);const Me={provide:l,useFactory:()=>he};class de extends M.S{constructor(S,D){super(),this._httpClient=S,this._cacheManager=D,this._serviceEndpoint="/ServiceModel/UserInfoService.svc"}_applyUserInfo(S){Object.keys(ie).forEach(D=>{delete ie[D]}),Object.assign(ie,S)}loadCurrentUserInfo(){if(!this._userInfo$){const S=`${this._serviceEndpoint}/GetCurrentUserInfo`;this._userInfo$=this._cacheManager.executeWithCache(m.Oi,m.Fg,this._httpClient.post(S,null)).pipe((0,b.tap)(D=>this._applyUserInfo(D?.userInfo)),(0,b.shareReplay)({bufferSize:1,refCount:!1}))}return this._userInfo$}static{this.\u0275fac=function(D){return new(D||de)(P.\u0275\u0275inject(g.HttpClient),P.\u0275\u0275inject(u.G))}}static{this.\u0275prov=P.\u0275\u0275defineInjectable({token:de,factory:de.\u0275fac,providedIn:"root"})}}},49820:(R,H,h)=>{h.d(H,{G:()=>de});var g=h(73308),_=h(63721),P=h(59131),i=h(84065),b=h(62278),k=h(36486);class m{constructor(S,D,L){this._indexedDBService=S,this.memoryCache=L,this._tableName=D.tableName,this._keyPrefix=D.keyPrefix}_getPrefixedKey(S){return this._keyPrefix?`${this._keyPrefix}_${S}`:S}_getIndexedDBRecord(S){return(0,b.firstValueFrom)(this._indexedDBService.getByKey(this._tableName,S))}_getIndexedDBRecords(S){return(0,b.firstValueFrom)(this._indexedDBService.getByKeys(this._tableName,S))}has(S){var D=this;return(0,g.A)(function*(){if(yield D.memoryCache?.has(D._getPrefixedKey(S)))return!0;const L=yield D._getIndexedDBRecord(D._getPrefixedKey(S));return yield D.memoryCache?.set(D._getPrefixedKey(S),L?.data),!!L?.data})()}get(S){var D=this;return(0,g.A)(function*(){if(yield D.memoryCache?.has(D._getPrefixedKey(S)))return D.memoryCache.get(D._getPrefixedKey(S));const L=yield D._getIndexedDBRecord(D._getPrefixedKey(S));return yield D.memoryCache?.set(D._getPrefixedKey(S),L?.data),L?.data??null})()}getAll(){var S=this;return(0,g.A)(function*(){return yield(0,b.firstValueFrom)(S._indexedDBService.getAll(S._tableName).pipe((0,b.map)(D=>D.map(L=>({key:L.key,value:L.data})))))})()}set(S,D){var L=this;return(0,g.A)(function*(){const W=yield L._getIndexedDBRecord(L._getPrefixedKey(S));W?yield(0,b.firstValueFrom)(L._indexedDBService.update(L._tableName,{id:W.id,key:L._getPrefixedKey(S),data:D})):yield(0,b.firstValueFrom)(L._indexedDBService.add(L._tableName,{key:L._getPrefixedKey(S),data:D})),yield L.memoryCache?.set(L._getPrefixedKey(S),D)})()}bulkSet(S){var D=this;return(0,g.A)(function*(){if(!S||S.length===0)return;const L=(yield D._getIndexedDBRecords(S.map(ne=>D._getPrefixedKey(ne.key))))||[],W=S.map(ne=>{const J=L.filter(Boolean).find(B=>B.key===D._getPrefixedKey(ne.key)),V={key:D._getPrefixedKey(ne.key),data:ne.value};return J?.id?{...V,id:J.id}:V});yield(0,b.firstValueFrom)(D._indexedDBService.bulkUpdate(D._tableName,W)),yield D.memoryCache?.bulkSet(S)})()}delete(S){var D=this;return(0,g.A)(function*(){yield(0,b.firstValueFrom)(D._indexedDBService.deleteByIndex(D._tableName,D._getPrefixedKey(S))),yield D.memoryCache?.delete(D._getPrefixedKey(S))})()}clear(){var S=this;return(0,g.A)(function*(){yield(0,b.firstValueFrom)(S._indexedDBService.clear(S._tableName)),yield S.memoryCache?.clear()})()}}class T{constructor(){this._cache=new Map}has(S){return Promise.resolve(this._cache.has(S))}get(S){return Promise.resolve(this._cache.get(S))}getAll(){return Promise.resolve([...this._cache].map(([S,D])=>({key:S,value:D})))}set(S,D){return this._cache.set(S,D),Promise.resolve()}bulkSet(S){return S.forEach(D=>{this._cache.set(D.key,D.value)}),Promise.resolve()}delete(S){return this._cache.delete(S),Promise.resolve()}clear(){return this._cache.clear(),Promise.resolve()}}var M=h(41483),u=h(40234),l=h(30293);const v={name:"crt-shell-db",version:9,objectStoresMeta:Object.values(l.w).map(pe=>({store:pe,storeConfig:{keyPath:"id",autoIncrement:!0},storeSchema:[{name:"key",keypath:"key",options:{unique:!0}},{name:"data",keypath:"data",options:{unique:!1}}]})),isDefault:!0};class ae{constructor(S){this.dbService=S,this._shouldRemoveDataBaseErrorNames=["VersionError","InvalidStateError","UnknownError"],this._dbReady=!0,this.dbService||(this._dbReady=!1,console.info("For using persistent cache, you need to register NgxIndexedDBService."))}_getErrorMessage(S){return S instanceof Error?`Name: ${S.name}, Message: ${S.message}`:S instanceof Event&&S.target&&"error"in S.target?`${S.target.error?.message}`:typeof S=="string"?S:JSON.stringify(S)}_handleError(S){const D=typeof S=="string"||S instanceof Error&&this._shouldRemoveDataBaseErrorNames.includes(S.name);return this._dbReady&&D?(indexedDB.deleteDatabase(v.name),console.warn(`IndexedDB has been refreshed. ${this._getErrorMessage(S)}`),this._dbReady=!1,(0,b.of)(void 0)):(console.warn(`IndexedDB request error. ${this._getErrorMessage(S)}`),(0,b.of)(void 0))}_executeIndexedDBOperation(S,D){return this._dbReady?S():(0,b.of)(D)}get dbReady(){return this._dbReady}add(S,D){return this._executeIndexedDBOperation(()=>this.dbService.add(S,D),void 0).pipe((0,b.catchError)(L=>this._handleError(L)))}bulkAdd(S,D){return this._executeIndexedDBOperation(()=>this.dbService.bulkAdd(S,D),[]).pipe((0,b.catchError)(L=>this._handleError(L)))}getByKey(S,D){return this._executeIndexedDBOperation(()=>this.dbService.getByIndex(S,"key",D),null).pipe((0,b.catchError)(L=>this._handleError(L)))}getByKeys(S,D){if(D.length===0)return(0,b.of)([]);const L=D.map(W=>this._executeIndexedDBOperation(()=>this.getByKey(S,W),null));return(0,b.forkJoin)(L).pipe((0,b.map)(W=>W.filter(Boolean)),(0,b.catchError)(W=>this._handleError(W)))}clear(S){return this._executeIndexedDBOperation(()=>this.dbService.clear(S),!1).pipe((0,b.catchError)(D=>this._handleError(D)))}update(S,D){return this._executeIndexedDBOperation(()=>this.dbService.update(S,D),void 0).pipe((0,b.catchError)(L=>this._handleError(L)))}bulkUpdate(S,D){return this._executeIndexedDBOperation(()=>this.dbService.bulkPut(S,D),[]).pipe((0,b.catchError)(L=>this._handleError(L)))}delete(S,D){return this._executeIndexedDBOperation(()=>this.dbService.deleteByKey(S,D),!0).pipe((0,b.catchError)(L=>this._handleError(L)))}deleteByIndex(S,D){return this._executeIndexedDBOperation(()=>this.dbService.getByIndex(S,"key",D),null).pipe((0,b.switchMap)(L=>L?this._executeIndexedDBOperation(()=>this.dbService.deleteByKey(S,L.id),!1):(0,b.of)(!0)),(0,b.catchError)(L=>this._handleError(L)))}getAll(S){return this._executeIndexedDBOperation(()=>this.dbService.getAll(S),null).pipe((0,b.catchError)(D=>this._handleError(D)))}static{this.\u0275fac=function(D){return new(D||ae)(P.\u0275\u0275inject(u.NgxIndexedDBService,8))}}static{this.\u0275prov=P.\u0275\u0275defineInjectable({token:ae,factory:ae.\u0275fac,providedIn:"root"})}}class ie{constructor(S){this._indexedDBService=S}create(S){switch(S.type){case M.P.Memory:return new T;case M.P.Persistent:return new m(this._indexedDBService,S.options);case M.P.PersistentAndMemory:return new m(this._indexedDBService,S.options,new T);default:throw new Error(`Unsupported cache type: ${S.type}`)}}static{this.\u0275fac=function(D){return new(D||ie)(P.\u0275\u0275inject(ae))}}static{this.\u0275prov=P.\u0275\u0275defineInjectable({token:ie,factory:ie.\u0275fac,providedIn:"root"})}}var he=h(72051);const Me=new P.InjectionToken("USE_SYSTEM_CLIENT_CACHE",{providedIn:"root",factory:()=>!!window.__useSystemClientCache});class de{constructor(S,D,L){this._injector=S,this._systemCaches=D,this._useSystemClientCache=L,this._caches=new Map}_getPersistentCacheRegistryItems(){var S=this;return(0,g.A)(function*(){return(yield(0,b.firstValueFrom)(S._indexedDBService.getAll(l.w.CacheRegistry)))?.map(L=>L.data)??[]})()}_initializePersistentCacheRegistry(){var S=this;return(0,g.A)(function*(){const L=(yield S._getPersistentCacheRegistryItems()).map(W=>[W.name,W]);S._persistentCacheRegistry=new Map(L)})()}_initializeRegisteredCaches(){this._persistentCacheRegistry.forEach(S=>{const D=this._cacheFactory.create({name:S.name,type:S.useMemoryCache?M.P.PersistentAndMemory:M.P.Persistent,options:{tableName:S.tableName}});this._caches.set(S.name,D)})}_registerPersistentCache(S){var D=this;return(0,g.A)(function*(){const L={name:S.name,tableName:S.options.tableName,useMemoryCache:S.type===M.P.PersistentAndMemory,hash:""};yield(0,b.firstValueFrom)(D._indexedDBService.add(l.w.CacheRegistry,{key:S.name,data:L})),D._persistentCacheRegistry.set(S.name,L)})()}_updatePersistentCacheHash(S,D){var L=this;return(0,g.A)(function*(){const W=L._persistentCacheRegistry.get(S);W.hash=D,L._persistentCacheRegistry.set(S,W);const ne=yield(0,b.firstValueFrom)(L._indexedDBService.getByKey(l.w.CacheRegistry,S));ne?.data&&(ne.data.hash=D,yield(0,b.firstValueFrom)(L._indexedDBService.update(l.w.CacheRegistry,{id:ne.id,key:S,data:W})))})()}_isPersistentCache(S){return S===M.P.Persistent||S===M.P.PersistentAndMemory}_initializeSystemCaches(){var S=this;return(0,g.A)(function*(){const D=S._systemCaches||[];if(D.length===0)return;const L=D.filter(W=>!S._caches.has(W.name));yield Promise.all(L.map(W=>S._create(W)))})()}_create(S){var D=this;return(0,g.A)(function*(){if(D._caches.has(S.name))throw new Error(`Cache instance with name "${S.name}" already exists.`);const L=D._cacheFactory.create(S);return D._caches.set(S.name,L),D._isPersistentCache(S.type)&&(yield D._registerPersistentCache(S)),L})()}_internalInitialize(){var S=this;return(0,g.A)(function*(){S._indexedDBService=S._injector.get(ae),S._cacheFactory=S._injector.get(ie),S._httpClient=S._injector.get(_.HttpClient),S._caches.clear(),yield S._initializePersistentCacheRegistry(),S._initializeRegisteredCaches(),yield S._initializeSystemCaches(),yield S._validateSystemCaches()})()}_validateSystemCaches(){var S=this;return(0,g.A)(function*(){if(!S._caches.size||!S._indexedDBService.dbReady)return;const{hashes:D=[],cacheVersion:L=0}=yield(0,b.lastValueFrom)(S._httpClient.get("api/ClientCache/Hashes").pipe((0,k.catchError)(()=>(console.warn("Failed to get system hashes"),(0,b.of)({hashes:[],cacheVersion:0})))));if(S._getIsNeedForceClearCache(L)){yield S._innerClearAll();return}yield Promise.all(D.map(({name:ne,value:J})=>S._internalValidateCache(ne,J)))})()}_getIsNeedForceClearCache(S){const D=this._injector.get(i.sj),L="ClientCacheVersion",W=D.get(L),ne=S&&S!==W;return ne&&D.set(L,S),ne}_internalValidateCache(S,D){var L=this;return(0,g.A)(function*(){if(!L._persistentCacheRegistry.has(S))return;if(L._persistentCacheRegistry.get(S).hash!==D){const ne=L._caches.get(S);ne&&(yield ne.clear(),yield L._updatePersistentCacheHash(S,D))}})()}_innerClearAll(){var S=this;return(0,g.A)(function*(){yield Promise.all([...S._caches.values()].map(D=>D.clear()))})()}whenInitialized(){return this._initialized??=this._internalInitialize(),this._initialized}get(S){var D=this;return(0,g.A)(function*(){yield D.whenInitialized();const L=D._caches.get(S);if(!L)throw new Error(`Cache instance with name "${S}" does not exist.`);return L})()}getOrCreate(S){var D=this;return(0,g.A)(function*(){if(yield D.whenInitialized(),!D._caches.has(S.name)){if(!S.type)throw new Error(`Cache type must be specified for cache "${S.name}".`);yield D._create({...S,type:S.type})}return D._caches.get(S.name)})()}clearAll(){var S=this;return(0,g.A)(function*(){yield S.whenInitialized(),yield S._innerClearAll()})()}validateCache(S,D){var L=this;return(0,g.A)(function*(){yield L.whenInitialized(),yield L._internalValidateCache(S,D)})()}executeWithCache(S,D,L){return this._useSystemClientCache?(0,b.from)(this.whenInitialized()).pipe((0,b.switchMap)(()=>(0,b.of)(this._caches.get(S))),(0,b.switchMap)(function(){var W=(0,g.A)(function*(ne){return{cacheValue:yield ne?.get(D),cacheInstance:ne}});return function(ne){return W.apply(this,arguments)}}()),(0,b.switchMap)(({cacheValue:W,cacheInstance:ne})=>W?(0,b.of)(W):L.pipe((0,b.tap)(J=>ne?.set(D,J))))):L}executeWithBulkCache(S,D){return this._useSystemClientCache?(0,b.from)(this.whenInitialized()).pipe((0,b.switchMap)(()=>(0,b.of)(this._caches.get(S))),(0,b.switchMap)(function(){var L=(0,g.A)(function*(W){return{cachedItems:yield W?.getAll(),cacheInstance:W}});return function(W){return L.apply(this,arguments)}}()),(0,b.switchMap)(({cachedItems:L,cacheInstance:W})=>L?.length?(0,b.of)(L):D.pipe((0,b.switchMap)(ne=>(0,b.from)(W?.bulkSet(ne)).pipe((0,k.map)(()=>ne)))))):D}static{this.\u0275fac=function(D){return new(D||de)(P.\u0275\u0275inject(P.Injector),P.\u0275\u0275inject(he.P,8),P.\u0275\u0275inject(Me,8))}}static{this.\u0275prov=P.\u0275\u0275defineInjectable({token:de,factory:de.\u0275fac,providedIn:"root"})}}},41483:(R,H,h)=>{h.d(H,{P:()=>g});var g;(function(_){_.Memory="Memory",_.Persistent="Persistent",_.PersistentAndMemory="PersistentAndMemory"})(g||(g={}))},72051:(R,H,h)=>{h.d(H,{P:()=>P});var g=h(59131),_=h.n(g);const P=new g.InjectionToken("SYSTEM_CACHE")},30293:(R,H,h)=>{h.d(H,{w:()=>g});var g;(function(_){_.CacheRegistry="cache-registry",_.Images="images",_.BusinessRules="business-rules",_.RuntimeEntitySchema="runtime-entity-schema",_.RuntimeFreedomUISchemas="runtime-freedom-ui-schemas",_.UserInfo="user-info",_.SystemSettingsCache="system-settings",_.ApplicationInfo="application-info"})(g||(g={}))},71260:(R,H,h)=>{h.d(H,{B4:()=>k,V_:()=>i});var g=h(59131),_=h.n(g),P=h(23092);class i{constructor(T){this.precision=2,Object.assign(this,T)}}class b{constructor(T={}){this.decimalSeparator=T.decimalSeparator||"",this.thousandSeparator=T.thousandSeparator||""}}class k{constructor(T){this._userInfo=T,this._digitsInRank=3}_collapseRepeatedChar(T,M){return T.replace(new RegExp(`[\\${M}]{1,}`,"g"),M)}_insertThousandSeparators(T,M){const u=T.split("");for(let l=u.length-this._digitsInRank;l>0;l-=this._digitsInRank)u.splice(l,0,M);return u.join("")}formatNumberValue(T,M=null){if(T=parseFloat(T&&T.toString()),!T||isNaN(T))return"0";let u="";T<0&&(u="-"),M=M||new i;const l=this.getNumberFormatInfo(),{decimalSeparator:v,thousandSeparator:ae}=l,ie=T.toFixed(M.precision).split(".");let he=ie[0].replace("-","");M.ignoreThousandSeparator||(he=this._insertThousandSeparators(he,ae));const Me=ie.length>1?ie[1].replace(/0{1,}$/,""):"";return Me!==""?`${u}${he}${v}${Me}`:`${u}${he}`}removeFractionalPart(T){const M=".",[u]=T.toString().split(M);return u}getNumberFormatInfo(){const T=this._userInfo.cultureInfo;return new b({decimalSeparator:T.decimalSeparator,thousandSeparator:T.thousandSeparator})}parseStringToNumber(T,M=2){if(!T)return NaN;typeof T!="string"&&(T=String(T));const u=this.getNumberFormatInfo().decimalSeparator;let l=this.formatStringValue(T);l=l.replace(u,".");const v=parseFloat(l);return Number(v.toFixed(M))}formatStringValue(T){typeof T!="string"&&(T=String(T));const M=T.match(/^-/)||"",u=this.getNumberFormatInfo().decimalSeparator,l=this._collapseRepeatedChar(T,u),v=new RegExp(`[^0-9\\${u}]+`,"g");return M+l.replace(v,"")}convertNumericStringToExponentialFormat(T,M=2){if(T&&T!==""){const u=parseFloat(T);if(!isNaN(u))return u.toExponential(M)}return""}static{this.\u0275fac=function(M){return new(M||k)(g.\u0275\u0275inject(P.oq))}}static{this.\u0275prov=g.\u0275\u0275defineInjectable({token:k,factory:k.\u0275fac,providedIn:"root"})}}},26242:R=>{R.exports=`<svg id="Group_7" data-name="Group 7" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
	<rect id="Rectangle_7" data-name="Rectangle 7" width="24" height="24" fill="none"/>
	<line id="Line_5" data-name="Line 5" y1="10" x2="10" transform="translate(7 7)" fill="none" stroke="#ffff" stroke-miterlimit="10" stroke-width="1"/>
	<line id="Line_6" data-name="Line 6" x2="10" y2="10" transform="translate(7 7)" fill="none" stroke="#ffff" stroke-miterlimit="10" stroke-width="1"/>
</svg>
`},92825:R=>{R.exports=`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path fill-rule="evenodd" clip-rule="evenodd" d="M13.1592 7.99998C13.1592 5.15064 10.8494 2.84079 8.00004 2.84079C5.1507 2.84079 2.84085 5.15064 2.84085 7.99998C2.84085 10.8493 5.1507 13.1592 8.00004 13.1592C10.8494 13.1592 13.1592 10.8493 13.1592 7.99998ZM8.00004 1.50079C11.5894 1.50079 14.4992 4.41058 14.4992 7.99998C14.4992 11.5894 11.5894 14.4992 8.00004 14.4992C4.41064 14.4992 1.50085 11.5894 1.50085 7.99998C1.50085 4.41058 4.41064 1.50079 8.00004 1.50079ZM7.16167 5.39671C7.16167 4.93555 7.53551 4.56171 7.99667 4.56171H8.00333C8.46449 4.56171 8.83833 4.93555 8.83833 5.39671C8.83833 5.85786 8.46449 6.23171 8.00333 6.23171H7.99667C7.53551 6.23171 7.16167 5.85786 7.16167 5.39671ZM7.99979 6.95437C8.46095 6.95477 8.83447 7.32893 8.83407 7.79009L8.83163 10.6063C8.83123 11.0674 8.45706 11.4409 7.9959 11.4405C7.53475 11.4401 7.16123 11.066 7.16163 10.6048L7.16407 7.78864C7.16447 7.32749 7.53864 6.95397 7.99979 6.95437Z" fill="currentColor"/>
</svg>
`},8035:R=>{R.exports=`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M3 1V15H13V5H8.99999V1H3ZM2 0H9.99999V4H14V16H2V0Z" fill="#006CE0"/>
<path d="M10 0L14 4H10V0Z" fill="#006CE0"/>
</svg>
`},25689:R=>{R.exports=`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M14.0667 3.80034V12.2003H9.40001V3.80034H14.0667ZM15 2.867H8.46667V13.1337H15V2.867Z" fill="#207245"/>
<path d="M13.1334 4.73367H11.2667V5.66701H13.1334V4.73367Z" fill="#207245"/>
<path d="M10.3334 4.73367H9.40002V5.66701H10.3334V4.73367Z" fill="#207245"/>
<path d="M13.1334 6.60034H11.2667V7.53368H13.1334V6.60034Z" fill="#207245"/>
<path d="M10.3334 6.60034H9.40002V7.53368H10.3334V6.60034Z" fill="#207245"/>
<path d="M13.1334 8.46701H11.2667V9.40034H13.1334V8.46701Z" fill="#207245"/>
<path d="M10.3334 8.46701H9.40002V9.40034H10.3334V8.46701Z" fill="#207245"/>
<path d="M13.1334 10.3337H11.2667V11.267H13.1334V10.3337Z" fill="#207245"/>
<path d="M10.3334 10.3337H9.40002V11.267H10.3334V10.3337Z" fill="#207245"/>
<path d="M8.46667 2.14835V13.8524L1.93333 12.4897V3.511L8.46667 2.14835ZM9.4 1.00034L1 2.75501V13.255L9.4 15.0097V1.00968V1.00034Z" fill="#207245"/>
<path d="M3.80005 5.66699L6.60005 10.8003" stroke="#207245" stroke-miterlimit="10"/>
<path d="M3.80005 10.3337L6.60005 5.20035" stroke="#207245" stroke-miterlimit="10"/>
</svg>
`},21431:R=>{R.exports=`<svg width="17" height="16" viewBox="0 0 17 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M15.5458 3H1.54578V13H15.5458V3Z" stroke="#FF8800" stroke-miterlimit="10"/>
<path d="M11.0458 8C11.8742 8 12.5458 7.32843 12.5458 6.5C12.5458 5.67157 11.8742 5 11.0458 5C10.2173 5 9.54578 5.67157 9.54578 6.5C9.54578 7.32843 10.2173 8 11.0458 8Z" fill="#FF8800"/>
<path d="M1.54578 13V11.6514L5.09954 6.32074L10.9439 13H1.54578Z" stroke="#FF8800"/>
<path d="M15.5458 13H13.8134L11.776 9.94392L13.447 9.10838L15.5458 11.2071V13Z" stroke="#FF8800"/>
</svg>
`},94570:R=>{R.exports=`<svg width="17" height="16" viewBox="0 0 17 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M3 8V2H10.3L14 5.42461V14H6.5" stroke="#F40000" stroke-miterlimit="10"/>
<path d="M10.4702 2H9.47021V6H13.4702V5H10.4702V2Z" fill="#F40000"/>
<path d="M12.4598 11.07C12.4498 10.98 12.3799 10.86 12.2999 10.78C12.0799 10.56 11.5899 10.44 10.8499 10.43C10.3499 10.43 9.73986 10.47 9.10986 10.56C8.82986 10.39 8.52986 10.21 8.29986 9.98996C7.67986 9.39996 7.15984 8.57996 6.83984 7.67996C6.85984 7.59996 6.87984 7.51995 6.89984 7.44995C6.89984 7.44995 7.24985 5.41996 7.15985 4.73996C7.14985 4.64996 7.13984 4.61995 7.11984 4.54995L7.08984 4.46997C6.98984 4.24997 6.80986 4.00996 6.51986 4.01996H6.33984C6.00984 4.01996 5.74984 4.17997 5.67984 4.43997C5.46984 5.23997 5.67986 6.42995 6.07986 7.97995L5.97986 8.22995C5.69986 8.93995 5.33984 9.64996 5.02984 10.27L4.98987 10.35C4.65987 11.01 4.35984 11.57 4.08984 12.04L3.80984 12.19C3.80984 12.19 3.30986 12.46 3.19986 12.53C2.24986 13.11 1.60985 13.77 1.50985 14.3C1.47985 14.47 1.50986 14.68 1.66986 14.78L1.93985 14.9199C2.05985 14.9799 2.17984 15.01 2.30984 15.01C2.98984 15.01 3.77984 14.14 4.86984 12.21C6.12984 11.79 7.55984 11.44 8.80984 11.25C9.76984 11.8 10.9398 12.18 11.6798 12.18C11.8098 12.18 11.9299 12.17 12.0199 12.14C12.1599 12.1 12.2799 12.02 12.3499 11.91C12.4899 11.69 12.5199 11.38 12.4799 11.07H12.4598ZM2.13986 14.4799C2.25986 14.1299 2.74986 13.45 3.47986 12.84C3.52986 12.8 3.63987 12.69 3.73987 12.59C2.97987 13.83 2.46986 14.32 2.13986 14.47V14.4799ZM6.43985 4.36996C6.65985 4.36996 6.77985 4.92996 6.78985 5.45996C6.79985 5.98996 6.67984 6.35997 6.52984 6.62997C6.40984 6.21997 6.34985 5.57995 6.34985 5.16995C6.34985 5.16995 6.34985 4.36996 6.43985 4.36996ZM5.15985 11.58C5.30985 11.3 5.46985 11.0099 5.62985 10.6999C6.02985 9.93995 6.26984 9.33997 6.45984 8.84997C6.82984 9.53997 7.28986 10.12 7.82986 10.59C7.89986 10.65 7.96985 10.71 8.03985 10.77C6.93985 10.99 5.98985 11.26 5.15985 11.59V11.58ZM12.0898 11.52C12.0198 11.56 11.8298 11.59 11.7098 11.59C11.3098 11.59 10.8198 11.4 10.1298 11.1C10.3998 11.08 10.6399 11.07 10.8599 11.07C11.2599 11.07 11.3799 11.0699 11.7699 11.1699C12.1599 11.2699 12.1699 11.48 12.0999 11.52H12.0898Z" fill="#F40000"/>
</svg>
`},17935:R=>{R.exports=`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M14.0667 3.80034V12.2003H9.40001V3.80034H14.0667ZM15 2.867H8.46667V13.1337H15V2.867Z" fill="#D24625"/>
<path d="M13.1333 10.3337H8.46667V11.267H13.1333V10.3337Z" fill="#D24625"/>
<path d="M8.46667 2.14835V13.8524L1.93333 12.4897V3.511L8.46667 2.14835ZM9.4 1.00034L1 2.75501V13.255L9.4 15.0097V1.00968V1.00034Z" fill="#D24625"/>
<path d="M11.2667 4.73367V6.60034H13.1334C13.1334 5.57367 12.2934 4.73367 11.2667 4.73367Z" fill="#D24625"/>
<path d="M6.63733 7.067C6.63733 6.227 6.33866 5.50835 5.89999 5.16302C5.22799 4.64035 4.192 4.73366 4.192 4.73366H3.79065V11.267H4.72398V9.44701C5.05065 9.44701 5.46132 9.37234 5.83465 9.09234C6.36665 8.69101 6.62799 8.00968 6.62799 7.05768L6.63733 7.067ZM5.28399 8.34566C5.11599 8.47633 4.90133 8.51368 4.73333 8.51368V5.62968C4.91066 5.65768 5.12533 5.71368 5.29333 5.86302C5.564 6.09635 5.704 6.49768 5.704 7.05768C5.704 7.49635 5.62932 8.07501 5.28399 8.33634V8.34566Z" fill="#D24625"/>
<path d="M10.3334 7.53366V5.66699C9.98802 5.66699 9.67069 5.76966 9.40002 5.92832V9.14834C9.67069 9.307 9.98802 9.40967 10.3334 9.40967C11.36 9.40967 12.2 8.56967 12.2 7.543H10.3334V7.53366Z" fill="#D24625"/>
</svg>
`},94896:R=>{R.exports=`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M14.0667 3.80034V12.2003H9.40001V3.80034H14.0667ZM15 2.867H8.46667V13.1337H15V2.867Z" fill="#2A5699"/>
<path d="M13.1334 4.73367H9.40002V5.66701H13.1334V4.73367Z" fill="#2A5699"/>
<path d="M13.1334 6.60034H9.40002V7.53368H13.1334V6.60034Z" fill="#2A5699"/>
<path d="M13.1334 8.46701H9.40002V9.40034H13.1334V8.46701Z" fill="#2A5699"/>
<path d="M13.1334 10.3337H9.40002V11.267H13.1334V10.3337Z" fill="#2A5699"/>
<path d="M8.46667 2.14835V13.8524L1.93333 12.4897V3.511L8.46667 2.14835ZM9.4 1.00034L1 2.75501V13.255L9.4 15.0097V1.00968V1.00034Z" fill="#2A5699"/>
<path d="M5.90935 10.3337L5.19069 7.35632L4.48135 10.3337H3.88403L2.8667 5.66699H3.61335L4.2107 8.58833L4.90136 5.66699H5.49868L6.18936 8.61633L6.78668 5.66699H7.53337L6.51604 10.3337H5.90935Z" fill="#2A5699"/>
</svg>
`},27107:R=>{R.exports=`<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M31 6L39 14H31V6Z" fill="#0058EF"/>
<mask id="path-2-inside-1_3672_46963" fill="white">
<path fill-rule="evenodd" clip-rule="evenodd" d="M31 6H11V44H39V14H31V6Z"/>
</mask>
<path d="M11 6V4H9V6H11ZM31 6H33V4H31V6ZM11 44H9V46H11V44ZM39 44V46H41V44H39ZM39 14H41V12H39V14ZM31 14H29V16H31V14ZM11 8H31V4H11V8ZM13 44V6H9V44H13ZM39 42H11V46H39V42ZM37 14V44H41V14H37ZM39 12H31V16H39V12ZM33 14V6H29V14H33Z" fill="#0058EF" mask="url(#path-2-inside-1_3672_46963)"/>
</svg>
`},76185:R=>{R.exports=`<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M11.849 16.7535L20.249 32.1535" stroke="#207245" stroke-width="2" stroke-miterlimit="10"/>
<path d="M11.849 30.7535L20.249 15.3535" stroke="#207245" stroke-width="2" stroke-miterlimit="10"/>
<path d="M26.8625 4.75354L4.44897 9.74786V38.7394L26.8625 43.2465V4.75354Z" stroke="#207245" stroke-width="2"/>
<path d="M26.8625 10.1133H43.551V38.0085H26.8625M26.8625 15.8385H31.5311M26.8625 21.3201H31.5311M26.8625 27.0454H31.5311M26.8625 32.6488H31.5311M34.2463 15.8385H39.9148M34.2463 21.3201H39.9148M34.2463 27.0454H39.9148M34.2463 32.6488H39.9148" stroke="#207245" stroke-width="2"/>
</svg>
`},87831:R=>{R.exports=`<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M5 37V11H43V37H5Z" stroke="#FF8800" stroke-width="2" stroke-miterlimit="10"/>
<path d="M33.6655 20.1493C33.6655 21.8257 32.3244 23.1657 30.6932 23.1657C29.0621 23.1657 27.7209 21.8257 27.7209 20.1493C27.7209 18.4729 29.0621 17.1329 30.6932 17.1329C32.3244 17.1329 33.6655 18.4729 33.6655 20.1493Z" stroke="#FF8800" stroke-width="2"/>
<path d="M6.09387 37V33.8161L14.9636 19.1407L31.0907 37H6.09387Z" stroke="#FF8800" stroke-width="2"/>
<path d="M42.0514 37H37.8244L32.1907 29.215L37.0649 26.7508L42.0514 32.5684V37Z" stroke="#FF8800" stroke-width="2"/>
</svg>
`},96682:R=>{R.exports=`<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M8 24V6H29.9001L41 16.2738V42H18.5" stroke="#F40000" stroke-width="2" stroke-miterlimit="10"/>
<path d="M29.3433 6.01556V16.5029C33.371 16.5029 41.4263 16.5029 41.4263 16.5029" stroke="#F40000" stroke-width="2"/>
<path d="M35.9689 33.2099C35.9389 32.9399 35.7289 32.5799 35.4889 32.3399C34.8289 31.6799 33.3589 31.3199 31.1389 31.2899C29.6389 31.2899 27.8089 31.4099 25.9189 31.6799C25.0789 31.1699 24.1789 30.6299 23.4889 29.9699C21.6289 28.1999 20.0689 25.7399 19.1089 23.0399C19.1689 22.7999 19.2289 22.5598 19.2889 22.3498C19.2889 22.3498 20.3389 16.2599 20.0689 14.2199C20.0389 13.9499 20.0089 13.8599 19.9489 13.6499L19.8589 13.4099C19.5589 12.7499 19.0189 12.0299 18.1489 12.0599H17.6089C16.6189 12.0599 15.8389 12.5399 15.6289 13.3199C14.9989 15.7199 15.6289 19.2898 16.8289 23.9398L16.5289 24.6898C15.6889 26.8198 14.6089 28.9499 13.6789 30.8099L13.559 31.0499C12.569 33.0299 11.6689 34.7099 10.8589 36.1199L10.0189 36.5699C10.0189 36.5699 8.51893 37.3799 8.18893 37.5899C5.33893 39.3299 3.41892 41.3099 3.11892 42.8999C3.02892 43.4099 3.11893 44.0399 3.59893 44.3399L4.4089 44.7598C4.7689 44.9398 5.12888 45.0299 5.51888 45.0299C7.55888 45.0299 9.92887 42.4199 13.1989 36.6299C16.9789 35.3699 21.2689 34.3199 25.0189 33.7499C27.8989 35.3999 31.4089 36.5399 33.6289 36.5399C34.0189 36.5399 34.3789 36.5098 34.6489 36.4198C35.0689 36.2999 35.4289 36.0599 35.6389 35.7299C36.0589 35.0699 36.1489 34.1399 36.0289 33.2099H35.9689ZM5.00893 43.4398C5.36893 42.3898 6.83892 40.3499 9.02892 38.5199C9.17892 38.3999 9.50895 38.0699 9.80895 37.7699C7.52895 41.4899 5.99893 42.9599 5.00893 43.4099V43.4398ZM17.9089 13.1099C18.5689 13.1099 18.9289 14.7899 18.9589 16.3799C18.9889 17.9699 18.6289 19.0799 18.1789 19.8899C17.8189 18.6599 17.6389 16.7398 17.6389 15.5098C17.6389 15.5098 17.6389 13.1099 17.9089 13.1099ZM14.0689 34.7399C14.5189 33.8999 14.9989 33.0298 15.4789 32.0998C16.6789 29.8198 17.3989 28.0199 17.9689 26.5499C19.0789 28.6199 20.4589 30.3599 22.0789 31.7699C22.2889 31.9499 22.4989 32.1299 22.7089 32.3099C19.4089 32.9699 16.5589 33.7799 14.0689 34.7699V34.7399ZM34.8589 34.5599C34.6489 34.6799 34.0789 34.7699 33.7189 34.7699C32.5189 34.7699 31.0489 34.1999 28.9789 33.2999C29.7889 33.2399 30.5089 33.2099 31.1689 33.2099C32.3689 33.2099 32.7289 33.2098 33.8989 33.5098C35.0689 33.8098 35.0989 34.4399 34.8889 34.5599H34.8589Z" fill="#F40000"/>
</svg>
`},30351:R=>{R.exports=`<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M26.8625 4.75354L4.44897 9.74786V38.7394L26.8625 43.2465V4.75354Z" stroke="#D24625" stroke-width="2"/>
<path d="M33.8 14.2097V19.8097H39.4C39.4 16.7297 36.88 14.2097 33.8 14.2097Z" fill="#D24625"/>
<path d="M31.0004 22.6097V17.0097C29.9644 17.0097 29.0124 17.3177 28.2004 17.7937V27.4537C29.0124 27.9297 29.9644 28.2377 31.0004 28.2377C34.0804 28.2377 36.6004 25.7177 36.6004 22.6377H31.0004V22.6097Z" fill="#D24625"/>
<path d="M19.9124 21.2097C19.9124 18.6897 19.0163 16.5337 17.7003 15.4977C15.6843 13.9297 12.5764 14.2097 12.5764 14.2097H11.3723V33.8097H14.1723V28.3497C15.1523 28.3497 16.3843 28.1257 17.5043 27.2857C19.1003 26.0817 19.8843 24.0377 19.8843 21.1817L19.9124 21.2097ZM15.8523 25.0457C15.3483 25.4377 14.7043 25.5497 14.2003 25.5497V16.8977C14.7323 16.9817 15.3764 17.1497 15.8804 17.5977C16.6924 18.2977 17.1124 19.5017 17.1124 21.1817C17.1124 22.4977 16.8883 24.2337 15.8523 25.0177V25.0457Z" fill="#D24625"/>
<path d="M26.8625 10.0612H43.551V37.9563H26.8625" stroke="#D24625" stroke-width="2"/>
<path d="M26.8748 32.0246H39.8748" stroke="#D24625" stroke-width="2"/>
</svg>
`},23472:R=>{R.exports=`<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M17.728 31.001L15.5721 22.069L13.444 31.001H11.6521L8.6001 17.001H10.8401L12.6321 25.765L14.7041 17.001H16.496L18.5681 25.849L20.36 17.001H22.6001L19.5481 31.001H17.728Z" fill="#2A5699"/>
<path d="M26.8413 4.54126L4.42773 9.53558V38.5271L26.8413 43.0342V4.54126Z" stroke="#2A5699" stroke-width="2"/>
<path d="M26.8413 9.90106H43.5298V37.7962H26.8413M26.8413 15.6263H39.5098M26.8413 21.1079H39.5098M26.8413 26.8331H39.5098M26.8413 32.4365H39.5098" stroke="#2A5699" stroke-width="2"/>
</svg>
`},35723:R=>{R.exports=`<svg xmlns="http://www.w3.org/2000/svg" width="72" height="64">
	<rect width="72" height="64" fill="none" rx="6"/>
	<g stroke="#999" stroke-width="0.5">
		<rect width="56" height="46" x="8" y="8" fill="#fff" rx="4"/>
		<rect width="55" height="45" x="8.5" y="8.5" fill="none" rx="3.5"/>
	</g>
	<g fill="#d1d1d1">
		<rect width="40" height="6" x="16" y="18" rx="3"/>
		<rect width="40" height="6" x="16" y="28" rx="3"/>
		<rect width="40" height="6" x="16" y="38" rx="3"/>
	</g>
</svg>
`},27320:R=>{R.exports=`<svg xmlns="http://www.w3.org/2000/svg" width="72" height="64">
	<rect width="72" height="64" fill="none" rx="6"/>
	<g fill="#7fc8f4" stroke="#006ce0" opacity=".34">
		<rect width="50" height="43" x="11" y="11" rx="4"/>
		<rect width="49" height="42" x="11.5" y="11.5" fill="none" rx="3.5"/>
	</g>
</svg>
`},48305:R=>{R.exports='<svg xmlns="http://www.w3.org/2000/svg" width="72" height="64"><g data-name="Group 14609" transform="translate(-446 -144)"><rect data-name="Rectangle 24755" width="72" height="64" rx="6" transform="translate(446 144)" fill="none"/><g data-name="Rectangle 39843" transform="translate(484 155)" fill="#7fc8f4" stroke="#006ce0" opacity=".34"><rect width="23" height="43" rx="4" stroke="none"/><rect x=".5" y=".5" width="22" height="42" rx="3.5" fill="none"/></g><g data-name="Rectangle 39845" transform="translate(457 155)" fill="#7fc8f4" stroke="#006ce0" opacity=".34"><rect width="23" height="43" rx="4" stroke="none"/><rect x=".5" y=".5" width="22" height="42" rx="3.5" fill="none"/></g></g></svg>'},6206:R=>{R.exports='<svg xmlns="http://www.w3.org/2000/svg" width="72" height="64"><g data-name="Group 14609" transform="translate(-446 -144)"><rect data-name="Rectangle 24755" width="72" height="64" rx="6" transform="translate(446 144)" fill="none"/><g data-name="Rectangle 39845" transform="translate(456 155)" fill="#7fc8f4" stroke="#006ce0" opacity=".34"><rect width="15" height="43" rx="4" stroke="none"/><rect x=".5" y=".5" width="14" height="42" rx="3.5" fill="none"/></g><g data-name="Rectangle 39906" transform="translate(474 155)" fill="#7fc8f4" stroke="#006ce0" opacity=".34"><rect width="15" height="43" rx="4" stroke="none"/><rect x=".5" y=".5" width="14" height="42" rx="3.5" fill="none"/></g><g data-name="Rectangle 39907" transform="translate(492 155)" fill="#7fc8f4" stroke="#006ce0" opacity=".34"><rect width="15" height="43" rx="4" stroke="none"/><rect x=".5" y=".5" width="14" height="42" rx="3.5" fill="none"/></g></g></svg>'},50103:R=>{R.exports='<svg xmlns="http://www.w3.org/2000/svg" width="72" height="64"><g data-name="Group 14609" transform="translate(-446 -144)"><rect data-name="Rectangle 24755" width="72" height="64" rx="6" transform="translate(446 144)" fill="none"/><g data-name="Rectangle 39845" transform="translate(457 155)" fill="#7fc8f4" stroke="#006ce0" opacity=".34"><rect width="10" height="43" rx="4" stroke="none"/><rect x=".5" y=".5" width="9" height="42" rx="3.5" fill="none"/></g><g data-name="Rectangle 39908" transform="translate(470 155)" fill="#7fc8f4" stroke="#006ce0" opacity=".34"><rect width="10" height="43" rx="4" stroke="none"/><rect x=".5" y=".5" width="9" height="42" rx="3.5" fill="none"/></g><g data-name="Rectangle 39909" transform="translate(483 155)" fill="#7fc8f4" stroke="#006ce0" opacity=".34"><rect width="10" height="43" rx="4" stroke="none"/><rect x=".5" y=".5" width="9" height="42" rx="3.5" fill="none"/></g><g data-name="Rectangle 39910" transform="translate(496 155)" fill="#7fc8f4" stroke="#006ce0" opacity=".34"><rect width="10" height="43" rx="4" stroke="none"/><rect x=".5" y=".5" width="9" height="42" rx="3.5" fill="none"/></g></g></svg>'},75670:R=>{R.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" enable-background="new 0 0 20 20"><g fill="#afb4c1"><path d="m9 11.8h2v3.3h-2z"/><circle cx="10" cy="12" r="1.5"/></g><g fill="none" stroke="#afb4c1" stroke-miterlimit="10"><path d="m16.5 18.5h-13c-.6 0-1-.4-1-1v-9c0-.6.4-1 1-1h13c.6 0 1 .4 1 1v9c0 .6-.4 1-1 1z"/><path d="M5.5,7V5.5c0-2.2,1.8-4,4-4h1c2.2,0,4,1.8,4,4V7" stroke-width="1.25"/></g></svg>'},112:R=>{R.exports=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewbox="0 0 16 16"><defs/><g transform="translate(143.941 -406.051)"><rect width="2" height="2" transform="translate(-136.941 408.051)" style="fill: #8095b3;"/><rect width="2" height="2" transform="translate(-136.941 413.051)" style="fill: #8095b3;"/><rect width="2" height="2" transform="translate(-136.941 418.051)" style="fill: #8095b3;"/></g><rect width="16" height="16" style="fill: none;"/></svg>
`},67347:R=>{R.exports=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewbox="0 0 16 16"><defs/><path d="M-26.666,687.452l2.438,2,4.062-4" transform="translate(31.666 -676.453)" style="fill: none; stroke: #54657d; stroke-miterlimit: 10;"/><g transform="translate(0 2)" style="fill: none; stroke: #54657d; stroke-miterlimit: 10;"><rect width="16" height="14" style="stroke: none;"/><rect x="0.5" y="0.5" width="15" height="13" style="fill: none;"/></g><line x2="16" transform="translate(0 6.5)" style="fill: none; stroke: #54657d; stroke-miterlimit: 10;"/><g transform="translate(2)" style="stroke: #54657d; stroke-miterlimit: 10; fill: #fff;"><rect width="3" height="5" style="stroke: none;"/><rect x="0.5" y="0.5" width="2" height="4" style="fill: none;"/></g><g transform="translate(11)" style="stroke: #54657d; stroke-miterlimit: 10; fill: #fff;"><rect width="3" height="5" style="stroke: none;"/><rect x="0.5" y="0.5" width="2" height="4" style="fill: none;"/></g></svg>
`},63202:R=>{R.exports=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewbox="0 0 16 16"><defs/><g transform="translate(-1816.814 -33.301)"><g transform="translate(1816.814 33.301)" style="fill: none; stroke: #54657d; stroke-miterlimit: 10;"><circle cx="8" cy="8" r="8" style="stroke: none;"/><circle cx="8" cy="8" r="7.5" style="fill: none;"/></g><path d="M1824.814,36.015v5.244l3.266,3.8" style="fill: none; stroke: #54657d; stroke-miterlimit: 10;"/></g></svg>
`},77017:R=>{R.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><defs><style>.error-icon-a{fill:#df1f26;}.error-icon-b,.error-icon-c{fill:none;}.error-icon-b{stroke:#fff;stroke-miterlimit:10;stroke-width:1.5px;}</style></defs><circle class="error-icon-a" cx="7" cy="7" r="7" transform="translate(1 1)"/><line class="error-icon-b" x2="6" y2="6" transform="translate(5 5)"/><line class="error-icon-b" y1="6" x2="6" transform="translate(5 5)"/><rect class="error-icon-c" width="16" height="16"/></svg>'},64207:R=>{R.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16.001" height="16" viewBox="0 0 16.001 16"><defs><style>.warning-icon-a{fill:#ff9800;}.warning-icon-b,.warning-icon-d{fill:none;}.warning-icon-b{stroke:#fff;stroke-linecap:round;stroke-miterlimit:10;stroke-width:2px;}.warning-icon-c{fill:#fff;}</style></defs><g transform="translate(-1330.138 361.759)"><path class="warning-icon-a" d="M1345.172-346.541H1331.1a.964.964,0,0,1-.84-1.438l7.033-12.505a.965.965,0,0,1,1.682,0l7.034,12.505A.965.965,0,0,1,1345.172-346.541Z"/><line class="warning-icon-b" y2="3" transform="translate(1338.139 -355.279)"/><circle class="warning-icon-c" cx="1.25" cy="1.25" r="1.25" transform="translate(1336.889 -350.529)"/></g><rect class="warning-icon-d" width="16" height="16" transform="translate(0.001)"/></svg>'},14186:R=>{R.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><defs><style>.a,.b{fill:none;}.b{stroke:#fff;stroke-linecap:round;stroke-width:1.5px;}</style></defs><g transform="translate(16) rotate(90)"><rect class="a" width="16" height="16"/><path class="b" d="M10.365,0,5.182,5.465,0,0" transform="translate(2.818 5.268)"/></g></svg>'},49967:R=>{R.exports=`<svg xmlns="http://www.w3.org/2000/svg" width="65.898" height="50" viewBox="0 0 65.898 50">
  <g id="Group_10554" data-name="Group 10554" transform="translate(-630.824 -282)">
    <g id="Group_10553" data-name="Group 10553" transform="translate(-8 4)">
      <rect id="Rectangle_23319" data-name="Rectangle 23319" width="24" height="8" transform="translate(640 311) rotate(-90)" fill="#757575" opacity="0.15"/>
      <rect id="Rectangle_23320" data-name="Rectangle 23320" width="15" height="8" transform="translate(655 313) rotate(-90)" fill="#757575" opacity="0.36"/>
      <rect id="Rectangle_23321" data-name="Rectangle 23321" width="50" height="8" transform="translate(671 328) rotate(-90)" fill="#757575" opacity="0.16"/>
      <rect id="Rectangle_23326" data-name="Rectangle 23326" width="20" height="8" transform="translate(671 298) rotate(-90)" fill="#757575" opacity="0.36"/>
      <rect id="Rectangle_23322" data-name="Rectangle 23322" width="30" height="8" transform="translate(687 311) rotate(-90)" fill="#757575" opacity="0.12"/>
      <rect id="Rectangle_23327" data-name="Rectangle 23327" width="17" height="8" transform="translate(687 298) rotate(-90)" fill="#757575" opacity="0.36"/>
      <rect id="Rectangle_23323" data-name="Rectangle 23323" width="11" height="8" transform="translate(640 298) rotate(-90)" fill="#757575" opacity="0.15"/>
      <rect id="Rectangle_23324" data-name="Rectangle 23324" width="25" height="8" transform="translate(655 313) rotate(-90)" fill="#757575" opacity="0.19"/>
      <path id="Path_9959" data-name="Path 9959" d="M223.923,2054c8.8,1.753,9.21,7.979,18.455,7.661s19.38-15.618,29.076-15.618,13.109-8.362,16.091-8.043" transform="translate(416.077 -1753.707)" fill="none" stroke="#757575" stroke-linecap="round" stroke-width="2" opacity="0.36"/>
    </g>
  </g>
</svg>
`},78683:R=>{R.exports=`<svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M0 1.49845H0.783829V4.00128H2.48383V0.000488281H0V1.49845Z" fill="#FF4013"/>
<path fill-rule="evenodd" clip-rule="evenodd" d="M14 1.00089H5.08699V3.00089H14V1.00089ZM14 6.00052H5.08699V8.00052H14V6.00052ZM0 12.7274V13.9998H3.19044V9.99979H0V11.1761H1.5V11.5073H0.75V12.3962H1.5V12.7274H0ZM14 10.9998H5.08699V12.9998H14V10.9998Z" fill="#FF4013"/>
<path d="M2.14577e-05 7.56383V8.99972L3.15902 8.99977V7.56383L2.26167 7.56378L3.15902 6.86625L3.15902 5.00135L2.14577e-05 5.00128L0 6.43327H1.5L2.14577e-05 7.56383Z" fill="#FF4013"/>
</svg>
`},36659:R=>{R.exports=`<svg id="Boolean_icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><rect id="Rectangle_23177" width="16" height="16" fill="none"/><g id="Rectangle_12" transform="translate(1 1)" fill="none" stroke="#ff4013" stroke-width="2"><rect width="14" height="14" stroke="none"/><rect x="1" y="1" width="12" height="12" fill="none"/></g><path id="Path_30" d="M10.5,4.5,5.912,9,4,7.162" transform="translate(1 0.5)" fill="rgba(0,0,0,0)" stroke="#ff4013" stroke-width="2"/></svg>
`},39078:R=>{R.exports=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"><path d="M8.183.779c2.084.007 2.813.35 4.468 1.861l-1.875 2.424-2.95-1.229Z" fill="#ff1c06"/><path d="M7.643 14.846c-2.083-.006-2.813-.35-4.467-1.861l1.875-2.424L8 11.79Z" fill="#ffc6b8"/><path d="M15.024 8.156c-.064 2.22-.431 3.006-2 4.809l-2.4-1.931 1.322-3.175Z" fill="#ff4013"/><path d="M13.074 3.143c1.5 1.443 1.8 2.195 1.949 4.431l-3.03.46-1.286-2.925Z" fill="#ff320e"/><path d="M3.224 12.86c-1.5-1.443-1.795-2.195-1.948-4.43l3.029-.46 1.287 2.925Z" fill="#ffe8e3"/><path d="M12.999 12.98c-1.578 1.562-2.386 1.878-4.769 2.1l-.4-3.055 3.149-1.384Z" fill="#ff795a"/><g transform="translate(-798.326 92.909)" fill="none"><path d="M798.326-92.909h16v16h-16z"/><circle cx="7" cy="7" r="7" transform="translate(799.326 -91.909)" stroke="#ff4013" stroke-width="2"/><circle cx="3" cy="3" r="3" transform="translate(803.326 -87.909)" stroke="#ff4013" stroke-width="2"/><g stroke="#ff4013" stroke-width="2"><path d="M806.326-81.454v3.686"/><path d="M806.326-88.519v-3.386"/><path d="M803.211-84.909h-3.685"/><path d="M812.826-84.909h-3.387"/><path d="M804.126-87.162c-.8-.8-2.306-2.252-3.1-3.05"/><path d="M811.628-79.605c-.729-.73-2.31-2.2-3.04-2.926"/><path d="m804.02-82.6-3 3"/><path d="m811.629-90.213-3.088 2.978"/></g></g></svg>
`},26861:R=>{R.exports=`<svg id="Date_icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><rect id="Rectangle_23177" width="16" height="16" fill="none"/><g id="Rectangle_6448" transform="translate(1 3)" fill="none" stroke="#ff4013" stroke-miterlimit="10" stroke-width="2"><rect width="14" height="12" stroke="none"/><rect x="1" y="1" width="12" height="10" fill="none"/></g><line id="Line_764" x2="12" transform="translate(2 7)" fill="none" stroke="#ff4013" stroke-miterlimit="10" stroke-width="2"/><path id="Path_11729" d="M176.171,1073.754v3" transform="translate(-171.171 -1072.754)" fill="none" stroke="#ff4013" stroke-width="2"/><path id="Path_11730" d="M176.171,1073.754v3" transform="translate(-165.171 -1072.754)" fill="none" stroke="#ff4013" stroke-width="2"/></svg>
`},55146:R=>{R.exports=`<svg id="Datetime_icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><g id="Icon_left_panel_date_time_16x16_heavy" transform="translate(0)"><rect id="Rectangle_6448" width="16" height="16" fill="none"/><path id="Path_6271" d="M1895.033,260.278h-4.149v-9h12v2" transform="translate(-1889.884 -248.278)" fill="none" stroke="#ff4013" stroke-miterlimit="10" stroke-width="2"/><path id="Path_7772" d="M0,0H4.5" transform="translate(1 6)" fill="none" stroke="#ff4013" stroke-width="2"/><line id="Line_771" y2="4" transform="translate(4)" fill="none" stroke="#ff4013" stroke-miterlimit="10" stroke-width="2"/><line id="Line_772" y2="4" transform="translate(10)" fill="none" stroke="#ff4013" stroke-miterlimit="10" stroke-width="2"/><g id="Path_6272" transform="translate(-1889.764 -248.582)" fill="none" stroke-miterlimit="10"><path d="M1905.764,258.584a5,5,0,1,1-5-5A5,5,0,0,1,1905.764,258.584Z" stroke="none"/><path d="M 1900.7626953125 261.5840454101562 C 1902.417602539062 261.5840454101562 1903.763916015625 260.23828125 1903.763916015625 258.5840759277344 C 1903.763916015625 256.9292602539062 1902.417602539062 255.5829772949219 1900.7626953125 255.5829772949219 C 1899.109130859375 255.5829772949219 1897.763916015625 256.9292602539062 1897.763916015625 258.5840759277344 C 1897.763916015625 260.23828125 1899.109130859375 261.5840454101562 1900.7626953125 261.5840454101562 M 1900.7626953125 263.5840454101562 C 1898.000244140625 263.5840454101562 1895.763916015625 261.3454284667969 1895.763916015625 258.5840759277344 C 1895.763916015625 255.8215942382812 1898.000244140625 253.5829772949219 1900.7626953125 253.5829772949219 C 1903.524169921875 253.5829772949219 1905.763916015625 255.8215942382812 1905.763916015625 258.5840759277344 C 1905.763916015625 261.3454284667969 1903.524169921875 263.5840454101562 1900.7626953125 263.5840454101562 Z" stroke="none" fill="#ff4013"/></g><path id="Path_6273" d="M1900.1,255.194v4h2.5" transform="translate(-1889.098 -249.194)" fill="none" stroke="#ff4013" stroke-miterlimit="10" stroke-width="2"/></g></svg>
`},71011:R=>{R.exports=`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M2 3.5H14V12C14 12.1326 13.9473 12.2598 13.8536 12.3536C13.7598 12.4473 13.6326 12.5 13.5 12.5H2.5C2.36739 12.5 2.24021 12.4473 2.14645 12.3536C2.05268 12.2598 2 12.1326 2 12V3.5Z" stroke="#FF4013" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M14 3.5L8 9L2 3.5" stroke="#FF4013" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
`},55039:R=>{R.exports=`<svg id="File_icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><rect id="Rectangle_23177" width="16" height="16" fill="none"/><g id="Group_7055" transform="translate(-733.278 92.545)"><g id="Rectangle_6454" transform="translate(735.278 -91.545)" fill="none" stroke="#ff4013" stroke-miterlimit="10" stroke-width="2"><rect width="12" height="14" stroke="none"/><rect x="1" y="1" width="10" height="12" fill="none"/></g><line id="Line_774" x2="6" transform="translate(738.278 -87.545)" fill="none" stroke="#ff4013" stroke-miterlimit="10" stroke-width="2"/><line id="Line_775" x2="6" transform="translate(738.278 -84.545)" fill="none" stroke="#ff4013" stroke-miterlimit="10" stroke-width="2"/><line id="Line_777" x2="4" transform="translate(738.278 -81.545)" fill="none" stroke="#ff4013" stroke-miterlimit="10" stroke-width="2"/></g></svg>
`},68877:R=>{R.exports=`<svg id="Float_icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><g id="Group_14515" transform="translate(-144 -422)"><rect id="Rectangle_39433" width="16" height="16" transform="translate(144 422)" fill="none"/></g><path id="Path_11302" d="M6.957-4.64a6.469,6.469,0,0,1-.8,3.6A2.764,2.764,0,0,1,3.707.127,2.732,2.732,0,0,1,1.285-1.079,6.377,6.377,0,0,1,.47-4.64a6.53,6.53,0,0,1,.793-3.621A2.752,2.752,0,0,1,3.707-9.426,2.739,2.739,0,0,1,6.135-8.208,6.39,6.39,0,0,1,6.957-4.64Zm-4.539,0a7.22,7.22,0,0,0,.3,2.447,1.022,1.022,0,0,0,.993.74A1.033,1.033,0,0,0,4.7-2.2,7.02,7.02,0,0,0,5-4.64a7,7,0,0,0-.308-2.453,1.034,1.034,0,0,0-.987-.746,1.025,1.025,0,0,0-.99.746A7.208,7.208,0,0,0,2.418-4.64ZM7.759-.908a1.064,1.064,0,0,1,.286-.806,1.158,1.158,0,0,1,.832-.273,1.125,1.125,0,0,1,.816.279,1.061,1.061,0,0,1,.289.8,1.061,1.061,0,0,1-.292.79,1.105,1.105,0,0,1-.812.289,1.138,1.138,0,0,1-.825-.282A1.057,1.057,0,0,1,7.759-.908ZM13.69,0H11.728V-5.37l.019-.882.032-.965q-.489.489-.679.641l-1.066.857L9.088-6.9l2.99-2.38H13.69Z" transform="translate(0.53 12.426)" fill="#ff4013"/></svg>
`},92458:R=>{R.exports=`<svg id="Guid_icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><rect id="Rectangle_42308" width="16" height="16" fill="none"/><path id="Path_11737" d="M1.162,0H3.43V-9.8H1.162Zm9.926-10.388v3.654a2.894,2.894,0,0,0-2.254-.91A3.661,3.661,0,0,0,5.068-3.766,3.661,3.661,0,0,0,8.834.112a2.9,2.9,0,0,0,2.352-.98V0h2.086V-10.388ZM9.212-1.68A1.911,1.911,0,0,1,7.28-3.766,1.911,1.911,0,0,1,9.212-5.852,1.908,1.908,0,0,1,11.13-3.766,1.908,1.908,0,0,1,9.212-1.68Z" transform="translate(0.838 13)" fill="#ff4013" stroke="rgba(0,0,0,0)" stroke-width="1"/></svg>
`},65689:R=>{R.exports=`<svg width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg">
<g clip-path="url(#clip0_1742_819)">
<path d="M10.913 8.99277L7.40833 13.0074H13.0074V11.2395L10.913 8.99277ZM10.8641 6.00745L15.0074 10.4519V15.0074H3.00745L10.8641 6.00745Z" fill="#ff4013"/>
<path d="M3.43597 9.72806C2.87697 10.2871 2.20496 9.92807 1.64496 9.37007C1.08596 8.81107 0.726988 8.13807 1.28699 7.57907L3.07794 5.78806C3.63694 5.22906 4.30898 5.58806 4.86798 6.14606C5.42798 6.70506 5.78595 7.37706 5.22595 7.93706L3.43597 9.72806Z" stroke="#ff4013" stroke-width="2" stroke-miterlimit="10"/>
<path d="M7.93689 5.22705C7.37689 5.78605 6.70591 5.42704 6.14691 4.86804C5.58691 4.30904 5.22894 3.63704 5.78894 3.07804L7.57892 1.28704C8.13892 0.728043 8.80993 1.08704 9.36993 1.64604C9.92993 2.20504 10.2879 2.87704 9.72888 3.43704L7.93689 5.22705Z" stroke="#ff4013" stroke-width="2" stroke-miterlimit="10"/>
<path d="M4.70691 6.51907L6.51791 4.70807" stroke="#ff4013" stroke-width="2"/>
<path d="M11.301 2.00702H14.0079V14.007H2.00793V11.581" stroke="#ff4013" stroke-width="2"/>
</g>
<defs>
<clipPath id="clip0_1742_819">
<rect width="16.007" height="16.007" fill="#ff4013"/>
</clipPath>
</defs>
</svg>
`},60521:R=>{R.exports=`<svg id="Integer_icon" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M8.99433 4.65198C9.48732 5.09802 9.74027 5.69781 9.74027 6.39946C9.74027 7.11039 9.46186 7.74386 8.95863 8.29085L8.95331 8.29664C8.68048 8.58037 8.17318 8.98047 7.44252 9.47417L7.44143 9.4749C7.00788 9.76552 6.67964 10.0338 6.4484 10.2773C6.39755 10.3308 6.35224 10.3822 6.31202 10.4316H9.03463C9.42976 10.4316 9.75009 10.7519 9.75009 11.1471C9.75009 11.5422 9.42976 11.8625 9.03463 11.8625H4.36201V11.5055C4.36201 10.774 4.62396 10.1113 5.14954 9.53003C5.45393 9.18287 5.98212 8.74216 6.73359 8.22779C7.28336 7.835 7.61754 7.57002 7.77738 7.40238C8.08169 7.07198 8.22096 6.73348 8.22096 6.38964C8.22096 6.03409 8.11952 5.81409 7.95289 5.66027C7.78277 5.50324 7.51683 5.40148 7.12478 5.40148C6.72877 5.40148 6.47218 5.52561 6.29884 5.75228L6.29169 5.76164L6.28392 5.77051C6.13055 5.94579 6.0142 6.20942 5.96505 6.5873C5.91679 6.95826 5.61042 7.29659 5.18377 7.29659C4.7751 7.29659 4.39395 6.95656 4.44447 6.49553C4.51728 5.83108 4.75991 5.26428 5.17392 4.82141C5.68203 4.26788 6.36125 4 7.15424 4C7.87626 4 8.49451 4.21025 8.99122 4.6492L8.99433 4.65198ZM14.8743 4.5961C15.3635 5.01371 15.6083 5.57814 15.6083 6.262C15.6083 6.71398 15.4974 7.12093 15.2526 7.45671C15.1531 7.59318 15.0352 7.71289 14.9008 7.81669C15.0605 7.92572 15.2015 8.0545 15.3211 8.20545C15.6165 8.55303 15.7556 8.98069 15.7556 9.46307C15.7556 10.1963 15.4914 10.8144 14.9713 11.2883C14.4419 11.7715 13.7612 12 12.9634 12C12.2299 12 11.6078 11.8045 11.1119 11.4124L11.1064 11.408C10.628 11.014 10.3332 10.4794 10.2052 9.83055C10.1107 9.35139 10.5042 8.97835 10.9288 8.97835C11.3492 8.97835 11.6378 9.30727 11.7079 9.64478C11.7693 9.94025 11.9002 10.158 12.0891 10.3154C12.3147 10.495 12.5969 10.5985 12.9634 10.5985C13.3872 10.5985 13.6961 10.4769 13.9229 10.2668C14.1282 10.0596 14.2363 9.80805 14.2363 9.49253C14.2363 9.15687 14.1319 8.93882 13.9486 8.7817C13.7609 8.62082 13.483 8.52399 13.0419 8.52399H12.7866C12.4159 8.52399 12.1154 8.22345 12.1154 7.85271C12.1154 7.48197 12.4159 7.18143 12.7866 7.18143H13.0125C13.4306 7.18143 13.6903 7.08609 13.85 6.9535C14.0037 6.81675 14.0989 6.61783 14.0989 6.31109C14.0989 6.00164 14.0017 5.79895 13.8513 5.66111L13.8504 5.66027C13.6842 5.50686 13.4217 5.4113 13.0223 5.4113C12.6106 5.4113 12.3484 5.51295 12.1702 5.68456L12.1656 5.68906C12.0215 5.82278 11.914 6.00455 11.8495 6.25293C11.766 6.57474 11.481 6.87436 11.0816 6.87436C10.6572 6.87436 10.2506 6.49494 10.3668 6.00508C10.4953 5.4634 10.7597 5.01133 11.1524 4.66211C11.6438 4.20736 12.2763 4 13.0125 4C13.739 4 14.3777 4.18225 14.8711 4.59337L14.8743 4.5961ZM3.41307 4.92822V11.1029C3.41307 11.5224 3.07297 11.8625 2.65342 11.8625C2.23388 11.8625 1.89377 11.5224 1.89377 11.1029V6.23307C1.68552 6.37174 1.46266 6.49124 1.22573 6.59268C0.723506 6.80771 0.244141 6.40276 0.244141 5.92406C0.244141 5.5872 0.467589 5.3135 0.755873 5.2089C0.963927 5.13341 1.17934 5.03405 1.39555 4.90741C1.64533 4.74519 1.85627 4.57307 2.04007 4.3863C2.18718 4.23681 2.39336 4.13748 2.62233 4.13748C3.05905 4.13748 3.41307 4.4915 3.41307 4.92822Z" fill="#ff4013"/>
</svg>
`},61631:R=>{R.exports=`<svg id="Lookup_icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><g id="Group_6916" transform="translate(2.277 2)"><g id="Group_6915" transform="translate(-0.277)"><circle id="Ellipse_237" cx="4.5" cy="4.5" r="4.5" fill="none" stroke="#ff4013" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2"/><path id="Path_6243" d="M.344.344,4.123,4.123" transform="translate(7.877 7.876)" fill="none" stroke="#ff4013" stroke-width="2"/></g></g><rect id="Rectangle_24756" width="16" height="16" fill="none"/></svg>
`},32643:R=>{R.exports=`<svg id="Money_icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><rect id="Rectangle_23177" width="16" height="16" fill="none"/><path id="Path_7070" d="M-318.645,863.293h-6v-8h14v4" transform="translate(325.645 -852.293)" fill="none" stroke="#ff4013" stroke-miterlimit="10" stroke-width="2"/><path id="Path_7071" d="M-322.646,855.292a2,2,0,0,1-2,2" transform="translate(326.646 -851.292)" fill="none" stroke="#ff4013" stroke-miterlimit="10" stroke-width="2"/><path id="Path_7072" d="M-312.246,857.292a2,2,0,0,1-2-2" transform="translate(326.246 -851.292)" fill="none" stroke="#ff4013" stroke-miterlimit="10" stroke-width="2"/><path id="Path_7073" d="M-324.646,861.692a2,2,0,0,1,2,2" transform="translate(326.646 -853.692)" fill="none" stroke="#ff4013" stroke-miterlimit="10" stroke-width="2"/><g id="Ellipse_1363" transform="translate(6 5)" fill="none" stroke="#ff4013" stroke-miterlimit="10" stroke-width="2"><circle cx="2" cy="2" r="2" stroke="none"/><circle cx="2" cy="2" r="1" fill="none"/></g><path id="Path_7074" d="M-310.846,861.425c0,.737-1.12,1.333-2.5,1.333s-2.5-.6-2.5-1.333,1.12-1.333,2.5-1.333S-310.846,860.69-310.846,861.425Z" transform="translate(325.846 -851.092)" fill="none" stroke="#ff4013" stroke-miterlimit="10" stroke-width="2"/><path id="Path_7075" d="M-310.846,863.292c0,.589-1.12,1.333-2.5,1.333s-2.5-.744-2.5-1.333" transform="translate(325.846 -850.292)" fill="none" stroke="#ff4013" stroke-miterlimit="10" stroke-width="2"/></svg>
`},59155:R=>{R.exports=`<svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M5.3353 1.83815L6.26378 1.46676L6.26378 1.46676L5.3353 1.83815ZM6.03813 3.59524L5.10965 3.96663L5.10965 3.96663L6.03813 3.59524ZM5.82454 4.94398L5.05632 4.3038L5.0563 4.30383L5.82454 4.94398ZM5.44629 5.39792L6.21451 6.03811L6.21453 6.03808L5.44629 5.39792ZM5.52758 7.19434L4.82047 7.90144L4.8205 7.90147L5.52758 7.19434ZM6.8057 8.47236L7.5128 7.76526L7.51278 7.76523L6.8057 8.47236ZM8.60205 8.55382L7.96198 7.7855L7.96187 7.78559L8.60205 8.55382ZM9.05613 8.17554L9.69619 8.94386L9.69631 8.94376L9.05613 8.17554ZM10.4048 7.96192L10.7762 7.03345L10.7761 7.03344L10.4048 7.96192ZM12.1617 8.66476L11.7903 9.59322L11.7903 9.59323L12.1617 8.66476ZM12.9999 9.90268H11.9999V9.90272L12.9999 9.90268ZM13 11.7369H14V11.7368L13 11.7369ZM4.09733 2C4.23363 2 4.3562 2.08298 4.40682 2.20954L6.26378 1.46676C5.90943 0.580885 5.05144 0 4.09733 0V2ZM4.40682 2.20953L5.10965 3.96663L6.96661 3.22386L6.26378 1.46676L4.40682 2.20953ZM5.10965 3.96663C5.15517 4.08044 5.13462 4.20985 5.05632 4.3038L6.59277 5.58417C7.14152 4.92566 7.28485 4.01947 6.96661 3.22385L5.10965 3.96663ZM5.0563 4.30383L4.67804 4.75777L6.21453 6.03808L6.59279 5.58414L5.0563 4.30383ZM4.67807 4.75774C3.90567 5.68462 3.96693 7.0479 4.82047 7.90144L6.23468 6.48723C6.11298 6.36552 6.10396 6.17076 6.21451 6.03811L4.67807 4.75774ZM4.8205 7.90147L6.09862 9.17949L7.51278 7.76523L6.23466 6.4872L4.8205 7.90147ZM6.09859 9.17947C6.95196 10.0328 8.31517 10.0946 9.24224 9.32204L7.96187 7.78559C7.82939 7.89599 7.63468 7.88713 7.5128 7.76526L6.09859 9.17947ZM9.24212 9.32213L9.69619 8.94386L8.41606 7.40722L7.96198 7.7855L9.24212 9.32213ZM9.69631 8.94376C9.79033 8.86541 9.91963 8.8449 10.0334 8.8904L10.7761 7.03344C9.98045 6.71516 9.07438 6.85861 8.41594 7.40732L9.69631 8.94376ZM10.0333 8.89039L11.7903 9.59322L12.5331 7.73629L10.7762 7.03345L10.0333 8.89039ZM11.7903 9.59323C11.917 9.64389 11.9999 9.76649 11.9999 9.90268H13.9999C13.9999 8.94847 13.4189 8.09059 12.5331 7.73628L11.7903 9.59323ZM11.9999 9.90272L12 11.7369L14 11.7368L13.9999 9.90264L11.9999 9.90272ZM12 11.7369C12 11.8823 11.8822 12 11.737 12V14C12.987 14 14 12.9867 14 11.7369H12ZM11.737 12C6.35945 12 2 7.64067 2 2.26318H0C0 8.74528 5.25492 14 11.737 14V12ZM2 2.26318C2 2.11782 2.11785 2 2.26316 2V0C1.01322 0 0 1.0133 0 2.26318H2ZM2.26316 2H4.09733V0H2.26316V2Z" fill="#FF4013"/>
</svg>
`},67021:R=>{R.exports=`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M13 1H3C1.89543 1 1 1.89543 1 3V13C1 14.1046 1.89543 15 3 15H13C14.1046 15 15 14.1046 15 13V3C15 1.89543 14.1046 1 13 1Z" stroke="#FF4013" stroke-width="2" stroke-miterlimit="10"/>
<path d="M9 12H7V6H4V4H12V6H9V12Z" fill="#FF4013"/>
</svg>
`},28010:R=>{R.exports=`<svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" clip-rule="evenodd" d="M5.14 6.90901C5.13775 7.50618 5.25259 8.098 5.478 8.65101L1.5 12.629V15.229H4.1V13.669H5.66V12.109H7.22L8.078 11.251C8.631 11.4764 9.22282 11.5912 9.82 11.589C10.7456 11.589 11.6504 11.3145 12.4201 10.8003C13.1897 10.286 13.7895 9.55512 14.1438 8.69996C14.498 7.84481 14.5907 6.90381 14.4101 5.99598C14.2295 5.08815 13.7838 4.25426 13.1293 3.59975C12.4747 2.94524 11.6409 2.49951 10.733 2.31893C9.82519 2.13835 8.8842 2.23103 8.02904 2.58525C7.17388 2.93947 6.44297 3.53932 5.92872 4.30894C5.41448 5.07856 5.14 5.98339 5.14 6.90901ZM12.4832 5.95178C12.4832 6.84671 11.7577 7.57221 10.8628 7.57221C9.96785 7.57221 9.24236 6.84671 9.24236 5.95178C9.24236 5.05684 9.96785 4.33135 10.8628 4.33135C11.7577 4.33135 12.4832 5.05684 12.4832 5.95178Z" fill="#FF4013"/>
</svg>
`},97180:R=>{R.exports=`<svg id="Text_icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><rect id="Rectangle_39432" width="16" height="16" fill="none"/><path id="Path_11304" d="M5.113,0H2.994V-8.23H.28V-9.994H7.827V-8.23H5.113Z" transform="translate(4 13)" fill="#ff4013"/></svg>
`},8510:R=>{R.exports=`<svg id="Time_icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><rect id="Rectangle_23177" width="16" height="16" fill="none"/><g id="Ellipse_1346" transform="translate(1 1)" fill="none" stroke="#ff4013" stroke-miterlimit="10" stroke-width="2"><circle cx="7" cy="7" r="7" stroke="none"/><circle cx="7" cy="7" r="6" fill="none"/></g><path id="Path_6908" d="M1824.814,31.345v6h3" transform="translate(-1816.814 -29.345)" fill="none" stroke="#ff4013" stroke-miterlimit="10" stroke-width="2"/></svg>
`},64337:R=>{R.exports=`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M8 14C11.3137 14 14 11.3137 14 8C14 4.68629 11.3137 2 8 2C4.68629 2 2 4.68629 2 8C2 11.3137 4.68629 14 8 14Z" stroke="#FF4013" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M2 8H14" stroke="#FF4013" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M8 13.8375C9.38071 13.8375 10.5 11.2239 10.5 7.99998C10.5 4.77601 9.38071 2.16248 8 2.16248C6.61929 2.16248 5.5 4.77601 5.5 7.99998C5.5 11.2239 6.61929 13.8375 8 13.8375Z" stroke="#FF4013" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
`},73308:(R,H,h)=>{h.d(H,{A:()=>_});function g(P,i,b,k,m,T,M){try{var u=P[T](M),l=u.value}catch(v){b(v);return}u.done?i(l):Promise.resolve(l).then(k,m)}function _(P){return function(){var i=this,b=arguments;return new Promise(function(k,m){var T=P.apply(i,b);function M(l){g(T,k,m,M,u,"next",l)}function u(l){g(T,k,m,M,u,"throw",l)}M(void 0)})}}}}]);
