(self.webpackChunkapp_studio_enterprise_schema_view=self.webpackChunkapp_studio_enterprise_schema_view||[]).push([[5872],{95872:(pe,L,w)=>{w.r(L),w.d(L,{Draggable:()=>ce,ThirdPartyDraggable:()=>ge,default:()=>ue});var U=w(55149),s=w(69649);s.config.touchMouseIgnoreWait=500;let R=0,T=0,I=!1;class P{constructor(e){this.subjectEl=null,this.selector="",this.handleSelector="",this.shouldIgnoreMove=!1,this.shouldWatchScroll=!0,this.isDragging=!1,this.isTouchDragging=!1,this.wasTouchScroll=!1,this.handleMouseDown=t=>{if(!this.shouldIgnoreMouse()&&X(t)&&this.tryStart(t)){let i=this.createEventFromMouse(t,!0);this.emitter.trigger("pointerdown",i),this.initScrollWatch(i),this.shouldIgnoreMove||document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp)}},this.handleMouseMove=t=>{let i=this.createEventFromMouse(t);this.recordCoords(i),this.emitter.trigger("pointermove",i)},this.handleMouseUp=t=>{document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),this.emitter.trigger("pointerup",this.createEventFromMouse(t)),this.cleanup()},this.handleTouchStart=t=>{if(this.tryStart(t)){this.isTouchDragging=!0;let i=this.createEventFromTouch(t,!0);this.emitter.trigger("pointerdown",i),this.initScrollWatch(i);let n=t.target;this.shouldIgnoreMove||n.addEventListener("touchmove",this.handleTouchMove),n.addEventListener("touchend",this.handleTouchEnd),n.addEventListener("touchcancel",this.handleTouchEnd),window.addEventListener("scroll",this.handleTouchScroll,!0)}},this.handleTouchMove=t=>{let i=this.createEventFromTouch(t);this.recordCoords(i),this.emitter.trigger("pointermove",i)},this.handleTouchEnd=t=>{if(this.isDragging){let i=t.target;i.removeEventListener("touchmove",this.handleTouchMove),i.removeEventListener("touchend",this.handleTouchEnd),i.removeEventListener("touchcancel",this.handleTouchEnd),window.removeEventListener("scroll",this.handleTouchScroll,!0),this.emitter.trigger("pointerup",this.createEventFromTouch(t)),this.cleanup(),this.isTouchDragging=!1,O()}},this.handleTouchScroll=()=>{this.wasTouchScroll=!0},this.handleScroll=t=>{if(!this.shouldIgnoreMove){let i=window.scrollX-this.prevScrollX+this.prevPageX,n=window.scrollY-this.prevScrollY+this.prevPageY;this.emitter.trigger("pointermove",{origEvent:t,isTouch:this.isTouchDragging,subjectEl:this.subjectEl,pageX:i,pageY:n,deltaX:i-this.origPageX,deltaY:n-this.origPageY})}},this.containerEl=e,this.emitter=new s.Emitter,e.addEventListener("mousedown",this.handleMouseDown),e.addEventListener("touchstart",this.handleTouchStart,{passive:!0}),W()}destroy(){this.containerEl.removeEventListener("mousedown",this.handleMouseDown),this.containerEl.removeEventListener("touchstart",this.handleTouchStart,{passive:!0}),q()}tryStart(e){let t=this.querySubjectEl(e),i=e.target;return t&&(!this.handleSelector||(0,s.elementClosest)(i,this.handleSelector))?(this.subjectEl=t,this.isDragging=!0,this.wasTouchScroll=!1,!0):!1}cleanup(){I=!1,this.isDragging=!1,this.subjectEl=null,this.destroyScrollWatch()}querySubjectEl(e){return this.selector?(0,s.elementClosest)(e.target,this.selector):this.containerEl}shouldIgnoreMouse(){return R||this.isTouchDragging}cancelTouchScroll(){this.isDragging&&(I=!0)}initScrollWatch(e){this.shouldWatchScroll&&(this.recordCoords(e),window.addEventListener("scroll",this.handleScroll,!0))}recordCoords(e){this.shouldWatchScroll&&(this.prevPageX=e.pageX,this.prevPageY=e.pageY,this.prevScrollX=window.scrollX,this.prevScrollY=window.scrollY)}destroyScrollWatch(){this.shouldWatchScroll&&window.removeEventListener("scroll",this.handleScroll,!0)}createEventFromMouse(e,t){let i=0,n=0;return t?(this.origPageX=e.pageX,this.origPageY=e.pageY):(i=e.pageX-this.origPageX,n=e.pageY-this.origPageY),{origEvent:e,isTouch:!1,subjectEl:this.subjectEl,pageX:e.pageX,pageY:e.pageY,deltaX:i,deltaY:n}}createEventFromTouch(e,t){let i=e.touches,n,o,r=0,l=0;return i&&i.length?(n=i[0].pageX,o=i[0].pageY):(n=e.pageX,o=e.pageY),t?(this.origPageX=n,this.origPageY=o):(r=n-this.origPageX,l=o-this.origPageY),{origEvent:e,isTouch:!0,subjectEl:this.subjectEl,pageX:n,pageY:o,deltaX:r,deltaY:l}}}function X(c){return c.button===0&&!c.ctrlKey}function O(){R+=1,setTimeout(()=>{R-=1},s.config.touchMouseIgnoreWait)}function W(){T+=1,T===1&&window.addEventListener("touchmove",x,{passive:!1})}function q(){T-=1,T||window.removeEventListener("touchmove",x,{passive:!1})}function x(c){I&&c.preventDefault()}class k{constructor(){this.isVisible=!1,this.sourceEl=null,this.mirrorEl=null,this.sourceElRect=null,this.parentNode=document.body,this.zIndex=9999,this.revertDuration=0}start(e,t,i){this.sourceEl=e,this.sourceElRect=this.sourceEl.getBoundingClientRect(),this.origScreenX=t-window.scrollX,this.origScreenY=i-window.scrollY,this.deltaX=0,this.deltaY=0,this.updateElPosition()}handleMove(e,t){this.deltaX=e-window.scrollX-this.origScreenX,this.deltaY=t-window.scrollY-this.origScreenY,this.updateElPosition()}setIsVisible(e){e?this.isVisible||(this.mirrorEl&&(this.mirrorEl.style.display=""),this.isVisible=e,this.updateElPosition()):this.isVisible&&(this.mirrorEl&&(this.mirrorEl.style.display="none"),this.isVisible=e)}stop(e,t){let i=()=>{this.cleanup(),t()};e&&this.mirrorEl&&this.isVisible&&this.revertDuration&&(this.deltaX||this.deltaY)?this.doRevertAnimation(i,this.revertDuration):setTimeout(i,0)}doRevertAnimation(e,t){let i=this.mirrorEl,n=this.sourceEl.getBoundingClientRect();i.style.transition="top "+t+"ms,left "+t+"ms",(0,s.applyStyle)(i,{left:n.left,top:n.top}),(0,s.whenTransitionDone)(i,()=>{i.style.transition="",e()})}cleanup(){this.mirrorEl&&((0,s.removeElement)(this.mirrorEl),this.mirrorEl=null),this.sourceEl=null}updateElPosition(){this.sourceEl&&this.isVisible&&(0,s.applyStyle)(this.getMirrorEl(),{left:this.sourceElRect.left+this.deltaX,top:this.sourceElRect.top+this.deltaY})}getMirrorEl(){let e=this.sourceElRect,t=this.mirrorEl;return t||(t=this.mirrorEl=this.sourceEl.cloneNode(!0),t.style.userSelect="none",t.style.webkitUserSelect="none",t.style.pointerEvents="none",t.classList.add("fc-event-dragging"),(0,s.applyStyle)(t,{position:"fixed",zIndex:this.zIndex,visibility:"",boxSizing:"border-box",width:e.right-e.left,height:e.bottom-e.top,right:"auto",bottom:"auto",margin:0}),this.parentNode.appendChild(t)),t}}class H extends s.ScrollController{constructor(e,t){super(),this.handleScroll=()=>{this.scrollTop=this.scrollController.getScrollTop(),this.scrollLeft=this.scrollController.getScrollLeft(),this.handleScrollChange()},this.scrollController=e,this.doesListening=t,this.scrollTop=this.origScrollTop=e.getScrollTop(),this.scrollLeft=this.origScrollLeft=e.getScrollLeft(),this.scrollWidth=e.getScrollWidth(),this.scrollHeight=e.getScrollHeight(),this.clientWidth=e.getClientWidth(),this.clientHeight=e.getClientHeight(),this.clientRect=this.computeClientRect(),this.doesListening&&this.getEventTarget().addEventListener("scroll",this.handleScroll)}destroy(){this.doesListening&&this.getEventTarget().removeEventListener("scroll",this.handleScroll)}getScrollTop(){return this.scrollTop}getScrollLeft(){return this.scrollLeft}setScrollTop(e){this.scrollController.setScrollTop(e),this.doesListening||(this.scrollTop=Math.max(Math.min(e,this.getMaxScrollTop()),0),this.handleScrollChange())}setScrollLeft(e){this.scrollController.setScrollLeft(e),this.doesListening||(this.scrollLeft=Math.max(Math.min(e,this.getMaxScrollLeft()),0),this.handleScrollChange())}getClientWidth(){return this.clientWidth}getClientHeight(){return this.clientHeight}getScrollWidth(){return this.scrollWidth}getScrollHeight(){return this.scrollHeight}handleScrollChange(){}}class _ extends H{constructor(e,t){super(new s.ElementScrollController(e),t)}getEventTarget(){return this.scrollController.el}computeClientRect(){return(0,s.computeInnerRect)(this.scrollController.el)}}class F extends H{constructor(e){super(new s.WindowScrollController,e)}getEventTarget(){return window}computeClientRect(){return{left:this.scrollLeft,right:this.scrollLeft+this.clientWidth,top:this.scrollTop,bottom:this.scrollTop+this.clientHeight}}handleScrollChange(){this.clientRect=this.computeClientRect()}}const N=typeof performance=="function"?performance.now:Date.now;class G{constructor(){this.isEnabled=!0,this.scrollQuery=[window,".fc-scroller"],this.edgeThreshold=50,this.maxVelocity=300,this.pointerScreenX=null,this.pointerScreenY=null,this.isAnimating=!1,this.scrollCaches=null,this.everMovedUp=!1,this.everMovedDown=!1,this.everMovedLeft=!1,this.everMovedRight=!1,this.animate=()=>{if(this.isAnimating){let e=this.computeBestEdge(this.pointerScreenX+window.scrollX,this.pointerScreenY+window.scrollY);if(e){let t=N();this.handleSide(e,(t-this.msSinceRequest)/1e3),this.requestAnimation(t)}else this.isAnimating=!1}}}start(e,t,i){this.isEnabled&&(this.scrollCaches=this.buildCaches(i),this.pointerScreenX=null,this.pointerScreenY=null,this.everMovedUp=!1,this.everMovedDown=!1,this.everMovedLeft=!1,this.everMovedRight=!1,this.handleMove(e,t))}handleMove(e,t){if(this.isEnabled){let i=e-window.scrollX,n=t-window.scrollY,o=this.pointerScreenY===null?0:n-this.pointerScreenY,r=this.pointerScreenX===null?0:i-this.pointerScreenX;o<0?this.everMovedUp=!0:o>0&&(this.everMovedDown=!0),r<0?this.everMovedLeft=!0:r>0&&(this.everMovedRight=!0),this.pointerScreenX=i,this.pointerScreenY=n,this.isAnimating||(this.isAnimating=!0,this.requestAnimation(N()))}}stop(){if(this.isEnabled){this.isAnimating=!1;for(let e of this.scrollCaches)e.destroy();this.scrollCaches=null}}requestAnimation(e){this.msSinceRequest=e,requestAnimationFrame(this.animate)}handleSide(e,t){let{scrollCache:i}=e,{edgeThreshold:n}=this,o=n-e.distance,r=o*o/(n*n)*this.maxVelocity*t,l=1;switch(e.name){case"left":l=-1;case"right":i.setScrollLeft(i.getScrollLeft()+r*l);break;case"top":l=-1;case"bottom":i.setScrollTop(i.getScrollTop()+r*l);break}}computeBestEdge(e,t){let{edgeThreshold:i}=this,n=null,o=this.scrollCaches||[];for(let r of o){let l=r.clientRect,a=e-l.left,h=l.right-e,g=t-l.top,d=l.bottom-t;a>=0&&h>=0&&g>=0&&d>=0&&(g<=i&&this.everMovedUp&&r.canScrollUp()&&(!n||n.distance>g)&&(n={scrollCache:r,name:"top",distance:g}),d<=i&&this.everMovedDown&&r.canScrollDown()&&(!n||n.distance>d)&&(n={scrollCache:r,name:"bottom",distance:d}),a<=i&&this.everMovedLeft&&r.canScrollLeft()&&(!n||n.distance>a)&&(n={scrollCache:r,name:"left",distance:a}),h<=i&&this.everMovedRight&&r.canScrollRight()&&(!n||n.distance>h)&&(n={scrollCache:r,name:"right",distance:h}))}return n}buildCaches(e){return this.queryScrollEls(e).map(t=>t===window?new F(!1):new _(t,!1))}queryScrollEls(e){let t=[];for(let i of this.scrollQuery)typeof i=="object"?t.push(i):t.push(...Array.prototype.slice.call(e.getRootNode().querySelectorAll(i)));return t}}class m extends s.ElementDragging{constructor(e,t){super(e),this.containerEl=e,this.delay=null,this.minDistance=0,this.touchScrollAllowed=!0,this.mirrorNeedsRevert=!1,this.isInteracting=!1,this.isDragging=!1,this.isDelayEnded=!1,this.isDistanceSurpassed=!1,this.delayTimeoutId=null,this.onPointerDown=n=>{this.isDragging||(this.isInteracting=!0,this.isDelayEnded=!1,this.isDistanceSurpassed=!1,(0,s.preventSelection)(document.body),(0,s.preventContextMenu)(document.body),n.isTouch||n.origEvent.preventDefault(),this.emitter.trigger("pointerdown",n),this.isInteracting&&!this.pointer.shouldIgnoreMove&&(this.mirror.setIsVisible(!1),this.mirror.start(n.subjectEl,n.pageX,n.pageY),this.startDelay(n),this.minDistance||this.handleDistanceSurpassed(n)))},this.onPointerMove=n=>{if(this.isInteracting){if(this.emitter.trigger("pointermove",n),!this.isDistanceSurpassed){let o=this.minDistance,r,{deltaX:l,deltaY:a}=n;r=l*l+a*a,r>=o*o&&this.handleDistanceSurpassed(n)}this.isDragging&&(n.origEvent.type!=="scroll"&&(this.mirror.handleMove(n.pageX,n.pageY),this.autoScroller.handleMove(n.pageX,n.pageY)),this.emitter.trigger("dragmove",n))}},this.onPointerUp=n=>{this.isInteracting&&(this.isInteracting=!1,(0,s.allowSelection)(document.body),(0,s.allowContextMenu)(document.body),this.emitter.trigger("pointerup",n),this.isDragging&&(this.autoScroller.stop(),this.tryStopDrag(n)),this.delayTimeoutId&&(clearTimeout(this.delayTimeoutId),this.delayTimeoutId=null))};let i=this.pointer=new P(e);i.emitter.on("pointerdown",this.onPointerDown),i.emitter.on("pointermove",this.onPointerMove),i.emitter.on("pointerup",this.onPointerUp),t&&(i.selector=t),this.mirror=new k,this.autoScroller=new G}destroy(){this.pointer.destroy(),this.onPointerUp({})}startDelay(e){typeof this.delay=="number"?this.delayTimeoutId=setTimeout(()=>{this.delayTimeoutId=null,this.handleDelayEnd(e)},this.delay):this.handleDelayEnd(e)}handleDelayEnd(e){this.isDelayEnded=!0,this.tryStartDrag(e)}handleDistanceSurpassed(e){this.isDistanceSurpassed=!0,this.tryStartDrag(e)}tryStartDrag(e){this.isDelayEnded&&this.isDistanceSurpassed&&(!this.pointer.wasTouchScroll||this.touchScrollAllowed)&&(this.isDragging=!0,this.mirrorNeedsRevert=!1,this.autoScroller.start(e.pageX,e.pageY,this.containerEl),this.emitter.trigger("dragstart",e),this.touchScrollAllowed===!1&&this.pointer.cancelTouchScroll())}tryStopDrag(e){this.mirror.stop(this.mirrorNeedsRevert,this.stopDrag.bind(this,e))}stopDrag(e){this.isDragging=!1,this.emitter.trigger("dragend",e)}setIgnoreMove(e){this.pointer.shouldIgnoreMove=e}setMirrorIsVisible(e){this.mirror.setIsVisible(e)}setMirrorNeedsRevert(e){this.mirrorNeedsRevert=e}setAutoScrollEnabled(e){this.autoScroller.isEnabled=e}}class z{constructor(e){this.el=e,this.origRect=(0,s.computeRect)(e),this.scrollCaches=(0,s.getClippingParents)(e).map(t=>new _(t,!0))}destroy(){for(let e of this.scrollCaches)e.destroy()}computeLeft(){let e=this.origRect.left;for(let t of this.scrollCaches)e+=t.origScrollLeft-t.getScrollLeft();return e}computeTop(){let e=this.origRect.top;for(let t of this.scrollCaches)e+=t.origScrollTop-t.getScrollTop();return e}isWithinClipping(e,t){let i={left:e,top:t};for(let n of this.scrollCaches)if(!B(n.getEventTarget())&&!(0,s.pointInsideRect)(i,n.clientRect))return!1;return!0}}function B(c){let e=c.tagName;return e==="HTML"||e==="BODY"}class S{constructor(e,t){this.useSubjectCenter=!1,this.requireInitial=!0,this.disablePointCheck=!1,this.initialHit=null,this.movingHit=null,this.finalHit=null,this.handlePointerDown=i=>{let{dragging:n}=this;this.initialHit=null,this.movingHit=null,this.finalHit=null,this.prepareHits(),this.processFirstCoord(i),this.initialHit||!this.requireInitial?(n.setIgnoreMove(!1),this.emitter.trigger("pointerdown",i)):n.setIgnoreMove(!0)},this.handleDragStart=i=>{this.emitter.trigger("dragstart",i),this.handleMove(i,!0)},this.handleDragMove=i=>{this.emitter.trigger("dragmove",i),this.handleMove(i)},this.handlePointerUp=i=>{this.releaseHits(),this.emitter.trigger("pointerup",i)},this.handleDragEnd=i=>{this.movingHit&&this.emitter.trigger("hitupdate",null,!0,i),this.finalHit=this.movingHit,this.movingHit=null,this.emitter.trigger("dragend",i)},this.droppableStore=t,e.emitter.on("pointerdown",this.handlePointerDown),e.emitter.on("dragstart",this.handleDragStart),e.emitter.on("dragmove",this.handleDragMove),e.emitter.on("pointerup",this.handlePointerUp),e.emitter.on("dragend",this.handleDragEnd),this.dragging=e,this.emitter=new s.Emitter}processFirstCoord(e){let t={left:e.pageX,top:e.pageY},i=t,n=e.subjectEl,o;n instanceof HTMLElement&&(o=(0,s.computeRect)(n),i=(0,s.constrainPoint)(i,o));let r=this.initialHit=this.queryHitForOffset(i.left,i.top);if(r){if(this.useSubjectCenter&&o){let l=(0,s.intersectRects)(o,r.rect);l&&(i=(0,s.getRectCenter)(l))}this.coordAdjust=(0,s.diffPoints)(i,t)}else this.coordAdjust={left:0,top:0}}handleMove(e,t){let i=this.queryHitForOffset(e.pageX+this.coordAdjust.left,e.pageY+this.coordAdjust.top);(t||!b(this.movingHit,i))&&(this.movingHit=i,this.emitter.trigger("hitupdate",i,!1,e))}prepareHits(){this.offsetTrackers=(0,s.mapHash)(this.droppableStore,e=>(e.component.prepareHits(),new z(e.el)))}releaseHits(){let{offsetTrackers:e}=this;for(let t in e)e[t].destroy();this.offsetTrackers={}}queryHitForOffset(e,t){let{droppableStore:i,offsetTrackers:n}=this,o=null;for(let r in i){let l=i[r].component,a=n[r];if(a&&a.isWithinClipping(e,t)){let h=a.computeLeft(),g=a.computeTop(),d=e-h,u=t-g,{origRect:E}=a,v=E.right-E.left,p=E.bottom-E.top;if(d>=0&&d<v&&u>=0&&u<p){let f=l.queryHit(d,u,v,p);f&&(0,s.rangeContainsRange)(f.dateProfile.activeRange,f.dateSpan.range)&&(this.disablePointCheck||a.el.contains(a.el.getRootNode().elementFromPoint(d+h-window.scrollX,u+g-window.scrollY)))&&(!o||f.layer>o.layer)&&(f.componentId=r,f.context=l.context,f.rect.left+=h,f.rect.right+=h,f.rect.top+=g,f.rect.bottom+=g,o=f)}}}return o}}function b(c,e){return!c&&!e?!0:!!c!=!!e?!1:(0,s.isDateSpansEqual)(c.dateSpan,e.dateSpan)}function A(c,e){let t={};for(let i of e.pluginHooks.datePointTransforms)Object.assign(t,i(c,e));return Object.assign(t,K(c,e.dateEnv)),t}function K(c,e){return{date:e.toDate(c.range.start),dateStr:e.formatIso(c.range.start,{omitTime:c.allDay}),allDay:c.allDay}}class Q extends s.Interaction{constructor(e){super(e),this.handlePointerDown=i=>{let{dragging:n}=this,o=i.origEvent.target;n.setIgnoreMove(!this.component.isValidDateDownEl(o))},this.handleDragEnd=i=>{let{component:n}=this,{pointer:o}=this.dragging;if(!o.wasTouchScroll){let{initialHit:r,finalHit:l}=this.hitDragging;if(r&&l&&b(r,l)){let{context:a}=n,h=Object.assign(Object.assign({},A(r.dateSpan,a)),{dayEl:r.dayEl,jsEvent:i.origEvent,view:a.viewApi||a.calendarApi.view});a.emitter.trigger("dateClick",h)}}},this.dragging=new m(e.el),this.dragging.autoScroller.isEnabled=!1;let t=this.hitDragging=new S(this.dragging,(0,s.interactionSettingsToStore)(e));t.emitter.on("pointerdown",this.handlePointerDown),t.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}}class Z extends s.Interaction{constructor(e){super(e),this.dragSelection=null,this.handlePointerDown=r=>{let{component:l,dragging:a}=this,{options:h}=l.context,g=h.selectable&&l.isValidDateDownEl(r.origEvent.target);a.setIgnoreMove(!g),a.delay=r.isTouch?J(l):null},this.handleDragStart=r=>{this.component.context.calendarApi.unselect(r)},this.handleHitUpdate=(r,l)=>{let{context:a}=this.component,h=null,g=!1;if(r){let d=this.hitDragging.initialHit;r.componentId===d.componentId&&this.isHitComboAllowed&&!this.isHitComboAllowed(d,r)||(h=$(d,r,a.pluginHooks.dateSelectionTransformers)),(!h||!(0,s.isDateSelectionValid)(h,r.dateProfile,a))&&(g=!0,h=null)}h?a.dispatch({type:"SELECT_DATES",selection:h}):l||a.dispatch({type:"UNSELECT_DATES"}),g?(0,s.disableCursor)():(0,s.enableCursor)(),l||(this.dragSelection=h)},this.handlePointerUp=r=>{this.dragSelection&&((0,s.triggerDateSelect)(this.dragSelection,r,this.component.context),this.dragSelection=null)};let{component:t}=e,{options:i}=t.context,n=this.dragging=new m(e.el);n.touchScrollAllowed=!1,n.minDistance=i.selectMinDistance||0,n.autoScroller.isEnabled=i.dragScroll;let o=this.hitDragging=new S(this.dragging,(0,s.interactionSettingsToStore)(e));o.emitter.on("pointerdown",this.handlePointerDown),o.emitter.on("dragstart",this.handleDragStart),o.emitter.on("hitupdate",this.handleHitUpdate),o.emitter.on("pointerup",this.handlePointerUp)}destroy(){this.dragging.destroy()}}function J(c){let{options:e}=c.context,t=e.selectLongPressDelay;return t==null&&(t=e.longPressDelay),t}function $(c,e,t){let i=c.dateSpan,n=e.dateSpan,o=[i.range.start,i.range.end,n.range.start,n.range.end];o.sort(s.compareNumbers);let r={};for(let l of t){let a=l(c,e);if(a===!1)return null;a&&Object.assign(r,a)}return r.range={start:o[0],end:o[3]},r.allDay=i.allDay,r}class D extends s.Interaction{constructor(e){super(e),this.subjectEl=null,this.subjectSeg=null,this.isDragging=!1,this.eventRange=null,this.relevantEvents=null,this.receivingContext=null,this.validMutation=null,this.mutatedRelevantEvents=null,this.handlePointerDown=r=>{let l=r.origEvent.target,{component:a,dragging:h}=this,{mirror:g}=h,{options:d}=a.context,u=a.context;this.subjectEl=r.subjectEl;let E=this.subjectSeg=(0,s.getElSeg)(r.subjectEl),p=(this.eventRange=E.eventRange).instance.instanceId;this.relevantEvents=(0,s.getRelevantEvents)(u.getCurrentData().eventStore,p),h.minDistance=r.isTouch?0:d.eventDragMinDistance,h.delay=r.isTouch&&p!==a.props.eventSelection?te(a):null,d.fixedMirrorParent?g.parentNode=d.fixedMirrorParent:g.parentNode=(0,s.elementClosest)(l,".fc"),g.revertDuration=d.dragRevertDuration;let f=a.isValidSegDownEl(l)&&!(0,s.elementClosest)(l,".fc-event-resizer");h.setIgnoreMove(!f),this.isDragging=f&&r.subjectEl.classList.contains("fc-event-draggable")},this.handleDragStart=r=>{let l=this.component.context,a=this.eventRange,h=a.instance.instanceId;r.isTouch?h!==this.component.props.eventSelection&&l.dispatch({type:"SELECT_EVENT",eventInstanceId:h}):l.dispatch({type:"UNSELECT_EVENT"}),this.isDragging&&(l.calendarApi.unselect(r),l.emitter.trigger("eventDragStart",{el:this.subjectEl,event:new s.EventImpl(l,a.def,a.instance),jsEvent:r.origEvent,view:l.viewApi}))},this.handleHitUpdate=(r,l)=>{if(!this.isDragging)return;let a=this.relevantEvents,h=this.hitDragging.initialHit,g=this.component.context,d=null,u=null,E=null,v=!1,p={affectedEvents:a,mutatedEvents:(0,s.createEmptyEventStore)(),isEvent:!0};if(r){d=r.context;let f=d.options;g===d||f.editable&&f.droppable?(u=ee(h,r,this.eventRange.instance.range.start,d.getCurrentData().pluginHooks.eventDragMutationMassagers),u&&(E=(0,s.applyMutationToEventStore)(a,d.getCurrentData().eventUiBases,u,d),p.mutatedEvents=E,(0,s.isInteractionValid)(p,r.dateProfile,d)||(v=!0,u=null,E=null,p.mutatedEvents=(0,s.createEmptyEventStore)()))):d=null}this.displayDrag(d,p),v?(0,s.disableCursor)():(0,s.enableCursor)(),l||(g===d&&b(h,r)&&(u=null),this.dragging.setMirrorNeedsRevert(!u),this.dragging.setMirrorIsVisible(!r||!this.subjectEl.getRootNode().querySelector(".fc-event-mirror")),this.receivingContext=d,this.validMutation=u,this.mutatedRelevantEvents=E)},this.handlePointerUp=()=>{this.isDragging||this.cleanup()},this.handleDragEnd=r=>{if(this.isDragging){let l=this.component.context,a=l.viewApi,{receivingContext:h,validMutation:g}=this,d=this.eventRange.def,u=this.eventRange.instance,E=new s.EventImpl(l,d,u),v=this.relevantEvents,p=this.mutatedRelevantEvents,{finalHit:f}=this.hitDragging;if(this.clearDrag(),l.emitter.trigger("eventDragStop",{el:this.subjectEl,event:E,jsEvent:r.origEvent,view:a}),g){if(h===l){let M=new s.EventImpl(l,p.defs[d.defId],u?p.instances[u.instanceId]:null);l.dispatch({type:"MERGE_EVENTS",eventStore:p});let C={oldEvent:E,event:M,relatedEvents:(0,s.buildEventApis)(p,l,u),revert(){l.dispatch({type:"MERGE_EVENTS",eventStore:v})}},y={};for(let j of l.getCurrentData().pluginHooks.eventDropTransformers)Object.assign(y,j(g,l));l.emitter.trigger("eventDrop",Object.assign(Object.assign(Object.assign({},C),y),{el:r.subjectEl,delta:g.datesDelta,jsEvent:r.origEvent,view:a})),l.emitter.trigger("eventChange",C)}else if(h){let M={event:E,relatedEvents:(0,s.buildEventApis)(v,l,u),revert(){l.dispatch({type:"MERGE_EVENTS",eventStore:v})}};l.emitter.trigger("eventLeave",Object.assign(Object.assign({},M),{draggedEl:r.subjectEl,view:a})),l.dispatch({type:"REMOVE_EVENTS",eventStore:v}),l.emitter.trigger("eventRemove",M);let C=p.defs[d.defId],y=p.instances[u.instanceId],j=new s.EventImpl(h,C,y);h.dispatch({type:"MERGE_EVENTS",eventStore:p});let Y={event:j,relatedEvents:(0,s.buildEventApis)(p,h,y),revert(){h.dispatch({type:"REMOVE_EVENTS",eventStore:p})}};h.emitter.trigger("eventAdd",Y),r.isTouch&&h.dispatch({type:"SELECT_EVENT",eventInstanceId:u.instanceId}),h.emitter.trigger("drop",Object.assign(Object.assign({},A(f.dateSpan,h)),{draggedEl:r.subjectEl,jsEvent:r.origEvent,view:f.context.viewApi})),h.emitter.trigger("eventReceive",Object.assign(Object.assign({},Y),{draggedEl:r.subjectEl,view:f.context.viewApi}))}}else l.emitter.trigger("_noEventDrop")}this.cleanup()};let{component:t}=this,{options:i}=t.context,n=this.dragging=new m(e.el);n.pointer.selector=D.SELECTOR,n.touchScrollAllowed=!1,n.autoScroller.isEnabled=i.dragScroll;let o=this.hitDragging=new S(this.dragging,s.interactionSettingsStore);o.useSubjectCenter=e.useEventCenter,o.emitter.on("pointerdown",this.handlePointerDown),o.emitter.on("dragstart",this.handleDragStart),o.emitter.on("hitupdate",this.handleHitUpdate),o.emitter.on("pointerup",this.handlePointerUp),o.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}displayDrag(e,t){let i=this.component.context,n=this.receivingContext;n&&n!==e&&(n===i?n.dispatch({type:"SET_EVENT_DRAG",state:{affectedEvents:t.affectedEvents,mutatedEvents:(0,s.createEmptyEventStore)(),isEvent:!0}}):n.dispatch({type:"UNSET_EVENT_DRAG"})),e&&e.dispatch({type:"SET_EVENT_DRAG",state:t})}clearDrag(){let e=this.component.context,{receivingContext:t}=this;t&&t.dispatch({type:"UNSET_EVENT_DRAG"}),e!==t&&e.dispatch({type:"UNSET_EVENT_DRAG"})}cleanup(){this.subjectSeg=null,this.isDragging=!1,this.eventRange=null,this.relevantEvents=null,this.receivingContext=null,this.validMutation=null,this.mutatedRelevantEvents=null}}D.SELECTOR=".fc-event-draggable, .fc-event-resizable";function ee(c,e,t,i){let n=c.dateSpan,o=e.dateSpan,r=n.range.start,l=o.range.start,a={};n.allDay!==o.allDay&&(a.allDay=o.allDay,a.hasEnd=e.context.options.allDayMaintainDuration,o.allDay?r=(0,s.startOfDay)(t):r=t);let h=(0,s.diffDates)(r,l,c.context.dateEnv,c.componentId===e.componentId?c.largeUnit:null);h.milliseconds&&(a.allDay=!1);let g={datesDelta:h,standardProps:a};for(let d of i)d(g,c,e);return g}function te(c){let{options:e}=c.context,t=e.eventLongPressDelay;return t==null&&(t=e.longPressDelay),t}class ie extends s.Interaction{constructor(e){super(e),this.draggingSegEl=null,this.draggingSeg=null,this.eventRange=null,this.relevantEvents=null,this.validMutation=null,this.mutatedRelevantEvents=null,this.handlePointerDown=o=>{let{component:r}=this,l=this.querySegEl(o),a=(0,s.getElSeg)(l),h=this.eventRange=a.eventRange;this.dragging.minDistance=r.context.options.eventDragMinDistance,this.dragging.setIgnoreMove(!this.component.isValidSegDownEl(o.origEvent.target)||o.isTouch&&this.component.props.eventSelection!==h.instance.instanceId)},this.handleDragStart=o=>{let{context:r}=this.component,l=this.eventRange;this.relevantEvents=(0,s.getRelevantEvents)(r.getCurrentData().eventStore,this.eventRange.instance.instanceId);let a=this.querySegEl(o);this.draggingSegEl=a,this.draggingSeg=(0,s.getElSeg)(a),r.calendarApi.unselect(),r.emitter.trigger("eventResizeStart",{el:a,event:new s.EventImpl(r,l.def,l.instance),jsEvent:o.origEvent,view:r.viewApi})},this.handleHitUpdate=(o,r,l)=>{let{context:a}=this.component,h=this.relevantEvents,g=this.hitDragging.initialHit,d=this.eventRange.instance,u=null,E=null,v=!1,p={affectedEvents:h,mutatedEvents:(0,s.createEmptyEventStore)(),isEvent:!0};o&&(o.componentId===g.componentId&&this.isHitComboAllowed&&!this.isHitComboAllowed(g,o)||(u=ne(g,o,l.subjectEl.classList.contains("fc-event-resizer-start"),d.range))),u&&(E=(0,s.applyMutationToEventStore)(h,a.getCurrentData().eventUiBases,u,a),p.mutatedEvents=E,(0,s.isInteractionValid)(p,o.dateProfile,a)||(v=!0,u=null,E=null,p.mutatedEvents=null)),E?a.dispatch({type:"SET_EVENT_RESIZE",state:p}):a.dispatch({type:"UNSET_EVENT_RESIZE"}),v?(0,s.disableCursor)():(0,s.enableCursor)(),r||(u&&b(g,o)&&(u=null),this.validMutation=u,this.mutatedRelevantEvents=E)},this.handleDragEnd=o=>{let{context:r}=this.component,l=this.eventRange.def,a=this.eventRange.instance,h=new s.EventImpl(r,l,a),g=this.relevantEvents,d=this.mutatedRelevantEvents;if(r.emitter.trigger("eventResizeStop",{el:this.draggingSegEl,event:h,jsEvent:o.origEvent,view:r.viewApi}),this.validMutation){let u=new s.EventImpl(r,d.defs[l.defId],a?d.instances[a.instanceId]:null);r.dispatch({type:"MERGE_EVENTS",eventStore:d});let E={oldEvent:h,event:u,relatedEvents:(0,s.buildEventApis)(d,r,a),revert(){r.dispatch({type:"MERGE_EVENTS",eventStore:g})}};r.emitter.trigger("eventResize",Object.assign(Object.assign({},E),{el:this.draggingSegEl,startDelta:this.validMutation.startDelta||(0,s.createDuration)(0),endDelta:this.validMutation.endDelta||(0,s.createDuration)(0),jsEvent:o.origEvent,view:r.viewApi})),r.emitter.trigger("eventChange",E)}else r.emitter.trigger("_noEventResize");this.draggingSeg=null,this.relevantEvents=null,this.validMutation=null};let{component:t}=e,i=this.dragging=new m(e.el);i.pointer.selector=".fc-event-resizer",i.touchScrollAllowed=!1,i.autoScroller.isEnabled=t.context.options.dragScroll;let n=this.hitDragging=new S(this.dragging,(0,s.interactionSettingsToStore)(e));n.emitter.on("pointerdown",this.handlePointerDown),n.emitter.on("dragstart",this.handleDragStart),n.emitter.on("hitupdate",this.handleHitUpdate),n.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}querySegEl(e){return(0,s.elementClosest)(e.subjectEl,".fc-event")}}function ne(c,e,t,i){let n=c.context.dateEnv,o=c.dateSpan.range.start,r=e.dateSpan.range.start,l=(0,s.diffDates)(o,r,n,c.largeUnit);if(t){if(n.add(i.start,l)<i.end)return{startDelta:l}}else if(n.add(i.end,l)>i.start)return{endDelta:l};return null}class re{constructor(e){this.context=e,this.isRecentPointerDateSelect=!1,this.matchesCancel=!1,this.matchesEvent=!1,this.onSelect=i=>{i.jsEvent&&(this.isRecentPointerDateSelect=!0)},this.onDocumentPointerDown=i=>{let n=this.context.options.unselectCancel,o=(0,s.getEventTargetViaRoot)(i.origEvent);this.matchesCancel=!!(0,s.elementClosest)(o,n),this.matchesEvent=!!(0,s.elementClosest)(o,D.SELECTOR)},this.onDocumentPointerUp=i=>{let{context:n}=this,{documentPointer:o}=this,r=n.getCurrentData();if(!o.wasTouchScroll){if(r.dateSelection&&!this.isRecentPointerDateSelect){let l=n.options.unselectAuto;l&&(!l||!this.matchesCancel)&&n.calendarApi.unselect(i)}r.eventSelection&&!this.matchesEvent&&n.dispatch({type:"UNSELECT_EVENT"})}this.isRecentPointerDateSelect=!1};let t=this.documentPointer=new P(document);t.shouldIgnoreMove=!0,t.shouldWatchScroll=!1,t.emitter.on("pointerdown",this.onDocumentPointerDown),t.emitter.on("pointerup",this.onDocumentPointerUp),e.emitter.on("select",this.onSelect)}destroy(){this.context.emitter.off("select",this.onSelect),this.documentPointer.destroy()}}const se={fixedMirrorParent:s.identity},le={dateClick:s.identity,eventDragStart:s.identity,eventDragStop:s.identity,eventDrop:s.identity,eventResizeStart:s.identity,eventResizeStop:s.identity,eventResize:s.identity,drop:s.identity,eventReceive:s.identity,eventLeave:s.identity};class V{constructor(e,t){this.receivingContext=null,this.droppableEvent=null,this.suppliedDragMeta=null,this.dragMeta=null,this.handleDragStart=n=>{this.dragMeta=this.buildDragMeta(n.subjectEl)},this.handleHitUpdate=(n,o,r)=>{let{dragging:l}=this.hitDragging,a=null,h=null,g=!1,d={affectedEvents:(0,s.createEmptyEventStore)(),mutatedEvents:(0,s.createEmptyEventStore)(),isEvent:this.dragMeta.create};n&&(a=n.context,this.canDropElOnCalendar(r.subjectEl,a)&&(h=oe(n.dateSpan,this.dragMeta,a),d.mutatedEvents=(0,s.eventTupleToStore)(h),g=!(0,s.isInteractionValid)(d,n.dateProfile,a),g&&(d.mutatedEvents=(0,s.createEmptyEventStore)(),h=null))),this.displayDrag(a,d),l.setMirrorIsVisible(o||!h||!document.querySelector(".fc-event-mirror")),g?(0,s.disableCursor)():(0,s.enableCursor)(),o||(l.setMirrorNeedsRevert(!h),this.receivingContext=a,this.droppableEvent=h)},this.handleDragEnd=n=>{let{receivingContext:o,droppableEvent:r}=this;if(this.clearDrag(),o&&r){let l=this.hitDragging.finalHit,a=l.context.viewApi,h=this.dragMeta;if(o.emitter.trigger("drop",Object.assign(Object.assign({},A(l.dateSpan,o)),{draggedEl:n.subjectEl,jsEvent:n.origEvent,view:a})),h.create){let g=(0,s.eventTupleToStore)(r);o.dispatch({type:"MERGE_EVENTS",eventStore:g}),n.isTouch&&o.dispatch({type:"SELECT_EVENT",eventInstanceId:r.instance.instanceId}),o.emitter.trigger("eventReceive",{event:new s.EventImpl(o,r.def,r.instance),relatedEvents:[],revert(){o.dispatch({type:"REMOVE_EVENTS",eventStore:g})},draggedEl:n.subjectEl,view:a})}}this.receivingContext=null,this.droppableEvent=null};let i=this.hitDragging=new S(e,s.interactionSettingsStore);i.requireInitial=!1,i.emitter.on("dragstart",this.handleDragStart),i.emitter.on("hitupdate",this.handleHitUpdate),i.emitter.on("dragend",this.handleDragEnd),this.suppliedDragMeta=t}buildDragMeta(e){return typeof this.suppliedDragMeta=="object"?(0,s.parseDragMeta)(this.suppliedDragMeta):typeof this.suppliedDragMeta=="function"?(0,s.parseDragMeta)(this.suppliedDragMeta(e)):ae(e)}displayDrag(e,t){let i=this.receivingContext;i&&i!==e&&i.dispatch({type:"UNSET_EVENT_DRAG"}),e&&e.dispatch({type:"SET_EVENT_DRAG",state:t})}clearDrag(){this.receivingContext&&this.receivingContext.dispatch({type:"UNSET_EVENT_DRAG"})}canDropElOnCalendar(e,t){let i=t.options.dropAccept;return typeof i=="function"?i.call(t.calendarApi,e):typeof i=="string"&&i?!!(0,s.elementMatches)(e,i):!0}}function oe(c,e,t){let i=Object.assign({},e.leftoverProps);for(let g of t.pluginHooks.externalDefTransforms)Object.assign(i,g(c,e));let{refined:n,extra:o}=(0,s.refineEventDef)(i,t),r=(0,s.parseEventDef)(n,o,e.sourceId,c.allDay,t.options.forceEventDuration||!!e.duration,t),l=c.range.start;c.allDay&&e.startTime&&(l=t.dateEnv.add(l,e.startTime));let a=e.duration?t.dateEnv.add(l,e.duration):(0,s.getDefaultEventEnd)(c.allDay,l,t),h=(0,s.createEventInstance)(r.defId,{start:l,end:a});return{def:r,instance:h}}function ae(c){let e=he(c,"event"),t=e?JSON.parse(e):{create:!1};return(0,s.parseDragMeta)(t)}s.config.dataAttrPrefix="";function he(c,e){let t=s.config.dataAttrPrefix,i=(t?t+"-":"")+e;return c.getAttribute("data-"+i)||""}class ce{constructor(e,t={}){this.handlePointerDown=n=>{let{dragging:o}=this,{minDistance:r,longPressDelay:l}=this.settings;o.minDistance=r??(n.isTouch?0:s.BASE_OPTION_DEFAULTS.eventDragMinDistance),o.delay=n.isTouch?l??s.BASE_OPTION_DEFAULTS.longPressDelay:0},this.handleDragStart=n=>{n.isTouch&&this.dragging.delay&&n.subjectEl.classList.contains("fc-event")&&this.dragging.mirror.getMirrorEl().classList.add("fc-event-selected")},this.settings=t;let i=this.dragging=new m(e);i.touchScrollAllowed=!1,t.itemSelector!=null&&(i.pointer.selector=t.itemSelector),t.appendTo!=null&&(i.mirror.parentNode=t.appendTo),i.emitter.on("pointerdown",this.handlePointerDown),i.emitter.on("dragstart",this.handleDragStart),new V(i,t.eventData)}destroy(){this.dragging.destroy()}}class de extends s.ElementDragging{constructor(e){super(e),this.shouldIgnoreMove=!1,this.mirrorSelector="",this.currentMirrorEl=null,this.handlePointerDown=i=>{this.emitter.trigger("pointerdown",i),this.shouldIgnoreMove||this.emitter.trigger("dragstart",i)},this.handlePointerMove=i=>{this.shouldIgnoreMove||this.emitter.trigger("dragmove",i)},this.handlePointerUp=i=>{this.emitter.trigger("pointerup",i),this.shouldIgnoreMove||this.emitter.trigger("dragend",i)};let t=this.pointer=new P(e);t.emitter.on("pointerdown",this.handlePointerDown),t.emitter.on("pointermove",this.handlePointerMove),t.emitter.on("pointerup",this.handlePointerUp)}destroy(){this.pointer.destroy()}setIgnoreMove(e){this.shouldIgnoreMove=e}setMirrorIsVisible(e){if(e)this.currentMirrorEl&&(this.currentMirrorEl.style.visibility="",this.currentMirrorEl=null);else{let t=this.mirrorSelector?document.querySelector(this.mirrorSelector):null;t&&(this.currentMirrorEl=t,t.style.visibility="hidden")}}}class ge{constructor(e,t){let i=document;e===document||e instanceof Element?(i=e,t=t||{}):t=e||{};let n=this.dragging=new de(i);typeof t.itemSelector=="string"?n.pointer.selector=t.itemSelector:i===document&&(n.pointer.selector="[data-event]"),typeof t.mirrorSelector=="string"&&(n.mirrorSelector=t.mirrorSelector);let o=new V(n,t.eventData);o.hitDragging.disablePointCheck=!0}destroy(){this.dragging.destroy()}}var ue=(0,U.createPlugin)({name:"@fullcalendar/interaction",componentInteractions:[Q,Z,D,ie],calendarInteractions:[re],elementDraggingImpl:m,optionRefiners:se,listenerRefiners:le})}}]);
