(self.webpackChunkapp_studio_enterprise_schema_view=self.webpackChunkapp_studio_enterprise_schema_view||[]).push([[2656],{43272:(W,x,e)=>{e.d(x,{A:()=>O});var n=e(18587),v=e(49973),t=e(58504),B=e(74709),E=e(43785),y=e(62278),_=e.n(y),P=e(36486),d=e.n(P);class O{constructor(h,i,o){this.queryExecutor=h,this._translateService=i,this.entityConverter=o,this.absentDataErrorKey="BaseSection.AbsentDataErrorMessage",this.primaryColumnName="Id"}_convertToErrorInfo(h){return{errorCode:null,message:h.message,stackTrace:h.stack}}_addColumnsToEsq(h){this.entityConverter.getEntityColumns({}).forEach(o=>{h.addSchemaColumn(o.path)})}_createDeleteQuery(){return new n.x(this.entitySchemaName)}getBaseErrorResponse(h){return(0,y.of)({success:!1,errorInfo:this._convertToErrorInfo(h),result:null})}handleResponse(h){return h.pipe((0,P.map)(()=>({success:!0,errorInfo:null,result:[]})),(0,P.catchError)(i=>(0,y.of)({success:!1,errorInfo:this._convertToErrorInfo(i),result:[]})))}getItemByIdEsq(h){const i=new v.s(this.entitySchemaName);return this._addColumnsToEsq(i),i.filters.addSchemaColumnFilterWithParameter(t.H.Equal,this.primaryColumnName,h),i}createGetAllItemsEsq(){const h=new v.s(this.entitySchemaName);return this._addColumnsToEsq(h),h}getUpdateQuery(h){const i=new B.N(this.entitySchemaName);return this.entityConverter.getEntityColumns(h).forEach(s=>{this.primaryColumnName===s.path?i.filters.addSchemaColumnFilterWithParameter(t.H.Equal,this.primaryColumnName,s.value):i.addColumn(s.path,s.value,s.type)}),i}getInsertQuery(h){const i=new E.L(this.entitySchemaName);return this.entityConverter.getEntityColumns(h).forEach(s=>{this.primaryColumnName===s.path&&!s.value||i.addColumn(s.path,s.value,s.type)}),i}getDeleteQuery(h){return this.getDeleteQueryWithPrimaryColumnFilter(h.id)}getDeleteQueryWithPrimaryColumnFilter(h){const i=this._createDeleteQuery();return i.filters.addSchemaColumnFilterWithParameter(t.H.Equal,this.primaryColumnName,h),i}loadAdditionalInfo(h){return(0,y.of)(h)}getItems(){const h=this.createGetAllItemsEsq();return this.queryExecutor.executeSelectQuery(h).pipe((0,P.mergeMap)(i=>this.loadAdditionalInfo(i)),(0,P.map)(i=>({success:!0,errorInfo:null,result:i.map(o=>this.entityConverter.getEntity(o))})),(0,P.catchError)(i=>this.getBaseErrorResponse(i)))}getItem(h){const i=this.getItemByIdEsq(h);return this.queryExecutor.executeSelectQuery(i).pipe((0,P.tap)(o=>{if(!(o&&o[0])){const s=this._translateService.instant(this.absentDataErrorKey);throw new Error(s)}}),(0,P.mergeMap)(o=>this.loadAdditionalInfo(o)),(0,P.map)(o=>({success:!0,errorInfo:null,result:[this.entityConverter.getEntity(o[0])]})),(0,P.catchError)(o=>this.getBaseErrorResponse(o)))}insertItem(h){const i=this.getInsertQuery(h),o=this.queryExecutor.executeInsertQuery(i);return this.handleResponse(o)}updateItem(h){const i=this.getUpdateQuery(h),o=this.queryExecutor.executeUpdateQuery(i);return this.handleResponse(o)}deleteItem(h){const i=this.getDeleteQuery(h),o=this.queryExecutor.executeDeleteQuery(i);return this.handleResponse(o)}deleteById(h){const i=this.getDeleteQueryWithPrimaryColumnFilter(h),o=this.queryExecutor.executeDeleteQuery(i);return this.handleResponse(o)}}},42656:(W,x,e)=>{e.d(x,{e:()=>rt});var n=e(5960),v=e(40297),t=e(52989),B=e(55642),E=e(79772),y=e(18351),_=e(47951),P=e(5476),d=e(56484),O=e(1891),M=e(28627),h=e(50663),i=e(57274),o=e(31149),s=e(24091),c=e(90895),u=e(71830),r=e(44267),p=e(39809),A=e(3585),R=e(43691),V=e(5433),C=e(12841),D=e(51521),L=e(18611),w=e(38739),S=e(28503),I=e(30073),f=e(88263),b=e(68759),K=e(90615),F=e(7917),$=e(83463),g=e(59131),Z=e(77592),q=e(34760),st=e(3671),k=e(52793),j=e(50999),l=e(10098),a=e(59969),m=e(8144),T=e(20555),H=e(62278);const Q=["*"];let G=class Ct extends m.Mm{constructor(U){super(U),this._modeWidthLimit=794,this._subscriptions=new H.Subscription,this.combinedModeEnabledChange=new g.EventEmitter,this.chatViewInit=new g.EventEmitter,this.combinedModeButtonVisibleChange=new g.EventEmitter,this.changeCombinedMode=new g.EventEmitter,this.openChatSession=new g.EventEmitter,this._customEventService=U.get(a.Dj)}_toggleCombinedModeButtonVisibility(U){this.combinedModeButtonVisible!==U&&(this.combinedModeButtonVisible=U,this.combinedModeButtonVisibleChange.emit(U))}_resetCombinedModeButtonEnabled(U){U||(this.combinedModeEnabled=!0,this.combinedModeEnabledChange.emit(!0))}updateResponsiveStyles(){const z=this.elementRef.nativeElement?.parentElement?.getBoundingClientRect().width>this._modeWidthLimit;this._toggleCombinedModeButtonVisibility(z),this._resetCombinedModeButtonEnabled(z),!(z===this.isCombinedMode||!this.combinedModeEnabled)&&this.changeCombinedMode.emit(z)}ngOnInit(){this._subscriptions.add(this._customEventService.subscribe(T.k).subscribe(U=>this.openChatSession.emit(U)))}ngAfterViewInit(){super.ngAfterViewInit(),this.chatViewInit.emit()}ngOnDestroy(){this._subscriptions.unsubscribe()}static{this.\u0275fac=function(N){return new(N||Ct)(g.\u0275\u0275directiveInject(g.Injector))}}static{this.\u0275cmp=g.\u0275\u0275defineComponent({type:Ct,selectors:[["crt-chat"]],inputs:{combinedModeEnabled:"combinedModeEnabled",isCombinedMode:"isCombinedMode",combinedModeButtonVisible:"combinedModeButtonVisible"},outputs:{combinedModeEnabledChange:"combinedModeEnabledChange",chatViewInit:"chatViewInit",combinedModeButtonVisibleChange:"combinedModeButtonVisibleChange",changeCombinedMode:"changeCombinedMode",openChatSession:"openChatSession"},features:[g.\u0275\u0275InheritDefinitionFeature],ngContentSelectors:Q,decls:2,vars:0,consts:[[1,"items"]],template:function(N,z){N&1&&(g.\u0275\u0275projectionDef(),g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275projection(1),g.\u0275\u0275elementEnd())},styles:["[_nghost-%COMP%]{display:block;height:100%}.items[_ngcontent-%COMP%]{height:100%}"]})}};(0,n.__decorate)([(0,Z.k)(),(0,n.__metadata)("design:type",Boolean)],G.prototype,"combinedModeEnabled",void 0),(0,n.__decorate)([(0,q.j)(),(0,n.__metadata)("design:type",Object)],G.prototype,"combinedModeEnabledChange",void 0),(0,n.__decorate)([(0,q.j)(),(0,n.__metadata)("design:type",Object)],G.prototype,"chatViewInit",void 0),(0,n.__decorate)([(0,Z.k)(),(0,n.__metadata)("design:type",Boolean)],G.prototype,"isCombinedMode",void 0),(0,n.__decorate)([(0,Z.k)(),(0,n.__metadata)("design:type",Boolean)],G.prototype,"combinedModeButtonVisible",void 0),(0,n.__decorate)([(0,q.j)(),(0,n.__metadata)("design:type",Object)],G.prototype,"combinedModeButtonVisibleChange",void 0),(0,n.__decorate)([(0,q.j)(),(0,n.__metadata)("design:type",g.EventEmitter)],G.prototype,"changeCombinedMode",void 0),(0,n.__decorate)([(0,q.j)(),(0,n.__metadata)("design:type",g.EventEmitter)],G.prototype,"openChatSession",void 0),G=(0,n.__decorate)([(0,st.v)({type:"crt.Chat",contentSlots:["items"]}),(0,k.f)({toolbarConfig:{requiredFeatures:{ShowDesignerDemoItems:!0},position:261,groupType:j.h.Components,icon:e(15208),hint:"Components.Chat.Hint",defaultPropertyValues:{masterSchemaId:"$Id",items:[]},defaultLocalizableStrings:{caption:"Components.Chat.Caption",label:"Components.Chat.Caption"}},propertiesPanelComponentTypeName:"crt.ChatPropertiesPanel",viewElementGroupType:l.J.Components,typeCaption:"Components.Chat.Caption",designControlConfig:{allowDesignContent:!0},designViewItemCommands:{create:"crt.CreateChatCommand"}}),(0,n.__metadata)("design:paramtypes",[g.Injector])],G);var it=e(89863),et=e(11395),nt=e(68712),at=e(65001),ot=e(95211),Dt=e(28399),Tt=e(62115);const xt=["toolbarItems"],At=["inputs"],bt=X=>({"message-editor-body-button-focussed":X});function Bt(X,U){X&1&&g.\u0275\u0275elementContainer(0)}function Rt(X,U){if(X&1&&(g.\u0275\u0275elementStart(0,"div"),g.\u0275\u0275template(1,Bt,1,0,"ng-container",8),g.\u0275\u0275elementEnd()),X&2){const N=U.$implicit;g.\u0275\u0275advance(),g.\u0275\u0275property("ngTemplateOutlet",N)}}function Lt(X,U){if(X&1&&(g.\u0275\u0275elementContainerStart(0),g.\u0275\u0275elementStart(1,"div",6),g.\u0275\u0275template(2,Rt,2,1,"div",7),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementContainerEnd()),X&2){const N=g.\u0275\u0275nextContext();g.\u0275\u0275advance(2),g.\u0275\u0275property("ngForOf",N.inputsTemplates)}}function St(X,U){X&1&&g.\u0275\u0275elementContainer(0)}function Ut(X,U){if(X&1&&(g.\u0275\u0275elementStart(0,"div"),g.\u0275\u0275template(1,St,1,0,"ng-container",8),g.\u0275\u0275elementEnd()),X&2){const N=U.$implicit;g.\u0275\u0275advance(),g.\u0275\u0275property("ngTemplateOutlet",N)}}function Wt(X,U){if(X&1&&(g.\u0275\u0275elementContainerStart(0),g.\u0275\u0275elementStart(1,"div",9),g.\u0275\u0275template(2,Ut,2,1,"div",7),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementContainerEnd()),X&2){const N=g.\u0275\u0275nextContext();g.\u0275\u0275advance(2),g.\u0275\u0275property("ngForOf",N.toolbarItemsTemplates)}}let tt=class lt extends nt.K{constructor(){super(...arguments),this.sizeEnum=at.Z,this.iconPositionEnum=ot.q,this.sendMessage=new g.EventEmitter}set toolbarItems(U){this._toolbarItems=U}set inputs(U){this._inputs=U}onSendClicked(){this.isInputContentEmpty()||this.sendMessage.emit(this.chatInput)}isInputContentEmpty(){return(0,Dt.isEmpty)(this.chatInput)}static{this.\u0275fac=(()=>{let U;return function(z){return(U||(U=g.\u0275\u0275getInheritedFactory(lt)))(z||lt)}})()}static{this.\u0275cmp=g.\u0275\u0275defineComponent({type:lt,selectors:[["crt-message-editor-body"]],contentQueries:function(N,z,J){if(N&1&&(g.\u0275\u0275contentQuery(J,xt,4,g.TemplateRef),g.\u0275\u0275contentQuery(J,At,4,g.TemplateRef)),N&2){let Y;g.\u0275\u0275queryRefresh(Y=g.\u0275\u0275loadQuery())&&(z.toolbarItemsTemplates=Y),g.\u0275\u0275queryRefresh(Y=g.\u0275\u0275loadQuery())&&(z.inputsTemplates=Y)}},inputs:{toolbarItems:"toolbarItems",inputs:"inputs",isFocused:"isFocused",chatInput:"chatInput"},outputs:{sendMessage:"sendMessage"},features:[g.\u0275\u0275InheritDefinitionFeature],decls:8,vars:12,consts:[[1,"message-editor-body"],[4,"ngIf"],[1,"message-editor-body-toolbar"],[1,"message-editor-body-toolbar-dropzone"],[1,"message-editor-body-toolbar-send"],[3,"clicked","ngClass","iconPosition","size","icon","disabled","title"],[1,"message-editor-input-container"],[4,"ngFor","ngForOf"],[4,"ngTemplateOutlet"],[1,"message-editor-toolbar-container"]],template:function(N,z){N&1&&(g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275template(1,Lt,3,1,"ng-container",1),g.\u0275\u0275elementStart(2,"div",2)(3,"div",3),g.\u0275\u0275template(4,Wt,3,1,"ng-container",1),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(5,"div",4)(6,"crt-button",5),g.\u0275\u0275pipe(7,"translate"),g.\u0275\u0275listener("clicked",function(){return z.onSendClicked()}),g.\u0275\u0275elementEnd()()()()),N&2&&(g.\u0275\u0275advance(),g.\u0275\u0275property("ngIf",z.inputsTemplates==null?null:z.inputsTemplates.length),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngIf",z.toolbarItemsTemplates==null?null:z.toolbarItemsTemplates.length),g.\u0275\u0275advance(2),g.\u0275\u0275propertyInterpolate("title",g.\u0275\u0275pipeBind1(7,8,"MessageEditor.SendButtonHint")),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction1(10,bt,z.isFocused===!0))("iconPosition",z.iconPositionEnum.OnlyIcon)("size",z.sizeEnum.Small)("icon","send-icon")("disabled",z.isInputContentEmpty()))},dependencies:[v.NgClass,v.NgForOf,v.NgIf,v.NgTemplateOutlet,Tt.B,E.TranslatePipe],styles:["[_nghost-%COMP%]{position:relative;width:100%}[_nghost-%COMP%]   .message-editor-body[_ngcontent-%COMP%]   .message-editor-body-toolbar[_ngcontent-%COMP%]{display:flex;margin-top:-32px;padding:7px 8px 3px 5px}[_nghost-%COMP%]   .message-editor-body[_ngcontent-%COMP%]   .message-editor-body-toolbar[_ngcontent-%COMP%]   .message-editor-body-toolbar-dropzone[_ngcontent-%COMP%]{flex-grow:1}[_nghost-%COMP%]   .message-editor-body[_ngcontent-%COMP%]   .message-editor-body-toolbar[_ngcontent-%COMP%]   .message-editor-body-toolbar-dropzone[_ngcontent-%COMP%]   .message-editor-toolbar-container[_ngcontent-%COMP%]{display:flex;flex-direction:row}[_nghost-%COMP%]   .message-editor-body[_ngcontent-%COMP%]   .message-editor-body-toolbar[_ngcontent-%COMP%]   .message-editor-body-toolbar-send[_ngcontent-%COMP%]{text-align:right}"]})}};(0,n.__decorate)([(0,Z.k)(),(0,n.__metadata)("design:type",Array),(0,n.__metadata)("design:paramtypes",[Array])],tt.prototype,"toolbarItems",null),(0,n.__decorate)([(0,Z.k)(),(0,n.__metadata)("design:type",Array),(0,n.__metadata)("design:paramtypes",[Array])],tt.prototype,"inputs",null),(0,n.__decorate)([(0,q.j)(),(0,n.__metadata)("design:type",Object)],tt.prototype,"sendMessage",void 0),(0,n.__decorate)([(0,Z.k)(),(0,n.__metadata)("design:type",Boolean)],tt.prototype,"isFocused",void 0),(0,n.__decorate)([(0,Z.k)(),(0,n.__metadata)("design:type",String)],tt.prototype,"chatInput",void 0),tt=(0,n.__decorate)([(0,st.v)({type:"crt.MessageEditorBody",contentSlots:[{name:"inputs",lazy:!0,input:!0},{name:"toolbarItems",lazy:!0,input:!0}]})],tt);var Ot=e(73308),Kt=e(41287),Ft=e(844),jt=e(96158);let mt=class extends Kt.l{constructor(){super(...arguments),this._actionCode=jt.g.TriggerMention}handle(U){var N=this;return(0,Ot.A)(function*(){yield N.next?.handle(U),U.$context[U.actionTarget]=N._actionCode,setTimeout(()=>U.$context[U.actionTarget]="",0)})()}};mt=(0,n.__decorate)([(0,Ft.l)({type:"crt.TriggerMentionRequestHandler",requestType:"crt.TriggerMentionRequest"})],mt);var Vt=e(4164),Ht=e(13555);let ht=class{constructor(U){this._searchTrimValue=50,this._chatDraftService=U.get(Ht.X)}_trimChatPreview(U,N,z){const J=U||"",Y=N?.trim();if(!Y||this._chatDraftService.getDraft(z))return U;if(!J)return J.length>this._searchTrimValue?J.slice(0,this._searchTrimValue)+"\u2026":J;const It=J.toLowerCase().indexOf(Y.toLowerCase());if(It===-1)return J.length>this._searchTrimValue?J.slice(0,this._searchTrimValue)+"\u2026":J;const pt=Math.max(0,It-Math.floor((this._searchTrimValue-Y.length)/2));let ut=pt+this._searchTrimValue;ut>J.length&&(ut=J.length);let gt=J.slice(pt,ut);return pt>0&&(gt="\u2026"+gt),gt}convert(U,N){var z=this;return(0,Ot.A)(function*(){if(!U)return[];const J=yield N.attributes.ChatsSearchFilter;return U.map(Y=>({...Y,preview:z._trimChatPreview(Y.preview,J,Y.id)}))})()}};ht=(0,n.__decorate)([(0,Vt.a)({type:"crt.ChatPreviewTrimConverter"}),(0,n.__metadata)("design:paramtypes",[g.Injector])],ht);var wt=e(42963),Nt=e(4944),kt=e(20903),Qt=e(99556),zt=e(53395),$t=e(53251),Gt=e(1978);let rt=class vt{constructor(U){this._materialIconsRegistrator=U,this._materialIconsRegistrator.addIcons([{name:"message-editor-send-icon",icon:e(21888)},{name:"arrow-down-heavy",icon:e(73869)},{name:"empty-chat-contact-designer-skeleton-icon",icon:e(78517)}])}static{this.\u0275fac=function(N){return new(N||vt)(g.\u0275\u0275inject(h.K))}}static{this.\u0275mod=g.\u0275\u0275defineNgModule({type:vt})}static{this.\u0275inj=g.\u0275\u0275defineInjector({providers:[{provide:C.m,useClass:Gt.k,multi:!0}],imports:[t.MatIconModule,v.CommonModule,i.u,y.C,o.q,s.S,E.TranslateModule,R.X,c.J,D.MarkdownModule.forRoot(),_.x,u.A,P.q,d.S,O.H,r.D,p.E,M.f,V.f]})}};rt=(0,n.__decorate)([(0,B.g)({viewElements:[L.g,w.E,S.j,tt,I.z,f.k,G,$.l,b.I],requestHandlers:[wt.o,Nt.G,kt.x,mt,Qt.m,zt.b,$t.h],converters:[ht]}),(0,n.__metadata)("design:paramtypes",[h.K])],rt),function(){(typeof ngJitMode>"u"||ngJitMode)&&g.\u0275\u0275setNgModuleScope(rt,{declarations:[K.z,L.g,w.E,S.j,tt,I.z,F.z,f.k,G,it.d,$.l,b.I,et.P],imports:[t.MatIconModule,v.CommonModule,i.u,y.C,o.q,s.S,E.TranslateModule,R.X,c.J,D.MarkdownModule,_.x,u.A,P.q,A.d,d.S,O.H,r.D,p.E,M.f,V.f],exports:[K.z,L.g,w.E,S.j,tt,I.z,F.z,f.k,G,$.l,b.I,et.P]})}()},88263:(W,x,e)=>{e.d(x,{k:()=>s});var n=e(5960),v=e.n(n),t=e(59131),B=e.n(t),E=e(71252),y=e.n(E),_=e(77592),P=e(34760),d=e(3671),O=e(96677),M=e(8144),h=e(62115),i=e(79772),o=e.n(i);let s=class Et extends M.Mm{set caption(u){this._consentText=u}get caption(){return this._sanitizer.bypassSecurityTrustHtml(this._consentText)}constructor(u){super(u),this.acceptClicked=new t.EventEmitter,this._sanitizer=u.get(E.DomSanitizer)}agreeClicked(){this.acceptClicked.emit()}static{this.\u0275fac=function(r){return new(r||Et)(t.\u0275\u0275directiveInject(t.Injector))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:Et,selectors:[["crt-chat-disclaimer"]],inputs:{consentCode:"consentCode",caption:"caption"},outputs:{acceptClicked:"acceptClicked"},features:[t.\u0275\u0275InheritDefinitionFeature],decls:5,vars:4,consts:[[1,"outer-border"],[1,"disclaimer-message",3,"innerHTML"],["color","primary","size","large","data-qa","button-disclaimer-agree",1,"agree-button",3,"clicked"]],template:function(r,p){r&1&&(t.\u0275\u0275elementStart(0,"div",0),t.\u0275\u0275element(1,"span",1),t.\u0275\u0275elementStart(2,"crt-button",2),t.\u0275\u0275listener("clicked",function(){return p.agreeClicked()}),t.\u0275\u0275text(3),t.\u0275\u0275pipe(4,"translate"),t.\u0275\u0275elementEnd()()),r&2&&(t.\u0275\u0275advance(),t.\u0275\u0275property("innerHTML",p.caption,t.\u0275\u0275sanitizeHtml),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(4,2,"CopilotDisclaimer.AgreeButton")," "))},dependencies:[h.B,i.TranslatePipe],styles:['.outer-border[_ngcontent-%COMP%]{position:relative;display:inline-block;padding:12px 16px;background:linear-gradient(90deg,#fafbfe,#fcfafe);border-radius:15px;border-width:1px;z-index:1}.outer-border[_ngcontent-%COMP%]   .agree-button[_ngcontent-%COMP%]{padding-top:8px;float:inline-end}.outer-border[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;z-index:-1;background:linear-gradient(90deg,#c4bdff,#ecb5ff);border-radius:16px}.outer-border[_ngcontent-%COMP%]:after{background:linear-gradient(90deg,#fafbfe,#fcfafe);content:"";position:absolute;inset:1px;border-radius:15px;z-index:-1}.disclaimer-message[_ngcontent-%COMP%]{display:block}']})}};(0,n.__decorate)([(0,_.k)(),(0,n.__metadata)("design:type",String)],s.prototype,"consentCode",void 0),(0,n.__decorate)([(0,P.j)(),(0,n.__metadata)("design:type",Object)],s.prototype,"acceptClicked",void 0),(0,n.__decorate)([(0,_.k)(),(0,n.__metadata)("design:type",String),(0,n.__metadata)("design:paramtypes",[String])],s.prototype,"caption",null),s=(0,n.__decorate)([(0,d.v)({type:"crt.ChatDisclaimer",reuseStrategy:O.B.Reuse}),(0,n.__metadata)("design:paramtypes",[t.Injector])],s)},68759:(W,x,e)=>{e.d(x,{I:()=>L});var n=e(5960),v=e.n(n),t=e(59131),B=e.n(t),E=e(86464),y=e(77592),_=e(3671),P=e(15959),d=e(40297),O=e.n(d),M=e(62115),h=e(92340),i=e(84137),o=e(4227),s=e(54653),c=e(79772),u=e.n(c),r=e(38884),p=e(79693);const A=w=>({dataType:w}),R=w=>({$implicit:w});function V(w,S){if(w&1&&(t.\u0275\u0275elementStart(0,"div",12),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),w&2){const I=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate1(" ",I.chat.unreadMessagesCount," ")}}function C(w,S){if(w&1){const I=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",13)(1,"crt-button",14,0),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275listener("click",function(b){return t.\u0275\u0275restoreView(I),b.preventDefault(),t.\u0275\u0275resetView(b.stopPropagation())})("menuOpened",function(){t.\u0275\u0275restoreView(I);const b=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(b.isActionsMenuOpened=!0)})("menuClosed",function(){t.\u0275\u0275restoreView(I);const b=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(b.isActionsMenuOpened=!1)}),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(4,"crt-menu",15,1),t.\u0275\u0275elementEnd()}if(w&2){const I=t.\u0275\u0275reference(5),f=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(),t.\u0275\u0275property("crtMenuTriggerFor",I)("crtMenuTriggerData",t.\u0275\u0275pureFunction1(6,R,f.chatMenuItems))("caption",t.\u0275\u0275pipeBind1(3,4,"ChatList.ChatItem.ActionsMenuCaption")),t.\u0275\u0275advance(3),t.\u0275\u0275property("items",f.chatMenuItems)}}function D(w,S){if(w&1){const I=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",3),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(I);const b=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(b.chatClick())})("mouseenter",function(){t.\u0275\u0275restoreView(I);const b=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(b.onChatHovered(!0))})("mouseleave",function(){t.\u0275\u0275restoreView(I);const b=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(b.onChatHovered(!1))}),t.\u0275\u0275elementStart(1,"div",4),t.\u0275\u0275element(2,"crt-image-input",5),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(3,"div",6),t.\u0275\u0275element(4,"div",7),t.\u0275\u0275pipe(5,"highlight"),t.\u0275\u0275elementStart(6,"div",8),t.\u0275\u0275pipe(7,"translate"),t.\u0275\u0275text(8),t.\u0275\u0275pipe(9,"dateTimeFormat"),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(10,"div",9),t.\u0275\u0275pipe(11,"highlight"),t.\u0275\u0275pipe(12,"translate"),t.\u0275\u0275template(13,V,2,1,"div",10)(14,C,6,8,"div",11),t.\u0275\u0275elementEnd()()}if(w&2){const I=t.\u0275\u0275nextContext();t.\u0275\u0275classMap(I.classes),t.\u0275\u0275attribute("aria-pressed",I.isSelected),t.\u0275\u0275advance(2),t.\u0275\u0275classMap(I.imageClass),t.\u0275\u0275property("value",I.chat.author.photo)("placeholder",I.chat.author.name)("customBorderWidth","1px")("crtTooltip",I.chat.author.name),t.\u0275\u0275advance(2),t.\u0275\u0275property("innerHtml",t.\u0275\u0275pipeBind2(5,17,I.chat.caption,I.searchFilter),t.\u0275\u0275sanitizeHtml),t.\u0275\u0275attribute("aria-label",I.chat.author.name+": "+I.chat.caption),t.\u0275\u0275advance(2),t.\u0275\u0275attribute("aria-label",t.\u0275\u0275pipeBind1(7,20,"ChatItem.Date")),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind2(9,22,I.chat.date,t.\u0275\u0275pureFunction1(31,A,I.dateFormatType))," "),t.\u0275\u0275advance(2),t.\u0275\u0275property("innerHtml",t.\u0275\u0275pipeBind3(11,25,I.chat.preview,I.searchFilter,!0),t.\u0275\u0275sanitizeHtml),t.\u0275\u0275attribute("aria-label",t.\u0275\u0275pipeBind1(12,29,"ChatItem.LastMessage")+": "+I.chat.preview),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngIf",I.chat.unreadMessagesCount>0),t.\u0275\u0275advance(),t.\u0275\u0275property("ngIf",(I.chatMenuItems==null?null:I.chatMenuItems.length)&&I.messageActionsVisible)}}let L=class ft{get classes(){return this.isSelected&&this.isCombinedMode?"chat-item chat-item-selected":"chat-item"}get imageClass(){return this.chat?.author.name==="Creatio.ai"?"chat-author-default":"chat-author"}get isCombined(){return this.isCombinedMode}set chat(S){this._chat=S,this._chat&&(this.dateFormatType=this._checkIfDateToday(this._chat.date)?E.r.Time:E.r.Date)}get chat(){return this._chat}get chatMenuItems(){return this._chatMenuItems}set chatMenuItems(S){S?.forEach(I=>{I.clicked.params.callback=f=>{this.menuItemsFocused.emit(f)}}),this._chatMenuItems=S}constructor(S){this.elementRef=S,this._searchTrimValue=50,this.isHovered=!1,this.isFocused=!1,this.isActionsMenuOpened=!1,this.dateFormatType=E.r.Time,this.chatFocused=new t.EventEmitter,this.menuItemsFocused=new t.EventEmitter,this.chatClicked=new t.EventEmitter}_disableAvatarTabFocus(){document.querySelectorAll(".avatar *").forEach(I=>{I.setAttribute("tabindex","-1")})}_checkIfDateToday(S){if(!S)return!1;const I=typeof S=="string"?new Date(S):S;if(!(I instanceof Date)||isNaN(I.getTime()))return!1;const f=new Date;return I.getDate()===f.getDate()&&I.getMonth()===f.getMonth()&&I.getFullYear()===f.getFullYear()}_onChatFocused(){this.chatFocused.emit(this.chat),this.isHovered=!0}_onChatBlurred(){this.isHovered=!1}chatClick(){this.chatClicked.emit(this.chat)}ngAfterViewInit(){this._disableAvatarTabFocus()}onChatHovered(S){S?this._onChatFocused():this._onChatBlurred()}get messageActionsVisible(){return this.isHovered||this.isActionsMenuOpened||this.isFocused}onFocus(){this.isFocused=!0,this._onChatFocused()}onBlur(){this._onChatBlurred()}onFocusOut(S){const I=S.relatedTarget,f=this.elementRef.nativeElement;(!I||!f.contains(I))&&(this.isFocused=!1)}static{this.\u0275fac=function(I){return new(I||ft)(t.\u0275\u0275directiveInject(t.ElementRef))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:ft,selectors:[["crt-chat-item"]],hostVars:2,hostBindings:function(I,f){I&1&&t.\u0275\u0275listener("focus",function(){return f.onFocus()})("blur",function(){return f.onBlur()})("focusout",function(K){return f.onFocusOut(K)}),I&2&&t.\u0275\u0275classProp("combined-item-mode",f.isCombined)},inputs:{chat:"chat",searchFilter:"searchFilter",chatMenuItems:"chatMenuItems",isCombinedMode:"isCombinedMode",isSelected:"isSelected"},outputs:{chatFocused:"chatFocused",menuItemsFocused:"menuItemsFocused",chatClicked:"chatClicked"},decls:1,vars:1,consts:[["trigger","crtMenuTrigger"],["chatMenu",""],["tabindex","-1","role","button",3,"class","click","mouseenter","mouseleave",4,"ngIf"],["tabindex","-1","role","button",3,"click","mouseenter","mouseleave"],["aria-hidden","true",1,"avatar"],["readonly","true","placeholderMode","abbreviation","borderRadius","large","positioning","cover","size","small",3,"value","placeholder","customBorderWidth","crtTooltip"],[1,"preview-container"],["role","heading","aria-level","3",1,"caption",3,"innerHtml"],[1,"date"],["role","text",1,"preview",3,"innerHtml"],["class","unread-counter",4,"ngIf"],["class","actions-container",4,"ngIf"],[1,"unread-counter"],[1,"actions-container"],["data-qa","actions-button","icon","more-button-icon","iconPosition","only-icon","color","default","size","small","iconPosition","only-icon",1,"chat-item-actions-button",3,"click","menuOpened","menuClosed","crtMenuTriggerFor","crtMenuTriggerData","caption"],[3,"items"]],template:function(I,f){I&1&&t.\u0275\u0275template(0,D,15,33,"div",2),I&2&&t.\u0275\u0275property("ngIf",f.chat)},dependencies:[d.NgIf,M.B,h.g,i.d,o.IK,s.O,c.TranslatePipe,r.V,p.v],styles:[".chat-item[_ngcontent-%COMP%]{display:flex;padding:16px 16px 16px 8px;align-items:flex-start;align-self:stretch;min-width:0}.chat-item[_ngcontent-%COMP%]   .author[_ngcontent-%COMP%]{margin:0 4px;display:flex;align-items:flex-end;padding-bottom:2px}.chat-item[_ngcontent-%COMP%]   .preview-container[_ngcontent-%COMP%]{display:grid;margin-inline-start:8px;padding-top:2px;flex-direction:column;align-items:flex-start;gap:6px;flex:1 0 0;min-width:0;grid-template-columns:1fr auto;grid-template-rows:auto auto}.chat-item[_ngcontent-%COMP%]   .preview-container[_ngcontent-%COMP%]   .caption[_ngcontent-%COMP%]{align-items:center;gap:10px;flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;min-width:0;grid-column:1;grid-row:1}.chat-item[_ngcontent-%COMP%]   .preview-container[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{margin-left:8px;white-space:nowrap;grid-column:2;grid-row:1}.chat-item[_ngcontent-%COMP%]   .preview-container[_ngcontent-%COMP%]   .preview[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;word-break:break-word;grid-column:1;grid-row:2}.chat-item[_ngcontent-%COMP%]   .preview-container[_ngcontent-%COMP%]   .unread-counter[_ngcontent-%COMP%]{margin-left:8px;white-space:nowrap;grid-column:2;grid-row:2;display:flex;justify-content:center;align-items:center;width:20px;height:20px;border-radius:50%;padding:0;justify-self:end;align-self:end}.chat-item[_ngcontent-%COMP%]   .preview-container[_ngcontent-%COMP%]   .actions-container[_ngcontent-%COMP%]{grid-column:2;grid-row:2;display:flex;justify-content:center;align-items:center;justify-self:end;align-self:end;height:16px}.chat-item-selected[_ngcontent-%COMP%]{border-start-start-radius:8px;border-end-start-radius:8px}[_nghost-%COMP%]:not(.combined-item-mode)   .chat-item[_ngcontent-%COMP%]:hover{cursor:pointer;border-radius:8px}.combined-item-mode[_nghost-%COMP%]   .chat-item[_ngcontent-%COMP%]:hover{cursor:pointer;border-start-start-radius:8px;border-end-start-radius:8px}"]})}};(0,n.__decorate)([(0,y.k)(),(0,n.__metadata)("design:type",P.H),(0,n.__metadata)("design:paramtypes",[P.H])],L.prototype,"chat",null),(0,n.__decorate)([(0,y.k)(),(0,n.__metadata)("design:type",String)],L.prototype,"searchFilter",void 0),(0,n.__decorate)([(0,y.k)(),(0,n.__metadata)("design:type",Array),(0,n.__metadata)("design:paramtypes",[Array])],L.prototype,"chatMenuItems",null),(0,n.__decorate)([(0,y.k)(),(0,n.__metadata)("design:type",Boolean)],L.prototype,"isCombinedMode",void 0),(0,n.__decorate)([(0,y.k)(),(0,n.__metadata)("design:type",Boolean)],L.prototype,"isSelected",void 0),L=(0,n.__decorate)([(0,_.v)({type:"crt.ChatItem"}),(0,n.__metadata)("design:paramtypes",[t.ElementRef])],L)},83463:(W,x,e)=>{e.d(x,{l:()=>j});var n=e(5960),v=e.n(n),t=e(59131),B=e.n(t),E=e(77592),y=e(34760),_=e(3671),P=e(96677),d=e(79772),O=e.n(d),M=e(8144),h=e(26594),i=e(97842),o=e(62278),s=e.n(o),c=e(29957),u=e.n(c),r=e(40297),p=e.n(r),A=e(62115),R=e(12325),V=e(86432),C=e(58433),D=e(41571),L=e(66675),w=e(22817),S=e(68759);const I=["chatListContainer"],f=["chatItemRef"];function b(l,a){if(l&1){const m=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"crt-search-filter",9),t.\u0275\u0275listener("valueChange",function(H){t.\u0275\u0275restoreView(m);const Q=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(Q.onSearchFilterChanged(H))}),t.\u0275\u0275elementEnd()}if(l&2){const m=t.\u0275\u0275nextContext();t.\u0275\u0275property("value",m.searchFilter)("iconOnly",!1)}}function K(l,a){if(l&1){const m=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"crt-chat-item",11,3),t.\u0275\u0275listener("chatClicked",function(H){t.\u0275\u0275restoreView(m);const Q=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(Q.onChatClicked(H))})("chatFocused",function(H){t.\u0275\u0275restoreView(m);const Q=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(Q.onChatFocused(H))})("menuItemsFocused",function(H){t.\u0275\u0275restoreView(m);const Q=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(Q.menuItemsFocused(H))}),t.\u0275\u0275elementEnd()}if(l&2){const m=a.$implicit,T=t.\u0275\u0275nextContext(2);t.\u0275\u0275property("chat",m)("searchFilter",T.searchFilter)("isCombinedMode",T.isCombinedMode)("isSelected",m.id===T.selectedChatId)("chatMenuItems",T.menuItems),t.\u0275\u0275attribute("aria-label",T.getChatItemAriaLabel(m))("aria-selected",m.id===T.selectedChatId)}}function F(l,a){if(l&1&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275element(1,"crt-skeleton-loader",12),t.\u0275\u0275elementContainerEnd()),l&2){const m=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(),t.\u0275\u0275property("styles",m.skeletonConfig)}}function $(l,a){if(l&1){const m=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",13,3)(2,"div",14),t.\u0275\u0275listener("crtObserveElementInViewportStateChange",function(H){t.\u0275\u0275restoreView(m);const Q=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(Q.onLastItemStateChange(H))}),t.\u0275\u0275elementEnd()()}}function g(l,a){if(l&1&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275template(1,K,2,7,"crt-chat-item",10)(2,F,2,1,"ng-container",8)(3,$,3,0,"ng-template",null,2,t.\u0275\u0275templateRefExtractor),t.\u0275\u0275elementContainerEnd()),l&2){const m=t.\u0275\u0275reference(4),T=t.\u0275\u0275nextContext();t.\u0275\u0275advance(),t.\u0275\u0275property("ngForOf",T.chats)("ngForTrackBy",T.trackByChatId),t.\u0275\u0275advance(),t.\u0275\u0275property("ngIf",T.loading)("ngIfElse",m)}}function Z(l,a){if(l&1&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275element(1,"crt-placeholder",17),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275elementContainerEnd()),l&2){const m=t.\u0275\u0275nextContext(3);t.\u0275\u0275advance(),t.\u0275\u0275propertyInterpolate("title",t.\u0275\u0275pipeBind1(2,3,"ChatList.NoDataBySearchFilter")),t.\u0275\u0275propertyInterpolate("subhead",t.\u0275\u0275pipeBind1(3,5,"ChatList.NoDataBySearchFilterSubtitle")),t.\u0275\u0275property("image",m.placeholderSearch)}}function q(l,a){if(l&1){const m=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",18),t.\u0275\u0275element(1,"crt-lottie",19)(2,"crt-label",20),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275elementStart(4,"crt-button",21),t.\u0275\u0275pipe(5,"translate"),t.\u0275\u0275listener("clicked",function(){t.\u0275\u0275restoreView(m);const H=t.\u0275\u0275nextContext(3);return t.\u0275\u0275resetView(H.onCreateChatClicked())}),t.\u0275\u0275text(6),t.\u0275\u0275pipe(7,"translate"),t.\u0275\u0275elementEnd()()}if(l&2){const m=t.\u0275\u0275nextContext(3);t.\u0275\u0275advance(),t.\u0275\u0275property("config",m.noDataAnimationOptions),t.\u0275\u0275advance(),t.\u0275\u0275property("caption",t.\u0275\u0275pipeBind1(3,4,"ChatList.NoDataMessage")),t.\u0275\u0275advance(2),t.\u0275\u0275property("title",t.\u0275\u0275pipeBind1(5,6,"ChatList.CreateChatButton")),t.\u0275\u0275advance(2),t.\u0275\u0275textInterpolate1(" ",t.\u0275\u0275pipeBind1(7,8,"ChatList.CreateChatButton")," ")}}function st(l,a){if(l&1&&(t.\u0275\u0275elementStart(0,"div",16),t.\u0275\u0275template(1,Z,4,7,"ng-container",8)(2,q,8,10,"ng-template",null,4,t.\u0275\u0275templateRefExtractor),t.\u0275\u0275elementEnd()),l&2){const m=t.\u0275\u0275reference(3),T=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(),t.\u0275\u0275property("ngIf",T.searchFilter)("ngIfElse",m)}}function k(l,a){if(l&1&&t.\u0275\u0275template(0,st,4,2,"div",15),l&2){const m=t.\u0275\u0275nextContext();t.\u0275\u0275property("ngIf",!m.loading&&(m.chats==null?null:m.chats.length)===0)}}let j=class Mt extends M.Mm{get addCombinedModeClass(){return this.isCombinedMode}get isSearchDisabled(){return!this._featureValues||!this.searchDisableFeatureName?!1:this._featureValues[this.searchDisableFeatureName]}constructor(a,m){super(a),this._injector=a,this._featureValues=m,this._rowsToLoadCount=15,this._focusedIndex=-1,this._destroy$=new o.Subject,this._translateService=(0,t.inject)(d.TranslateService),this.skeletonConfig={display:"inline-flex",height:"80px",width:"100%","margin-bottom":"16px"},this.noDataAnimationOptions={animationData:()=>e.e(9295).then(e.t.bind(e,39295,19)),autoplay:!0,loop:!1},this.placeholderSearch={type:"animation",name:"search",autoplay:!0,loop:!0},this.searchFilterChange=new t.EventEmitter,this.chatsListChange=new t.EventEmitter,this.menuItems=[],this.focusedChatIdChange=new t.EventEmitter,this.currentPageChange=new t.EventEmitter,this.chatClicked=new t.EventEmitter,this.createChatClicked=new t.EventEmitter,this.loadData=new t.EventEmitter}_containerFocusedHandler(a){if(this._focusedIndex=0,a.key!=="Enter")return;const m=this.chatItemElements?.first?.nativeElement;m&&(a.preventDefault(),m.focus())}_focusOnContainer(){if(this.loading)return;this._focusedIndex=0;const a=this.chatListContainerRef?.nativeElement;a&&a.focus()}_getActionsButton(a){return a.querySelector(".chat-item-actions-button button")}_itemsFocusedHandler(a){const m=this.chatItemElements.toArray(),T=this.chatItemComponents.toArray();if(!m.length)return;const H=document.activeElement,Q=m.findIndex(ot=>ot.nativeElement.contains(H));if(Q===-1)return;const G=ot=>{ot>=0&&ot<m.length?(this._focusedIndex=ot,m[ot].nativeElement.focus()):this._focusOnContainer()},it=m[Q].nativeElement,et=this._getActionsButton(it),nt=et&&H===et,at=!!et;switch(a.key){case"Tab":a.preventDefault(),a.shiftKey?nt?it.focus():G(Q-1):at&&!nt?et?.focus():G(Q+1);break;case"ArrowDown":a.preventDefault(),at&&!nt?et?.focus():G(Q+1);break;case"ArrowUp":a.preventDefault(),nt?it.focus():G(Q-1);break;case"Enter":a.preventDefault(),nt?(T[Q].keepMenuVisible=!0,et?.click()):this.onChatClicked(this.chats[Q]),this._focusedIndex=-1;break;case"Escape":a.preventDefault(),nt?it.focus():this._focusOnContainer();break}}ngAfterViewInit(){this.chatItemElements.changes.pipe((0,o.takeUntil)(this._destroy$)).subscribe(()=>{setTimeout(()=>{const a=this.chatItemElements.toArray();a[this._focusedIndex]&&a[this._focusedIndex].nativeElement.focus()})})}onChatClicked(a){this.chatClicked.emit(a)}onCreateChatClicked(){this.createChatClicked.emit()}onLastItemStateChange(a){a.visible!==!1&&(this.loading||this.chats.length<this._rowsToLoadCount||this.loadData.emit({count:this._rowsToLoadCount,search:this.searchFilter||""}))}onKeydown(a){return document.activeElement===this.chatListContainerRef.nativeElement?this._containerFocusedHandler(a):this._itemsFocusedHandler(a)}onChatFocused(a){this.focusedChatId=a?.id,this.focusedChatIdChange.emit(this.focusedChatId)}onSearchFilterChanged(a){this.searchFilter!==a?.value&&(this.searchFilter=a?.value||"",this.loading=!0,this.chats=[],this.chatsListChange.emit(this.chats),this.searchFilterChange.emit(this.searchFilter),this.currentPageChange.emit(0),this.loadData.emit({count:this._rowsToLoadCount,search:this.searchFilter||""}))}ngOnDestroy(){this._destroy$.next(),this._destroy$.complete()}menuItemsFocused(a){const T=this.chatItemComponents.toArray().find(H=>H.chat.id===a);T?.keepMenuVisible&&(T.keepMenuVisible=!1,T.isFocused=!0,setTimeout(()=>{const H=this._getActionsButton(T.elementRef.nativeElement);H&&H.focus()},0))}getChatItemAriaLabel(a){if(a.caption&&a.preview){const m=this._translateService.instant("ChatList.ARIA.ChatItem");if(m)return c.String.format(m,a.caption,a.preview)}return""}trackByChatId(a,m){return m.id}static{this.\u0275fac=function(m){return new(m||Mt)(t.\u0275\u0275directiveInject(t.Injector),t.\u0275\u0275directiveInject(h.G))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:Mt,selectors:[["crt-chat-list"]],viewQuery:function(m,T){if(m&1&&(t.\u0275\u0275viewQuery(I,7),t.\u0275\u0275viewQuery(f,5,t.ElementRef),t.\u0275\u0275viewQuery(f,5)),m&2){let H;t.\u0275\u0275queryRefresh(H=t.\u0275\u0275loadQuery())&&(T.chatListContainerRef=H.first),t.\u0275\u0275queryRefresh(H=t.\u0275\u0275loadQuery())&&(T.chatItemElements=H),t.\u0275\u0275queryRefresh(H=t.\u0275\u0275loadQuery())&&(T.chatItemComponents=H)}},hostVars:2,hostBindings:function(m,T){m&2&&t.\u0275\u0275classProp("combined-mode",T.addCombinedModeClass)},inputs:{searchFilter:"searchFilter",chats:"chats",menuItems:"menuItems",selectedChatId:"selectedChatId",searchDisableFeatureName:"searchDisableFeatureName",focusedChatId:"focusedChatId",isCombinedMode:"isCombinedMode",currentPage:"currentPage"},outputs:{searchFilterChange:"searchFilterChange",chatsListChange:"chatsListChange",focusedChatIdChange:"focusedChatIdChange",currentPageChange:"currentPageChange",chatClicked:"chatClicked",createChatClicked:"createChatClicked",loadData:"loadData"},features:[t.\u0275\u0275InheritDefinitionFeature],decls:8,vars:6,consts:[["chatListContainer",""],["blankslate",""],["lastRow",""],["chatItemRef",""],["noDataBlankslate",""],[1,"chats-search-container"],[3,"value","iconOnly","valueChange",4,"ngIf"],["tabindex","0","role","listbox",1,"chat-list-container",3,"keydown"],[4,"ngIf","ngIfElse"],[3,"valueChange","value","iconOnly"],["tabindex","-1","role","option",3,"chat","searchFilter","isCombinedMode","isSelected","chatMenuItems","chatClicked","chatFocused","menuItemsFocused",4,"ngFor","ngForOf","ngForTrackBy"],["tabindex","-1","role","option",3,"chatClicked","chatFocused","menuItemsFocused","chat","searchFilter","isCombinedMode","isSelected","chatMenuItems"],["appearance","line","count","4",3,"styles"],["tabindex","-1",1,"observe-last-row"],["crtObserveElementInViewport","",3,"crtObserveElementInViewportStateChange"],["class","no-data-container",4,"ngIf"],[1,"no-data-container"],[3,"image","title","subhead"],[1,"no-data-content"],[3,"config"],["labelTextAlign","center",1,"no-data-label",3,"caption"],["size","large","icon","edit-button-icon","iconPosition","left-icon",1,"create-chat-button",3,"clicked","title"]],template:function(m,T){if(m&1){const H=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",5),t.\u0275\u0275template(1,b,1,2,"crt-search-filter",6),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(2,"div",7,0),t.\u0275\u0275pipe(4,"translate"),t.\u0275\u0275listener("keydown",function(G){return t.\u0275\u0275restoreView(H),t.\u0275\u0275resetView(T.onKeydown(G))}),t.\u0275\u0275template(5,g,5,4,"ng-container",8)(6,k,1,1,"ng-template",null,1,t.\u0275\u0275templateRefExtractor),t.\u0275\u0275elementEnd()}if(m&2){const H=t.\u0275\u0275reference(7);t.\u0275\u0275advance(),t.\u0275\u0275property("ngIf",!T.isSearchDisabled),t.\u0275\u0275advance(),t.\u0275\u0275attribute("aria-label",t.\u0275\u0275pipeBind1(4,4,"ChatList.ARIA.Label")),t.\u0275\u0275advance(3),t.\u0275\u0275property("ngIf",T.loading||T.chats&&T.chats.length>0)("ngIfElse",H)}},dependencies:[r.NgForOf,r.NgIf,A.B,R.V,V.w,C.W,D.w,L.d,w.Q,S.I,d.TranslatePipe],styles:[".chat-list-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;position:relative;height:calc(100% - 40px);margin:2px 2px 0 0;width:100%;max-width:794px;overflow-y:auto}.chat-list-container[_ngcontent-%COMP%]   #chat-list-no-data-animation[_ngcontent-%COMP%]{cursor:pointer}.chat-list-container[_ngcontent-%COMP%]   .no-data-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:100%;height:calc(100% - 40px)}.chat-list-container[_ngcontent-%COMP%]   .no-data-container[_ngcontent-%COMP%]   .no-data-content[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;position:absolute;flex-direction:column;top:50%;left:50%;transform:translate(-50%,-50%)}.chat-list-container[_ngcontent-%COMP%]   .no-data-container[_ngcontent-%COMP%]   .no-data-content[_ngcontent-%COMP%]   .create-chat-button[_ngcontent-%COMP%]{margin-top:16px}[_nghost-%COMP%]   .chats-search-container[_ngcontent-%COMP%]{margin-bottom:8px}[_nghost-%COMP%]:not(.combined-mode){width:100%;margin-right:0}.combined-mode[_nghost-%COMP%]{width:354px;margin-inline-end:16px}.combined-mode[_nghost-%COMP%]   .chat-list-container[_ngcontent-%COMP%]{min-width:354px!important}.observe-last-row[_ngcontent-%COMP%]{height:1px;position:sticky;left:0;right:0}.observe-last-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{height:1px}"]})}};(0,n.__decorate)([(0,E.k)(),(0,n.__metadata)("design:type",c.String)],j.prototype,"searchFilter",void 0),(0,n.__decorate)([(0,y.j)(),(0,n.__metadata)("design:type",Object)],j.prototype,"searchFilterChange",void 0),(0,n.__decorate)([(0,E.k)(),(0,n.__metadata)("design:type",Array)],j.prototype,"chats",void 0),(0,n.__decorate)([(0,y.j)(),(0,n.__metadata)("design:type",Object)],j.prototype,"chatsListChange",void 0),(0,n.__decorate)([(0,E.k)(),(0,n.__metadata)("design:type",Array)],j.prototype,"menuItems",void 0),(0,n.__decorate)([(0,E.k)(),(0,n.__metadata)("design:type",c.String)],j.prototype,"selectedChatId",void 0),(0,n.__decorate)([(0,E.k)(),(0,n.__metadata)("design:type",c.String)],j.prototype,"searchDisableFeatureName",void 0),(0,n.__decorate)([(0,E.k)(),(0,n.__metadata)("design:type",c.String)],j.prototype,"focusedChatId",void 0),(0,n.__decorate)([(0,y.j)(),(0,n.__metadata)("design:type",Object)],j.prototype,"focusedChatIdChange",void 0),(0,n.__decorate)([(0,E.k)(),(0,n.__metadata)("design:type",Boolean)],j.prototype,"isCombinedMode",void 0),(0,n.__decorate)([(0,E.k)(),(0,n.__metadata)("design:type",Number)],j.prototype,"currentPage",void 0),(0,n.__decorate)([(0,y.j)(),(0,n.__metadata)("design:type",Object)],j.prototype,"currentPageChange",void 0),(0,n.__decorate)([(0,y.j)(),(0,n.__metadata)("design:type",Object)],j.prototype,"chatClicked",void 0),(0,n.__decorate)([(0,y.j)(),(0,n.__metadata)("design:type",Object)],j.prototype,"createChatClicked",void 0),(0,n.__decorate)([(0,y.j)(),(0,n.__metadata)("design:type",Object)],j.prototype,"loadData",void 0),j=(0,n.__decorate)([(0,_.v)({type:"crt.ChatList",contentSlots:["chats"],reuseStrategy:P.B.Reuse}),(0,n.__metadata)("design:paramtypes",[t.Injector,i.x])],j)},90615:(W,x,e)=>{e.d(x,{z:()=>M});var n=e(5960),v=e.n(n),t=e(59131),B=e.n(t),E=e(11629),y=e(77592);const _=["messages"],P=[[["",8,"messages-header"]]],d=[".messages-header"];function O(h,i){}class M{get _lastAuthor(){return this._renderedMessages.length===0?this._lastMessageAuthor:this._renderedMessages[this._renderedMessages.length-1]?.author?.name??null}constructor(i){this._renderer=i,this._renderedMessages=[],this._lastMessageAuthor=null,this._messagesCounter=0,this._lastMessageDirections=null,this._isRendering=!1,this._messageElementsMap=new Map,this.messagePositionAttributeName="chat-message-position",this.messageIdAttributeName="chat-message-id"}_getParentContainer(){return this.messagesContainer.nativeElement.parentElement}_updateMessages(i){if(this._isRendering)return;if(this._isRendering=!0,i.length===0){this.reset(),this._isRendering=!1;return}const o=new Set(this._renderedMessages.map(r=>r.id)),s=new Set(i.map(r=>r.id)),c=this._renderedMessages.filter(r=>!s.has(r.id)),u=i.filter(r=>o.has(r.id)&&JSON.stringify(this._renderedMessages.find(p=>p.id===r.id))!==JSON.stringify(r));c.forEach(r=>{this._removeMessage(r.id)}),u.forEach(r=>{this._updateMessage(r)}),i.forEach((r,p)=>{const A=this._messageElementsMap.get(r.id);if(A){const R=this._getParentContainer();Array.from(R.children).indexOf(A)!==p&&(this._renderer.removeChild(R,A),this._insertMessageAtPosition(A,p,R))}else this._addMessage(r,i)}),this._renderedMessages=[...i],this._isRendering=!1}_removeMessage(i){const o=this._messageElementsMap.get(i);o&&(this._renderer.removeChild(this._getParentContainer(),o),this._messageElementsMap.delete(i))}_updateMessage(i){const o=this._messageElementsMap.get(i.id);o&&this._renderer.setProperty(o,"message",i)}_addMessage(i,o){this._messagesCounter++;const s=E.L.getSelector(i.type),c=this._renderer.createElement(s);c.classList.add("chat-message"),this._lastMessageDirections!==i.direction&&(c.classList.add("message-group-starter"),this._lastMessageDirections=i.direction),this._renderer.setProperty(c,"message",i),this._renderer.setProperty(c,"searchFilter",this.searchFilter),this._renderer.setAttribute(c,this.messagePositionAttributeName,`${this._messagesCounter}`),this._renderer.setAttribute(c,this.messageIdAttributeName,i.id);const u=this._getParentContainer(),r=o.findIndex(p=>p.id===i.id);this._insertMessageAtPosition(c,r,u),this._messageElementsMap.set(i.id,c)}_insertMessageAtPosition(i,o,s){const c=Array.from(s.children);o<c.length?this._renderer.insertBefore(s,i,c[o]):this._renderer.appendChild(s,i)}_processMessages(i){let o=this._lastAuthor;return i.map(s=>s.author?.name!==o?(o=s.author?.name??null,this._lastMessageAuthor=o,s):{...s,author:null})}rerenderMessages(i){if(!i||this._isRendering||this._getParentContainer()?.childElementCount>0)return;this._isRendering=!0,this.reset();const o=this._processMessages(i);o.forEach(s=>{this._addMessage(s,o)}),this._renderedMessages=[...o],this._isRendering=!1}reset(){this._messagesCounter=0,this._renderedMessages=[],this._messageElementsMap.clear();const i=this._getParentContainer();Array.from(i?.children||[]).forEach(s=>{this._renderer.removeChild(i,s)})}ngOnChanges(i){if("searchFilter"in i){const o=this.messagesContainer.nativeElement.scrollTop;this.reset(),requestAnimationFrame(()=>{this.messagesContainer.nativeElement.scrollTop=o})}if("messages"in i){const o=i.messages?.currentValue||this.messages;if(!o||o.length===0){this.reset();return}const s=this._processMessages(o);this._updateMessages(s)}}static{this.\u0275fac=function(o){return new(o||M)(t.\u0275\u0275directiveInject(t.Renderer2))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:M,selectors:[["crt-chat-messages"]],viewQuery:function(o,s){if(o&1&&t.\u0275\u0275viewQuery(_,7,t.ElementRef),o&2){let c;t.\u0275\u0275queryRefresh(c=t.\u0275\u0275loadQuery())&&(s.messagesContainer=c.first)}},inputs:{searchFilter:"searchFilter",messages:"messages"},features:[t.\u0275\u0275NgOnChangesFeature],ngContentSelectors:d,decls:6,vars:0,consts:[["messages",""],[1,"wrapper"],[1,"header-container"],[1,"messages-container"]],template:function(o,s){o&1&&(t.\u0275\u0275projectionDef(P),t.\u0275\u0275elementStart(0,"div",1)(1,"div",2),t.\u0275\u0275projection(2),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(3,"div",3),t.\u0275\u0275template(4,O,0,0,"ng-template",null,0,t.\u0275\u0275templateRefExtractor),t.\u0275\u0275elementEnd()())}})}}(0,n.__decorate)([(0,y.k)(),(0,n.__metadata)("design:type",String)],M.prototype,"searchFilter",void 0),(0,n.__decorate)([(0,y.k)(),(0,n.__metadata)("design:type",Array)],M.prototype,"messages",void 0)},38739:(W,x,e)=>{e.d(x,{E:()=>c});var n=e(5960),v=e.n(n),t=e(77592),B=e(3671),E=e(96677),y=e(23872),_=e(59131),P=e.n(_),d=e(40297),O=e.n(d),M=e(12325),h=e(92340),i=e(86432);function o(u,r){if(u&1&&_.\u0275\u0275element(0,"crt-image-input",10),u&2){const p=_.\u0275\u0275nextContext(2);_.\u0275\u0275property("value",p.author.photo)("placeholder",p.author.name)}}function s(u,r){if(u&1&&(_.\u0275\u0275elementStart(0,"div",7),_.\u0275\u0275template(1,o,1,2,"crt-image-input",8),_.\u0275\u0275element(2,"crt-label",9),_.\u0275\u0275elementEnd()),u&2){const p=_.\u0275\u0275nextContext();_.\u0275\u0275advance(),_.\u0275\u0275property("ngIf",p.shouldShowImage),_.\u0275\u0275advance(),_.\u0275\u0275property("caption",p.author.name)}}let c=class yt{constructor(){this.ignoredAuthors=["Creatio.ai"]}get shouldShowImage(){return!!(this.author&&!this.ignoredAuthors.includes(this.author.name))}_initAnimation(){this.typingAnimation={animationData:()=>e.e(7228).then(e.t.bind(e,37228,19)),autoplay:!0,loop:!0}}ngOnInit(){this._initAnimation()}static{this.\u0275fac=function(p){return new(p||yt)}}static{this.\u0275cmp=_.\u0275\u0275defineComponent({type:yt,selectors:[["crt-chat-typing"]],inputs:{author:"author",message:"message",loading:"loading"},decls:7,vars:3,consts:[[1,"typing"],["class","author",4,"ngIf"],[1,"typing-message"],[1,"animation"],["width","16px","height","16px",3,"config"],[1,"text"],["labelColor","var(--crt-palette-label-500)","labelType","caption","labelFontSize","10px",1,"typing-text",3,"caption"],[1,"author"],["readonly","true","class","author-image","placeholderMode","abbreviation","borderRadius","large","positioning","cover","size","extra-small",3,"value","placeholder",4,"ngIf"],["labelColor","var(--crt-palette-label-500)","labelType","caption","labelFontSize","12px",1,"author-text",3,"caption"],["readonly","true","placeholderMode","abbreviation","borderRadius","large","positioning","cover","size","extra-small",1,"author-image",3,"value","placeholder"]],template:function(p,A){p&1&&(_.\u0275\u0275elementStart(0,"div",0),_.\u0275\u0275template(1,s,3,2,"div",1),_.\u0275\u0275elementStart(2,"div",2)(3,"div",3),_.\u0275\u0275element(4,"crt-lottie",4),_.\u0275\u0275elementEnd(),_.\u0275\u0275elementStart(5,"div",5),_.\u0275\u0275element(6,"crt-label",6),_.\u0275\u0275elementEnd()()()),p&2&&(_.\u0275\u0275advance(),_.\u0275\u0275property("ngIf",A.author),_.\u0275\u0275advance(3),_.\u0275\u0275property("config",A.typingAnimation),_.\u0275\u0275advance(2),_.\u0275\u0275property("caption",A.message))},dependencies:[d.NgIf,M.V,h.g,i.w],styles:[".author[_ngcontent-%COMP%], .typing-message[_ngcontent-%COMP%]{display:flex;gap:8px;margin:10px 0}"]})}};(0,n.__decorate)([(0,t.k)(),(0,n.__metadata)("design:type",y.B)],c.prototype,"author",void 0),(0,n.__decorate)([(0,t.k)(),(0,n.__metadata)("design:type",String)],c.prototype,"message",void 0),(0,n.__decorate)([(0,t.k)(),(0,n.__metadata)("design:type",Boolean)],c.prototype,"loading",void 0),c=(0,n.__decorate)([(0,B.v)({type:"crt.ChatTyping",reuseStrategy:E.B.Reuse})],c)},89863:(W,x,e)=>{e.d(x,{d:()=>h});var n=e(59131),v=e.n(n),t=e(40297),B=e.n(t),E=e(58433);const y=()=>({width:"80%",height:"32px","border-radius":"8px"}),_=()=>[1,2,3,4],P=(i,o)=>({left:i,right:o}),d=()=>({width:"60%",height:"16px","border-radius":"16px"}),O=()=>({width:"80%",height:"104px","border-radius":"16px"});function M(i,o){if(i&1&&(n.\u0275\u0275elementStart(0,"div",6),n.\u0275\u0275element(1,"crt-skeleton-loader",1)(2,"crt-skeleton-loader",7),n.\u0275\u0275elementEnd()),i&2){const s=o.index;n.\u0275\u0275property("ngClass",n.\u0275\u0275pureFunction2(3,P,(s+1)%2===0,(s+1)%2!==0)),n.\u0275\u0275advance(),n.\u0275\u0275property("styles",n.\u0275\u0275pureFunction0(6,d)),n.\u0275\u0275advance(),n.\u0275\u0275property("styles",n.\u0275\u0275pureFunction0(7,O))}}class h{constructor(){}static{this.\u0275fac=function(s){return new(s||h)}}static{this.\u0275cmp=n.\u0275\u0275defineComponent({type:h,selectors:[["crt-conversation-skeleton"]],decls:6,vars:4,consts:[[1,"conversation-skeleton-container"],["appearance","line","count","1",1,"caption",3,"styles"],[1,"divider"],[1,"messages"],["class","item-skeleton",3,"ngClass",4,"ngFor","ngForOf"],[1,"input-container"],[1,"item-skeleton",3,"ngClass"],["appearance","line","count","1",1,"content",3,"styles"]],template:function(s,c){s&1&&(n.\u0275\u0275elementStart(0,"div",0),n.\u0275\u0275element(1,"crt-skeleton-loader",1)(2,"div",2),n.\u0275\u0275elementStart(3,"div",3),n.\u0275\u0275template(4,M,3,8,"div",4),n.\u0275\u0275elementEnd(),n.\u0275\u0275element(5,"div",5),n.\u0275\u0275elementEnd()),s&2&&(n.\u0275\u0275advance(),n.\u0275\u0275property("styles",n.\u0275\u0275pureFunction0(2,y)),n.\u0275\u0275advance(3),n.\u0275\u0275property("ngForOf",n.\u0275\u0275pureFunction0(3,_)))},dependencies:[t.NgClass,t.NgForOf,E.W],styles:["[_nghost-%COMP%]{height:100%;width:100%;display:flex;justify-content:center}.conversation-skeleton-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;width:100%;max-width:800px;height:100%}.conversation-skeleton-container[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{height:1px;margin:16px 0 24px;width:100%}.conversation-skeleton-container[_ngcontent-%COMP%]   .messages[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding-bottom:16px}.conversation-skeleton-container[_ngcontent-%COMP%]   .item-skeleton[_ngcontent-%COMP%]{margin:16px 8px 0}.conversation-skeleton-container[_ngcontent-%COMP%]   .item-skeleton.right[_ngcontent-%COMP%]{text-align:right}.conversation-skeleton-container[_ngcontent-%COMP%]   .item-skeleton.left[_ngcontent-%COMP%]{text-align:left}.conversation-skeleton-container[_ngcontent-%COMP%]   .item-skeleton[_ngcontent-%COMP%]   .caption[_ngcontent-%COMP%]{margin-bottom:8px}.conversation-skeleton-container[_ngcontent-%COMP%]   .item-skeleton[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{margin-bottom:16px}.conversation-skeleton-container[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]{padding:12px 8px;flex-shrink:0;border-radius:8px;height:80px}"]})}}},18611:(W,x,e)=>{e.d(x,{g:()=>k});var n=e(5960),v=e.n(n),t=e(59131),B=e.n(t),E=e(77592),y=e(34760),_=e(3671),P=e(52793),d=e(50999),O=e(10098),M=e(8144),h=e(48594),i=e(90204),o=e(28399),s=e.n(o),c=e(43778),u=e(19540),r=e(90615),p=e(52989),A=e.n(p),R=e(40297),V=e.n(R),C=e(62115),D=e(89863),L=e(79772),w=e.n(L);const S=["typing"],I=["contentWrap"],f=[[["","slot","information"]],[["","slot","placeholder"]],[["","slot","tools"]],[["","slot","actions"]],[["","slot","typing"]]],b=["[slot='information']","[slot='placeholder']","[slot='tools']","[slot='actions']","[slot='typing']"];function K(j,l){j&1&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275elementStart(1,"div",12),t.\u0275\u0275projection(2,3),t.\u0275\u0275elementEnd(),t.\u0275\u0275element(3,"div",13),t.\u0275\u0275elementContainerEnd())}function F(j,l){if(j&1){const a=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"crt-button",14),t.\u0275\u0275listener("clicked",function(){t.\u0275\u0275restoreView(a);const T=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(T.onLoadPreviousMessagesClicked())}),t.\u0275\u0275text(1),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275elementEnd()}j&2&&(t.\u0275\u0275property("size","medium"),t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate(t.\u0275\u0275pipeBind1(2,2,"Conversation.LoadPreviousChat")))}function $(j,l){j&1&&(t.\u0275\u0275elementStart(0,"div",15,2),t.\u0275\u0275projection(2,4),t.\u0275\u0275elementEnd())}function g(j,l){if(j&1&&(t.\u0275\u0275elementStart(0,"span",20),t.\u0275\u0275text(1),t.\u0275\u0275elementEnd()),j&2){const a=t.\u0275\u0275nextContext(3);t.\u0275\u0275advance(),t.\u0275\u0275textInterpolate(a.unreadMessages>9?"9+":a.unreadMessages)}}function Z(j,l){if(j&1){const a=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",16),t.\u0275\u0275listener("click",function(){t.\u0275\u0275restoreView(a);const T=t.\u0275\u0275nextContext(2);return t.\u0275\u0275resetView(T.onScrollToBottomButtonClick())}),t.\u0275\u0275template(1,g,2,1,"span",17),t.\u0275\u0275elementStart(2,"div",18),t.\u0275\u0275element(3,"mat-icon",19),t.\u0275\u0275elementEnd()()}if(j&2){const a=t.\u0275\u0275nextContext(2);t.\u0275\u0275advance(),t.\u0275\u0275property("ngIf",a.unreadMessages>0)}}function q(j,l){if(j&1&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275template(1,K,4,0,"ng-container",4),t.\u0275\u0275elementStart(2,"div",5),t.\u0275\u0275projection(3),t.\u0275\u0275elementStart(4,"div",6,1),t.\u0275\u0275template(6,F,3,4,"crt-button",7),t.\u0275\u0275elementStart(7,"crt-chat-messages",8),t.\u0275\u0275projection(8,1,[1,"messages-header"]),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(9,$,3,0,"div",9),t.\u0275\u0275elementEnd(),t.\u0275\u0275template(10,Z,4,1,"div",10),t.\u0275\u0275elementStart(11,"div",11),t.\u0275\u0275projection(12,2),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementContainerEnd()),j&2){const a=t.\u0275\u0275nextContext();t.\u0275\u0275advance(),t.\u0275\u0275property("ngIf",!a.isEmbeddedMode),t.\u0275\u0275advance(5),t.\u0275\u0275property("ngIf",a.hasPreviousMessages),t.\u0275\u0275advance(),t.\u0275\u0275property("messages",a.messages)("searchFilter",a.searchFilter),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",a.isTyping),t.\u0275\u0275advance(),t.\u0275\u0275property("ngIf",a.isScrolledUp)}}function st(j,l){j&1&&t.\u0275\u0275element(0,"crt-conversation-skeleton")}let k=class Pt extends M.Mm{get _messagesContainer(){return this._chatMessagesComponent?.messagesContainer?.nativeElement?.parentElement}get _scrollContainer(){return this._contentWrap?.nativeElement}set conversationEvent(l){l?.forEach(a=>{a.name===c.R&&(this._chatMessagesComponent?.reset(),this.isScrolledUp=!1,this.unreadMessages=0,this._isPaginationEnabled=!1)}),l?.length&&this.conversationEventChange.emit([])}constructor(l){super(l),this.injector=l,this._scrollOnOpen=!0,this._isSilentScroll=!1,this._isPaginationEnabled=!0,this._scrollPositionBeforePagination=0,this._previousScrollTop=0,this._shouldRestoreFocus=!1,this._lockFocus=!1,this._isMessagePreviewChanged=!1,this._isMessagesCountChanged=!1,this._scrollPaginationThreshold=300,this._onScrollHandlerFn=(0,o.debounce)(a=>this._onScrollHandler(a),100),this._observeLastVisibleMessageElementFn=(0,o.debounce)(()=>this._observeLastVisibleMessageElement(),100),this.unreadMessages=0,this.isScrolledUp=!1,this.actions=[],this.information=[],this.tools=[],this.placeholder=[],this.disableAutoScroll=!1,this.typing=[],this.messages=[],this.previewMessageIdChange=new t.EventEmitter,this.hasPreviousMessages=!1,this.isTyping=!1,this.isEmbeddedMode=!1,this.conversationEventChange=new t.EventEmitter,this.paginationChange=new t.EventEmitter,this.loadPreviousMessages=new t.EventEmitter,this._observeLastVisibleMessageElement=()=>{if(!this._messagesContainer)return;const a=this._messagesContainer.querySelectorAll(`[${this._chatMessagesComponent.messagePositionAttributeName}]`),m=a.length;if(m===0)return;const T=this._getLastVisibleMessageElement(a),H=T?parseInt(T.getAttribute(this._chatMessagesComponent.messagePositionAttributeName)):0;this.isScrolledUp=!this._isMessageBottomBorderVisible(a[m-1]),this.unreadMessages=Math.min(m-H,this.unreadMessages||0),this.changeDetectorRef.detectChanges()},this._chatScrollPositionService=l.get(u.U)}_scrollToBottom(l=!1,a="end"){if(!this.isScrolledUp&&(!this.disableAutoScroll||l)){const m=this._typingContainer?.nativeElement||this._messagesContainer?.lastChild;setTimeout(()=>{m?.scrollIntoView?.({block:a})},0),this.isScrolledUp=!1}}_startObserve(l,a){l&&(this._stopObserve(l),this._observer=new IntersectionObserver(m=>a(m.filter(T=>T.target===l),l)),this._observer.observe(l))}_stopObserve(l){this._observer&&this._observer.unobserve(l)}_observeMessages(){if(!this._messagesContainer)return;new MutationObserver(a=>{const m=a.filter(T=>T.type==="childList"&&T.addedNodes.length>0).pop();if(m){const T=m.addedNodes[m.addedNodes.length-1];T.nodeType===Node.ELEMENT_NODE&&this._processLastElement(T)}}).observe(this._messagesContainer,{childList:!0,subtree:!1})}_processLastElement(l){l?.message?.direction===h.Tt.Outcoming?(this.isScrolledUp=!1,this._scrollToBottom()):l?.message?.direction===h.Tt.Incoming&&!this.isScrolledUp?this._scrollToMessageTop(this._messagesContainer?.lastChild):this.isScrolledUp&&this._isMessagesCountChanged&&(this.unreadMessages=(this.unreadMessages||0)+1,this.changeDetectorRef.detectChanges()),this.isScrolledUp||(this._observer?.disconnect(),this._startObserve(l,a=>{a.forEach(m=>{this.isScrolledUp=!m.isIntersecting&&this.messages?.length>0,this.changeDetectorRef.detectChanges()})}))}_getLastVisibleMessageElement(l){const a=this._contentWrap.nativeElement;let m=null;return l.forEach(T=>{if(T instanceof HTMLElement){const H=T.getBoundingClientRect(),Q=a.getBoundingClientRect();H.top<Q.bottom&&H.bottom>Q.top&&(m=T)}}),m}_isMessageBottomBorderVisible(l){const a=this._contentWrap.nativeElement.getBoundingClientRect();return l.getBoundingClientRect().bottom-a.bottom<1}_setScrollPosition(){const l=this._contentWrap?.nativeElement;if(l&&this.conversationId&&this.messages&&!this.disableAutoScroll&&this._scrollPositionBeforePagination<1){if(this.previewMessageId){this._scrollToMessage(this.previewMessageId),this._scrollOnOpen=!1;return}const a=this._chatScrollPositionService.getScrollPosition(this.conversationId);a!==void 0?requestAnimationFrame(()=>{l.scrollTop=a}):this._scrollToBottom(),this._scrollOnOpen=!1}}_scrollToMessage(l){requestAnimationFrame(()=>{const a=this._getMessageElementById(l);a?this._scrollToMessageTop(a):this._scrollToBottom(),this.isScrolledUp=!1})}_observeContentWrap(){this._contentWrap?.nativeElement&&(this._messageContentWrapMutationObserver=new MutationObserver(l=>{this._contentWrap?.nativeElement&&this._messageContentWrapMutationObserver!==null&&(this._setScrollPosition(),this._messageContentWrapMutationObserver.disconnect(),this._messageContentWrapMutationObserver=null)}),this._messageContentWrapMutationObserver.observe(this.elementRef.nativeElement,{childList:!0,subtree:!0}))}_getFirstUnreadMessageElement(){const l=this.messages.filter(m=>m.direction===h.Tt.Incoming);if(l.length<this.unreadMessages)return null;const a=l[l.length-this.unreadMessages];return this._getMessageElementById(a.id)}_getMessageElementById(l){return this._messagesContainer.querySelector(`[${this._chatMessagesComponent.messageIdAttributeName}="${l}"]`)}_scrollToMessageTop(l){setTimeout(()=>{l?.scrollIntoView?.({block:"start"})},0)}_onScrollHandler(l){this._isScrollingUp(l)&&this._scrollContainer?.scrollTop<=this._scrollPaginationThreshold&&this._isPaginationEnabled&&(this._scrollPositionBeforePagination=this._getCurrentScrollHeight(),this._lockFocus=!0,this.paginationChange.emit({id:this.conversationId,offset:this.messages.length})),this.conversationId&&!this._isSilentScroll&&(this._chatScrollPositionService.saveScrollPosition(this.conversationId,this._scrollContainer?.scrollTop||0),this.previewMessageId="",this.previewMessageIdChange.emit(this.previewMessageId)),this._isSilentScroll=!1}_getCurrentScrollHeight(){return this._scrollContainer?.scrollHeight||0}_restorePaginationScroll(){this._scrollPositionBeforePagination>0&&setTimeout(()=>{if(!this._scrollContainer||this._scrollPositionBeforePagination<1)return;const l=this._scrollContainer.scrollHeight;this._scrollContainer.scrollTop=l-this._scrollPositionBeforePagination,this._scrollPositionBeforePagination=0},0)}_isScrollingUp(l){const m=l.target.scrollTop,T=m===0||m<this._previousScrollTop;return this._previousScrollTop=m,T}_restoreFocusIfNeeded(l){if(l.messages){const a=document.activeElement===this._scrollContainer;setTimeout(()=>{this._scrollContainer&&(a||this._shouldRestoreFocus)&&this._scrollContainer.focus(),this._lockFocus=!1},0)}}_getLastMessage(){return this.messages?.length?this.messages[this.messages.length-1]:null}_isFirstMessageChanged(l){return!l||!l.messages||!l.messages.currentValue||!l.messages.previousValue||l.messages.currentValue.length===0||l.messages.previousValue.length===0?!1:l.messages.currentValue[0].id!==l.messages.previousValue[0].id}_isInputPropertyChanged(l,a,m=!1){return a[l]&&a[l].previousValue!==a[l].currentValue&&(!m||a[l].currentValue)}handleFinishLoadViewModelAttributes(){super.handleFinishLoadViewModelAttributes(),setTimeout(()=>{this._observeMessages(),this._scrollContainer?.addEventListener?.("scroll",this._observeLastVisibleMessageElementFn),this._scrollContainer?.addEventListener?.("scroll",this._onScrollHandlerFn.bind(this)),this._scrollContainer?.addEventListener("focus",()=>this._shouldRestoreFocus=!0),this._scrollContainer?.addEventListener("blur",()=>this._shouldRestoreFocus=this._lockFocus)},0)}ngAfterViewInit(){super.ngAfterViewInit(),this._observeContentWrap()}ngAfterViewChecked(){this._chatMessagesComponent?.rerenderMessages(this.messages),this.elementRef.nativeElement?.checkVisibility?.()?this._scrollOnOpen&&(this._scrollContainer?this._setScrollPosition():this._observeContentWrap()):(this._isSilentScroll=!0,this._scrollOnOpen=!0)}ngOnChanges(l){if(this._isInputPropertyChanged("previewMessageId",l,!0)){this._scrollToMessage(l.previewMessageId.currentValue),this._scrollOnOpen=!1;return}if("messages"in l){const a=l.messages;a?.previousValue?.length===0&&(this.unreadMessages=0,this.isScrolledUp=!1),this._isMessagesCountChanged=a.previousValue?.length!==a.currentValue?.length}else this._isMessagesCountChanged=!1;(this._isInputPropertyChanged("conversationId",l)||this._isInputPropertyChanged("searchFilter",l))&&(this._scrollPositionBeforePagination=this._contentWrap?.nativeElement.scrollTop||0,this._scrollOnOpen=!0,this._observeContentWrap(),"messages"in l&&(this._isPaginationEnabled=!0)),this._isInputPropertyChanged("isTyping",l,!0)&&this._getLastMessage()?.direction===h.Tt.Outcoming&&this._scrollToBottom(!1,"start"),this._isFirstMessageChanged(l)&&this._restorePaginationScroll(),this._restoreFocusIfNeeded(l)}ngOnDestroy(){super.ngOnDestroy(),this._scrollContainer?.removeEventListener?.("scroll",this._observeLastVisibleMessageElementFn),this._scrollContainer?.removeEventListener?.("scroll",this._onScrollHandlerFn)}onScrollToBottomButtonClick(){this.isScrolledUp=!1,this._isMessagePreviewChanged=!1,this.previewMessageId="",this.previewMessageIdChange.emit(this.previewMessageId),this.unreadMessages>0?this._scrollToMessageTop(this._getFirstUnreadMessageElement()):this._scrollToBottom(!0)}onLoadPreviousMessagesClicked(){this.loadPreviousMessages.emit()}static{this.\u0275fac=function(a){return new(a||Pt)(t.\u0275\u0275directiveInject(t.Injector))}}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:Pt,selectors:[["crt-conversation"]],viewQuery:function(a,m){if(a&1&&(t.\u0275\u0275viewQuery(r.z,5),t.\u0275\u0275viewQuery(S,5,t.ElementRef),t.\u0275\u0275viewQuery(I,5,t.ElementRef)),a&2){let T;t.\u0275\u0275queryRefresh(T=t.\u0275\u0275loadQuery())&&(m._chatMessagesComponent=T.first),t.\u0275\u0275queryRefresh(T=t.\u0275\u0275loadQuery())&&(m._typingContainer=T.first),t.\u0275\u0275queryRefresh(T=t.\u0275\u0275loadQuery())&&(m._contentWrap=T.first)}},inputs:{actions:"actions",information:"information",tools:"tools",placeholder:"placeholder",disableAutoScroll:"disableAutoScroll",typing:"typing",conversationId:"conversationId",conversationEvent:"conversationEvent",messages:"messages",previewMessageId:"previewMessageId",hasPreviousMessages:"hasPreviousMessages",isTyping:"isTyping",searchFilter:"searchFilter",isEmbeddedMode:"isEmbeddedMode"},outputs:{previewMessageIdChange:"previewMessageIdChange",conversationEventChange:"conversationEventChange",paginationChange:"paginationChange",loadPreviousMessages:"loadPreviousMessages"},features:[t.\u0275\u0275InheritDefinitionFeature,t.\u0275\u0275NgOnChangesFeature],ngContentSelectors:b,decls:3,vars:2,consts:[["skeleton",""],["contentWrap",""],["typing",""],[4,"ngIf","ngIfElse"],[4,"ngIf"],[1,"conversation-container"],["tabindex","0","role","region",1,"chat-panel-content-wrap"],["class","load-previous-messages","color","outline",3,"size","clicked",4,"ngIf"],[3,"messages","searchFilter"],["class","typing",4,"ngIf"],["class","scroll-to-bottom",3,"click",4,"ngIf"],[1,"tools"],[1,"actions-container"],[1,"divider"],["color","outline",1,"load-previous-messages",3,"clicked","size"],[1,"typing"],[1,"scroll-to-bottom",3,"click"],["class","unread-messages",4,"ngIf"],[1,"arrow-wrap"],["svgIcon","arrow-down-heavy"],[1,"unread-messages"]],template:function(a,m){if(a&1&&(t.\u0275\u0275projectionDef(f),t.\u0275\u0275template(0,q,13,6,"ng-container",3)(1,st,1,0,"ng-template",null,0,t.\u0275\u0275templateRefExtractor)),a&2){const T=t.\u0275\u0275reference(2);t.\u0275\u0275property("ngIf",!m.loading)("ngIfElse",T)}},dependencies:[p.MatIcon,R.NgIf,C.B,r.z,D.d,L.TranslatePipe],styles:[".chat-panel-content-wrap[_ngcontent-%COMP%]{flex:1 1 auto;overflow-y:auto;box-sizing:border-box;overflow-x:hidden}.chat-panel-content-wrap[_ngcontent-%COMP%]   crt-button.load-previous-messages[_ngcontent-%COMP%]{display:block;margin:8px auto 16px}.conversation-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;overflow:auto;width:100%;max-width:800px;align-self:center}.conversation-container[_ngcontent-%COMP%]   .scroll-to-bottom[_ngcontent-%COMP%]{position:sticky;margin-left:auto;margin-right:auto;transform:translate(-50%);bottom:4px;display:inline-flex;flex-direction:column;align-items:center;border-radius:16px}.conversation-container[_ngcontent-%COMP%]   .scroll-to-bottom[_ngcontent-%COMP%]   .unread-messages[_ngcontent-%COMP%]{position:fixed;min-width:8px;height:16px;top:-8px;left:-4px;border-radius:8px;padding:0 4px;text-align:center;direction:ltr}.conversation-container[_ngcontent-%COMP%]   .scroll-to-bottom[_ngcontent-%COMP%]   .arrow-wrap[_ngcontent-%COMP%]{width:32px;height:32px;cursor:pointer;display:flex;align-items:center;justify-content:center}.conversation-container[_ngcontent-%COMP%]   .scroll-to-bottom[_ngcontent-%COMP%]   .arrow-wrap[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{width:16px;height:16px}.tools[_ngcontent-%COMP%]{width:100%;box-sizing:border-box;padding-top:8px}[_nghost-%COMP%]{height:100%;width:100%;display:flex;flex-direction:column;align-items:flex-start}[_nghost-%COMP%]   .divider[_ngcontent-%COMP%]{height:1px;margin:16px 0;width:100%}[dir=rtl][_ngcontent-%COMP%]   .scroll-to-bottom[_ngcontent-%COMP%]   .unread-messages[_ngcontent-%COMP%]{left:unset;right:-4px}.actions-container[_ngcontent-%COMP%]{width:100%}"]})}};(0,n.__decorate)([(0,E.k)(),(0,n.__metadata)("design:type",Array)],k.prototype,"actions",void 0),(0,n.__decorate)([(0,E.k)(),(0,n.__metadata)("design:type",Array)],k.prototype,"information",void 0),(0,n.__decorate)([(0,E.k)(),(0,n.__metadata)("design:type",Array)],k.prototype,"tools",void 0),(0,n.__decorate)([(0,E.k)(),(0,n.__metadata)("design:type",Array)],k.prototype,"placeholder",void 0),(0,n.__decorate)([(0,E.k)(),(0,n.__metadata)("design:type",Object)],k.prototype,"disableAutoScroll",void 0),(0,n.__decorate)([(0,E.k)(),(0,n.__metadata)("design:type",Array)],k.prototype,"typing",void 0),(0,n.__decorate)([(0,E.k)(),(0,n.__metadata)("design:type",String)],k.prototype,"conversationId",void 0),(0,n.__decorate)([(0,E.k)(),(0,n.__metadata)("design:type",Array),(0,n.__metadata)("design:paramtypes",[Array])],k.prototype,"conversationEvent",null),(0,n.__decorate)([(0,E.k)(),(0,n.__metadata)("design:type",Array)],k.prototype,"messages",void 0),(0,n.__decorate)([(0,E.k)(),(0,n.__metadata)("design:type",String)],k.prototype,"previewMessageId",void 0),(0,n.__decorate)([(0,y.j)(),(0,n.__metadata)("design:type",Object)],k.prototype,"previewMessageIdChange",void 0),(0,n.__decorate)([(0,E.k)(),(0,n.__metadata)("design:type",Object)],k.prototype,"hasPreviousMessages",void 0),(0,n.__decorate)([(0,E.k)(),(0,n.__metadata)("design:type",Object)],k.prototype,"isTyping",void 0),(0,n.__decorate)([(0,E.k)(),(0,n.__metadata)("design:type",String)],k.prototype,"searchFilter",void 0),(0,n.__decorate)([(0,E.k)(),(0,n.__metadata)("design:type",Object)],k.prototype,"isEmbeddedMode",void 0),(0,n.__decorate)([(0,y.j)(),(0,n.__metadata)("design:type",Object)],k.prototype,"conversationEventChange",void 0),(0,n.__decorate)([(0,y.j)(),(0,n.__metadata)("design:type",Object)],k.prototype,"paginationChange",void 0),(0,n.__decorate)([(0,y.j)(),(0,n.__metadata)("design:type",Object)],k.prototype,"loadPreviousMessages",void 0),k=(0,n.__decorate)([(0,_.v)({type:"crt.Conversation",contentSlots:["actions","information","typing","tools","placeholder"]}),(0,P.f)({toolbarConfig:{requiredFeatures:{ShowDesignerDemoItems:!0},position:110,groupType:d.h.Components,icon:e(70807),defaultPropertyValues:{actions:[],information:[],messages:[],tools:[{name:"MessageEditor_"+i.N,type:"crt.MessageEditor",items:[{name:"MessageEditorBody_"+i.N,type:"crt.MessageEditorBody",inputs:[{name:"MessageEditorInput_"+i.N,type:"crt.MessageEditorInput"}]}]}],placeholder:[],typing:[]},addCommandTypeName:"crt.AddConversationCommand"},designControlConfig:{allowDesignContent:!0},propertiesPanelComponentTypeName:"crt.ConversationPropertiesPanel",viewElementGroupType:O.J.LayoutElements,typeCaption:"Conversation.Caption",placeholderSize:{height:"1000px"}}),(0,n.__metadata)("design:paramtypes",[t.Injector])],k)},11395:(W,x,e)=>{e.d(x,{P:()=>s});var n=e(59131),v=e.n(n),t=e(56711),B=e.n(t),E=e(76923),y=e.n(E),_=e(59969),P=e(97998),d=e(18046),O=e(19344),M=e(62115),h=e(12325),i=e(79772),o=e.n(i);class s{constructor(u,r,p,A,R){this._dialogRef=u,this._dialogData=r,this._domPurifier=p,this._crtControlStateAdapter=A,this._injector=R,this.chatTitleInputControl=new t.FormControl("",{validators:[this._crtControlStateAdapter.transform({instance:new P.Y(this._injector)})]})}get chatTitle(){return this._dialogData.chatTitle}onCloseButtonClicked(){this._dialogRef.close()}onSaveButtonClicked(){const u=this._domPurifier.sanitize(this.chatTitleInputControl.value)||"";u.trim()!==""&&this._dialogRef.close(u)}static{this.\u0275fac=function(r){return new(r||s)(n.\u0275\u0275directiveInject(E.MatLegacyDialogRef),n.\u0275\u0275directiveInject(E.MAT_LEGACY_DIALOG_DATA),n.\u0275\u0275directiveInject(_.MV),n.\u0275\u0275directiveInject(d.f),n.\u0275\u0275directiveInject(n.Injector))}}static{this.\u0275cmp=n.\u0275\u0275defineComponent({type:s,selectors:[["crt-rename-chat"]],decls:11,vars:19,consts:[[1,"rename-dialog-container"],["labelType","headline-3","labelColor","var(--crt-palette-secondary-500)",1,"dialog-title",3,"title","caption"],[1,"dialog-input",3,"keyup.enter","control","value","label","labelPosition"],[1,"dialog-actions"],["data-item-marker","closeButton",1,"cancel-button",3,"clicked","caption"],["color","primary","data-item-marker","saveButton",1,"save-button",3,"clicked","disabled","caption"]],template:function(r,p){r&1&&(n.\u0275\u0275elementStart(0,"div",0),n.\u0275\u0275element(1,"crt-label",1),n.\u0275\u0275pipe(2,"translate"),n.\u0275\u0275pipe(3,"translate"),n.\u0275\u0275elementStart(4,"crt-input",2),n.\u0275\u0275pipe(5,"translate"),n.\u0275\u0275listener("keyup.enter",function(){return p.onSaveButtonClicked()}),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(6,"div",3)(7,"crt-button",4),n.\u0275\u0275pipe(8,"translate"),n.\u0275\u0275listener("clicked",function(){return p.onCloseButtonClicked()}),n.\u0275\u0275elementEnd(),n.\u0275\u0275elementStart(9,"crt-button",5),n.\u0275\u0275pipe(10,"translate"),n.\u0275\u0275listener("clicked",function(){return p.onSaveButtonClicked()}),n.\u0275\u0275elementEnd()()()),r&2&&(n.\u0275\u0275advance(),n.\u0275\u0275property("title",n.\u0275\u0275pipeBind1(2,9,"ChatList.RenameChat.LabelTitle"))("caption",n.\u0275\u0275pipeBind1(3,11,"ChatList.RenameChat.LabelTitle")),n.\u0275\u0275advance(3),n.\u0275\u0275property("control",p.chatTitleInputControl)("value",p.chatTitle)("label",n.\u0275\u0275pipeBind1(5,13,"ChatList.RenameChat.InputTitle"))("labelPosition","above"),n.\u0275\u0275advance(3),n.\u0275\u0275property("caption",n.\u0275\u0275pipeBind1(8,15,"ChatList.RenameChat.CancelButton")),n.\u0275\u0275advance(2),n.\u0275\u0275property("disabled",!p.chatTitleInputControl.valid)("caption",n.\u0275\u0275pipeBind1(10,17,"ChatList.RenameChat.SaveButton")))},dependencies:[O.j,M.B,h.V,i.TranslatePipe],styles:[".rename-dialog-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:8px}"]})}}},96158:(W,x,e)=>{e.d(x,{g:()=>n});var n;(function(v){v.TriggerMention="triggerMention",v.Focus="focus"})(n||(n={}))},30073:(W,x,e)=>{e.d(x,{z:()=>S});var n=e(5960),v=e.n(n),t=e(59131),B=e.n(t),E=e(56711),y=e.n(E),_=e(77592),P=e(34760),d=e(3671),O=e(3585),M=e(68712),h=e(28399),i=e.n(h),o=e(96158),s=e(40297),c=e.n(s),u=e(19344),r=e(54327),p=e(79772),A=e.n(p);const R=["crtInput"],V=["editableDiv"],C=["plainInput"],D=I=>({"message-editor-input-focused":I});function L(I,f){if(I&1){const b=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"crt-input",5,1),t.\u0275\u0275pipe(3,"translate"),t.\u0275\u0275listener("focusout",function(){t.\u0275\u0275restoreView(b);const F=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(F.onBlur())})("crtKeyboardHotkeyPressed",function(F){t.\u0275\u0275restoreView(b);const $=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView($.onHotKeyPressed(F))}),t.\u0275\u0275elementEnd()}if(I&2){const b=t.\u0275\u0275nextContext();t.\u0275\u0275propertyInterpolate("placeholder",t.\u0275\u0275pipeBind1(3,5,"MessageEditor.InputPlaceholder")),t.\u0275\u0275property("control",b.messageFormControl)("labelPosition","hidden")("multiline",!0)("crtKeyboardHotkeys",b.keyboardHotkeysMap)}}function w(I,f){if(I&1){const b=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",6,2),t.\u0275\u0275pipe(2,"translate"),t.\u0275\u0275listener("input",function(F){t.\u0275\u0275restoreView(b);const $=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView($.onContentChanged(F))})("focusout",function(){t.\u0275\u0275restoreView(b);const F=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(F.onBlur())})("mentionSelected",function(){t.\u0275\u0275restoreView(b);const F=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView(F.onMentionSelected())})("crtKeyboardHotkeyPressed",function(F){t.\u0275\u0275restoreView(b);const $=t.\u0275\u0275nextContext();return t.\u0275\u0275resetView($.onHotKeyPressed(F))}),t.\u0275\u0275elementEnd()}if(I&2){const b=t.\u0275\u0275nextContext();t.\u0275\u0275property("mentionService",b.mentionService)("crtKeyboardHotkeys",b.keyboardHotkeysMap),t.\u0275\u0275attribute("data-placeholder",t.\u0275\u0275pipeBind1(2,3,"MessageEditor.InputPlaceholder"))}}let S=class ct extends M.K{constructor(){super(...arguments),this._publishMessageHotKeys=["Enter"],this._publishKeyboardAction="publishMessage",this.keyboardHotkeysMap={keydown:{[this._publishKeyboardAction]:{sequence:this._publishMessageHotKeys}}},this.messageFormControl=new E.FormControl(""),this.inputMode="text",this.getMentionService=new t.EventEmitter,this.sendHotkeyPressed=new t.EventEmitter,this.chatInputChange=new t.EventEmitter,this.isFocusedChange=new t.EventEmitter,this.sendMessage=new t.EventEmitter}set action(f){switch(f){case o.g.TriggerMention:this._triggerMention();break;case o.g.Focus:{const b=this.onMessageEditorAreaClicked();this._setCursorPositionToEnd(b);break}}}set chatInput(f){this.inputMode==="text"?f!==this.messageFormControl?.value&&this.messageFormControl?.setValue(f):this.inputMode==="html"&&f!==this.editableDiv?.nativeElement.innerHTML&&this.editableDiv?.nativeElement&&(this.editableDiv.nativeElement.innerHTML=f)}_setIsFocused(f){this.isFocused=f,this.isFocusedChange.emit(f)}_getMentionService(f){this.mentionService=f}_triggerMention(){if(this.inputMode!=="html"){console.warn('"Mention" action is only supported for html input mode');return}const f=new Event("input",{bubbles:!0,cancelable:!0}),b=this.mentionDirective.mentionSymbol,K=this.editableDiv.nativeElement;K.innerHTML==="<br>"?K.innerHTML=b:K.innerHTML.endsWith(b)?K.innerHTML=K.innerHTML.slice(0,-b.length):K.innerHTML+=b;const $=K.lastChild||K,g=document.createRange();g.setStart($,$.textContent.length),g.collapse(!0);const Z=window.getSelection();Z.removeAllRanges(),Z.addRange(g),K.focus(),K.dispatchEvent(f)}_setCursorPositionToEnd(f){f&&requestAnimationFrame(()=>{if(f instanceof HTMLInputElement||f instanceof HTMLTextAreaElement){const $=f.value.length;f.setSelectionRange($,$);return}const b=document.createRange(),K=window.getSelection();let F=f;for(;F.lastChild;)F=F.lastChild;F.nodeType!==Node.TEXT_NODE&&(F=F.appendChild(document.createTextNode(""))),b.setStart(F,F.textContent?.length??0),b.collapse(!0),K?.removeAllRanges(),K?.addRange(b),f instanceof HTMLDivElement&&(f.scrollTop=f.scrollHeight)})}onBlur(){this._setIsFocused(!1)}ngOnInit(){this.getMentionService.emit(this._getMentionService.bind(this)),this.messageFormControl?.valueChanges.subscribe(f=>{this.onInputContentChanged(f)})}onContentChanged(f){const b=f.target.innerHTML;this.chatInput=b,this.chatInputChange.emit(b)}onMessageEditorAreaClicked(){let f;if(this.inputMode==="text"?(this.crtInput?.focus(),f=this.crtInput?.textArea?.nativeElement):(this.editableDiv.nativeElement.focus(),f=this.editableDiv.nativeElement),!this.isFocused)return this._setIsFocused(!0),f}onInputContentChanged(f){f!==this.chatInput&&(this.chatInput=f,this.chatInputChange.emit(f))}onHotKeyPressed({action:f,event:b}){if(b.shiftKey===!1&&f===this._publishKeyboardAction){if(b.preventDefault(),this.inputMode==="text")(0,h.isEmpty)(this.messageFormControl?.value)||this.sendMessage.emit();else if(this.inputMode==="html"){const K=this.editableDiv.nativeElement.innerHTML.trim();K&&(this.sendMessage.emit(K),this.editableDiv.nativeElement.innerHTML="")}}}onMentionSelected(){const f=this.editableDiv.nativeElement.innerHTML;this.chatInput=f,this.chatInputChange.emit(f),this.onMessageEditorAreaClicked()}static{this.\u0275fac=(()=>{let f;return function(K){return(f||(f=t.\u0275\u0275getInheritedFactory(ct)))(K||ct)}})()}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:ct,selectors:[["crt-message-editor-input"]],viewQuery:function(b,K){if(b&1&&(t.\u0275\u0275viewQuery(O.d,5),t.\u0275\u0275viewQuery(R,5),t.\u0275\u0275viewQuery(V,5),t.\u0275\u0275viewQuery(C,5)),b&2){let F;t.\u0275\u0275queryRefresh(F=t.\u0275\u0275loadQuery())&&(K.mentionDirective=F.first),t.\u0275\u0275queryRefresh(F=t.\u0275\u0275loadQuery())&&(K.crtInput=F.first),t.\u0275\u0275queryRefresh(F=t.\u0275\u0275loadQuery())&&(K.editableDiv=F.first),t.\u0275\u0275queryRefresh(F=t.\u0275\u0275loadQuery())&&(K.plainInput=F.first)}},inputs:{inputMode:"inputMode",action:"action",chatInput:"chatInput",isFocused:"isFocused",mentionService:"mentionService"},outputs:{getMentionService:"getMentionService",sendHotkeyPressed:"sendHotkeyPressed",chatInputChange:"chatInputChange",isFocusedChange:"isFocusedChange",sendMessage:"sendMessage"},features:[t.\u0275\u0275InheritDefinitionFeature],decls:4,vars:5,consts:[["divMode",""],["plainInput","","crtInput",""],["editableDiv",""],[1,"message-editor-input",3,"click","ngClass"],["role","textbox","aria-multiline","true",3,"control","labelPosition","multiline","placeholder","crtKeyboardHotkeys","focusout","crtKeyboardHotkeyPressed",4,"ngIf","ngIfElse"],["role","textbox","aria-multiline","true",3,"focusout","crtKeyboardHotkeyPressed","control","labelPosition","multiline","placeholder","crtKeyboardHotkeys"],["contenteditable","true","tabindex","0","role","textbox","aria-multiline","true","crtMention","",1,"editable-div",3,"input","focusout","mentionSelected","crtKeyboardHotkeyPressed","mentionService","crtKeyboardHotkeys"]],template:function(b,K){if(b&1){const F=t.\u0275\u0275getCurrentView();t.\u0275\u0275elementStart(0,"div",3),t.\u0275\u0275listener("click",function(){return t.\u0275\u0275restoreView(F),t.\u0275\u0275resetView(K.onMessageEditorAreaClicked())}),t.\u0275\u0275template(1,L,4,7,"crt-input",4)(2,w,3,5,"ng-template",null,0,t.\u0275\u0275templateRefExtractor),t.\u0275\u0275elementEnd()}if(b&2){const F=t.\u0275\u0275reference(3);t.\u0275\u0275property("ngClass",t.\u0275\u0275pureFunction1(3,D,K.isFocused===!0)),t.\u0275\u0275advance(),t.\u0275\u0275property("ngIf",K.inputMode==="text")("ngIfElse",F)}},dependencies:[s.NgClass,s.NgIf,u.j,r.h,O.d,p.TranslatePipe],styles:[".message-editor-input[_ngcontent-%COMP%]{display:flex;min-height:80px;max-height:147px;border:1px solid var(--crt-palette-border-900);border-radius:8px;padding-bottom:32px}.message-editor-input.message-editor-input-focused[_ngcontent-%COMP%], .message-editor-input[_ngcontent-%COMP%]:hover{border:1px solid var(--crt-palette-primary-800)}.message-editor-input[_ngcontent-%COMP%]   crt-input[_ngcontent-%COMP%], .message-editor-input[_ngcontent-%COMP%]   .editable-div[_ngcontent-%COMP%]{flex:1;overflow-y:scroll}.message-editor-input[_ngcontent-%COMP%]   .editable-div[_ngcontent-%COMP%]{outline:none;padding:12px}"],changeDetection:0})}};(0,n.__decorate)([(0,_.k)(),(0,n.__metadata)("design:type",String)],S.prototype,"inputMode",void 0),(0,n.__decorate)([(0,P.j)(),(0,n.__metadata)("design:type",t.EventEmitter)],S.prototype,"getMentionService",void 0),(0,n.__decorate)([(0,_.k)(),(0,n.__metadata)("design:type",String),(0,n.__metadata)("design:paramtypes",[String])],S.prototype,"action",null),(0,n.__decorate)([(0,_.k)(),(0,n.__metadata)("design:type",String),(0,n.__metadata)("design:paramtypes",[String])],S.prototype,"chatInput",null),(0,n.__decorate)([(0,P.j)(),(0,n.__metadata)("design:type",Object)],S.prototype,"sendHotkeyPressed",void 0),(0,n.__decorate)([(0,P.j)(),(0,n.__metadata)("design:type",t.EventEmitter)],S.prototype,"chatInputChange",void 0),(0,n.__decorate)([(0,P.j)(),(0,n.__metadata)("design:type",t.EventEmitter)],S.prototype,"isFocusedChange",void 0),(0,n.__decorate)([(0,P.j)(),(0,n.__metadata)("design:type",Object)],S.prototype,"sendMessage",void 0),(0,n.__decorate)([(0,_.k)(),(0,n.__metadata)("design:type",Boolean)],S.prototype,"isFocused",void 0),(0,n.__decorate)([(0,_.k)(),(0,n.__metadata)("design:type",Object)],S.prototype,"mentionService",void 0),S=(0,n.__decorate)([(0,d.v)({type:"crt.MessageEditorInput"})],S)},7917:(W,x,e)=>{e.d(x,{z:()=>_});var n=e(5960),v=e.n(n),t=e(3671),B=e(68712),E=e(59131),y=e.n(E);let _=class _t extends B.K{static{this.\u0275fac=(()=>{let d;return function(M){return(d||(d=E.\u0275\u0275getInheritedFactory(_t)))(M||_t)}})()}static{this.\u0275cmp=E.\u0275\u0275defineComponent({type:_t,selectors:[["crt-message-editor-reply"]],features:[E.\u0275\u0275InheritDefinitionFeature],decls:0,vars:0,template:function(O,M){}})}};_=(0,n.__decorate)([(0,t.v)({type:"crt.MessageEditorReply"})],_)},28503:(W,x,e)=>{e.d(x,{j:()=>r});var n=e(5960),v=e.n(n),t=e(59131),B=e.n(t),E=e(77592),y=e(3671),_=e(96677),P=e(52793),d=e(10098),O=e(68712),M=e(40297),h=e.n(M),i=e(7917);const o=["items"];function s(p,A){p&1&&t.\u0275\u0275elementContainer(0)}function c(p,A){if(p&1&&(t.\u0275\u0275elementStart(0,"div"),t.\u0275\u0275template(1,s,1,0,"ng-container",3),t.\u0275\u0275elementEnd()),p&2){const R=A.$implicit;t.\u0275\u0275advance(),t.\u0275\u0275property("ngTemplateOutlet",R)}}function u(p,A){if(p&1&&(t.\u0275\u0275elementContainerStart(0),t.\u0275\u0275template(1,c,2,1,"div",2),t.\u0275\u0275elementContainerEnd()),p&2){const R=t.\u0275\u0275nextContext();t.\u0275\u0275advance(),t.\u0275\u0275property("ngForOf",R.itemsTemplates)}}let r=class dt extends O.K{set items(A){this._items=A}static{this.\u0275fac=(()=>{let A;return function(V){return(A||(A=t.\u0275\u0275getInheritedFactory(dt)))(V||dt)}})()}static{this.\u0275cmp=t.\u0275\u0275defineComponent({type:dt,selectors:[["crt-message-editor"]],contentQueries:function(R,V,C){if(R&1&&t.\u0275\u0275contentQuery(C,o,4,t.TemplateRef),R&2){let D;t.\u0275\u0275queryRefresh(D=t.\u0275\u0275loadQuery())&&(V.itemsTemplates=D)}},inputs:{items:"items"},features:[t.\u0275\u0275InheritDefinitionFeature],decls:3,vars:1,consts:[[1,"message-editor"],[4,"ngIf"],[4,"ngFor","ngForOf"],[4,"ngTemplateOutlet"]],template:function(R,V){R&1&&(t.\u0275\u0275elementStart(0,"div",0),t.\u0275\u0275element(1,"crt-message-editor-reply"),t.\u0275\u0275template(2,u,2,1,"ng-container",1),t.\u0275\u0275elementEnd()),R&2&&(t.\u0275\u0275advance(2),t.\u0275\u0275property("ngIf",V.itemsTemplates==null?null:V.itemsTemplates.length))},dependencies:[M.NgForOf,M.NgIf,M.NgTemplateOutlet,i.z],styles:["[_nghost-%COMP%]{width:100%}"]})}};(0,n.__decorate)([(0,E.k)(),(0,n.__metadata)("design:type",Array),(0,n.__metadata)("design:paramtypes",[Array])],r.prototype,"items",null),r=(0,n.__decorate)([(0,y.v)({type:"crt.MessageEditor",reuseStrategy:_.B.Reuse,contentSlots:[{name:"items",lazy:!0,input:!0}]}),(0,P.f)({propertiesPanelComponentTypeName:"crt.MessageEditorPropertiesPanel",viewElementGroupType:d.J.Components,typeCaption:"MessageEditor.Caption"})],r)},42963:(W,x,e)=>{e.d(x,{o:()=>M});var n=e(73308),v=e(5960),t=e.n(v),B=e(59131),E=e.n(B),y=e(41287),_=e(86464),P=e(844),d=e(8017),O=e(48534);let M=class extends y.l{constructor(i){super(),this._sanitizeHtmlPipe=i.get(d.b),this._copilotToEditorCommunicationService=i.get(O.i)}handle(i){var o=this;return(0,n.A)(function*(){const s=o._sanitizeHtmlPipe.transform(i.message.text,{mode:"textOnly",dataType:_.r.MAXSIZE_TEXT});o._copilotToEditorCommunicationService.notify({editorAction:i.action,selection:s}),yield o.next?.handle(i)})()}};M=(0,v.__decorate)([(0,P.l)({type:"crt.ChatMessageActionHandler",requestType:"crt.ChatMessageActionRequest"}),(0,v.__metadata)("design:paramtypes",[B.Injector])],M)},99556:(W,x,e)=>{e.d(x,{m:()=>h});var n=e(73308),v=e(5960),t=e.n(v),B=e(59131),E=e.n(B),y=e(41287),_=e(844),P=e(18357),d=e(62278),O=e.n(d),M=e(13161);let h=class extends y.l{constructor(o){super(),this._profileService=o.get(P.c)}handle(o){var s=this;return(0,n.A)(function*(){return yield s.next?.handle(o),(0,d.lastValueFrom)(s._profileService.getProfile(M.j).pipe((0,d.share)()))})()}};h=(0,v.__decorate)([(0,_.l)({type:"crt.LoadChatProfileHandler",requestType:"crt.LoadChatProfileRequest"}),(0,v.__metadata)("design:paramtypes",[B.Injector])],h)},53395:(W,x,e)=>{e.d(x,{b:()=>i});var n=e(73308),v=e(5960),t=e.n(v),B=e(59131),E=e.n(B),y=e(41287),_=e(844),P=e(18357),d=e(23092),O=e(62278),M=e.n(O),h=e(13161);let i=class extends y.l{constructor(s){super(),this._profileService=s.get(P.c),this._userInfo=s.get(d.oq)}handle(s){var c=this;return(0,n.A)(function*(){const{$context:u}=s,r={lastChatId:yield u.CurrentCopilotSessionId,isCombinedMode:yield u.IsCombinedMode,isChatsListVisible:yield u.ChatsListVisible,combinedModeEnabled:yield u.CombinedModeEnabled,savedInSessionId:c._userInfo.sessionId};yield(0,O.lastValueFrom)(c._profileService.saveProfile(h.j,r).pipe((0,O.share)())),yield c.next?.handle(s)})()}};i=(0,v.__decorate)([(0,_.l)({type:"crt.SaveChatProfileHandler",requestType:"crt.SaveChatProfileRequest"}),(0,v.__metadata)("design:paramtypes",[B.Injector])],i)},53251:(W,x,e)=>{e.d(x,{h:()=>P,w:()=>_});var n=e(73308),v=e(5960),t=e.n(v),B=e(81517),E=e(41287),y=e(844);class _ extends B.S{}let P=class extends E.l{handle(O){var M=this;return(0,n.A)(function*(){O.$context.ActiveChats=O.chats,yield M.next?.handle(O)})()}};P=(0,v.__decorate)([(0,y.l)({type:"crt.ChatListChangeHandler",requestType:"crt.ChatListChangeRequest"})],P)},4944:(W,x,e)=>{e.d(x,{G:()=>c});var n=e(73308),v=e(5960),t=e(41287),B=e(6530),E=e(844),y=e(79772),_=e(48594),P=e(22701);class d{static get(r){switch(r){case _.Go.Image:return P.X.Image;case _.Go.File:return P.X.File;case _.Go.System:return P.X.System;case _.Go.Text:default:return P.X.Text}}}var O=e(56704),M=e(84323),h=e(23092),i=e(62278),o=e(15932),s=e(43778);let c=class extends t.l{constructor(r,p,A){super(),this._userInfo=r,this._omniChatService=p,this._translateService=A}_getUserLocalDate(r){return(0,M.v8)(r,this._userInfo.timeZoneOffsetHours),r}_getConvertedMessages(r){return r.map(p=>({attachments:p.attachments,macrosTemplate:p.macrosTemplate,id:p.id,author:p.author,date:this._getUserLocalDate(p.time),direction:p.direction,isBotMessage:p.isBotMessage,text:p.text,type:d.get(p.type)}))}_getChatMessages(r){var p=this;return(0,n.A)(function*(){return p._getConvertedMessages(yield(0,i.lastValueFrom)(p._omniChatService.getConversation(r)))})()}_addChatStartedMessage(r){const p=r.find(R=>R.type!==P.X.System),A={id:(0,B.qv)(),type:P.X.System,date:p.date,macrosTemplate:{template:this._translateService.instant("ChatMessage.System.ChatStartedMessage"),tokens:[{key:"chatStartedAt",type:"datetime",value:p.date.toString()},{key:"chatStartedBy",type:"lookup",value:{entitySchemaName:"Contact",primaryColumnValue:p.author.id,caption:p.author.name}},{key:"icon",type:"icon",value:"flag-icon"}]}};return r.unshift(A),A.id}_addDateChangedDividers(r,p){if(r.length===0)return;const A=JSON.stringify({type:P.X.System,date:null,macrosTemplate:{template:"{dateHeader}",tokens:[{key:"icon",type:"icon",value:"date-time"}]}});let R=this._getDatePart(r[r.length-1].date);for(let V=r.length-1;V>=0;V--)if((V===0||this._getDatePart(r[V].date)!==R)&&r[V].id!==p){const C=JSON.parse(A);C.date=new Date(R),C.macrosTemplate.tokens.push({key:"dateHeader",type:"date",value:R}),r.splice(V===0?0:V+1,0,C),R=this._getDatePart(r[V].date)}}_getDatePart(r){return r.toISOString().split("T")[0]}handle(r){var p=this;return(0,n.A)(function*(){yield p.next?.handle(r);const A=r.$context;if(!A[`${r.chatMessagesAttributeName}`])return;const R=r.chatId,V=r.loadMode;let C,D,L,w;switch(V){case o.W.Append:L=yield A[`${r.previousChatIdAttributeName}`],C=yield p._getChatMessages(L),w=p._addChatStartedMessage(C),p._addDateChangedDividers(C,w),D=yield A[`${r.chatMessagesAttributeName}`],A.ConversationEvent=[{name:s.R}],A[`${r.chatMessagesAttributeName}`]=C.concat(D),L=yield(0,i.lastValueFrom)(p._omniChatService.getPreviousChatId(L)),A[`${r.previousChatIdAttributeName}`]=L===B.To?null:L;return;case o.W.Replace:default:C=yield p._getChatMessages(R),A.ChatId=R,A.ConversationEvent=[{name:s.R}],w=p._addChatStartedMessage(C),p._addDateChangedDividers(C,w),A[`${r.chatMessagesAttributeName}`]=C,r.previousChatIdAttributeName&&(L=yield(0,i.lastValueFrom)(p._omniChatService.getPreviousChatId(R)),A[`${r.previousChatIdAttributeName}`]=L===B.To?null:L);return}})()}};c=(0,v.__decorate)([(0,E.l)({type:"crt.LoadConversationHandler",requestType:"crt.LoadConversationRequest"}),(0,v.__metadata)("design:paramtypes",[h.oq,O.I,y.TranslateService])],c)},20903:(W,x,e)=>{e.d(x,{x:()=>h});var n=e(73308),v=e(5960),t=e.n(v),B=e(59131),E=e.n(B),y=e(41287),_=e(844),P=e(79772),d=e.n(P),O=e(13555),M=e(92385);let h=class extends y.l{constructor(o){super(),this._chatDraftService=o.get(O.X),this._translateService=o.get(P.TranslateService),this._copilotContentUtils=o.get(M.$)}_updateChatPreview(o,s){var c=this;return(0,n.A)(function*(){const u=yield o.$context.ActiveChats;if(!u)return;const r=u.findIndex(V=>V.id===s);if(r===-1)return;const p=u[r],A=c._copilotContentUtils.sanitizeContent(o.newValue),R=c._copilotContentUtils.toPlainText(A);o.newValue&&R!==""?p.preview=c._translateService.instant("ChatList.DraftPreview")+R:p.preview=p.previewFromServer,o.$context.ActiveChats=u})()}handle(o){var s=this;return(0,n.A)(function*(){yield s.next?.handle(o),o.$context[o.attributesMapping.chatInput]=o.newValue;const c=yield o.$context[o.attributesMapping.chatId];s._chatDraftService.setDraft(c,o.newValue),yield s._updateChatPreview(o,c)})()}};h=(0,v.__decorate)([(0,_.l)({type:"crt.MessageEditorInputChangeHandler",requestType:"crt.MessageEditorInputChangeRequest"}),(0,v.__metadata)("design:paramtypes",[B.Injector])],h)},13161:(W,x,e)=>{e.d(x,{j:()=>n});const n="ChatPanel"},15959:(W,x,e)=>{e.d(x,{H:()=>n});class n{constructor(){this.isTyping=!1,this.unreadMessagesCount=0}}},43778:(W,x,e)=>{e.d(x,{R:()=>v,u:()=>n});class n{}const v="reset"},15932:(W,x,e)=>{e.d(x,{W:()=>n});var n;(function(v){v.Replace="replace",v.Append="append"})(n||(n={}))},1978:(W,x,e)=>{e.d(x,{k:()=>_});var n=e(73308),v=e(59131),t=e.n(v),B=e(74368),E=e(28399),y=e.n(E);class _{constructor(){this._metadataSchemaUtils=(0,v.inject)(B.u)}_getViewConfigs(d,O){return this._metadataSchemaUtils.getViewConfigInfoByProperty("type",O,d).map(M=>M?.viewConfig).filter(Boolean)}_updateBindings(d,O){this._setChatInputAttribute(d,O),this._setSendMessageRequest(d),this._setBindingsMappingAttribure(d,O)}_setChatInputAttribute(d,O){if(!(0,E.isEmpty)(d.chatInput))return;const M=`ChatInput_${d.name}`;O[M]={value:null},d.chatInput=`$${M}`}_setSendMessageRequest(d){if(!(0,E.isEmpty)(d.sendMessage))return;const O=this._getBindingsMappingAttribureName(d);d.sendMessage={request:"crt.MessageEditorSendRequest",params:{attributesMapping:`$${O}`}}}_setBindingsMappingAttribure(d,O){const M=this._getBindingsMappingAttribureName(d),h=O[M]?.value||{};h.ChatInput=d.chatInput.split("$").pop(),O[M]={value:h},d.bindingsMappingAttribute=M}_getBindingsMappingAttribureName(d){return d.bindingsMappingAttribute||`BindingsMapping_${d.name}`}crtOnMetaDataInit(d){var O=this;return(0,n.A)(function*(){const M=d,h=O._getViewConfigs(M.viewConfig,"crt.MessageEditor"),i=M.viewModelConfig.attributes;for(const o of h)O._updateBindings(o,i);return Promise.resolve(d)})()}static{this.\u0275fac=function(O){return new(O||_)}}static{this.\u0275prov=v.\u0275\u0275defineInjectable({token:_,factory:_.\u0275fac})}}},13555:(W,x,e)=>{e.d(x,{X:()=>_});var n=e(62278),v=e.n(n),t=e(36486),B=e.n(t),E=e(59131),y=e.n(E);class _{constructor(){this._saveMessageDebounceTimeout=500,this._storageKeyPrefix="chat-draft",this._draftUpdatesMap=new Map}_getOrCreateSubject(d){if(!this._draftUpdatesMap.has(d)){const O=new n.Subject;O.pipe((0,t.debounceTime)(this._saveMessageDebounceTimeout)).subscribe(M=>{const h=this._getStorageKey(d);M===null?sessionStorage.removeItem(h):sessionStorage.setItem(h,M)}),this._draftUpdatesMap.set(d,O)}return this._draftUpdatesMap.get(d)}_getStorageKey(d){return`${this._storageKeyPrefix}-${d||"new"}`}setDraft(d,O){this._getOrCreateSubject(d).next(O)}getDraft(d){const O=this._getStorageKey(d);return sessionStorage.getItem(O)||""}clearDraft(d){this._getOrCreateSubject(d).next(null)}ngOnDestroy(){this._draftUpdatesMap.forEach(d=>{d.complete()}),this._draftUpdatesMap.clear()}static{this.\u0275fac=function(O){return new(O||_)}}static{this.\u0275prov=E.\u0275\u0275defineInjectable({token:_,factory:_.\u0275fac,providedIn:"root"})}}},19540:(W,x,e)=>{e.d(x,{U:()=>B});var n=e(59969),v=e(59131),t=e.n(v);class B{constructor(y){this.window=y}saveScrollPosition(y,_=0){this.window.sessionStorage.setItem(`${y}_scrollTop`,_.toString())}getScrollPosition(y){const _=this.window.sessionStorage.getItem(`${y}_scrollTop`);if(_===null||_==="")return;const P=Number(_);return isNaN(P)?void 0:P}static{this.\u0275fac=function(_){return new(_||B)(v.\u0275\u0275inject(n.ZP))}}static{this.\u0275prov=v.\u0275\u0275defineInjectable({token:B,factory:B.\u0275fac,providedIn:"root"})}}},92385:(W,x,e)=>{e.d(x,{$:()=>M});var n=e(79772),v=e.n(n),t=e(34268),B=e.n(t),E=e(89986),y=e(59131),_=e.n(y),P=e(13555);const d=["span"],O=["class","data-mention"];class M{constructor(i,o){this._translateService=i,this._chatDraftService=o,this._domPurifier=B()(window),this._domPurifier.addHook("uponSanitizeElement",E.F.func)}_replaceMentions(i){if(!i.includes('class="mention"')&&!i.includes("class='mention'"))return i;const o=document.createElement("div");return o.innerHTML=i,o.querySelectorAll(".mention").forEach(s=>{const u=s.textContent||""||" ";s.replaceWith(document.createTextNode(u))}),o.innerHTML}_stripMarkdown(i){return i.replace(/\[([^\]]+)\]\([^)]+\)/g,"$1").replace(/\*\*(.*?)\*\*/g,"$1").replace(/\*(.*?)\*/g,"$1").replace(/__(.*?)__/g,"$1").replace(/_(.*?)_/g,"$1").replace(/`([^`]+?)`/g,"$1").replace(/^>+\s?/gm,"").replace(/^#{1,6}\s?/gm,"").replace(/&nbsp;/g," ").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&amp;/g,"&").replace(/\\n/g,`
`).replace(/\n{2,}/g,`

`).trim()}sanitizeContent(i){const o={ALLOWED_TAGS:d,ALLOWED_ATTR:O};return this._domPurifier.sanitize(i,o)}getPreview(i,o,s){if(!s)return this._translateService.instant("ChatList.YourPreview")+this.toPlainText(o);const c=this.sanitizeContent(this._chatDraftService.getDraft(i));return c&&c.length>0?this._translateService.instant("ChatList.DraftPreview")+this.toPlainText(c):this.toPlainText(o)}toPlainText(i){if(!i)return"";const o=this._replaceMentions(i);return this._stripMarkdown(o)}static{this.\u0275fac=function(o){return new(o||M)(y.\u0275\u0275inject(n.TranslateService),y.\u0275\u0275inject(P.X))}}static{this.\u0275prov=y.\u0275\u0275defineInjectable({token:M,factory:M.\u0275fac,providedIn:"root"})}}},89986:(W,x,e)=>{e.d(x,{F:()=>n});const n={name:"uponSanitizeElement",func:(v,t)=>{if(t.tagName==="span"){const B=v.getAttribute("class"),E=v.getAttribute("data-mention");if(!(B==="mention"&&E)){const _=document.createTextNode(v.textContent||"");v.parentNode?.replaceChild(_,v)}}}}},3585:(W,x,e)=>{e.d(x,{d:()=>h});var n=e(59131),v=e(62278),t=e(40297),B=e(59969),E=e(90895),y=e(92340);const _=["popupContainer"],P=i=>({"active-item":i});function d(i,o){if(i&1&&(n.\u0275\u0275elementStart(0,"span",8),n.\u0275\u0275text(1),n.\u0275\u0275elementEnd()),i&2){const s=n.\u0275\u0275nextContext().$implicit;n.\u0275\u0275propertyInterpolate("title",s.description),n.\u0275\u0275advance(),n.\u0275\u0275textInterpolate(s.description)}}function O(i,o){if(i&1){const s=n.\u0275\u0275getCurrentView();n.\u0275\u0275elementStart(0,"div",3),n.\u0275\u0275listener("click",function(){const u=n.\u0275\u0275restoreView(s).$implicit,r=n.\u0275\u0275nextContext();return n.\u0275\u0275resetView(r.selectMention(u))}),n.\u0275\u0275element(1,"crt-image-input",4),n.\u0275\u0275elementStart(2,"div",5)(3,"span",6),n.\u0275\u0275text(4),n.\u0275\u0275elementEnd(),n.\u0275\u0275template(5,d,2,2,"span",7),n.\u0275\u0275elementEnd()()}if(i&2){const s=o.$implicit,c=o.index,u=n.\u0275\u0275nextContext();n.\u0275\u0275property("ngClass",n.\u0275\u0275pureFunction1(5,P,c===u.activeIndex)),n.\u0275\u0275advance(),n.\u0275\u0275property("value",s.photo||null)("placeholder",s.displayValue),n.\u0275\u0275advance(3),n.\u0275\u0275textInterpolate(s.displayValue),n.\u0275\u0275advance(),n.\u0275\u0275property("ngIf",s.description)}}class M{constructor(){this._changeDetector=(0,n.inject)(n.ChangeDetectorRef),this._liveAnnouncementService=(0,n.inject)(B.DW),this._isVisible=!1,this.mentions=[],this.activeIndex=-1,this.mentionSelected=new n.EventEmitter,this.scrolledToBottom=new n.EventEmitter,this._scrollHandler=o=>{const s=o.target;s.scrollTop+s.clientHeight>=s.scrollHeight-20&&this.scrolledToBottom.emit()}}selectMention(o){this.mentionSelected.emit(o),this.hide()}show(o){this._isVisible=!0;const s=10,c=this.popupContainerRef?.nativeElement;if(c){const r=window.innerHeight-o.top;c.classList.remove("popup-hidden"),Object.assign(c.style,{position:"absolute",width:`${o.width}px`,left:`${o.left}px`,bottom:`${r+s}px`,top:"auto"}),setTimeout(()=>{c.getBoundingClientRect().top<0&&Object.assign(c.style,{bottom:"auto",top:`${o.top}px`,maxHeight:`${o.top-s}px`})},0)}this._changeDetector.detectChanges()}hide(){this._isVisible=!1,this.popupContainerRef?.nativeElement?.classList.add("popup-hidden")}isVisible(){return this._isVisible}getItems(){return Array.from(this.popupContainerRef?.nativeElement?.children||[])}highlightItem(o){if(this.getItems().forEach((c,u)=>{c.classList.toggle("active-item",u===o)}),o>=0&&o<this.mentions.length){const c=this.mentions[o],u=`${c.displayValue} ${c.description||""}`.trim();this._liveAnnouncementService.announce(u,"polite")}}selectItem(o){o>=0&&o<this.mentions.length&&this.selectMention(this.mentions[o])}scrollToItem(o){this.popupContainerRef?.nativeElement&&o>=0&&this.getItems()[o]?.scrollIntoView({behavior:"auto",block:"nearest"})}ngAfterViewInit(){this.popupContainerRef?.nativeElement?.addEventListener("scroll",this._scrollHandler)}ngOnDestroy(){this.popupContainerRef?.nativeElement?.removeEventListener("scroll",this._scrollHandler)}static{this.\u0275fac=function(s){return new(s||M)}}static{this.\u0275cmp=n.\u0275\u0275defineComponent({type:M,selectors:[["crt-mention-popup"]],viewQuery:function(s,c){if(s&1&&n.\u0275\u0275viewQuery(_,5),s&2){let u;n.\u0275\u0275queryRefresh(u=n.\u0275\u0275loadQuery())&&(c.popupContainerRef=u.first)}},inputs:{mentions:"mentions",activeIndex:"activeIndex"},outputs:{mentionSelected:"mentionSelected",scrolledToBottom:"scrolledToBottom"},standalone:!0,features:[n.\u0275\u0275StandaloneFeature],decls:3,vars:3,consts:[["popupContainer",""],[1,"container"],["class","item",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"item",3,"click","ngClass"],["readonly","true","placeholderMode","abbreviation","borderRadius","large","positioning","cover","size","small","aria-hidden","true",1,"image",3,"value","placeholder"],[1,"text"],[1,"name"],["class","description",3,"title",4,"ngIf"],[1,"description",3,"title"]],template:function(s,c){s&1&&(n.\u0275\u0275elementStart(0,"div",1,0),n.\u0275\u0275template(2,O,6,7,"div",2),n.\u0275\u0275elementEnd()),s&2&&(n.\u0275\u0275classProp("popup-hidden",!(c.mentions!=null&&c.mentions.length)),n.\u0275\u0275advance(2),n.\u0275\u0275property("ngForOf",c.mentions))},dependencies:[t.CommonModule,t.NgClass,t.NgForOf,t.NgIf,E.J,y.g],styles:["body[_ngcontent-%COMP%]{--focus-outline-outer-color: var(--crt-palette-secondary-500);--focus-outline-inner-color: white}[_nghost-%COMP%]   .container[_ngcontent-%COMP%]{position:absolute;border-radius:4px;max-width:500px;max-height:276px;overflow-y:auto;z-index:1000;padding:8px 0 8px 8px}[_nghost-%COMP%]   .container.popup-hidden[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]   .container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:8px 16px;cursor:pointer;border-radius:4px;gap:8px}[_nghost-%COMP%]   .container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{display:flex;width:calc(100% - 32px);max-width:100%;flex-direction:column;gap:2px}[_nghost-%COMP%]   .container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%], [_nghost-%COMP%]   .container[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{white-space:nowrap;text-overflow:ellipsis;overflow:hidden}"]})}}class h{get mentionSymbol(){return this._mentionSymbol}constructor(o,s,c){this._injector=o,this._el=s,this._viewContainerRef=c,this._subscriptions=new v.Subscription,this._activeIndex=-1,this._page=0,this._pageSize=15,this._currentSearch="",this._mentionSymbol="@",this._mentionClassName="mention",this._lastRange=null,this._searchSubject=new v.Subject,this.mentionSelected=new n.EventEmitter}onInput(o){const s=o.target,c=window.getSelection();if(!c||c.rangeCount===0){this._popupComponent.hide();return}const u=c.getRangeAt(0),r=u.startOffset;if(!(s.textContent||s.innerHTML)){this._popupComponent.hide();return}const A=u.startContainer.textContent.substring(0,r),R=A.lastIndexOf(this._mentionSymbol);if(this._lastRange=u.cloneRange(),R!==-1){const V=A.substring(R+1);this._page=0,this._fetchMentions(V)}else this._popupComponent.hide()}_fetchMentions(o,s=!1){this._currentSearch=o,this._searchSubject.next({search:o,append:s})}_executeSearch(o,s){const c=this._page*this._pageSize;this.mentionService.getContacts(o,c,this._pageSize).pipe((0,v.take)(1)).subscribe(u=>{this._populatePopup(u,s)})}_createPopup(){this._componentRef=this._viewContainerRef.createComponent(M,{injector:this._injector});const o=this._componentRef.location.nativeElement;document.body.appendChild(o),this._popupComponent=this._componentRef.instance,this._popupComponent.mentionSelected.subscribe(s=>this._selectMention(s)),this._popupComponent.scrolledToBottom.subscribe(()=>{this._page++,this._fetchMentions(this._currentSearch,!0)})}_populatePopup(o,s){if(o.length===0&&!s){this._popupComponent.hide();return}s||o.length===0?this._popupComponent.mentions=[...this._popupComponent.mentions,...o]:(this._popupComponent.mentions=o,this._page=0),this._popupComponent.activeIndex=this._activeIndex,this._popupComponent.show(this._el.nativeElement.getBoundingClientRect())}_selectMention(o){const s=this._el.nativeElement,c=window.getSelection(),u=this._lastRange||c.getRangeAt(0);if(u){const p=u.startContainer.textContent.substring(0,u.startOffset).lastIndexOf(this._mentionSymbol);if(p!==-1){const A=u.startContainer,R=A.textContent.substring(0,p);A.textContent=R,u.setStart(A,R.length),u.collapse(!0);const V=document.createElement("span");V.dataset.mention=o.value,Object.assign(V,{className:this._mentionClassName,contentEditable:"false",textContent:o.displayValue}),u.insertNode(V),s.childElementCount===1&&u.insertNode(document.createTextNode("\u200B")),this._forcePlaceCursorAtEnd(V)}}this.mentionSelected.emit(o),this._popupComponent.hide(),s.focus()}_handleKeyboard(o){if(!this._popupComponent.isVisible())return;const s=this._popupComponent.getItems();if(s.length!==0)switch(o.key){case"ArrowDown":o.preventDefault(),this._activeIndex=(this._activeIndex+1)%s.length,this._popupComponent.highlightItem(this._activeIndex),this._activeIndex>=s.length-3&&(this._page++,this._fetchMentions(this._currentSearch,!0)),this._popupComponent.scrollToItem(this._activeIndex);break;case"ArrowUp":o.preventDefault(),this._activeIndex=(this._activeIndex-1+s.length)%s.length,this._popupComponent.highlightItem(this._activeIndex),this._popupComponent.scrollToItem(this._activeIndex);break;case"Enter":o.preventDefault(),o.stopImmediatePropagation(),o.stopPropagation(),this._activeIndex>=0&&this._activeIndex<s.length&&this._popupComponent.selectItem(this._activeIndex);break;case"Remove":case"Delete":this._handleRemove(o),o.preventDefault();break;case"Escape":o.preventDefault(),this._popupComponent.hide();break;case"Tab":this._popupComponent.hide();break}}_handleRemove(o){const c=window.getSelection().getRangeAt(0);if(c.collapsed&&c.startContainer.nodeType===3){const u=c.startContainer,r=o.key==="Backspace"?u.previousSibling:u.nextSibling;r instanceof HTMLElement&&r.classList.contains(this._mentionClassName)&&r.remove()}}_forcePlaceCursorAtEnd(o){const s=o.parentNode,c=document.createTextNode("\xA0");o.nextSibling?s.insertBefore(c,o.nextSibling):s.appendChild(c);const u=document.createRange();u.setStart(c,1),u.collapse(!0);const r=window.getSelection();r.removeAllRanges(),r.addRange(u)}_subscribeClick(){this._subscriptions.add((0,v.fromEvent)(document,"click",{capture:!0}).subscribe(o=>{if(this._popupComponent?.isVisible()){const s=o.target,c=this._popupComponent.popupContainerRef?.nativeElement,u=this._el.nativeElement;c&&!c.contains(s)&&s!==u&&!u.contains(s)&&this._popupComponent.hide()}}))}_subscribeKeydown(){this._subscriptions.add((0,v.fromEvent)(this._el.nativeElement,"keydown",{capture:!0}).subscribe(o=>this._handleKeyboard(o)))}ngOnInit(){this._createPopup(),this._subscriptions.add(this._searchSubject.pipe((0,v.debounceTime)(10)).subscribe(({search:o,append:s})=>{this._executeSearch(o,s)})),this._subscribeClick(),this._subscribeKeydown()}ngOnDestroy(){this._subscriptions.unsubscribe(),this._componentRef?.destroy()}static{this.\u0275fac=function(s){return new(s||h)(n.\u0275\u0275directiveInject(n.Injector),n.\u0275\u0275directiveInject(n.ElementRef),n.\u0275\u0275directiveInject(n.ViewContainerRef))}}static{this.\u0275dir=n.\u0275\u0275defineDirective({type:h,selectors:[["","crtMention",""]],hostBindings:function(s,c){s&1&&n.\u0275\u0275listener("input",function(r){return c.onInput(r)})},inputs:{mentionService:"mentionService"},outputs:{mentionSelected:"mentionSelected"},standalone:!0})}}},56704:(W,x,e)=>{e.d(x,{I:()=>R});var n=e(63721),v=e.n(n),t=e(49973),B=e(58504),E=e(41108),y=e(56267),_=e(79772),P=e.n(_),d=e(43272),O=e(23872),M=e(62278),h=e.n(M),i=e(36486),o=e.n(i),s=e(59131),c=e.n(s),u=e(50485),r=e(65751),p=e(14876),A=e(23092);class R extends d.A{static get rowsCount(){return 30}constructor(C,D,L,w,S,I){super(D,L,w),this.rightsService=C,this.httpClient=S,this.userInfo=I,this._serviceUrl="/rest/OmnichannelChatService/",this._canManageChatsOperationCode="CanManageChats",this._cacheChatActions={},this.entitySchemaName="OmniChat"}_postWithChatId(C,D){const L=this._serviceUrl+D;return this.httpClient.post(L,{chatId:C})}_getMessages(C,D){const L=this._serviceUrl+D;return this.httpClient.post(L,{chatId:C}).pipe((0,i.map)(this._mapChatMessage()))}_getAllConversationMessages(C,D,L){const w=new n.HttpHeaders().set("Content-Type","application/json; charset=utf-8"),S=this._serviceUrl+"GetAllConversation";return this.httpClient.post(S,{contactId:C,channelId:D,rowCount:R.rowsCount,rowOffset:L},{headers:w}).pipe((0,i.map)(this._mapChatMessage()))}_mapChatMessage(){return C=>(C.forEach(D=>{D.time=new Date(D.time),D.author=new O.B(D.author.id,D.author.name,D.author.photoId),D.macrosTemplate&&this._handleMessageMacros(D)}),C)}_handleMessageMacros(C){let D;try{D=JSON.parse(C.macrosTemplate.tokens)}catch(L){console.error("Failed to parse tokens:",L)}C.macrosTemplate.tokens=D}acceptChat(C){return this._postWithChatId(C,"AcceptChat")}getAllConversationByChat(C,D=0){const L=new n.HttpHeaders().set("Content-Type","application/json; charset=utf-8"),w=this._serviceUrl+"GetAllConversationByChat";return this.httpClient.post(w,{chatId:C,rowCount:R.rowsCount,rowOffset:D},{headers:L}).pipe((0,i.map)(this._mapChatMessage()))}getAllConversation(C,D,L=0){return this._getAllConversationMessages(C,D,L)}getConversation(C){const D=new n.HttpHeaders().set("Content-Type","application/json; charset=utf-8"),L=this._serviceUrl+"GetConversation";return this.httpClient.post(L,{chatId:C},{headers:D}).pipe((0,i.map)(this._mapChatMessage()))}markAsRead(C){const D=this._serviceUrl+"MarkChatAsRead";this.httpClient.post(D,{chatId:C}).subscribe()}getMessageTemplate(C){const D=this._serviceUrl+"GetUnifiedMessageTemplate";return this.httpClient.post(D,{chatId:C})}getPreviousChatId(C){const D=this._serviceUrl+"GetPreviousChatId";return this.httpClient.post(D,{chatId:C})}sendMessage(C){const D="/rest/OmnichannelOutcomeMessagingService/SendMessage",L={message:C};return this.httpClient.post(D,L)}sendMessageWithAttachments(C,D){const L="/rest/OmnichannelOutcomeMessagingService/SendMessageWithAttachments",w=new FormData;return w.append("message",JSON.stringify(C)),Array.from(D).forEach((S,I)=>{w.append("file"+I,S,S.name)}),this.httpClient.post(L,w)}completeChat(C){return this._postWithChatId(C,"CloseActiveChat")}getOperatorChats(){const C=this._serviceUrl+"GetChats";return this.httpClient.post(C,{operatorId:this.userInfo.id}).pipe((0,i.map)(D=>({success:!0,errorInfo:null,result:D.Chats.map(L=>this.entityConverter.getEntity(L))})),(0,i.catchError)(D=>this.getBaseErrorResponse(D)))}getChatHistory(C){return this._getMessages(C,"GetHistory")}getChatActions(C){if(this._cacheChatActions[C])return(0,M.of)(this._cacheChatActions[C]);const D=this._serviceUrl+"GetChatActions";return this.httpClient.post(D,{chatId:C}).pipe((0,i.tap)(L=>this._cacheChatActions[C]=L))}isOperatorCanManageChats(){return this.rightsService.getCanExecuteOperation(this._canManageChatsOperationCode).pipe((0,i.map)(C=>C))}isOperatorActive(){const C=new t.s("OperatorSession");return C.rowCount=1,C.addSchemaColumn("OperatorState.OperatorAvailable","IsActive"),C.filters.addSchemaColumnFilterWithParameter(B.H.Is_null,"SessionEndDate",null),C.filters.addSchemaColumnFilterWithParameter(B.H.Equal,"SysUser",this.userInfo.id),this.queryExecutor.executeSelectQuery(C).pipe((0,i.map)(D=>D&&D[0].IsActive||!1),(0,i.catchError)(()=>(0,M.of)(!1)))}isOperatorHasActiveChannel(){const C=new t.s("Channel");C.rowCount=1;const D=new E.X;return D.logicalOperation=y.H.Or,D.addSchemaColumnFilterWithParameter(B.H.Equal,"ChatQueue.[ChatQueueOperator:ChatQueue:Id].[SysAdminUnitInRole:SysAdminUnit:Operator].SysAdminUnit",this.userInfo.id),D.addSchemaColumnFilterWithParameter(B.H.Equal,"ChatQueue.[ChatQueueOperator:ChatQueue:Id].[SysAdminUnitInRole:SysAdminUnitRoleId:Operator].SysAdminUnit",this.userInfo.id),C.filters.add(D),C.filters.addSchemaColumnFilterWithParameter(B.H.Equal,"IsActive",!0),this.queryExecutor.executeSelectQuery(C).pipe((0,i.map)(L=>L&&L.length>0||!1),(0,i.catchError)(()=>(0,M.of)(!1)))}hasUncompletedChats(C){const D=this._serviceUrl+"GetHasUncompletedChats";return this.httpClient.post(D,{channelId:C})}static{this.\u0275fac=function(D){return new(D||R)(s.\u0275\u0275inject(u.f),s.\u0275\u0275inject(r.w),s.\u0275\u0275inject(_.TranslateService),s.\u0275\u0275inject(p.K),s.\u0275\u0275inject(n.HttpClient),s.\u0275\u0275inject(A.oq))}}static{this.\u0275prov=s.\u0275\u0275defineInjectable({token:R,factory:R.\u0275fac,providedIn:"root"})}}},20555:(W,x,e)=>{e.d(x,{b:()=>v,k:()=>n});const n="OpenChatSessionEvent",v="Copilot"},85040:(W,x,e)=>{e.d(x,{u:()=>n});var n;(function(v){v.SetHighlighting="setHighlighting",v.RemoveHighlighting="removeHighlighting"})(n||(n={}))},48534:(W,x,e)=>{e.d(x,{i:()=>y});var n=e(62278),v=e.n(n),t=e(85040),B=e(59131),E=e.n(B);class y{constructor(){this._currentSubscriptionIdentifier=null,this._currentSubscription=null,this._replaceSelectionSubject=new n.Subject}_unsubscribeLastEditor(){if(this._currentSubscription){const P={editorAction:t.u.RemoveHighlighting};this._replaceSelectionSubject?.next(P),this._currentSubscriptionIdentifier=null,this._currentSubscription.unsubscribe()}}subscribeToNotifications(P,d){this._currentSubscriptionIdentifier!==P&&(this._unsubscribeLastEditor(),this._currentSubscriptionIdentifier=P,this._currentSubscription=this._replaceSelectionSubject.subscribe(d))}notify(P){this._replaceSelectionSubject?.next(P)}static{this.\u0275fac=function(d){return new(d||y)}}static{this.\u0275prov=B.\u0275\u0275defineInjectable({token:y,factory:y.\u0275fac,providedIn:"root"})}}},15208:W=>{W.exports=`<svg width="72" height="64" viewBox="0 0 72 64" fill="none" xmlns="http://www.w3.org/2000/svg">
<g id="Components | Chat - 72x64 | bright">
<g id="Icon">
<rect x="16.5" y="7.5" width="39" height="49" rx="2.5" stroke="#70ACEE"/>
<g id="Frame 19809">
<rect id="Rectangle 45209" x="21" y="11" width="16" height="2" rx="1" fill="#7FC7F4"/>
<g id="Frame 19808">
<g id="Frame 19814">
<circle id="Ellipse 3260" cx="23" cy="17" r="2" fill="#D1D1D1"/>
<g id="Frame 17499">
<rect x="21" y="20" width="24" height="9" rx="2" fill="#D1D1D1"/>
<g id="Frame 19807">
<line id="Line 2314" x1="24" y1="23.5" x2="30" y2="23.5" stroke="white"/>
<line id="Line 2315" x1="24" y1="25.5" x2="42" y2="25.5" stroke="white"/>
</g>
</g>
</g>
<g id="Frame 19815">
<circle id="Ellipse 3260_2" cx="49" cy="30" r="2" fill="#80C8F5"/>
<g id="Frame 17500">
<rect x="27" y="33" width="24" height="9" rx="2" fill="#80C8F5"/>
<g id="Frame 19807_2">
<line id="Line 2314_2" x1="30" y1="36.5" x2="48" y2="36.5" stroke="white"/>
<line id="Line 2315_2" x1="44" y1="38.5" x2="48" y2="38.5" stroke="white"/>
</g>
</g>
</g>
<g id="Frame 19816">
<circle id="Ellipse 3260_3" cx="23" cy="43" r="2" fill="#D1D1D1"/>
<g id="Frame 17499_2">
<rect x="21" y="46" width="24" height="7" rx="2" fill="#D1D1D1"/>
<g id="Frame 19807_3">
<line id="Line 2314_3" x1="24" y1="49.5" x2="42" y2="49.5" stroke="white"/>
</g>
</g>
</g>
</g>
</g>
</g>
</g>
</svg>
`},70807:W=>{W.exports=`<svg width="72" height="64" viewBox="0 0 72 64" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M58 15H28C26.3431 15 25 16.3431 25 18C25 19.6569 26.3431 21 28 21H58C59.6569 21 61 19.6569 61 18C61 16.3431 59.6569 15 58 15Z" fill="#40ACF0"/>
<path d="M58 36H40C38.3431 36 37 37.3431 37 39C37 40.6569 38.3431 42 40 42H58C59.6569 42 61 40.6569 61 39C61 37.3431 59.6569 36 58 36Z" fill="#D1D1D1"/>
<path d="M58 26H40C38.3431 26 37 27.3431 37 29C37 30.6569 38.3431 32 40 32H58C59.6569 32 61 30.6569 61 29C61 27.3431 59.6569 26 58 26Z" fill="#D1D1D1"/>
<path d="M58 46H40C38.3431 46 37 47.3431 37 49C37 50.6569 38.3431 52 40 52H58C59.6569 52 61 50.6569 61 49C61 47.3431 59.6569 46 58 46Z" fill="#D1D1D1"/>
<circle cx="29" cy="39" r="4" fill="#004FD6"/>
<circle cx="29" cy="29" r="4" fill="#004FD6"/>
<circle cx="29" cy="49" r="4" fill="#004FD6"/>
<path d="M15 26C18.3137 26 21 23.3137 21 20C21 16.6863 18.3137 14 15 14C11.6863 14 9 16.6863 9 20C9 23.3137 11.6863 26 15 26Z" stroke="#FF4013" stroke-width="2" stroke-miterlimit="10"/>
<path d="M15 17.1152V20.3722L16.682 22.3302" stroke="#FF4013" stroke-width="2" stroke-miterlimit="10" stroke-linecap="round"/>
</svg>
`},78517:W=>{W.exports='<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48"><path d="M42.2,39.7l-8.1-3.6-.5-1.6c-.2-.6-.4-1.1-.9-1.2a.68.68,0,0,1-.4-.6L32,29.5a.91.91,0,0,1,.3-.7,6.1,6.1,0,0,0,1.5-3.6c.1-.7.5-1.3.6-2l.7-3.8a.85.85,0,0,0-.5-1.1c-.2,0-.3-.3-.3-.7a44.6,44.6,0,0,0,.5-6.7c-.3-2.3-2.1-7-6.9-6.7C15.2.4,16.2,6.6,11.8,8.5a2.6,2.6,0,0,0,2.8.5c-.2.2-1.8.3-2.5,3.3a3.76,3.76,0,0,1,2-1.5c-1.5.8-.1,5.7-.1,6.2v.6a.78.78,0,0,1-.3.7c-.6.3-.6.6-.6,1.1l.7,3.8a7.62,7.62,0,0,1,.6,2,7.7,7.7,0,0,0,1.5,3.6.91.91,0,0,1,.3.7l-.3,3.2a.82.82,0,0,1-.4.6c-.5.1-.8.7-.9,1.2l-.5,1.6L5.9,39.7A24.11,24.11,0,0,0,24,47.9,23.83,23.83,0,0,0,42.2,39.7Z" fill="#cacaca"/><g opacity="0.05"><path d="M24,2A22,22,0,1,1,2,24,22,22,0,0,1,24,2m0-2A24,24,0,1,0,48,24,24,24,0,0,0,24,0Z" fill="#181818"/></g></svg>'},21888:W=>{W.exports=`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M13.5538 7.23804L4.32784 2.12044C4.17412 2.03159 3.99711 1.99031 3.81954 2.00192C3.64197 2.01352 3.47196 2.07747 3.33133 2.18556C3.18772 2.29787 3.08345 2.45217 3.03332 2.62654C2.98319 2.80092 2.98976 2.98652 3.05209 3.15698L4.59066 7.41713C4.60623 7.4596 4.63447 7.49638 4.67164 7.52255C4.70881 7.54873 4.75313 7.56306 4.79872 7.56365H8.75192C8.86558 7.56187 8.9757 7.60289 9.06004 7.67843C9.14438 7.75397 9.19668 7.85841 9.20637 7.97067C9.21011 8.02993 9.20155 8.08932 9.18122 8.14516C9.16089 8.20101 9.12922 8.25213 9.08817 8.29536C9.04712 8.3386 8.99755 8.37303 8.94254 8.39652C8.88753 8.42002 8.82824 8.43208 8.76834 8.43196H4.79872C4.75313 8.43256 4.70881 8.44689 4.67164 8.47307C4.63447 8.49924 4.60623 8.53601 4.59066 8.57849L3.05209 12.8386C3.00593 12.9699 2.99202 13.1101 3.01151 13.2478C3.03101 13.3854 3.08336 13.5165 3.16421 13.63C3.24505 13.7436 3.35206 13.8364 3.47636 13.9007C3.60065 13.9651 3.73864 13.9991 3.87887 14C4.02808 13.9993 4.17481 13.962 4.30594 13.8915L13.5538 8.75758C13.6893 8.68132 13.8019 8.57083 13.8803 8.43737C13.9587 8.30391 14 8.15224 14 7.99781C14 7.84338 13.9587 7.69171 13.8803 7.55825C13.8019 7.42479 13.6893 7.3143 13.5538 7.23804Z" fill="currentColor"/>
</svg>
`},73869:W=>{W.exports=`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
<path id="Vector" fill-rule="evenodd" clip-rule="evenodd" d="M8.58802 13.7571C8.43705 13.9072 8.22896 14 7.99921 14C7.75841 14 7.54141 13.8981 7.38902 13.735L3.25662 9.7663C2.92401 9.44687 2.91333 8.91829 3.23276 8.58568C3.55219 8.25307 4.08078 8.24239 4.41339 8.56182L7.16421 11.2037L7.16421 2.835C7.16421 2.37384 7.53805 2 7.99921 2C8.46037 2 8.83421 2.37384 8.83421 2.835L8.83421 11.2052L11.5866 8.56182C11.9192 8.24239 12.4478 8.25307 12.7672 8.58568C13.0867 8.91829 13.076 9.44687 12.7434 9.7663L8.58802 13.7571Z" fill="currentColor"/>
</svg>
`}}]);
