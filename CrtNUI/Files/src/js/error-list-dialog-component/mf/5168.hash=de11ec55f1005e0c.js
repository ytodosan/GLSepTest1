(self.webpackChunkapp_studio_enterprise_error_list_dialog=self.webpackChunkapp_studio_enterprise_error_list_dialog||[]).push([[5168,3308,2787],{32787:(K,k,D)=>{D.r(k),D.d(k,{CONFIG_TOKEN:()=>q,DBMode:()=>g,NgxIndexedDBModule:()=>P,NgxIndexedDBService:()=>I});var j=D(73308),v=D(59131),w=D(40297),u=D(62278),M=D(36486);function l(b,e,n,t){return new Promise((r,o)=>{b||o("IndexedDB not available");const i=b.open(e,n);let s;i.onsuccess=c=>{s=i.result,r(s)},i.onerror=c=>{o(`IndexedDB error: ${i.error}`)},typeof t=="function"&&(i.onupgradeneeded=c=>{t(c,s)})})}function S(b,e,n,t,r){return C.apply(this,arguments)}function C(){return C=(0,j.A)(function*(b,e,n,t,r){return new Promise((o,i)=>{if(!b)return;const s=b.open(e,n);s.onupgradeneeded=function(){var c=(0,j.A)(function*(d){const a=d.target.result,m=t.map(function(){var y=(0,j.A)(function*(_){if(!a.objectStoreNames.contains(_.store)){const E=a.createObjectStore(_.store,_.storeConfig);for(const A of _.storeSchema)E.createIndex(A.name,A.keypath,A.options)}});return function(_){return y.apply(this,arguments)}}());yield Promise.all(m);const h=r&&r();if(h){const y=Object.keys(h).map(_=>parseInt(_,10)).filter(_=>_>d.oldVersion).sort((_,E)=>_-E);for(const _ of y)h[_](a,s.transaction)}a.close(),o()});return function(d){return c.apply(this,arguments)}}(),s.onsuccess=c=>{c.target.result.close(),o()},s.onerror=c=>{i(c)}})}),C.apply(this,arguments)}function B(b,e,n){if(!b||!e||!n)throw Error('Params: "dbName", "version", "storeName" are mandatory.');return new u.Observable(t=>{try{const r=e+1,o=indexedDB.open(b,r);o.onupgradeneeded=i=>{const s=i.target.result;s.deleteObjectStore(n),s.close(),console.log("onupgradeneeded"),t.next(!0),t.complete()},o.onerror=i=>t.error(i)}catch(r){t.error(r)}})}function O(b,e){return b.objectStoreNames.contains(e)}function f(b,e,n){b||n("You need to use the openDatabase function to create a database before you query it!"),O(b,e)||n(`objectStore does not exists: ${e}`)}function p(b,e){const n=b.transaction(e.storeName,e.dbMode);return n.onerror=e.error,n.onabort=e.abort,n}function x(b,e,n,t){return{storeName:e,dbMode:b,error:r=>{n(r)},abort:r=>{n(r)}}}var g;(function(b){b.readonly="readonly",b.readwrite="readwrite"})(g||(g={}));const q=new v.InjectionToken(null);class I{constructor(e,n){if(this.dbConfigs=e,this.platformId=n,this.defaultDatabaseName=null,this.isBrowser=(0,w.isPlatformBrowser)(this.platformId),this.isBrowser){this.indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;const t=Object.values(this.dbConfigs),r=t.length===1;for(const o of t)this.instanciateConfig(o,r)}}instanciateConfig(e,n){var t=this;return(0,j.A)(function*(){if(!e.name)throw new Error("NgxIndexedDB: Please, provide the dbName in the configuration");if(!e.version)throw new Error("NgxIndexedDB: Please, provide the db version in the configuration");if((e.isDefault??!1)&&t.defaultDatabaseName)throw new Error("NgxIndexedDB: Only one database can be set as default");((e.isDefault??!1)&&!t.defaultDatabaseName||n)&&(t.defaultDatabaseName=e.name,t.selectedDb=e.name),yield S(t.indexedDB,e.name,e.version,e.objectStoresMeta,e.migrationFactory),l(t.indexedDB,e.name).then(r=>{r.version!==e.version&&(t.dbConfigs[e.name].version=r.version)})})()}get dbConfig(){return this.dbConfigs[this.selectedDb]}getDatabaseVersion(){return new u.Observable(e=>{l(this.indexedDB,this.dbConfig.name,this.dbConfig.version).then(n=>{e.next(n.version),e.complete()}).catch(n=>e.error(`error during get version of database => ${n} `))})}selectDb(e){if(e=e??this.defaultDatabaseName,!e)throw new Error("No database name specified and no default database set.");if(!Object.keys(this.dbConfigs).includes(e))throw new Error(`NgxIndexedDB: Database ${e} is not initialized.`);this.selectedDb=e}createObjectStore(e,n){var t=this;return(0,j.A)(function*(){const r=[e];yield S(t.indexedDB,t.dbConfig.name,++t.dbConfig.version,r,n)})()}add(e,n,t){return new u.Observable(r=>{l(this.indexedDB,this.dbConfig.name,this.dbConfig.version).then(o=>{const s=p(o,x(g.readwrite,e,d=>r.error(d))).objectStore(e),c=t?s.add(n,t):s.add(n);c.onsuccess=function(){var d=(0,j.A)(function*(a){const m=a.target.result,h=s.get(m);h.onsuccess=y=>{r.next(y.target.result),r.complete()},h.onerror=y=>{r.error(y)}});return function(a){return d.apply(this,arguments)}}(),c.onerror=d=>{r.error(d)}}).catch(o=>r.error(o))})}bulkAdd(e,n){const t=new Promise((r,o)=>{l(this.indexedDB,this.dbConfig.name,this.dbConfig.version).then(i=>{const c=p(i,x(g.readwrite,e,r,o)).objectStore(e),d=n.map(a=>new Promise((m,h)=>{const y=a.key;delete a.key;const _=y?c.add(a,y):c.add(a);_.onsuccess=E=>{const A=E.target.result;m(A)}}));r(Promise.all(d))}).catch(i=>o(i))});return(0,u.from)(t)}bulkDelete(e,n){const t=n.map(r=>new Promise((o,i)=>{l(this.indexedDB,this.dbConfig.name,this.dbConfig.version).then(s=>{const c=p(s,x(g.readwrite,e,i,o));c.objectStore(e).delete(r),c.oncomplete=()=>{this.getAll(e).pipe((0,M.take)(1)).subscribe(a=>{o(a)})}}).catch(s=>i(s))}));return(0,u.from)(Promise.all(t))}getByKey(e,n){return new u.Observable(t=>{l(this.indexedDB,this.dbConfig.name,this.dbConfig.version).then(r=>{const s=p(r,x(g.readonly,e,t.error)).objectStore(e).get(n);s.onsuccess=c=>{t.next(c.target.result),t.complete()},s.onerror=c=>{t.error(c)}}).catch(r=>t.error(r))})}bulkGet(e,n){const t=n.map(r=>this.getByKey(e,r));return new u.Observable(r=>{(0,u.combineLatest)(t).subscribe(o=>{r.next(o),r.complete()})})}getByID(e,n){return new u.Observable(t=>{l(this.indexedDB,this.dbConfig.name,this.dbConfig.version).then(r=>{f(r,e,c=>t.error(c));const s=p(r,x(g.readonly,e,t.error,t.next)).objectStore(e).get(n);s.onsuccess=c=>{t.next(c.target.result)}}).catch(r=>t.error(r))})}getByIndex(e,n,t){return new u.Observable(r=>{l(this.indexedDB,this.dbConfig.name,this.dbConfig.version).then(o=>{f(o,e,a=>r.error(a));const d=p(o,x(g.readonly,e,r.error)).objectStore(e).index(n).get(t);d.onsuccess=a=>{r.next(a.target.result),r.complete()}}).catch(o=>r.error(o))})}getAll(e){return new u.Observable(n=>{l(this.indexedDB,this.dbConfig.name,this.dbConfig.version).then(t=>{f(t,e,s=>n.error(s));const i=p(t,x(g.readonly,e,n.error,n.next)).objectStore(e).getAll();i.onerror=s=>{n.error(s)},i.onsuccess=({target:{result:s}})=>{n.next(s),n.complete()}}).catch(t=>n.error(t))})}update(e,n){return new u.Observable(t=>{l(this.indexedDB,this.dbConfig.name,this.dbConfig.version).then(r=>{f(r,e,c=>t.error(c));const i=p(r,x(g.readwrite,e,c=>t.error(c))).objectStore(e),s=i.put(n);s.onsuccess=function(){var c=(0,j.A)(function*(d){const a=d.target.result,m=i.get(a);m.onsuccess=h=>{t.next(h.target.result),t.complete()}});return function(d){return c.apply(this,arguments)}}()}).catch(r=>t.error(r))})}bulkPut(e,n){let t;return new u.Observable(r=>{l(this.indexedDB,this.dbConfig.name,this.dbConfig.version).then(o=>{f(o,e,s=>r.error(s)),t=p(o,x(g.readwrite,e,s=>r.error(s)));const i=t.objectStore(e);n.forEach((s,c)=>{const d=i.put(s);c===n.length-1&&(d.onsuccess=a=>{t.commit(),r.next(a.target.result),r.complete()}),d.onerror=a=>{t.abort(),r.error(a)}})}).catch(o=>{t?.abort(),r.error(o)})})}delete(e,n){return new u.Observable(t=>{l(this.indexedDB,this.dbConfig.name,this.dbConfig.version).then(r=>{f(r,e,s=>t.error(s));const o=p(r,x(g.readwrite,e,s=>t.error(s)));o.objectStore(e).delete(n),o.oncomplete=()=>{this.getAll(e).pipe((0,M.take)(1)).subscribe(s=>{t.next(s),t.complete()})}}).catch(r=>t.error(r))})}deleteByKey(e,n){return new u.Observable(t=>{l(this.indexedDB,this.dbConfig.name,this.dbConfig.version).then(r=>{f(r,e,s=>t.error(s));const o=p(r,x(g.readwrite,e,s=>t.error(s))),i=o.objectStore(e);o.oncomplete=()=>{t.next(!0),t.complete()},i.delete(n)}).catch(r=>t.error(r))})}clear(e){return new u.Observable(n=>{l(this.indexedDB,this.dbConfig.name,this.dbConfig.version).then(t=>{f(t,e,i=>n.error(i));const r=p(t,x(g.readwrite,e,i=>n.error(i)));r.objectStore(e).clear(),r.oncomplete=()=>{n.next(!0),n.complete()}}).catch(t=>n.error(t))})}deleteDatabase(){var e=this;return new u.Observable(n=>{l(this.indexedDB,this.dbConfig.name,this.dbConfig.version).then(function(){var t=(0,j.A)(function*(r){yield r.close();const o=e.indexedDB.deleteDatabase(e.dbConfig.name);o.onsuccess=()=>{n.next(!0),n.complete()},o.onerror=i=>n.error(i),o.onblocked=()=>{throw new Error("Unable to delete database because it's blocked")}});return function(r){return t.apply(this,arguments)}}()).catch(t=>n.error(t))})}openCursor(e,n,t="next"){return new u.Observable(r=>{l(this.indexedDB,this.dbConfig.name,this.dbConfig.version).then(o=>{f(o,e,d=>r.error(d));const s=p(o,x(g.readonly,e,r.error)).objectStore(e),c=n===void 0?s.openCursor():s.openCursor(n,t);c.onsuccess=d=>{r.next(d),r.complete()}}).catch(o=>r.error(o))})}openCursorByIndex(e,n,t,r="next",o=g.readonly){const i=new u.Subject;return l(this.indexedDB,this.dbConfig.name,this.dbConfig.version).then(s=>{f(s,e,h=>{i.error(h)});const m=p(s,x(o,e,h=>{i.error(h)},()=>{i.next()})).objectStore(e).index(n).openCursor(t,r);m.onsuccess=h=>{i.next(h)}}).catch(s=>i.error(s)),i}getAllByIndex(e,n,t){const r=[];return new u.Observable(o=>{l(this.indexedDB,this.dbConfig.name,this.dbConfig.version).then(i=>{f(i,e,m=>o.error(m));const a=p(i,x(g.readonly,e,o.error)).objectStore(e).index(n).openCursor(t);a.onsuccess=m=>{const h=m.target.result;h?(r.push(h.value),h.continue()):(o.next(r),o.complete())}}).catch(i=>o.error(i))})}getAllKeysByIndex(e,n,t){const r=[];return new u.Observable(o=>{l(this.indexedDB,this.dbConfig.name,this.dbConfig.version).then(i=>{f(i,e,m=>o.error(m));const a=p(i,x(g.readonly,e,o.error)).objectStore(e).index(n).openKeyCursor(t);a.onsuccess=m=>{const h=m.target.result;h?(r.push({primaryKey:h.primaryKey,key:h.key}),h.continue()):(o.next(r),o.complete())}}).catch(i=>o.error(i))})}count(e,n){return new u.Observable(t=>{l(this.indexedDB,this.dbConfig.name,this.dbConfig.version).then(r=>{f(r,e,c=>t.error(c));const s=p(r,x(g.readonly,e,t.error)).objectStore(e).count(n);s.onerror=c=>t.error(c),s.onsuccess=c=>{t.next(c.target.result),t.complete()}}).catch(r=>t.error(r))})}countByIndex(e,n,t){return new u.Observable(r=>{l(this.indexedDB,this.dbConfig.name,this.dbConfig.version).then(o=>{f(o,e,a=>r.error(a));const d=p(o,x(g.readonly,e,r.error)).objectStore(e).index(n).count(t);d.onerror=a=>r.error(a),d.onsuccess=a=>{r.next(a.target.result),r.complete()}}).catch(o=>r.error(o))})}deleteObjectStore(e){return B(this.dbConfig.name,++this.dbConfig.version,e)}static#e=this.\u0275fac=function(n){return new(n||I)(v.\u0275\u0275inject(q),v.\u0275\u0275inject(v.PLATFORM_ID))};static#t=this.\u0275prov=v.\u0275\u0275defineInjectable({token:I,factory:I.\u0275fac})}(typeof ngDevMode>"u"||ngDevMode)&&v.\u0275setClassMetadata(I,[{type:v.Injectable}],()=>[{type:void 0,decorators:[{type:v.Inject,args:[q]}]},{type:void 0,decorators:[{type:v.Inject,args:[v.PLATFORM_ID]}]}],null);class P{static forRoot(...e){const n={};for(const t of e)Object.assign(n,{[t.name]:t});return{ngModule:P,providers:[I,{provide:q,useValue:n}]}}static#e=this.\u0275fac=function(n){return new(n||P)};static#t=this.\u0275mod=v.\u0275\u0275defineNgModule({type:P});static#r=this.\u0275inj=v.\u0275\u0275defineInjector({imports:[w.CommonModule]})}(typeof ngDevMode>"u"||ngDevMode)&&v.\u0275setClassMetadata(P,[{type:v.NgModule,args:[{declarations:[],imports:[w.CommonModule]}]}],null,null)},73308:(K,k,D)=>{D.d(k,{A:()=>v});function j(w,u,M,l,S,C,B){try{var O=w[C](B),f=O.value}catch(p){M(p);return}O.done?u(f):Promise.resolve(f).then(l,S)}function v(w){return function(){var u=this,M=arguments;return new Promise(function(l,S){var C=w.apply(u,M);function B(f){j(C,l,S,B,O,"next",f)}function O(f){j(C,l,S,B,O,"throw",f)}B(void 0)})}}}}]);
